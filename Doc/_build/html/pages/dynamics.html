<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>8. Analysis: Dynamics &mdash; MDANSE 1.5.2 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="9. Analysis: Scattering" href="scattering.html" />
    <link rel="prev" title="7. Using MDANSE Graphical User Interface" href="gui.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> MDANSE
            <img src="../_static/mdanse_logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.5
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">MDANSE User Manual</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="opening.html">1. MDANSE User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="authors.html">2. Acknowledgements</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">3. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">4. Installing MDANSE</a></li>
<li class="toctree-l1"><a class="reference internal" href="build.html">5. Building MDANSE from source code</a></li>
<li class="toctree-l1"><a class="reference internal" href="files.html">6. Input and output files</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui.html">7. Using MDANSE Graphical User Interface</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">8. Analysis: Dynamics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#dynamics">8.1. Dynamics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#angular-correlation">8.1.1. Angular Correlation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#density-of-states">8.1.2. Density Of States</a></li>
<li class="toctree-l3"><a class="reference internal" href="#general-autocorrelation-function">8.1.3. General AutoCorrelation Function</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mean-square-displacement">8.1.4. Mean Square Displacement</a></li>
<li class="toctree-l3"><a class="reference internal" href="#order-parameter">8.1.5. Order Parameter</a></li>
<li class="toctree-l3"><a class="reference internal" href="#position-autocorrelation-function">8.1.6. Position AutoCorrelation Function</a></li>
<li class="toctree-l3"><a class="reference internal" href="#velocity-autocorrelation-function">8.1.7. Velocity AutoCorrelation Function</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="scattering.html">9. Analysis: Scattering</a></li>
<li class="toctree-l1"><a class="reference internal" href="structure.html">10. Analysis: Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="analysis.html">11. Analysis: other options</a></li>
<li class="toctree-l1"><a class="reference internal" href="cmd.html">12. Using MDANSE from command line</a></li>
<li class="toctree-l1"><a class="reference internal" href="trajectory.html">13. Trajectory Converters</a></li>
<li class="toctree-l1"><a class="reference internal" href="plotting.html">14. Plotting Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="plotting.html#units">15. Units</a></li>
<li class="toctree-l1"><a class="reference internal" href="parameters.html">16. Glossary of Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html">17. References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MDANSE</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li><span class="section-number">8. </span>Analysis: Dynamics</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/pages/dynamics.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="analysis-dynamics">
<h1><span class="section-number">8. </span>Analysis: Dynamics<a class="headerlink" href="#analysis-dynamics" title="Permalink to this heading"></a></h1>
<p>This menu contains all data manipulations and appears as in the picture
below when a trajectory is loaded. As indicated by the plus buttons,
each of these options is a menu in itself.</p>
<a class="reference internal image-reference" href="../_images/10000001000000F9000000B9A79707AE37EC9465.png"><img alt="../_images/10000001000000F9000000B9A79707AE37EC9465.png" src="../_images/10000001000000F9000000B9A79707AE37EC9465.png" style="width: 6.588cm; height: 4.895cm;" /></a>
<p>They are explored in greater depth in the following sections, and the
analyses are in turn explored in their subsections. Some contain a
discussion of the theory behind the computation, and all show the
analysis window of that analysis, the one that is launched by
double-clicking the option in this Plugins panel.</p>
<p>Each analysis window is different since each requires different
parameters to be configured before it can be run. However, all of them
have the same structure (example window below), consisting of these
parts:</p>
<ul class="simple">
<li><p><strong>trajectory</strong> box shows the path to the <a class="reference external" href="#_NetCDF_file_format">MMTK
NetCDF</a> trajectory that this analysis will
be performed on.</p></li>
<li><p><strong>Parameters</strong> are a group of options, of which the common ones are
discussed in depth in <a class="reference external" href="#_Appendix_2">Appendix 2</a>. These are the
options which vary from analysis to analysis. The only parameters
that exist on every analysis are Frames and Output files.</p></li>
<li><p><strong>Buttons</strong> are situated at the bottom of each analysis and consist
of these options:</p>
<ul>
<li><p><strong>Help</strong> opens the source code documentation for the relevant
class in an MDANSE window.</p></li>
<li><p><strong>Save</strong> opens a file browser that allows you to save the current
analysis with the set options into a python script which can be
run from the command line. More information about scripts in
<a class="reference external" href="#_Using_MDANSE_from">Using MDANSE from command line.</a></p></li>
<li><p><strong>Run</strong> starts the analysis and prompts you whether you want to
close the window. The status of the analysis can be found in the
<a class="reference external" href="#_Jobs">Jobs</a> panel, though there is a known bug where
successful analyses do not show up.</p></li>
</ul>
</li>
</ul>
<section id="dynamics">
<h2><span class="section-number">8.1. </span>Dynamics<a class="headerlink" href="#dynamics" title="Permalink to this heading"></a></h2>
<p>This section contains the following Plugins:</p>
<ul class="simple">
<li><p><a class="reference external" href="#_Angular_Correlation">Angular Correlation</a></p></li>
<li><p><a class="reference external" href="#_Density_Of_States">Density Of States</a></p></li>
<li><p><a class="reference external" href="#_General_AutoCorrelation_Function">General AutoCorrelation
Function</a></p></li>
<li><p><a class="reference external" href="#_Mean_Square_Displacement">Mean Square Displacement</a></p></li>
<li><p><a class="reference external" href="#_Order_Parameter">Order Parameter</a></p></li>
<li><p><a class="reference external" href="#_Position_AutoCorrelation_Function">Position AutoCorrelation
Function</a></p></li>
<li><p><a class="reference external" href="#_Velocity_AutoCorrelation_Function">Velocity AutoCorrelation
Function</a></p></li>
</ul>
<section id="angular-correlation">
<h3><span class="section-number">8.1.1. </span>Angular Correlation<a class="headerlink" href="#angular-correlation" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p>Available for trajectories only</p></li>
</ul>
<p>Theory and implementation</p>
<p>The angular correlation analysis computes the autocorrelation of a set
of vectors describing the extent of a molecule in three orthogonal
directions. This kind of analysis can be useful when trying to highlight
the fact that a molecule is constrained in a given direction.</p>
<p>For a given triplet of non-colinear atoms <em>g</em>=(a1,a2,a3), one can
derive an orthonormal set of three vectors v1, v2, v3 using the
following scheme:</p>
<ul>
<li><div class="math" id="equation-pfx1">
<p><span class="eqno">(1)<a class="headerlink" href="#equation-pfx1" title="Permalink to this equation"></a></span><img src="../_images/math/835be192d148b2fc664bf579224b43cf33d739ed.png" alt="v_{1} = \frac{n_{1} + n_{2}}{\left| \left| {n_{1} + n_{2}} \right| \right|}"/></p>
</div><p>where <strong>n</strong><sub>1</sub> and <strong>n</strong><sub>2</sub> are respectively the
normalized vectors along (<strong>a1,a2</strong>) and (<strong>a1,a3</strong>) directions.</p>
</li>
<li><p>v2 is defined as the clockwise normal vector orthogonal to v1 that
belongs to the plane defined by a1, a2 and a3 atoms</p></li>
<li><div class="math" id="equation-pfx2">
<p><span class="eqno">(2)<a class="headerlink" href="#equation-pfx2" title="Permalink to this equation"></a></span><img src="../_images/math/495f03f47239aa5565b6dd7ecc8cfe4c713d8072.png" alt="{\overrightarrow{v_{3}} = \overrightarrow{v_{1}}}\times\overrightarrow{v_{2}}"/></p>
</div></li>
</ul>
<p>Thus, one can define the following autocorrelation functions for the
vectors v1, v2 and v3 defined on triplet t :</p>
<div class="math" id="equation-pfx3">
<p><span class="eqno">(3)<a class="headerlink" href="#equation-pfx3" title="Permalink to this equation"></a></span><img src="../_images/math/b23e5a1a52b806bf792f7bc0b3a9cfad843db508.png" alt="{AC_{g,i}{(t) = \left\langle {v_{t,i}(0)\cdot v_{t,i}(t)} \right\rangle},{i = 1,2,3}}"/></p>
</div><p>And the angular correlation averaged over all triplets is:</p>
<div class="math" id="equation-pfx4">
<p><span class="eqno">(4)<a class="headerlink" href="#equation-pfx4" title="Permalink to this equation"></a></span><img src="../_images/math/893be8d5bcf17f9c6138516289cd830b3db22a99.png" alt="{AC_{i}{(t) = {\sum\limits_{g = 1}^{N_{\mathit{triplets}}}{AC_{g,i}(t)}}},{i = 1,2,3}}"/></p>
</div><p>where N<sub>triplets</sub> is the number of selected triplets.</p>
<p>GUI</p>
<a class="reference internal image-reference" href="../_images/10000001000003220000021BA346CFB73717C1BE.png"><img alt="../_images/10000001000003220000021BA346CFB73717C1BE.png" src="../_images/10000001000003220000021BA346CFB73717C1BE.png" style="width: 15.921cm; height: 10.7cm;" /></a>
<p>Parameters:</p>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Axis_Selection_1">axis selection</a></p></li>
<li><p><a class="reference external" href="#_Output_contribution_per">output contribution per axis</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="density-of-states">
<h3><span class="section-number">8.1.2. </span>Density Of States<a class="headerlink" href="#density-of-states" title="Permalink to this heading"></a></h3>
<p id="theory-and-implementation-1">Theory and implementation</p>
<p><em>MDANSE</em> calculates the power spectrum of the <em>VACF</em>, which in case of
the mass-weighted <em>VACF</em> defines the phonon discrete <em>DOS</em>, (see the
section on <a class="reference external" href="#_Theory_and_implementation_1">VACF</a>) defined as:</p>
<div class="math" id="equation-pfx5">
<p><span class="eqno">(5)<a class="headerlink" href="#equation-pfx5" title="Permalink to this equation"></a></span><img src="../_images/math/c8af5b3b99f47ad217eeb3f0df0b1fc5f57cc59b.png" alt="{\mathit{DOS}\left( {n\cdot\mathit{\Delta\nu}} \right)\doteq{\sum\limits_{\alpha}\omega_{\alpha}}{\overset{\sim}{C}}_{\mathit{vv};\mathit{\alpha\alpha}}\left( {n\cdot\mathit{\Delta\nu}} \right),{n = 0}\ldots{N_{t} - 1.}}"/></p>
</div><p>N<sub>t</sub> is the total number of time steps and</p>
<div class="math" id="equation-pfx6">
<p><span class="eqno">(6)<a class="headerlink" href="#equation-pfx6" title="Permalink to this equation"></a></span><img src="../_images/math/eaf4cb5116f407dac2bd0c2b940502b8e733012c.png" alt="{\mathit{\Delta\nu} = 1}\text{/}\left( {2N_{t}\Delta t} \right)"/></p>
</div><p>is the frequency step.</p>
<div class="math" id="equation-pfx7">
<p><span class="eqno">(7)<a class="headerlink" href="#equation-pfx7" title="Permalink to this equation"></a></span><img src="../_images/math/af4573cc36e216a7c438f26337d4d3df941f4644.png" alt="{\mathit{DOS}\left( {n\cdot\mathit{\Delta\nu}} \right)}"/></p>
</div><p>can be computed either for the isotropic case or with respect to a
user-defined axis. The spectrum</p>
<div class="math" id="equation-pfx8">
<p><span class="eqno">(8)<a class="headerlink" href="#equation-pfx8" title="Permalink to this equation"></a></span><img src="../_images/math/38e99d4b08c8f366c4d43c585e030efb1dacd536.png" alt="{\mathit{DOS}\left( {n\cdot\Delta\nu} \right)}"/></p>
</div><p>is computed from the <em>unnormalized VACF</em>, such that <em>DOS(0)</em> gives an
approximate value for the diffusion constant</p>
<div class="math" id="equation-pfx9">
<p><span class="eqno">(9)<a class="headerlink" href="#equation-pfx9" title="Permalink to this equation"></a></span><img src="../_images/math/3e72e6f98a9b7c8fba154798fe720c773e2db989.png" alt="{D = {\sum\limits_{\alpha}D_{\alpha}}}"/></p>
</div><p>(see Eqs. <img class="math" src="../_images/math/475d5964a90500c461804bca3d965ff8679e248c.png" alt="10"/> and <img class="math" src="../_images/math/2ee3680488bb1f7166e08a65cef9a7e3d7020d78.png" alt="11"/>).</p>
<div class="math" id="equation-pfx10">
<p><span class="eqno">(10)<a class="headerlink" href="#equation-pfx10" title="Permalink to this equation"></a></span><img src="../_images/math/38e99d4b08c8f366c4d43c585e030efb1dacd536.png" alt="{\mathit{DOS}\left( {n\cdot\Delta\nu} \right)}"/></p>
</div><p>is smoothed by applying a Gaussian window in the time domain
[<a class="reference external" href="#SignetBibliographie_010">10</a>] (see the section on <a class="reference external" href="#_Theory_and_implementation">Spatial
Density</a>). Its width in the time domain
is</p>
<div class="math" id="equation-pfx11">
<p><span class="eqno">(11)<a class="headerlink" href="#equation-pfx11" title="Permalink to this equation"></a></span><img src="../_images/math/d5ef271fd50635b3ea8f445e9cad09f00bc59d2e.png" alt="{\sigma_{t} = \alpha}\text{/}T"/></p>
</div><p>, where T is the length of the simulation. We remark that the diffusion
constant obtained from <em>DOS</em> is biased due to the spectral smoothing
procedure since the <em>VACF</em> is weighted by this window Gaussian function.
<em>MDANSE</em> computes the density of states starting from both atomic
velocities and atomic coordinates. In this case the velocities are
computed by numerical differentiation of the coordinate trajectories
correcting first for possible jumps due to periodic boundary conditions.</p>
<p id="gui-1">GUI</p>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<p><a class="reference internal" href="../_images/1000000100000323000002D1329469D922AFA541.png"><img alt="image14" src="../_images/1000000100000323000002D1329469D922AFA541.png" style="width: 15.921cm; height: 14.295cm;" /></a> <a class="reference internal" href="../_images/100000010000031E000000F3118920C50EDE8CB0.png"><img alt="image15" src="../_images/100000010000031E000000F3118920C50EDE8CB0.png" style="width: 15.921cm; height: 4.847cm;" /></a></p>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Instrument_resolution">instrument resolution</a></p></li>
<li><p><a class="reference external" href="#_Interpolation_order">interpolation order</a></p></li>
<li><p><a class="reference external" href="#_Project_coordinates">project coordinates</a></p></li>
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Group_coordinates_by">Group coordinates by</a></p></li>
<li><p><a class="reference external" href="#_Atom_Transmutation_1">atom transmutation</a></p></li>
<li><p><a class="reference external" href="#_Weights">weights</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="general-autocorrelation-function">
<h3><span class="section-number">8.1.3. </span>General AutoCorrelation Function<a class="headerlink" href="#general-autocorrelation-function" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<p><a class="reference internal" href="../_images/100000010000031F00000248D8781028790CCDA5.png"><img alt="image16" src="../_images/100000010000031F00000248D8781028790CCDA5.png" style="width: 15.921cm; height: 11.636cm;" /></a> <a class="reference internal" href="../_images/100000010000031E00000105F69265329BBA5756.png"><img alt="image17" src="../_images/100000010000031E00000105F69265329BBA5756.png" style="width: 15.921cm; height: 5.207cm;" /></a></p>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Group_coordinates_by">Group coordinates by</a></p></li>
<li><p><a class="reference external" href="#_Atom_Transmutation_1">atom transmutation</a></p></li>
<li><p><strong>trajectory variable</strong></p></li>
</ul>
<p><em>Format:</em> drop-down</p>
<p><em>Default:</em> configuration</p>
<p><em>Description:</em> determines the variable for which the autocorrelation
function is calculated. Therefore, if the selected variable is
‘configuration’, essentially position autocorrelation function is
calculated.</p>
<ul class="simple">
<li><p><a class="reference external" href="#_Normalize">normalize</a></p></li>
<li><p><a class="reference external" href="#_Weights">weights</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="mean-square-displacement">
<h3><span class="section-number">8.1.4. </span>Mean Square Displacement<a class="headerlink" href="#mean-square-displacement" title="Permalink to this heading"></a></h3>
<p id="theory-and-implementation-2">Theory and implementation</p>
<p>Molecules in liquids and gases do not stay in the same place but move
constantly. This process is called diffusion and it happens quite
naturally in fluids at equilibrium. During this process, the motion of
an individual molecule does not follow a simple path. As it travels, the
molecule undergoes some collisions with other molecules which prevent it
from following a straight line. If the path is examined in close detail,
it will be seen to be a good approximation to a random walk.
Mathematically, a random walk is a series of steps where each step is
taken in a completely random direction from the one before. This kind of
path was famously analysed by Albert Einstein in a study of Brownian
motion. He showed that the Mean-Square Displacement (<em>MSD</em>) of a
particle following a random walk is proportional to the time elapsed.
This relationship can be written as</p>
<div class="math" id="equation-pfx12">
<p><span class="eqno">(12)<a class="headerlink" href="#equation-pfx12" title="Permalink to this equation"></a></span><img src="../_images/math/fac2ca7fcc6a05c8f9431672b56c6a99eadfbfb8.png" alt="{\left\langle r^{2} \right\rangle = 6}{\mathit{Dt} + C}"/></p>
</div><p>where &lt; r2 &gt; is the <em>MSD</em> and <em>t</em> is the time. <em>D</em> and <em>C</em> are
constants. The constant <em>D</em> defines the so-called diffusion coefficient.</p>
<p>The <a class="reference external" href="#figure1">Figure 1</a> shows an example of an <em>MSD</em> analysis
performed on a water box of 768 water molecules. To get the diffusion
coefficient out of this plot, the slope of the linear part of the plot
should be calculated.</p>
<a class="reference internal image-reference" href="../_images/10000000000001BC00000163C18A769B32940652.png"><img alt="../_images/10000000000001BC00000163C18A769B32940652.png" src="../_images/10000000000001BC00000163C18A769B32940652.png" style="width: 11.748cm; height: 9.393cm;" /></a>
<p>Figure 1: <em>MSD</em> calculated for a 100 ps MD simulation of 256 water
molecules using NPT condition at 1 bar and 300 K.</p>
<p>Defining</p>
<div class="math" id="equation-pfx13">
<p><span class="eqno">(13)<a class="headerlink" href="#equation-pfx13" title="Permalink to this equation"></a></span><img src="../_images/math/201285b5a1f4dd115f63487802288396ca681d50.png" alt="{d_{\alpha}\left( {t,t_{0}} \right)\doteq R_{\alpha}{\left( {t_{0} + t} \right) - R_{\alpha}}\left( t_{0} \right),}"/></p>
</div><p>the <em>MSD</em> of particle <img class="math" src="../_images/math/2f5aa019312e1bbc969deab8dca8b00f76025404.png" alt="\alpha"/> can be defined as:</p>
<div class="math" id="equation-pfx14">
<p><span class="eqno">(14)<a class="headerlink" href="#equation-pfx14" title="Permalink to this equation"></a></span><img src="../_images/math/9f4c39f351d245bd50fe3b625e7ce7c914f92d98.png" alt="\mathrm{\Delta}_{\alpha}^{2}{(t) = \left\langle {d_{\alpha}^{2}\left( {t,t_{0}} \right)} \right\rangle_{t_{0}}}"/></p>
</div><p>where R_(t0) and R_(t0 + t) are respectively the position of particle <img class="math" src="../_images/math/2f5aa019312e1bbc969deab8dca8b00f76025404.png" alt="\alpha"/>
at times t0 and t0 + t. One can introduce an <em>MSD</em> with respect to a
given axis n:</p>
<div class="math" id="equation-pfx15">
<p><span class="eqno">(15)<a class="headerlink" href="#equation-pfx15" title="Permalink to this equation"></a></span><img src="../_images/math/7f3456cd8834f6aff06373a28fc3fb909207d723.png" alt="{\mathrm{\Delta}_{\alpha}^{2}\left( {t,t_{0};n} \right)\doteq\left\langle {d_{\alpha}^{2}\left( {t,\tau;n} \right)} \right\rangle_{t_{0}}}"/></p>
</div><p>with</p>
<div class="math" id="equation-pfx16">
<p><span class="eqno">(16)<a class="headerlink" href="#equation-pfx16" title="Permalink to this equation"></a></span><img src="../_images/math/e91079c6f9e51ba3ce11dbbb3f9c05ea235fd613.png" alt="{d_{\alpha}^{}\left( {t,\tau;n} \right)\doteq n\bullet d_{\alpha}^{}\left( {t,t_{0}} \right).}"/></p>
</div><p>The calculation of <em>MSD</em> is the standard way to obtain diffusion
coefficients from Molecular Dynamics (<em>MD</em>) simulations. Assuming
Einstein-diffusion in the long time limit one has for isotropic systems</p>
<div class="math" id="equation-pfx17">
<p><span class="eqno">(17)<a class="headerlink" href="#equation-pfx17" title="Permalink to this equation"></a></span><img src="../_images/math/c062bfc85f64e6eff7df60e884e50a4add48322a.png" alt="{D_{\alpha} = {\lim\limits_{t\rightarrow\infty}{\frac{1}{6t}\mathrm{\Delta}_{\alpha}^{2}(t)}}}."/></p>
</div><p>There exists also a well-known relation between the <em>MSD</em> and the
velocity autocorrelation function. Writing</p>
<div class="math" id="equation-pfx18">
<p><span class="eqno">(18)<a class="headerlink" href="#equation-pfx18" title="Permalink to this equation"></a></span><img src="../_images/math/88d27269edc30468390b89d0496fde54ce51b2fc.png" alt="{d_{\alpha}{(t) = {\int\limits_{0}^{t}{\mathit{d\tau}v_{\alpha}(\tau)}}}}"/></p>
</div><p>in Eq. <img class="math" src="../_images/math/51d4ace3c51c5a5490fc4464952d6c46d518fbc8.png" alt="5"/> one can show (see
e.g. [<a class="reference external" href="#SignetBibliographie_011">11</a>]) that</p>
<div class="math" id="equation-pfx19">
<p><span class="eqno">(19)<a class="headerlink" href="#equation-pfx19" title="Permalink to this equation"></a></span><img src="../_images/math/ca4c13aceeb31d8ab6139c909ba4106ab255fbee.png" alt="{\mathrm{\Delta}_{\alpha}^{2}{(t) = 6}{\int\limits_{0}^{t}{\mathit{d\tau}\left( {t - \tau} \right)C_{\mathit{\upsilon\upsilon};\mathit{\alpha\alpha}}(t)}}.}"/></p>
</div><p>Using now the definition <img class="math" src="../_images/math/963219eafec84d240711eb594e2b8904b8883d82.png" alt="8"/> of the diffusion
coefficient one obtains the relation</p>
<div class="math" id="equation-pfx20">
<p><span class="eqno">(20)<a class="headerlink" href="#equation-pfx20" title="Permalink to this equation"></a></span><img src="../_images/math/e0df5ba347c185f0266138845480c68c351fa8a6.png" alt="{{D_{\alpha} = {\int\limits_{0}^{t}{\mathit{d\tau}C_{\mathit{\upsilon\upsilon};\mathit{\alpha\alpha}}(t)}}}.}"/></p>
</div><p>With Eq. <img class="math" src="../_images/math/5d9fae2fae50dbfa109b452f6cd56007137e5cc4.png" alt="28"/> this can also be written as</p>
<div class="math" id="equation-pfx21">
<p><span class="eqno">(21)<a class="headerlink" href="#equation-pfx21" title="Permalink to this equation"></a></span><img src="../_images/math/5866a83acd08f7cfae5620c7f8c45412c646aa53.png" alt="{{D_{\alpha} = \pi}{\overset{\sim}{C}}_{\mathit{\upsilon\upsilon};\mathit{\alpha\alpha}}(0).}"/></p>
</div><p>Computationally, the <em>MSD</em> is calculated using the Fast Correlation
Algorithm (<em>FCA</em>) [<a class="reference external" href="#SignetBibliographie_012">12</a>]. In this
framework, in the discrete case, the mean-square displacement of a
particle is given by</p>
<div class="math" id="equation-pfx22">
<p><span class="eqno">(22)<a class="headerlink" href="#equation-pfx22" title="Permalink to this equation"></a></span><img src="../_images/math/b6a8aa4b62c75c1f6d09eda81a9eda52d2e58d6e.png" alt="{\mathrm{\Delta}^{2}{(m) = \frac{1}{N_{t} - m}}{\sum\limits_{k = 0}^{N_{t} - m - 1}\left\lbrack {r{\left( {k + m} \right) - r}(k)} \right\rbrack^{2}},{m = 0.}..{N_{t} - 1}}"/></p>
</div><p>where r(k) is the particle trajectory and <img class="math" src="../_images/math/9833b53d840a07e6a9b33d17ddd3f5dbb7810ebe.png" alt="N_{t}"/> is the number of frames of
the trajectory. We define now the auxiliary function</p>
<div class="math" id="equation-pfx23">
<p><span class="eqno">(23)<a class="headerlink" href="#equation-pfx23" title="Permalink to this equation"></a></span><img src="../_images/math/380633701dc3ae01feecd81628fe1489e6d07fb2.png" alt="{S(m)\doteq{\sum\limits_{k = 0}^{N_{t} - m - 1}\left\lbrack {r{\left( {k + m} \right) - r}(k)} \right\rbrack^{2}},{m = 0}...N{t - 1},}"/></p>
</div><p>which is split as follows:</p>
<div class="math" id="equation-pfx24">
<p><span class="eqno">(24)<a class="headerlink" href="#equation-pfx24" title="Permalink to this equation"></a></span><img src="../_images/math/f8f2cbe43327af7afa6a385dd9b9d576351602f3.png" alt="{S{(m) = S_{\mathit{AA} + \mathit{BB}}}{(m) - 2}S_{\mathit{AB}}(m),}"/></p>
</div><div class="math" id="equation-pfx25">
<p><span class="eqno">(25)<a class="headerlink" href="#equation-pfx25" title="Permalink to this equation"></a></span><img src="../_images/math/ac44f7912b2ef28433af7c039a20a059ee8a74c4.png" alt="{S_{\mathit{AA} + \mathit{BB}}{(m) = \sum\limits_{k = 0}^{N_{t} - m - 1}}\left\lbrack {r^{2}{\left( {k + m} \right) + r^{2}}(k)} \right\rbrack,}"/></p>
</div><div class="math" id="equation-pfx26">
<p><span class="eqno">(26)<a class="headerlink" href="#equation-pfx26" title="Permalink to this equation"></a></span><img src="../_images/math/f7fd8ddcfd53b5ce2833f55b58d233a96fed1678.png" alt="{S_{\mathit{AB}}{(m) = {\sum\limits_{k = 0}^{N_{t} - m - 1}{r(k)}}}\cdot r\left( {k + m} \right).}"/></p>
</div><p>The function SAB(m) can be computed using the <em>FCA</em> method described in
the section on <a class="reference external" href="#_Theory_and_implementation">Spatial Density</a>. For
SAA+BB(m) the following recursion relation holds:</p>
<div class="math" id="equation-pfx27">
<p><span class="eqno">(27)<a class="headerlink" href="#equation-pfx27" title="Permalink to this equation"></a></span><img src="../_images/math/c17c2fee779ca3c54f5b634e3cecf42f274cbbec.png" alt="{S_{\mathit{AA} + \mathit{BB}}{(m) = S_{\mathit{AA} + \mathit{BB}}}{\left( {m - 1} \right) - r^{2}}{\left( {m - 1} \right) - r^{2}}\left( {N_{t} - m} \right),}"/></p>
</div><div class="math" id="equation-pfx28">
<p><span class="eqno">(28)<a class="headerlink" href="#equation-pfx28" title="Permalink to this equation"></a></span><img src="../_images/math/bffcefaca518ca02cdabd6d8ea0209f2a48eeb93.png" alt="{S_{\mathit{AA} + \mathit{BB}}{(0) = {\sum\limits_{k = 0}^{N_{t} - 1}{r^{2}(k)}}}.}"/></p>
</div><p>This allows one to construct the following efficient scheme for the
computation of the <em>MSD</em>:</p>
<ol class="arabic">
<li><p>Compute</p>
<div class="math" id="equation-pfx29">
<p><span class="eqno">(29)<a class="headerlink" href="#equation-pfx29" title="Permalink to this equation"></a></span><img src="../_images/math/6e423177eabbaf0ac04ee03ebb350930d0d8d7fe.png" alt="{\mathit{DSQ}{{(k)} = r}2{(k)},{k = 0}...N{t - 1}}"/></p>
</div><p>;</p>
<div class="math" id="equation-pfx30">
<p><span class="eqno">(30)<a class="headerlink" href="#equation-pfx30" title="Permalink to this equation"></a></span><img src="../_images/math/0ec420256e11b877b1df7aa9359f262fa31b4dff.png" alt="{\mathit{DSQ}{{({- 1})} = \mathit{DSQ}}{{({Nt})} = 0}}"/></p>
</div><p>.</p>
</li>
<li><p>Compute</p>
<div class="math" id="equation-pfx31">
<p><span class="eqno">(31)<a class="headerlink" href="#equation-pfx31" title="Permalink to this equation"></a></span><img src="../_images/math/9d117ec2b5fbe13ce43d2eb96c3278ec194197a2.png" alt="{\mathit{SUMSQ} = 2}\cdot{\sum\limits_{k = 0}^{N_{t} - 1}{\mathit{DSQ}(k)}}"/></p>
</div></li>
<li><p>Compute SAB(m) using the Fast Fourier Transform (<em>FFT</em>) method.</p></li>
<li><p>Compute <em>MSD(m)</em> in the following loop:</p></li>
</ol>
<div class="math" id="equation-pfx32">
<p><span class="eqno">(32)<a class="headerlink" href="#equation-pfx32" title="Permalink to this equation"></a></span><img src="../_images/math/3771eaa19b3350522425f1caaf8f222439588415.png" alt="{\mathit{SUMSQ}\leftarrow{\mathit{SUMSQ} - \mathit{DSQ}}{{({m - 1})} - \mathit{DSQ}}{({N{t - m}})}}"/></p>
</div><div class="math" id="equation-pfx33">
<p><span class="eqno">(33)<a class="headerlink" href="#equation-pfx33" title="Permalink to this equation"></a></span><img src="../_images/math/6723a0605e6a70352bde8271f8e4ddc5aafdda45.png" alt="{\mathit{MSD}{(m)}\leftarrow{}}"/></p>
</div><p>m running from 0 to Nt - 1</p>
<p>It should be noted that the efficiency of this algorithm is the same as
for the <em>FCA</em> computation</p>
<p>of time correlation functions since the number of operations in step
(1), (2), and (4) grows</p>
<p>linearly with Nt.</p>
<p id="gui-2">GUI</p>
<p><a class="reference internal" href="../_images/100000010000031F00000247259172131CFA3B36.png"><img alt="image18" src="../_images/100000010000031F00000247259172131CFA3B36.png" style="width: 15.921cm; height: 11.617cm;" /></a> <a class="reference internal" href="../_images/100000010000031F000001000B539E0E94164B2D.png"><img alt="image19" src="../_images/100000010000031F000001000B539E0E94164B2D.png" style="width: 15.921cm; height: 5.101cm;" /></a></p>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Project_coordinates">project coordinates</a></p></li>
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Group_coordinates_by">Group coordinates by</a></p></li>
<li><p><a class="reference external" href="#_Atom_Transmutation_1">atom transmutation</a></p></li>
<li><p><a class="reference external" href="#_Weights">weights</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="order-parameter">
<h3><span class="section-number">8.1.5. </span>Order Parameter<a class="headerlink" href="#order-parameter" title="Permalink to this heading"></a></h3>
<p id="theory-and-implementation-3">Theory and implementation</p>
<p>Adequate and accurate cross comparison of the NMR and <em>MD</em> simulation
data is of crucial importance in versatile studies conformational
dynamics of proteins. NMR relaxation spectroscopy has proven to be a
unique approach for a site-specific investigation of both global
tumbling and internal motions of proteins. The molecular motions
modulate the magnetic interactions between the nuclear spins and lead
for each nuclear spin to a relaxation behaviour which reflects its
environment. Since its first applications to the study of protein
dynamics, a wide variety of experiments has been proposed to investigate
backbone as well as side chain dynamics. Among them, the heteronuclear
relaxation measurement of amide backbone <sup>15</sup>N nuclei is one of
the most widespread techniques. The relationship between microscopic
motions and measured spin relaxation rates is given by Redfield’s theory
[<a class="reference external" href="#SignetBibliographie_013">13</a>]. Under the hypothesis that
<sup>15</sup>N relaxation occurs through dipole-dipole interactions with
the directly bonded <sup>1</sup>H atom and chemical shift anisotropy
(CSA), and assuming that the tensor describing the CSA is axially
symmetric with its axis parallel to the N-H bond, the relaxation rates
of the <sup>15</sup>N nuclei are determined by a time correlation
function,</p>
<div class="math" id="equation-pfx34">
<p><span class="eqno">(34)<a class="headerlink" href="#equation-pfx34" title="Permalink to this equation"></a></span><img src="../_images/math/49cd4adb4a284e61f91aa8b80c373e2d390fd0be.png" alt="{C_{\mathit{ii}}{(t) = \left\langle {P_{2}\left( {\mu_{i}(0)\cdot\mu_{i}(t)} \right)} \right\rangle}}"/></p>
</div><p>which describes the dynamics of a unit vector μ<sub>i</sub>(t) pointing
along the <sup>15</sup>N-<sup>1</sup>H bond of the residue <em>i</em> in the
laboratory frame. Here P<sub>2</sub>(.) is the second order Legendre
polynomial. The Redfield theory shows that relaxation measurements probe
the relaxation dynamics of a selected nuclear spin only at a few
frequencies. Moreover, only a limited number of independent observables
are accessible. Hence, to relate relaxation data to protein dynamics one
has to postulate either a dynamical model for molecular motions or a
functional form for C<sub>ii</sub>(t), yet depending on a limited number
of adjustable parameters. Usually, the tumbling motion of proteins in
solution is assumed isotropic and uncorrelated with the internal
motions, such that:</p>
<div class="math" id="equation-pfx35">
<p><span class="eqno">(35)<a class="headerlink" href="#equation-pfx35" title="Permalink to this equation"></a></span><img src="../_images/math/7556f218c7f3019253e58df5fdef585857669d68.png" alt="{C_{\mathit{ii}}{(t) = C^{G}}(t)\cdot C_{\mathit{ii}}^{I}(t)}"/></p>
</div><p>where C<sup>G</sup>(t) and</p>
<div class="math" id="equation-pfx36">
<p><span class="eqno">(36)<a class="headerlink" href="#equation-pfx36" title="Permalink to this equation"></a></span><img src="../_images/math/4a735613b8779883848f0aa9a247cc9e57bf9f24.png" alt="{C_{\mathit{ii}}^{I}(t)}"/></p>
</div><p>denote the global and the internal time correlation function,
respectively. Within the so-called model free approach
[<a class="reference external" href="#SignetBibliographie_014">14</a>], [<a class="reference external" href="#SignetBibliographie_015">15</a>]
the internal correlation function is modelled by an exponential,</p>
<div class="math" id="equation-pfx37">
<p><span class="eqno">(37)<a class="headerlink" href="#equation-pfx37" title="Permalink to this equation"></a></span><img src="../_images/math/267320f1bdef0e8668e63d63dd8f9955bf572c5c.png" alt="{C_{\mathit{ii}}^{I}{(t) = {S_{i}^{2} + \left( {1 - S_{i}^{2}} \right)}}\exp\left( \frac{- t}{\tau_{\mathit{eff},i}} \right)}"/></p>
</div><p>Here the asymptotic value</p>
<div class="math" id="equation-pfx38">
<p><span class="eqno">(38)<a class="headerlink" href="#equation-pfx38" title="Permalink to this equation"></a></span><img src="../_images/math/79029b0b02397ed9d642737db70bdad9e2c6d511.png" alt="{S_{i}^{2} = C_{\mathit{ii}}}\left( {+ \infty} \right)"/></p>
</div><p>is the so-called generalized order parameter, which indicates the
degree of spatial restriction of the internal motions of a bond vector,
while the characteristic time</p>
<div class="math" id="equation-pfx39">
<p><span class="eqno">(39)<a class="headerlink" href="#equation-pfx39" title="Permalink to this equation"></a></span><img src="../_images/math/a621278da70308b8fe95a0c53d2e952090a77b15.png" alt="{tau_{\mathit{eff},i}}"/></p>
</div><p>is an effective correlation time, setting the time scale of the
internal relaxation processes.</p>
<div class="math" id="equation-pfx40">
<p><span class="eqno">(40)<a class="headerlink" href="#equation-pfx40" title="Permalink to this equation"></a></span><img src="../_images/math/f9dcc861ff1359978bb705dda431e5037ae81a69.png" alt="{S_{i}^{2}}"/></p>
</div><p>can adopt values ranging from 0 (completely disordered) to 1 (fully
ordered). So,</p>
<div class="math" id="equation-pfx41">
<p><span class="eqno">(41)<a class="headerlink" href="#equation-pfx41" title="Permalink to this equation"></a></span><img src="../_images/math/f9dcc861ff1359978bb705dda431e5037ae81a69.png" alt="{S_{i}^{2}}"/></p>
</div><p>is the appropriate indicator of protein backbone motions in
computationally feasible timescales as it describes the spatial aspects
of the reorientational motion of N-H peptidic bonds vector.</p>
<p>When performing Order Parameter analysis, <em>MDANSE</em> computes for each
residue <em>i</em> both</p>
<div class="math" id="equation-pfx42">
<p><span class="eqno">(42)<a class="headerlink" href="#equation-pfx42" title="Permalink to this equation"></a></span><img src="../_images/math/04969f09866299ec55b4703d7d84bc876049881f.png" alt="{C_{\mathit{ii}}(t)}"/></p>
</div><p>and</p>
<div class="math" id="equation-pfx43">
<p><span class="eqno">(43)<a class="headerlink" href="#equation-pfx43" title="Permalink to this equation"></a></span><img src="../_images/math/f9dcc861ff1359978bb705dda431e5037ae81a69.png" alt="{S_{i}^{2}}"/></p>
</div><p>. It also computes a correlation function averaged over all the selected
bonds defined as:</p>
<div class="math" id="equation-pfx44">
<p><span class="eqno">(44)<a class="headerlink" href="#equation-pfx44" title="Permalink to this equation"></a></span><img src="../_images/math/ee2d5585028ba086512aba2c70dff1f9a4978364.png" alt="{C^{I}{(t) = {\sum\limits_{i = 1}^{N_{\mathit{bonds}}}{C_{\mathit{ii}}^{I}(t)}}}}"/></p>
</div><p>where N<sub>bonds</sub> is the number of selected bonds for the analysis.</p>
<p id="gui-3">GUI</p>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<a class="reference internal image-reference" href="../_images/10000001000003220000027563B8CBFF70E2089C.png"><img alt="../_images/10000001000003220000027563B8CBFF70E2089C.png" src="../_images/10000001000003220000027563B8CBFF70E2089C.png" style="width: 15.921cm; height: 12.487cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Axis_Selection_1">axis selection</a></p></li>
<li><p>reference direction</p>
<ul>
<li><p><strong>x-component</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int or float</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> &lt;insert&gt;</p>
<ul class="simple">
<li><ul>
<li><p><strong>y-component</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int or float</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> &lt;insert&gt;</p>
<ul class="simple">
<li><ul>
<li><p><strong>z-component</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int or float</p>
<p><em>Default:</em> 1</p>
<p><em>Description:</em> &lt;insert&gt;</p>
<ul class="simple">
<li><p><a class="reference external" href="#_Output_contribution_per">output contribution per axis</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="position-autocorrelation-function">
<h3><span class="section-number">8.1.6. </span>Position AutoCorrelation Function<a class="headerlink" href="#position-autocorrelation-function" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<p><a class="reference internal" href="../_images/1000000100000320000001F34B3598CBB7D90098.png"><img alt="image20" src="../_images/1000000100000320000001F34B3598CBB7D90098.png" style="width: 15.921cm; height: 9.931cm;" /></a> <a class="reference internal" href="../_images/1000000100000322000001997BE6CF552F7A05D0.png"><img alt="image21" src="../_images/1000000100000322000001997BE6CF552F7A05D0.png" style="width: 15.921cm; height: 8.119cm;" /></a></p>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Normalize">normalize</a></p></li>
<li><p><a class="reference external" href="#_Project_coordinates">project coordinates</a></p></li>
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Group_coordinates_by">Group coordinates by</a></p></li>
<li><p><a class="reference external" href="#_Atom_Transmutation_1">atom transmutation</a></p></li>
<li><p><a class="reference external" href="#_Weights">weights</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="velocity-autocorrelation-function">
<h3><span class="section-number">8.1.7. </span>Velocity AutoCorrelation Function<a class="headerlink" href="#velocity-autocorrelation-function" title="Permalink to this heading"></a></h3>
<p id="theory-and-implementation-4">Theory and implementation</p>
<p>The Velocity AutoCorrelation Function (<em>VACF</em>) is another interesting
property describing the dynamics of a molecular system. Indeed, it
reveals the underlying nature of the forces acting on the system.</p>
<p>In a molecular system that would be made of non-interacting particles,
the velocities would be constant at any time triggering the <em>VACF</em> to be
a constant value. Now, if we think about a system with small
interactions such as in a gas-phase, the magnitude and direction of the
velocity of a particle will change gradually over time due to its
collision with the other particles of the molecular system. In such a
system, the <em>VACF</em> will be represented by a decaying exponential.</p>
<p>In the case of solid phase, the interactions are much stronger and, as a
results, the atoms are bound to a given position from which they will
move backwards and forwards oscillating between positive and negative
values of their velocity. The oscillations will not be of equal
magnitude however, but will decay in time, because there are still
perturbative forces acting on the atoms to disrupt the perfection of
their oscillatory motion. So, in that case the <em>VACF</em> will look like a
damped harmonic motion.</p>
<p>Finally, in the case of liquid phase, the atoms have more freedom than
in solid phase and because of the diffusion process, the oscillatory
motion seen in solid phase will be cancelled quite rapidly depending on
the density of the system. So, the <em>VACF</em> will just have one very damped
oscillation before decaying to zero. This decaying time can be
considered as the average time for a collision between two atoms to
occur before they diffuse away.</p>
<p>Mathematically, the <em>VACF</em> of atom <img class="math" src="../_images/math/2f5aa019312e1bbc969deab8dca8b00f76025404.png" alt="\alpha"/> in an atomic or molecular system is
usually defined as</p>
<div class="math" id="equation-pfx45">
<p><span class="eqno">(45)<a class="headerlink" href="#equation-pfx45" title="Permalink to this equation"></a></span><img src="../_images/math/9545ea3c0235d69fb495bfa658e9d86c28e577b7.png" alt="{C_{\mathit{vv};\mathit{\alpha\alpha}}(t)\doteq\frac{1}{3}\left\langle {v_{\alpha}\left( t_{0} \right)\cdot v_{\alpha}\left( {t_{0} + t} \right)} \right\rangle_{t_{0}}.}"/></p>
</div><p>In some cases, e.g. for non-isotropic systems, it is useful to define
<em>VACF</em> along a given axis,</p>
<div class="math" id="equation-pfx46">
<p><span class="eqno">(46)<a class="headerlink" href="#equation-pfx46" title="Permalink to this equation"></a></span><img src="../_images/math/e4be0dedefb2de223372c4d0d90bfea9eba59a7a.png" alt="{C_{\mathit{vv};\mathit{\alpha\alpha}}\left( {t;n} \right)\doteq\left\langle {v_{\alpha}\left( {t_{0};n} \right)v_{\alpha}\left( {{t_{0} + t};n} \right)} \right\rangle_{t_{0}},}"/></p>
</div><p>where <img class="math" src="../_images/math/9ccd274ba1401cf144ff621838dad4d304ba63bd.png" alt="v_{\alpha}(t; n)"/> is given by</p>
<div class="math" id="equation-pfx47">
<p><span class="eqno">(47)<a class="headerlink" href="#equation-pfx47" title="Permalink to this equation"></a></span><img src="../_images/math/8f72da231b6165871a4b3c41cf009d0cb19ccd69.png" alt="{v_{\alpha}\left( {t;n} \right)\doteq n\cdot v_{\alpha}(t).}"/></p>
</div><p>The vector n is a unit vector defining a space-fixed axis.</p>
<p>The <em>VACF</em> of the particles in a many body system can be related to the
incoherent dynamic structure factor by the relation:</p>
<div class="math" id="equation-pfx48">
<p><span class="eqno">(48)<a class="headerlink" href="#equation-pfx48" title="Permalink to this equation"></a></span><img src="../_images/math/e847c1922997792e35a9a389a7642efc78424d6e.png" alt="{\lim\limits_{q\rightarrow 0}\frac{\omega^{2}}{q^{2}}S{\left( {q,\omega} \right) = G}(\omega),}"/></p>
</div><p>where G(<img class="math" src="../_images/math/16cb1e006199f0853a2dc67ea814446a38beb54e.png" alt="\omega"/>) is the Density Of States (<em>DOS</em>). For an isotropic system it
reads</p>
<div class="math" id="equation-pfx49">
<p><span class="eqno">(49)<a class="headerlink" href="#equation-pfx49" title="Permalink to this equation"></a></span><img src="../_images/math/f919efbd78aebbb8810a12a71eb1218f122a7b99.png" alt="{G{(\omega) = {\sum\limits_{\alpha}{b_{\alpha,\mathit{inc}}^{2}{\overset{\sim}{C}}_{\mathit{vv};\mathit{\alpha\alpha}}(\omega)}}},}"/></p>
</div><div class="math" id="equation-pfx50">
<p><span class="eqno">(50)<a class="headerlink" href="#equation-pfx50" title="Permalink to this equation"></a></span><img src="../_images/math/477f4be5cb41411c5fa5e828d11ca8de58f20db6.png" alt="{{\overset{\sim}{C}}_{\mathit{vv};\mathit{\alpha\alpha}}{(\omega) = \frac{1}{2\pi}}{\int\limits_{- \infty}^{+ \infty}\mathit{dt}}\exp\left\lbrack {{- i}\omega t} \right\rbrack C_{\mathit{vv};\mathit{\alpha\alpha}}(t).}"/></p>
</div><p>For non-isotropic systems, relation <img class="math" src="../_images/math/553011ba8faacbc63e79977430412691af151728.png" alt="26"/> holds if the <em>DOS</em>
is computed from the atomic velocity autocorrelation functions</p>
<div class="math" id="equation-pfx51">
<p><span class="eqno">(51)<a class="headerlink" href="#equation-pfx51" title="Permalink to this equation"></a></span><img src="../_images/math/294f7ee490ada9bb3746c0cf5ff0fe4a064c3773.png" alt="{C_{\mathit{vv};\mathit{\alpha\alpha}}\left( {t;n_{q}} \right)}"/></p>
</div><p>, where nq is the unit vector in the direction of q.</p>
<p id="gui-4">GUI</p>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<p><a class="reference internal" href="../_images/100000010000031F000001F4716D097EF0177F0B.png"><img alt="image22" src="../_images/100000010000031F000001F4716D097EF0177F0B.png" style="width: 15.921cm; height: 9.964cm;" /></a> <a class="reference internal" href="../_images/100000010000031F000001BDEA9E86A41E3EBCA6.png"><img alt="image23" src="../_images/100000010000031F000001BDEA9E86A41E3EBCA6.png" style="width: 15.921cm; height: 8.867cm;" /></a></p>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Interpolation_order">interpolation order</a></p></li>
<li><p><a class="reference external" href="#_Project_coordinates">project coordinates</a></p></li>
<li><p><a class="reference external" href="#_Normalize">normalize</a></p></li>
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Group_coordinates_by">Group coordinates by</a></p></li>
<li><p><a class="reference external" href="#_Atom_Transmutation_1">atom transmutation</a></p></li>
<li><p><a class="reference external" href="#_Weights">weights</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="gui.html" class="btn btn-neutral float-left" title="7. Using MDANSE Graphical User Interface" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="scattering.html" class="btn btn-neutral float-right" title="9. Analysis: Scattering" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2015, Gael Goret, Bachir Aoun and Eric C. Pellegrini.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>