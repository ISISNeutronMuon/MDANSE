<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Acknowledgements &mdash; MDANSE 1.5.2 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> MDANSE
            <img src="../_static/mdanse_logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.5
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">MDANSE User Manual</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="opening.html">1. MDANSE</a></li>
<li class="toctree-l1"><a class="reference internal" href="authors.html">2. Acknowledgements</a></li>
<li class="toctree-l1"><a class="reference internal" href="authors.html#citing-mdanse">3. Citing MDANSE</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">4. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">5. Installing MDANSE</a></li>
<li class="toctree-l1"><a class="reference internal" href="files.html">6. Input and output files</a></li>
<li class="toctree-l1"><a class="reference internal" href="GUI/startup.html">7. Using MDANSE Graphical User Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="GUI/main-window.html">8. The main window</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MDANSE</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Acknowledgements</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/pages/mdanse-manual.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <p><strong>MDANSE (Molecular Dynamics Analysis of Neutron Scattering
Experiments)</strong></p>
<p>Users Guide</p>
<p>Version 1.0</p>
<p>Rastislav Turanyi<sup>1</sup>, Miguel A. Gonzalez<sup>2</sup>, Eric
Pellegrini<sup>2</sup>, Sanghamitra Mukhopadhyay<sup>1</sup></p>
<p><sup>1</sup>ISIS Neutron and Muon Source, Science and Technology
Facilities Council, UKRI</p>
<p><sup>2</sup>Institut Laue-Langevin, France</p>
<p>March 2022</p>
<section id="acknowledgements">
<h1>Acknowledgements<a class="headerlink" href="#acknowledgements" title="Permalink to this heading"></a></h1>
<p>MDANSE was born at the ILL in 2012, as an extension of the nMOLDYN
program, originally developed by Gerald Kneller in 1995. Subsequent
versions of nMOLDYN were further developed by Gerald Kneller, Konrad
Hinsen and Eric Pellegrini. We are grateful to all the people who have
helped in some way or another to improve nMOLDYN and/or MDANSE along
those years. Apart from the main developers mentioned above, we would
like to acknowledge explicitly the contributions done in the past by
Bachir Aoun, Vania Calandrini, Paolo Calligari, Gael Goret and Remi
Perenon.</p>
<p>We would also like to thank Remi Perenon (ESRF), Dominik Jochym (SCD)
and Franz Lang (ISIS) for useful discussions during the redaction of
this manual.</p>
<p>The MDANSE project is supported by Ada Lovelace Centre and ISIS Neutron
and Muon Source, Science and Technology Facilities Council, UKRI. Past
financial support from the Institut Laue-Langevin and the French Agence
Nationale de la Recherche (ANR) through contracts No.
ANR-2010-COSI-001-01 and ANR-06-CIS6-012-01 is also acknowledged.</p>
</section>
<section id="citing-mdanse">
<h1>Citing MDANSE<a class="headerlink" href="#citing-mdanse" title="Permalink to this heading"></a></h1>
<p>If you find MDANSE useful for your research, please cite the following
paper in your publications:</p>
<p>MDANSE: An Interactive Analysis Environment for Molecular Dynamics
Simulations</p>
<ol class="upperalpha simple" start="7">
<li><p>Goret, B. Aoun, and E. Pellegrini</p></li>
</ol>
<p>Journal of Chemical Information and Modeling 2017 57 (1), 1-5</p>
<p>DOI: 10.1021/acs.jcim.6b00571</p>
</section>
<section id="contents">
<h1>Contents<a class="headerlink" href="#contents" title="Permalink to this heading"></a></h1>
</section>
<section id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading"></a></h1>
<p>Neutron scattering experiments are useful tools for probing atomic
positions and molecular dynamics in materials. Computational simulations
and modelling are essential tools to analyse and interpret such
experiments. These interpretations help to improve existing materials
for bespoke applications and design new ones. Atomistic simulations,
particularly molecular dynamics (MD) simulations are being used
increasingly for these purposes. However, predicting neutron observables
from MD trajectories is not straightforward. A number of operations,
such as calculations of mean square displacements, densities of states,
velocity and position auto- and cross-correlation functions, Fourier
transformations and convolutions with instrument parameters are required
to calculate neutron observables that can be compared directly with
experimental data.</p>
<p>Some of these steps were implemented in the open source MDANSE
(Molecular Dynamics Analysis of Neutron Scattering Experiments)
[<a class="reference external" href="#SignetBibliographie_001">1</a>]. This software is a Python based
application for analysing MD simulation data. This has interface with
more than ten MD codes including ab-initio MD codes as listed in
Appendix 1. MDANSE is benefited from a simple python-based graphical
users interface (GUI) to compare the calculated spectrum with
experimental data. It also can be used through command line scripts. In
addition to this GUI, a well developed molecular viewer and 2D/3D
plotter improve the users experience in analysing neutron experimental
data.</p>
<p>This users guide provides a detailed overview of the capabilities of
MDANSE along with theoretical background and installation instructions
on three different platforms Windows, Mac OS and Ubuntu. Authors will be
happy to receive any suggestions, feedback and bug reports about the
MDANSE software and this Users guide.</p>
</section>
<section id="installing-mdanse">
<h1>Installing MDANSE<a class="headerlink" href="#installing-mdanse" title="Permalink to this heading"></a></h1>
<p>MDANSE can be downloaded from <a class="reference external" href="https://mdanse.org/downloads/">https://mdanse.org/downloads/</a>. It is a
platform-specific installer that can be used directly and without any
other software. The package that gets installed comes with all the
necessary libraries and files that MDANSE requires to run. New versions
of MDANSE are released after sufficient changes are made, but in the
meantime MDANSE can be built from source. Instructions for doing that
are given in <a class="reference external" href="#_Appendix_4">Appendix 4</a>. Some beta versions may also
be generated by our continuous integration
[<a class="reference external" href="#SignetBibliographie_002">2</a>].</p>
<section id="windows">
<h2>Windows<a class="headerlink" href="#windows" title="Permalink to this heading"></a></h2>
<p>Installing MDANSE on Windows is straightforward. Once downloaded, you
will get MDANSE.exe file which can be run like any other exe installer.
If you want to install MDANSE, you need to have administrator
privileges, ie. Windows will ask you if you really want to install the
software, and you might need to enter your password. When that is done,
you will see a welcome screen, followed by a license agreement.</p>
<a class="reference internal image-reference" href="../_images/picture2.png"><img alt="../_images/picture2.png" src="../_images/picture2.png" style="width: 9.103cm; height: 7.082cm;" /></a>
<a class="reference internal image-reference" href="../_images/picture3.png"><img alt="../_images/picture3.png" src="../_images/picture3.png" style="width: 9.022cm; height: 6.967cm;" /></a>
<p>The default installation location is in C:\Program Files\MDANSE, but
it can be changed to any location. Once you select next, the
installation will start, which may take a while.</p>
<a class="reference internal image-reference" href="../_images/picture4.png"><img alt="../_images/picture4.png" src="../_images/picture4.png" style="width: 9.428cm; height: 7.408cm;" /></a>
<p>Finally, you will see a screen where you can select some extra options.
If you want to have a desktop shortcut, don’t forget to check the box.
The ‘View CHANGELOG’ link at the bottom will open CHANGELOG.txt file
where you can see what has changed.</p>
<a class="reference internal image-reference" href="../_images/picture5.png"><img alt="../_images/picture5.png" src="../_images/picture5.png" style="width: 9.571cm; height: 7.504cm;" /></a>
</section>
<section id="macos">
<h2>MacOS<a class="headerlink" href="#macos" title="Permalink to this heading"></a></h2>
<p>Since version 1.5.1, MDANSE installer for MacOS comes with a README.txt
file that will be unzipped together with the MDANSE.dmg installer once
you download MDANSE. Inside are the installation instructions as well as
instructions for using MDANSE from the command line. Despite the aid
however, MDANSE can be installed like any other DMG file:</p>
<ol class="arabic simple">
<li><p>Double click the DMG file. A window should open.</p></li>
<li><p>Drag the MDANSE icon onto the folder icon.</p></li>
<li><p>Wait for copying to finish.</p></li>
<li><p>Eject the DMG and delete it.</p></li>
</ol>
<p>Once that is done, MDANSE will be installed in /Applications, and so you
can run it like other applications. However, since we are not registered
with Apple, you might have to go through some extra steps to run. For
that purpose, the guides in Ref [<a class="reference external" href="#SignetBibliographie_003">3</a>] and
Ref [<a class="reference external" href="#SignetBibliographie_004">4</a>] might be of help.</p>
</section>
<section id="linux">
<h2>Linux<a class="headerlink" href="#linux" title="Permalink to this heading"></a></h2>
<p>We provide MDANSE.deb installer, so if your system is Debian-based, you
can directly use this like any other DEB package:</p>
<ol class="arabic simple">
<li><p>Un-tar the tarball.</p></li>
<li><p>In terminal run (make sure to use the correct path and full name of
the DEB file):</p></li>
</ol>
<p>sudo apt install ./MDANSE.deb</p>
<p>Apt will install any missing dependencies, so once you approve when
prompted and wait for installation to finish, you can start the MDANSE
either from terminal or from applications list.</p>
<p>If you use a system that does not support DEB natively, you will most
likely have to build MDANSE from source code. Feel free to try using
conversion packages, such as Alien, but we have not been able to make
this work. Instructions on building from source are in <a class="reference external" href="#_Appendix_4">Appendix
4</a> and issue #8 on our
GitHub.[<a class="reference external" href="#SignetBibliographie_005">5</a>] If you are still facing
difficulties, do not hesitate to contact us!</p>
</section>
</section>
<section id="input-and-output-files">
<h1>Input and output files<a class="headerlink" href="#input-and-output-files" title="Permalink to this heading"></a></h1>
<p>Almost, if not all, functionalities provided by MDANSE are based on
Network Common Data Form (NetCDF) input file. However, in certain
circumstances MDANSE can use or produce another type of files. We will
start this section by explaining in detail the NetCDF file format
introducing next the other file formats used by MDANSE.</p>
<section id="netcdf-file-format">
<h2>NetCDF file format<a class="headerlink" href="#netcdf-file-format" title="Permalink to this heading"></a></h2>
<p>NetCDF is a set of software libraries and self-describing,
machine-independent data formats that support the creation, access, and
sharing of array-oriented scientific data. The project homepage is
hosted by the Unidata program at the University Corporation for
Atmospheric Research.[<a class="reference external" href="#SignetBibliographie_006">6</a>] They are also
the chief source of NetCDF -based software, standards development,
updates, etc. The format is an open standard.</p>
<p>The data format is self-describing. This means that there is a header
which describes the layout of the rest of the file, in particular the
data arrays, as well as arbitrary file metadata in the form of
name/value attributes. The format is platform independent, with issues
such as endianness being addressed in the software libraries. The data
arrays are rectangular, not ragged, and stored in a simple and regular
fashion that allows efficient sub setting.</p>
<p>MDANSE expects trajectories to be in NetCDF format and follow the
conventions of Molecular Modelling ToolKit (MMTK). Trajectories that
have not been produced with MMTK or MMTK-based programs must be
converted to MMTK format before they can be analysed with MDANSE. This
conversion is necessary because no other common trajectory format
permits efficient access both to conformations at a given time and to
one-atom trajectories for all times. In addition to providing such an
access, the NetCDF format has several advantages that make it
particularly suitable for archiving trajectories:</p>
<ul class="simple">
<li><p>compact files (binary storage)</p></li>
<li><p>machine-independent format</p></li>
<li><p>fully self-contained, complete information about the system is stored
in the trajectory file.</p></li>
</ul>
<p>The conversion of the trajectories from different formats to the MMTK
format can be made directly via the MDANSE <a class="reference external" href="#_Using_MDANSE_Graphical">graphical user
interface</a>, specifically the <a class="reference external" href="#_Trajectory_converter">trajectory
converters</a>.</p>
<p>MMTK NetCDF files work, however, not just as input files; they are at
the centre of MDANSE. The result of an <a class="reference external" href="#_Analysis">analysis</a> is, by
default, written into an MMTK NetCDF file, which can then be once again
used as an input file. The <a class="reference external" href="#_2D/3D_Plotter">2D/3D Plotter</a>, the
inbuilt tool for graph visualisation, only works with MMTK NetCDF files.</p>
</section>
<section id="hdf5-file-format">
<h2>HDF5 file format<a class="headerlink" href="#hdf5-file-format" title="Permalink to this heading"></a></h2>
<p>HDF is a set of file formats designed to store and organise large
amounts of data. The project is maintained by The HDF Group
[<a class="reference external" href="#SignetBibliographie_007">7</a>], a non-profit corporation, who ensure
its continued development and accessibility. The associated libraries
and tools are available under a liberal license for general use.</p>
<p>HDF5 is the latest version, and its use is widespread; even the version
4 of the NetCDF format is built on top of HDF5. It is organised
hierarchically like a file system and uses POSIX-like syntax. The data
is stored in datasets, n-dimensional arrays, which are grouped in
groups, file-like objects. Either can then be modified with metadata by
adding attributes.</p>
<p>It is a goal to replace NetCDF with HDF5 as the main storage format, and
therefore MDANSE supports HDF5 output for <a class="reference external" href="#_Analysis">analyses</a> and
input for <a class="reference external" href="#_2D/3D_Plotter">plotters</a>.</p>
</section>
<section id="dat-file-format">
<h2>DAT file format<a class="headerlink" href="#dat-file-format" title="Permalink to this heading"></a></h2>
<p>When performing an <a class="reference external" href="#_Analysis">analysis</a>, it there are two options
for output file formats: NetCDF and ASCII. By default, only NetCDF is
selected, creating an MMTK NetCDF file, but it is possible to change
that to ASCII or both. If the ASCII option is selected, a tarball is
generated. Inside are multiple files which together contain the results
of the analysis. Firstly, there is a text file, jobinfo.txt, which
contains the options that were selected when performing the analysis.</p>
<p>Secondly, there is a DAT file for each variable generated by the
analysis. Each file is named after the variable it contains, and this
name is identical to the name that would appear in <a class="reference external" href="#_2D/3D_Plotter">2D/3D
Plotter</a> if the equivalent NetCDF file were loaded
in. Each file begins with a couple commented line describing the
variable:</p>
<ul class="simple">
<li><p>variable name</p></li>
<li><p>type of plot (this represents the dimensions of plot)</p></li>
<li><p>which variable is on the x-axis if the variable in this DAT file were
to be plotted on the y-axis</p></li>
<li><p><a class="reference external" href="#_Units">units</a> in which the data is written</p></li>
<li><p>the length of the trajectory (indicated as slice:[length])</p></li>
</ul>
<p>After that is a list of numbers representing the variable as described.</p>
</section>
<section id="mdanse-scripts">
<h2>MDANSE scripts<a class="headerlink" href="#mdanse-scripts" title="Permalink to this heading"></a></h2>
<p>These files are python scripts that, when run, perform a given analysis
with all the options set the way they were when this script was created.
It can be run like any other script, you only have to make sure you use
the python interpreter that comes with MDANSE. For more information
about MDANSE python, read <a class="reference external" href="#_Using_MDANSE_from">Using MDANSE from command
line</a>.</p>
</section>
</section>
<section id="using-mdanse-graphical-user-interface">
<h1>Using MDANSE Graphical User Interface<a class="headerlink" href="#using-mdanse-graphical-user-interface" title="Permalink to this heading"></a></h1>
<p>Through the MDANSE graphical user interface (GUI), you will usually open
a trajectory, then specify the parameters for the analysis you wish to
perform and finally start the calculation itself. In this interface you
can also perform some other actions such as plotting the results of an
analysis, performing some file conversions, and view the geometrical
structure of your calculations. The GUI gives access to most of the
functionalities of MDANSE. Moreover, from the GUI it is possible to
create an input file for the command-line interface or an auto-start
analysis python script. Both kind of files provide a convenient starting
point to set up and run new analysis directly from the <a class="reference external" href="#_Using_MDANSE_from">command
line</a>.</p>
<section id="opening-mdanse-gui">
<h2>Opening MDANSE GUI<a class="headerlink" href="#opening-mdanse-gui" title="Permalink to this heading"></a></h2>
<p>On all platforms, the GUI can be started either through an icon, or from
the command line. Below are outlined the subtleties connected to each
platform. In each case, it might take some time before the GUI opens, so
please be patient.</p>
<section id="windows-1">
<span id="id1"></span><h3>Windows<a class="headerlink" href="#windows-1" title="Permalink to this heading"></a></h3>
<p>If, during the installation, you selected to create a desktop shortcut,
you can use that to start MDANSE. Otherwise, you will have to open the
folder where you installed MDANSE (C:\Program Files\MDANSE by
default). Inside you can double click on the file called MDANSE with the
MDANSE icon:</p>
<a class="reference internal image-reference" href="../_images/picture6.png"><img alt="../_images/picture6.png" src="../_images/picture6.png" style="width: 1.789cm; height: 1.727cm;" /></a>
<a class="reference internal image-reference" href="../_images/picture7.png"><img alt="../_images/picture7.png" src="../_images/picture7.png" style="width: 14.021cm; height: 0.467cm;" /></a>
<p>Alternatively, you can double click the file called MDANSE_launcher.bat.
If you want to start MDANSE GUI from the command line, you just have to
type in the path to this batch file, not forgetting to use “ if there
are spaces in the path.</p>
</section>
<section id="macos-1">
<span id="id2"></span><h3>MacOS<a class="headerlink" href="#macos-1" title="Permalink to this heading"></a></h3>
<p>If you installed it normally, MDANSE icon should appear in Applications
like any other app. However, starting it the first time is a bit more
complicated since Apple implements stricter protections and we are not
registered as trusted developers. Therefore, you might have to change
some settings (see Ref [<a class="reference external" href="#SignetBibliographie_004">4</a>] for a guide).
Before you do that though, try simply opening MDANSE from the right
click menu (see Ref [<a class="reference external" href="#SignetBibliographie_003">3</a>] for a guide).</p>
<p>To start MDANSE GUI from terminal, you will have to run the following
command (change /Applications if you installed MDANSE elsewhere):</p>
<p>/Applications/MDANSE.app/Contents/MacOS/MDANSE</p>
</section>
<section id="linux-1">
<span id="id3"></span><h3>Linux<a class="headerlink" href="#linux-1" title="Permalink to this heading"></a></h3>
<p>If your distribution has an applications menu of some sort, like below,
you should be able to find an MDANSE icon in there that can be used to
start the GUI.</p>
<a class="reference internal image-reference" href="../_images/picture8.png"><img alt="../_images/picture8.png" src="../_images/picture8.png" style="width: 12.314cm; height: 6.959cm;" /></a>
<p>Otherwise, you will need to use the terminal. First, try running:</p>
<p>mdanse_gui</p>
<p>If that doesn’t work, you will need to know where MDANSE got installed.
By default, it should be in /usr/local, so try looking if the above
script is inside /usr/local/bin. If it isn’t there, the best bet is
searching for it with find / -name mdanse_gui. Once you know the path
(let’s call it mdanse_bin), run the following:</p>
<p>mdanse_bin/mdanse_gui</p>
</section>
</section>
<section id="the-main-window">
<h2>The main window<a class="headerlink" href="#the-main-window" title="Permalink to this heading"></a></h2>
<p>Below is an image of the window you will see when you open MDANSE GUI.
All the parts have been marked and their short descriptions can be found
below. Further information on all parts is in the following sections.</p>
<p>Please note that all pictures come from Windows 10, so the GUI will look
very slightly different on other platforms. However, MDANSE works
equally well, bugs notwithstanding, on all platforms.</p>
<a class="reference internal image-reference" href="../_images/picture9.jpg"><img alt="../_images/picture9.jpg" src="../_images/picture9.jpg" style="width: 15.921cm; height: 10.186cm;" /></a>
<ol class="arabic simple">
<li><p><a class="reference external" href="#_The_File_menu">File menu</a> handles file manipulation. It can be
used to load NetCDF trajectories or to convert other trajectories
into the NetCDF format.</p></li>
<li><p><a class="reference external" href="#_The_View_menu">View menu</a> allows you to hide/show various
parts of MDANSE.</p></li>
<li><p><a class="reference external" href="#_The_Help_menu">Help menu</a> contains access to files that you
can use to better understand MDANSE and the theory behind it.</p></li>
<li><p><a class="reference external" href="#_Load_data">Load trajectory button</a> can be used to load a
NetCDF trajectory.</p></li>
<li><p><a class="reference external" href="#_Periodic_table_viewer">Periodic table viewer</a> opens a periodic
table containing the constants and data that MDANSE uses for
calculations.</p></li>
<li><p><a class="reference external" href="#_Elements_database_editor">Elements database editor</a> allows you
to change the atomic constants that MDANSE uses for calculations.</p></li>
<li><p><a class="reference external" href="#_2D/3D_Plotter">2D/3D Plotter</a> launches a window where the
calculated data can be plotted, and the plots formatted.</p></li>
<li><p><strong>User definitions editor</strong> opens a window where you can view the
definitions that have been created for each trajectory. More on
definitions in <a class="reference external" href="#_Creating_selections">Selections</a>.</p></li>
<li><p><a class="reference external" href="#_Unites_Editor">Units editor</a> opens a window where the units
used in MDANSE can be managed.</p></li>
<li><p><strong>MDANSE classes framework</strong> allows you to peruse the documentation
for the classes that make up MDANSE. This is useful if you want to
use MDANSE from the command line.</p></li>
<li><p><strong>Save analysis template</strong> allows you to create a new analysis. This
will be available in My jobs inside the Plugins panel and can be run
like the native analyses.</p></li>
<li><p><strong>Open MDANSE API</strong> opens MDANSE documentation in a browser. This is
very similar to MDANSE classes framework.</p></li>
<li><p><strong>Open MDANSE website</strong> opens the MDANSE
website[<a class="reference external" href="#SignetBibliographie_008">8</a>] in a browser.</p></li>
<li><p><strong>About</strong> launches a window with very basic information about the
MDANSE you have installed.</p></li>
<li><p><strong>Bug report</strong> opens your default mail application. Please use this
or create an issue on MDANSE
GitHub[<a class="reference external" href="#SignetBibliographie_009">9</a>] to inform us of any issues
you have come across.</p></li>
<li><p><a class="reference external" href="#_Quit">Quit MDANSE</a> closes the MDANSE window.</p></li>
<li><p><a class="reference external" href="#_Data_panel">Data panel</a> contains any NetCDF files you loaded
into MDANSE using either #4 Load trajectory button, or from #1 File
menu &gt; Load trajectory.</p></li>
<li><p><a class="reference external" href="#_Plugins_panel">Plugins panel</a> contains all the options you can
do with the selected trajectory.</p></li>
<li><p><a class="reference external" href="#_Working_panel">Working panel</a> shows the trajectories you have
opened. To open a trajectory, double click a trajectory in #16 Data
panel. You can then inspect the system described by the trajectory.</p></li>
<li><p><strong>Logger</strong> shows all the messages generated by MDANSE. These can be
errors or information messages, such as ones confirming you saved a
script etc.</p></li>
<li><p><strong>Console</strong> is a Python shell. It can be used like normal when
python is being used from the command line, i.e.. when python is
typed and executed in an OS shell. It contains all the bundled
modules, but you will need to import them first.</p></li>
<li><p><a class="reference external" href="#_Jobs">Jobs</a> shows the status of all current jobs. Once you
start an analysis or trajectory conversion, you can view its
progress here.</p></li>
</ol>
</section>
<section id="the-file-menu">
<h2>The File menu<a class="headerlink" href="#the-file-menu" title="Permalink to this heading"></a></h2>
<p>Pressing the <strong>File</strong> menu button brings up the following menu:</p>
<a class="reference internal image-reference" href="../_images/picture10.png"><img alt="../_images/picture10.png" src="../_images/picture10.png" style="width: 3.759cm; height: 2.078cm;" /></a>
<section id="load-data">
<h3>Load data<a class="headerlink" href="#load-data" title="Permalink to this heading"></a></h3>
<p>This option allows you to select an MMTK NetCDF file. Once you click the
Load data button, a standard (platform-specific) file browser will open,
like the one below:</p>
<a class="reference internal image-reference" href="../_images/picture11.png"><img alt="../_images/picture11.png" src="../_images/picture11.png" style="width: 10.315cm; height: 6.509cm;" /></a>
<p>Use it as per normal, and the file you selected will appear in the <a class="reference external" href="#_Data_panel">Data
panel</a>. While it says in the file browser that you can
load mvi trace file format, this is not currently implemented. Please
only load NetCDF files that have been generated using MMTK or MMTK-based
software. If you have a trajectory from elsewhere, it must be converted
first. For more information about converting trajectories, please see
the <a class="reference external" href="#_Trajectory_converter">next section</a>.</p>
</section>
<section id="trajectory-converter">
<h3>Trajectory converter<a class="headerlink" href="#trajectory-converter" title="Permalink to this heading"></a></h3>
<p>This option allows to convert a trajectory derived with a non MMTK-based
program to the NetCDF MMTK trajectory format. Hovering over the
Trajectory converter brings up the following menu:</p>
<a class="reference internal image-reference" href="../_images/picture12.png"><img alt="../_images/picture12.png" src="../_images/picture12.png" style="width: 6.909cm; height: 7.287cm;" /></a>
<p>Clicking on any button opens a window of that converter. Each converter
contains these three buttons at the bottom:</p>
<ul class="simple">
<li><p><strong>Help</strong> will open MDANSE documentation for the converter class.</p></li>
<li><p><strong>Save</strong> creates a python script with the values of all the fields
set the way they were when the button is clicked. This script can be
used to quickly run this conversion again in the future.</p></li>
<li><p><strong>Run</strong> initiates the conversion. Its progress can be seen in
<a class="reference external" href="#_Jobs">Jobs</a>. After a successful Run, the converted trajectory
is saved in the location specified in the field “output files” in the
converter interface.</p></li>
</ul>
<p>The descriptions of all converters will be found in <a class="reference external" href="#_Appendix_1">Appendix
1</a>.</p>
</section>
<section id="quit">
<h3>Quit<a class="headerlink" href="#quit" title="Permalink to this heading"></a></h3>
<p>Selecting this option opens a confirmation prompt. If you select yes,
MDANSE will close.</p>
</section>
</section>
<section id="the-view-menu">
<h2>The View menu<a class="headerlink" href="#the-view-menu" title="Permalink to this heading"></a></h2>
<p>This menu contains several options to hide/show various parts of MDANSE:</p>
<a class="reference internal image-reference" href="../_images/picture13.png"><img alt="../_images/picture13.png" src="../_images/picture13.png" style="width: 3.962cm; height: 2.649cm;" /></a>
<ul class="simple">
<li><p><strong>Toggle data tree</strong> shows/hides the <a class="reference external" href="#_Data_panel">Data panel</a>:</p></li>
</ul>
<p><a class="reference internal" href="../_images/picture14.png"><img alt="image1" src="../_images/picture14.png" style="width: 7.096cm; height: 5.426cm;" /></a><a class="reference internal" href="../_images/picture15.png"><img alt="image2" src="../_images/picture15.png" style="width: 7.131cm; height: 5.452cm;" /></a></p>
<ul class="simple">
<li><p><strong>Toggle plugins tree</strong> shows/hides the <a class="reference external" href="#_Plugins_panel">Plugins
panel</a>:</p></li>
</ul>
<p><a class="reference internal" href="../_images/picture16.png"><img alt="image3" src="../_images/picture16.png" style="width: 7.096cm; height: 5.426cm;" /></a><a class="reference internal" href="../_images/picture17.png"><img alt="image4" src="../_images/picture17.png" style="width: 7.193cm; height: 5.466cm;" /></a></p>
<ul class="simple">
<li><p><strong>Toggle controller</strong> shows/hides the bottom bar containing Logger,
Console, and Jobs:</p></li>
</ul>
<p><a class="reference internal" href="../_images/picture18.png"><img alt="image5" src="../_images/picture18.png" style="width: 7.096cm; height: 5.426cm;" /></a><a class="reference internal" href="../_images/picture19.png"><img alt="image6" src="../_images/picture19.png" style="width: 7.131cm; height: 5.445cm;" /></a></p>
<ul class="simple">
<li><p><strong>Toggle toolbar</strong> should show/hide the <a class="reference external" href="#_Toolbar">toolbar</a>:</p></li>
</ul>
<p><a class="reference internal" href="../_images/picture20.png"><img alt="image7" src="../_images/picture20.png" style="width: 6.959cm; height: 5.156cm;" /></a><a class="reference internal" href="../_images/picture21.png"><img alt="image8" src="../_images/picture21.png" style="width: 7.011cm; height: 5.191cm;" /></a></p>
</section>
<section id="the-help-menu">
<h2>The Help menu<a class="headerlink" href="#the-help-menu" title="Permalink to this heading"></a></h2>
<p>Pressing the Help button brings up the following menu:</p>
<a class="reference internal image-reference" href="../_images/picture22.png"><img alt="../_images/picture22.png" src="../_images/picture22.png" style="width: 5.741cm; height: 4.048cm;" /></a>
<ul class="simple">
<li><p><strong>About</strong> opens a window containing information about MDANSE version,
a short summary, and a list of authors.</p></li>
<li><p><strong>Simple help</strong> opens a window with a brief summary of MDANSE
workflow and the various options that can be encountered.</p></li>
<li><p><strong>Theoretical background</strong> opens, in a browser, a document
summarising the theory behind many of the analyses.</p></li>
<li><p><strong>User guide</strong> opens the DOI to this user guide in the default
browser, showing a RAL Technical Report webpage. From there, this
user guide can be downloaded as a pdf.</p></li>
<li><p><strong>Bug report</strong> opens the default email app so that you can send us an
email, informing us of any issue you have encountered. When reporting
an issue, please include a picture or copy of the error, such as the
<a class="reference external" href="#STATE">traceback from job failure</a>.</p></li>
</ul>
</section>
<section id="toolbar">
<h2>Toolbar<a class="headerlink" href="#toolbar" title="Permalink to this heading"></a></h2>
<p>This is a set of pictographic buttons that you can use to quickly
perform many important actions. Below is a brief overview of all of
them, going left to right, and after that we will take a look at the
more complex ones.</p>
<a class="reference internal image-reference" href="../_images/picture23.png"><img alt="../_images/picture23.png" src="../_images/picture23.png" style="width: 13.416cm; height: 1.138cm;" /></a>
<ol class="arabic simple">
<li><p><strong>Load trajectory button</strong> can be used to load a NetCDF trajectory.
More information in <a class="reference external" href="#_Load_data">Load data</a>.</p></li>
<li><p><a class="reference external" href="#_Periodic_table_viewer">Periodic table viewer</a> opens a periodic
table containing the constants and data that MDANSE uses for
calculations.</p></li>
<li><p><a class="reference external" href="#_Elements_database_editor">Elements database editor</a> allows you
to change the atomic constants that MDANSE uses for calculations.</p></li>
<li><p><a class="reference external" href="#_2D/3D_Plotter">2D/3D Plotter</a> launches a window where the
calculated data can be plotted, and the plots formatted.</p></li>
<li><p><strong>User definitions editor</strong> opens a window where you can view the
definitions that have been created for each trajectory. More on
definitions in <a class="reference external" href="#_Creating_selections">Selections</a>.</p></li>
<li><p><a class="reference external" href="#_Unites_Editor">Units editor</a> opens a window where the units
used in MDANSE can be managed.</p></li>
<li><p><strong>MDANSE classes framework</strong> allows you to peruse the documentation
for the classes that make up MDANSE. This is useful if you want to
use MDANSE from the command line.</p></li>
<li><p><strong>Save analysis template</strong> allows you to create a new analysis. This
will be available in My jobs inside the Plugins panel and can be run
like the native analyses.</p></li>
<li><p><strong>Open MDANSE API</strong> opens MDANSE documentation in a browser. This is
very similar to MDANSE classes framework.</p></li>
<li><p><strong>Open MDANSE website</strong> opens the MDANSE website in a browser.</p></li>
<li><p><strong>About</strong> launches a window with very basic information about the
MDANSE you have installed.</p></li>
<li><p><strong>Bug report</strong> opens your default mail application. Please use this
or our GitHub[<a class="reference external" href="#SignetBibliographie_009">9</a>] to inform us of any
issues you have come across. When reporting an issue, please include
a picture or copy of the error, such as the <a class="reference external" href="#STATE">traceback from job
failure</a>.</p></li>
<li><p><strong>Quit MDANSE</strong> closes MDANSE.</p></li>
</ol>
<section id="periodic-table-viewer">
<h3>Periodic table viewer<a class="headerlink" href="#periodic-table-viewer" title="Permalink to this heading"></a></h3>
<p>Once launched, it will open this window:</p>
<a class="reference internal image-reference" href="../_images/picture24.png"><img alt="../_images/picture24.png" src="../_images/picture24.png" style="width: 15.806cm; height: 9.733cm;" /></a>
<p>By hovering over an element, detailed information from MDANSE elements
database will show up at the top. By clicking on an element, a list of
its isotopes will appear as a menu:</p>
<a class="reference internal image-reference" href="../_images/picture25.png"><img alt="../_images/picture25.png" src="../_images/picture25.png" style="width: 3.254cm; height: 3.016cm;" /></a>
<p>When an isotope is selected, all the information that is stored in the
database will be displayed:</p>
<a class="reference internal image-reference" href="../_images/picture26.png"><img alt="../_images/picture26.png" src="../_images/picture26.png" style="width: 7.509cm; height: 10.566cm;" /></a>
<p>Clicking on the link at the bottom opens a Wikipedia article about that
element. Other than that, you cannot interact with this page in any way.
If you would like to change any of the displayed data, you will have to
use the Elements database editor.</p>
</section>
<section id="elements-database-editor">
<h3>Elements database editor<a class="headerlink" href="#elements-database-editor" title="Permalink to this heading"></a></h3>
<p>Clicking on this button opens this window:</p>
<a class="reference internal image-reference" href="../_images/picture27.png"><img alt="../_images/picture27.png" src="../_images/picture27.png" style="width: 15.789cm; height: 7.895cm;" /></a>
<p>It can be interacted with like a normal spreadsheet; click (or double
click) on a field you want to edit and type the new value. Once you are
done with making changes, don’t forget to save them before closing. You
can do that through the file menu.</p>
<section id="file-menu">
<h4>File menu<a class="headerlink" href="#file-menu" title="Permalink to this heading"></a></h4>
<a class="reference internal image-reference" href="../_images/picture28.png"><img alt="../_images/picture28.png" src="../_images/picture28.png" style="width: 6.773cm; height: 1.984cm;" /></a>
<ul class="simple">
<li><p><strong>Save database</strong> overwrites the current database, so it is best to
be careful. Due to that, you will need to confirm a prompt before the
changes are saved.</p></li>
<li><p><strong>Save database as</strong> opens a file browser which can be used to save
the changes in a new file.</p></li>
</ul>
</section>
<section id="database-menu">
<h4>Database menu<a class="headerlink" href="#database-menu" title="Permalink to this heading"></a></h4>
<p>Clicking on Database opens this menu:</p>
<a class="reference internal image-reference" href="../_images/picture29.png"><img alt="../_images/picture29.png" src="../_images/picture29.png" style="width: 4.329cm; height: 1.99cm;" /></a>
<ul class="simple">
<li><p><strong>New element</strong> allows you to add a new element.</p></li>
<li><p><strong>New property</strong> allows you to add a new property.</p></li>
</ul>
</section>
</section>
<section id="d-3d-plotter">
<h3>2D/3D Plotter<a class="headerlink" href="#d-3d-plotter" title="Permalink to this heading"></a></h3>
<p>Upon clicking on the icon, this window will open:</p>
<a class="reference internal image-reference" href="../_images/picture30.png"><img alt="../_images/picture30.png" src="../_images/picture30.png" style="width: 12.173cm; height: 8.58cm;" /></a>
<p>To use it, a file has to be loaded first. This can be done using the
File menu → Load, which will open a file browser. Only NetCDF files
(ending in .nc, .cdf, or .netcdf) and HDF5 files (extension .h5 or .hdf)
can be loaded; other file formats will result in an error.</p>
<a class="reference internal image-reference" href="../_images/picture31.png"><img alt="../_images/picture31.png" src="../_images/picture31.png" style="width: 3.201cm; height: 2.081cm;" /></a>
<p>Once a file is loaded, it will appear in the data panel. This is a table
listing all the files loaded in the Plotter, showing the name MDANSE
assigned to the loaded instance (i.e. a key to e.g. distinguish between
files with the same name), the name of the file, and the full path to
the file.</p>
<a class="reference internal image-reference" href="../_images/picture32.png"><img alt="../_images/picture32.png" src="../_images/picture32.png" style="width: 6.645cm; height: 3.826cm;" /></a>
<p>Clicking on a loaded file will show all the variables that can be
plotted in the box below, though the whole Plotter window might have to
be resized so that more than one variable shows up at a time. A preview
of the plot of the first variable will also be shown at the bottom, but
only for 1D and 2D plots.</p>
<p><a class="reference internal" href="../_images/picture33.png"><img alt="image9" src="../_images/picture33.png" style="width: 7.191cm; height: 14.887cm;" /></a></p>
<p>Once you have selected a variable from the second box, you can select a
plotter from the Select Plotter drop-down menu. The following plotters
are available in MDANSE:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 42%" />
<col style="width: 17%" />
<col style="width: 42%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Plotter</p></td>
<td><p>Dimension</p></td>
<td><p>Description</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="#_Line_Plotter">Line</a></p></td>
<td><p>1D</p></td>
<td><p>A simple plot depicting
the dependence of one
variable on another. It
consists of a single
line. Uses normal plot()
function from matplotlib.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="#_Image_Plotter">I
mage</a></p></td>
<td><p>2D</p></td>
<td><p>Plots data as an image,
i.e. on a 2D regular
raster. Uses matplotlib
imshow() function.</p></td>
</tr>
<tr class="row-even"><td><dl class="simple">
<dt><a href="#id4"><span class="problematic" id="id5">`</span></a>Elevation</dt><dd><p>&lt;#_Elevation_Plotter&gt;`__</p>
</dd>
</dl>
</td>
<td><p>2D</p></td>
<td><p>Plots data as an image.
Uses VTK.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="#_2D_Slice_Plotter">2D
Slic
e</a></p></td>
<td><p>2D</p></td>
<td><p>Plots a subset of a 3D
variable.</p></td>
</tr>
<tr class="row-even"><td><p><a href="#id13"><span class="problematic" id="id14">`Iso
Surface &lt;
#_Iso_Surface_Plotter&gt;`__</span></a></p></td>
<td><p>3D</p></td>
<td><p>A 3D plot depicting a
surface through lines or
one continuous surface.
Uses VTK.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="#_Scalar-Field_Plotter">Scalar-Field</a></p></td>
<td><p>3D</p></td>
<td></td>
</tr>
</tbody>
</table>
<p>After all that is selected, the data can be plotted. There are two
options for this, represented by the two buttons:</p>
<ul class="simple">
<li><p><strong>Plot in new window</strong> creates a new tab, ie. a separate plot, inside
the Multiple Plot Window.</p></li>
</ul>
<p><a class="reference internal" href="../_images/picture34.png"><img alt="image10" src="../_images/picture34.png" style="width: 7.728cm; height: 7.313cm;" /></a><a class="reference internal" href="../_images/picture35.png"><img alt="image11" src="../_images/picture35.png" style="width: 7.798cm; height: 7.345cm;" /></a></p>
<ul class="simple">
<li><p><strong>Plot in current figure</strong> plots the chosen data in the currently
selected tab of the Multiple Plot Window, ie. it will create a plot
with multiple lines etc.</p></li>
</ul>
<p><a class="reference internal" href="../_images/picture36.png"><img alt="image12" src="../_images/picture36.png" style="width: 7.798cm; height: 7.345cm;" /></a><a class="reference internal" href="../_images/picture37.png"><img alt="image13" src="../_images/picture37.png" style="width: 7.765cm; height: 7.357cm;" /></a></p>
<p>As can be seen, the plot automatically adjusts the axes so that all
plots fit. More details on plotting options is in <a class="reference external" href="#_Appendix_3_1">Appendix
3</a>.</p>
</section>
<section id="units-editor">
<h3>Units Editor<a class="headerlink" href="#units-editor" title="Permalink to this heading"></a></h3>
<p>When opened, this window will appear:</p>
<a class="reference internal image-reference" href="../_images/picture38.png"><img alt="../_images/picture38.png" src="../_images/picture38.png" style="width: 9.693cm; height: 8.167cm;" /></a>
<p>Here, the units that MDANSE uses can be managed. The white box on the
left is a list of all the defined units, which includes both the units
that come together with MDANSE as well as any user-defined units. More
information on how units work is in the <a class="reference external" href="#_Units">Units</a> section.
This list is interactive; any unit in it can be clicked on, which
displays its details, like so:</p>
<a class="reference internal image-reference" href="../_images/picture39.png"><img alt="../_images/picture39.png" src="../_images/picture39.png" style="width: 9.804cm; height: 8.142cm;" /></a>
<p>The fields in the middle and right of the window show the definition of
the selected unit using SI units. The selected unit is equivalent to
<strong>Factor</strong> * the product of the SI units listed on the right, where the
values inside the fields are the powers of the SI units. Therefore, the
unit shown in the above example, J_per_mole, is in MDANSE defined as
1.66055927342 * 10<sup>-24</sup> kg m<sup>2</sup> mol<sup>-1</sup>.</p>
<p>There are four buttons in the Units Editor window:</p>
<ul class="simple">
<li><p><strong>Cancel</strong> closes the window without saving any changes made.</p></li>
<li><p><strong>Save</strong> saves the changes for future use; they can be used in the
current session and in any future ones. The Units Editor window is
also closed.</p></li>
<li><p><strong>OK</strong> saves the changes for the current session; they can be used
until the main MDANSE window is closed. When MDANSE is closed and
opened again, the changes will not appear. The Units Editor window is
also closed.</p></li>
<li><p><strong>Add unit</strong> opens the following window, which can be used to add new
units or edit existing ones.</p></li>
</ul>
<a class="reference internal image-reference" href="../_images/picture40.png"><img alt="../_images/picture40.png" src="../_images/picture40.png" style="width: 2.84cm; height: 5.547cm;" /></a>
<ul class="simple">
<li><p><strong>Unit name</strong></p></li>
</ul>
<p><em>Format:</em> str</p>
<p><em>Default:</em> None</p>
<p><em>Description:</em> the name of the unit. If a name not yet registered is
inputted, a new unit will be created. Please note that the names are
case-sensitive, and that already existing units cannot be overwritten.</p>
<ul class="simple">
<li><p><strong>Factor</strong></p></li>
</ul>
<p><em>Format:</em> float</p>
<p><em>Default:</em> 1.0</p>
<p><em>Description:</em></p>
<ul class="simple">
<li><p><strong>unit</strong> (any of the displayed SI basic units)</p></li>
</ul>
<p><em>Format:</em> int (it must lie in the interval )</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> the power of the SI unit.</p>
<ul class="simple">
<li><p><strong>OK</strong> adds the new definition to the unit registry, but the change
has to be saved in the Units Editor window to be useable in the rest
of MDANSE. Please not that once, a new unit is added, it cannot be
changed only removed.</p></li>
<li><p><strong>Cancel</strong> closes the window without saving the changes.</p></li>
</ul>
<p>Further, existing units can be deleted from the Units Editor window. To
do this, the unit to be deleted has to be selected by clicking on it,
and then the ‘Delete’ button has to be clicked. This will show a prompt
for confirmation, and once that is accepted, the unit will be removed,
though the change has to be saved by clicking on either the OK or Cancel
button.</p>
</section>
</section>
<section id="data-panel">
<h2>Data panel<a class="headerlink" href="#data-panel" title="Permalink to this heading"></a></h2>
<p>This is where files loaded into MDANSE are displayed. Trajectories and
results of analyses are distinctly separated as ‘mmtk trajectory’ and
‘netcdf data’ respectively. To proceed, you need to double-click on a
file name here to bring it to the Working panel. This can be done
multiple times for each file.</p>
<a class="reference internal image-reference" href="../_images/picture41.png"><img alt="../_images/picture41.png" src="../_images/picture41.png" style="width: 6.696cm; height: 7.223cm;" /></a>
</section>
<section id="working-panel">
<h2>Working panel<a class="headerlink" href="#working-panel" title="Permalink to this heading"></a></h2>
<p>The selected files appear in the Working panel as tabs. The currently
opened tab is the one that whose file is going to be used for analysis
and other operations when using the Plugins panel.</p>
<a class="reference internal image-reference" href="../_images/picture42.png"><img alt="../_images/picture42.png" src="../_images/picture42.png" style="width: 7.093cm; height: 1.217cm;" /></a>
<p>The Working panel is also the space which some of the plugins use to do
their job. <a class="reference external" href="#_Molecular_Viewer">The Molecular Viewer</a>,
<a class="reference external" href="#_Animation">Animation</a>, and <a class="reference external" href="#_Plotter">2D/3D Plotter</a> plugins
all load into the <a class="reference external" href="#_Working_panel">Working panel</a>. Furthermore, it
is possible to bring the windows opened by the other plugins into the
working panel, like below. To do that, you have to drag the window so
that its top is near the top of the working panel, where the tabs are.
An indicator will appear when you got it right.</p>
<a class="reference internal image-reference" href="../_images/picture43.png"><img alt="../_images/picture43.png" src="../_images/picture43.png" style="width: 13.376cm; height: 7.927cm;" /></a>
<a class="reference internal image-reference" href="../_images/picture44.png"><img alt="../_images/picture44.png" src="../_images/picture44.png" style="width: 15.921cm; height: 4.186cm;" /></a>
</section>
<section id="plugins-panel">
<h2>Plugins panel<a class="headerlink" href="#plugins-panel" title="Permalink to this heading"></a></h2>
<p>This is the heart of MDANSE, where all the analyses as well as other
important features can be found. If the selected tab in the Working
panel is from a trajectory, the Plugins panel will look like this:</p>
<a class="reference internal image-reference" href="../_images/picture45.png"><img alt="../_images/picture45.png" src="../_images/picture45.png" style="width: 6.616cm; height: 7.408cm;" /></a>
<p>If it is from the result of an analysis, it will look like this:</p>
<a class="reference internal image-reference" href="../_images/picture46.png"><img alt="../_images/picture46.png" src="../_images/picture46.png" style="width: 6.535cm; height: 7.251cm;" /></a>
<p>There are far fewer options available for analysis results.
Nevertheless, in each of the sections below, it will be stated if the
plugin appears for trajectories, results, or both.</p>
<p>All the options in above are just headings. To get to the actual
plugins, click on the ‘plus’ buttons next to the text to unhide the
options. If there is no such button next to a text, that means that that
is a plugin and can be launched by double-clicking on the text.</p>
<section id="analysis">
<h3>Analysis<a class="headerlink" href="#analysis" title="Permalink to this heading"></a></h3>
<p>This menu contains all data manipulations and appears as in the picture
below when a trajectory is loaded. As indicated by the plus buttons,
each of these options is a menu in itself.</p>
<a class="reference internal image-reference" href="../_images/picture47.png"><img alt="../_images/picture47.png" src="../_images/picture47.png" style="width: 6.588cm; height: 4.895cm;" /></a>
<p>They are explored in greater depth in the following sections, and the
analyses are in turn explored in their subsections. Some contain a
discussion of the theory behind the computation, and all show the
analysis window of that analysis, the one that is launched by
double-clicking the option in this Plugins panel.</p>
<p>Each analysis window is different since each requires different
parameters to be configured before it can be run. However, all of them
have the same structure (example window below), consisting of these
parts:</p>
<ul class="simple">
<li><p><strong>trajectory</strong> box shows the path to the <a class="reference external" href="#_NetCDF_file_format">MMTK
NetCDF</a> trajectory that this analysis will
be performed on.</p></li>
<li><p><strong>Parameters</strong> are a group of options, of which the common ones are
discussed in depth in <a class="reference external" href="#_Appendix_2">Appendix 2</a>. These are the
options which vary from analysis to analysis. The only parameters
that exist on every analysis are Frames and Output files.</p></li>
<li><p><strong>Buttons</strong> are situated at the bottom of each analysis and consist
of these options:</p>
<ul>
<li><p><strong>Help</strong> opens the source code documentation for the relevant
class in an MDANSE window.</p></li>
<li><p><strong>Save</strong> opens a file browser that allows you to save the current
analysis with the set options into a python script which can be
run from the command line. More information about scripts in
<a class="reference external" href="#_Using_MDANSE_from">Using MDANSE from command line.</a></p></li>
<li><p><strong>Run</strong> starts the analysis and prompts you whether you want to
close the window. The status of the analysis can be found in the
<a class="reference external" href="#_Jobs">Jobs</a> panel, though there is a known bug where
successful analyses do not show up.</p></li>
</ul>
</li>
</ul>
<section id="dynamics">
<h4>Dynamics<a class="headerlink" href="#dynamics" title="Permalink to this heading"></a></h4>
<p>This section contains the following Plugins:</p>
<ul class="simple">
<li><p><a class="reference external" href="#_Angular_Correlation">Angular Correlation</a></p></li>
<li><p><a class="reference external" href="#_Density_Of_States">Density Of States</a></p></li>
<li><p><a class="reference external" href="#_General_AutoCorrelation_Function">General AutoCorrelation
Function</a></p></li>
<li><p><a class="reference external" href="#_Mean_Square_Displacement">Mean Square Displacement</a></p></li>
<li><p><a class="reference external" href="#_Order_Parameter">Order Parameter</a></p></li>
<li><p><a class="reference external" href="#_Position_AutoCorrelation_Function">Position AutoCorrelation
Function</a></p></li>
<li><p><a class="reference external" href="#_Velocity_AutoCorrelation_Function">Velocity AutoCorrelation
Function</a></p></li>
</ul>
<section id="angular-correlation">
<h5>Angular Correlation<a class="headerlink" href="#angular-correlation" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p>Available for trajectories only</p></li>
</ul>
<p>Theory and implementation</p>
<p>The angular correlation analysis computes the autocorrelation of a set
of vectors describing the extent of a molecule in three orthogonal
directions. This kind of analysis can be useful when trying to highlight
the fact that a molecule is constrained in a given direction.</p>
<p>For a given triplet of non-colinear atoms <em>g</em>=(a1,a2,a3), one can
derive an orthonormal set of three vectors v1, v2, v3 using the
following scheme:</p>
<ul>
<li><div class="math">
<p><span class="math">v_{1} = \frac{n_{1} + n_{2}}{\left| \left| {n_{1} + n_{2}} \right| \right|}</span></p>
</div><p>where <strong>n</strong><sub>1</sub> and <strong>n</strong><sub>2</sub> are respectively the
normalized vectors along (<strong>a1,a2</strong>) and (<strong>a1,a3</strong>) directions.</p>
</li>
<li><p>v2 is defined as the clockwise normal vector orthogonal to v1 that
belongs to the plane defined by a1, a2 and a3 atoms</p></li>
<li><div class="math">
<p><span class="math">{\overrightarrow{v_{3}} = \overrightarrow{v_{1}}}\times\overrightarrow{v_{2}}</span></p>
</div></li>
</ul>
<p>Thus, one can define the following autocorrelation functions for the
vectors v1, v2 and v3 defined on triplet t :</p>
<div class="math">
<p><span class="math">\begin{matrix}
{AC_{g,i}{(t) = \left\langle {v_{t,i}(0)\cdot v_{t,i}(t)} \right\rangle},{i = 1,2,3}} \\
{({\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}1})} \\
\end{matrix}</span></p>
</div><p>And the angular correlation averaged over all triplets is:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{AC_{i}{(t) = {\sum\limits_{g = 1}^{N_{\mathit{triplets}}}{AC_{g,i}(t)}}},{i = 1,2,3}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}2} \right) \\
\end{matrix}</span></p>
</div><p>where N<sub>triplets</sub> is the number of selected triplets.</p>
<p>GUI</p>
<a class="reference internal image-reference" href="../_images/picture48.png"><img alt="../_images/picture48.png" src="../_images/picture48.png" style="width: 15.921cm; height: 10.7cm;" /></a>
<p>Parameters:</p>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Axis_Selection_1">axis selection</a></p></li>
<li><p><a class="reference external" href="#_Output_contribution_per">output contribution per axis</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="density-of-states">
<h5>Density Of States<a class="headerlink" href="#density-of-states" title="Permalink to this heading"></a></h5>
<p id="theory-and-implementation-1">Theory and implementation</p>
<p><em>MDANSE</em> calculates the power spectrum of the <em>VACF</em>, which in case of
the mass-weighted <em>VACF</em> defines the phonon discrete <em>DOS</em>, (see the
section on <a class="reference external" href="#_Theory_and_implementation_1">VACF</a>) defined as:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\mathit{DOS}\left( {n\cdot\mathit{\Delta\nu}} \right)\doteq{\sum\limits_{\alpha}\omega_{\alpha}}{\overset{\sim}{C}}_{\mathit{vv};\mathit{\alpha\alpha}}\left( {n\cdot\mathit{\Delta\nu}} \right),{n = 0}\ldots{N_{t} - 1.}} \\
(3) \\
\end{matrix}</span></p>
</div><p>N<sub>t</sub> is the total number of time steps and</p>
<div class="math">
<p><span class="math">{\mathit{\Delta\nu} = 1}\text{/}\left( {2N_{t}\Delta t} \right)</span></p>
</div><p>is the frequency step.</p>
<div class="math">
<p><span class="math">\mathit{DOS}\left( {n\cdot\mathit{\Delta\nu}} \right)</span></p>
</div><p>can be computed either for the isotropic case or with respect to a
user-defined axis. The spectrum</p>
<div class="math">
<p><span class="math">\mathit{DOS}\left( {n\cdot\Delta\nu} \right)</span></p>
</div><p>is computed from the <em>unnormalized VACF</em>, such that <em>DOS(0)</em> gives an
approximate value for the diffusion constant</p>
<div class="math">
<p><span class="math">D = {\sum\limits_{\alpha}D_{\alpha}}</span></p>
</div><p>(see Eqs.</p>
<div class="math">
<p><span class="math">10</span></p>
</div><p><a class="reference external" href="#anchor-73">Error: Reference source not found</a> and</p>
<div class="math">
<p><span class="math">11</span></p>
</div><p><a class="reference external" href="#anchor-74">Error: Reference source not found</a>).</p>
<div class="math">
<p><span class="math">\mathit{DOS}\left( {n\cdot\Delta\nu} \right)</span></p>
</div><p>is smoothed by applying a Gaussian window in the time domain
[<a class="reference external" href="#SignetBibliographie_010">10</a>] (see the section on <a class="reference external" href="#_Theory_and_implementation">Spatial
Density</a>). Its width in the time domain
is</p>
<div class="math">
<p><span class="math">{\sigma_{t} = \alpha}\text{/}T</span></p>
</div><p>, where T is the length of the simulation. We remark that the diffusion
constant obtained from <em>DOS</em> is biased due to the spectral smoothing
procedure since the <em>VACF</em> is weighted by this window Gaussian function.
<em>MDANSE</em> computes the density of states starting from both atomic
velocities and atomic coordinates. In this case the velocities are
computed by numerical differentiation of the coordinate trajectories
correcting first for possible jumps due to periodic boundary conditions.</p>
<p id="gui-1">GUI</p>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<p><a class="reference internal" href="../_images/picture49.png"><img alt="image14" src="../_images/picture49.png" style="width: 15.921cm; height: 14.295cm;" /></a> <a class="reference internal" href="../_images/picture50.png"><img alt="image15" src="../_images/picture50.png" style="width: 15.921cm; height: 4.847cm;" /></a></p>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Instrument_resolution">instrument resolution</a></p></li>
<li><p><a class="reference external" href="#_Interpolation_order">interpolation order</a></p></li>
<li><p><a class="reference external" href="#_Project_coordinates">project coordinates</a></p></li>
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Group_coordinates_by">Group coordinates by</a></p></li>
<li><p><a class="reference external" href="#_Atom_Transmutation_1">atom transmutation</a></p></li>
<li><p><a class="reference external" href="#_Weights">weights</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="general-autocorrelation-function">
<h5>General AutoCorrelation Function<a class="headerlink" href="#general-autocorrelation-function" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<p><a class="reference internal" href="../_images/picture51.png"><img alt="image16" src="../_images/picture51.png" style="width: 15.921cm; height: 11.636cm;" /></a> <a class="reference internal" href="../_images/picture52.png"><img alt="image17" src="../_images/picture52.png" style="width: 15.921cm; height: 5.207cm;" /></a></p>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Group_coordinates_by">Group coordinates by</a></p></li>
<li><p><a class="reference external" href="#_Atom_Transmutation_1">atom transmutation</a></p></li>
<li><p><strong>trajectory variable</strong></p></li>
</ul>
<p><em>Format:</em> drop-down</p>
<p><em>Default:</em> configuration</p>
<p><em>Description:</em> determines the variable for which the autocorrelation
function is calculated. Therefore, if the selected variable is
‘configuration’, essentially position autocorrelation function is
calculated.</p>
<ul class="simple">
<li><p><a class="reference external" href="#_Normalize">normalize</a></p></li>
<li><p><a class="reference external" href="#_Weights">weights</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="mean-square-displacement">
<h5>Mean Square Displacement<a class="headerlink" href="#mean-square-displacement" title="Permalink to this heading"></a></h5>
<p id="theory-and-implementation-2">Theory and implementation</p>
<p>Molecules in liquids and gases do not stay in the same place but move
constantly. This process is called diffusion and it happens quite
naturally in fluids at equilibrium. During this process, the motion of
an individual molecule does not follow a simple path. As it travels, the
molecule undergoes some collisions with other molecules which prevent it
from following a straight line. If the path is examined in close detail,
it will be seen to be a good approximation to a random walk.
Mathematically, a random walk is a series of steps where each step is
taken in a completely random direction from the one before. This kind of
path was famously analysed by Albert Einstein in a study of Brownian
motion. He showed that the Mean-Square Displacement (<em>MSD</em>) of a
particle following a random walk is proportional to the time elapsed.
This relationship can be written as</p>
<div class="math">
<p><span class="math">\begin{matrix}
{{\left\langle r^{2} \right\rangle = 6}{\mathit{Dt} + C}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}3} \right) \\
\end{matrix}</span></p>
</div><p>where &lt; r2 &gt; is the <em>MSD</em> and <em>t</em> is the time. <em>D</em> and <em>C</em> are
constants. The constant <em>D</em> defines the so-called diffusion coefficient.</p>
<p>The <a class="reference external" href="#figure1">Figure 1</a> shows an example of an <em>MSD</em> analysis
performed on a water box of 768 water molecules. To get the diffusion
coefficient out of this plot, the slope of the linear part of the plot
should be calculated.</p>
<a class="reference internal image-reference" href="pages/Pictures/picture53.png"><img alt="pages/Pictures/picture53.png" src="pages/Pictures/picture53.png" style="width: 11.748cm; height: 9.393cm;" /></a>
<p>Figure 1: <em>MSD</em> calculated for a 100 ps MD simulation of 256 water
molecules using NPT condition at 1 bar and 300 K.</p>
<p>Defining</p>
<div class="math">
<p><span class="math">\begin{matrix}
{d_{\alpha}\left( {t,t_{0}} \right)\doteq R_{\alpha}{\left( {t_{0} + t} \right) - R_{\alpha}}\left( t_{0} \right),} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}4} \right) \\
\end{matrix}</span></p>
</div><p>the <em>MSD</em> of particle α can be defined as:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\mathrm{\Delta}_{\alpha}^{2}{(t) = \left\langle {d_{\alpha}^{2}\left( {t,t_{0}} \right)} \right\rangle_{t_{0}}}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}5} \right) \\
\end{matrix}</span></p>
</div><p>where R_(t0) and R_(t0 + t) are respectively the position of particle α
at times t0 and t0 + t. One can introduce an <em>MSD</em> with respect to a
given axis n:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\mathrm{\Delta}_{\alpha}^{2}\left( {t,t_{0};n} \right)\doteq\left\langle {d_{\alpha}^{2}\left( {t,\tau;n} \right)} \right\rangle_{t_{0}}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}6} \right) \\
\end{matrix}</span></p>
</div><p>with</p>
<div class="math">
<p><span class="math">\begin{matrix}
{d_{\alpha}^{}\left( {t,\tau;n} \right)\doteq n\bullet d_{\alpha}^{}\left( {t,t_{0}} \right).} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}7} \right) \\
\end{matrix}</span></p>
</div><p>The calculation of <em>MSD</em> is the standard way to obtain diffusion
coefficients from Molecular Dynamics (<em>MD</em>) simulations. Assuming
Einstein-diffusion in the long time limit one has for isotropic systems</p>
<div class="math">
<p><span class="math">\begin{matrix}
{{D_{\alpha} = {\lim\limits_{t\rightarrow\infty}{\frac{1}{6t}\mathrm{\Delta}_{\alpha}^{2}(t)}}}.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}8} \right) \\
\end{matrix}</span></p>
</div><p>There exists also a well-known relation between the <em>MSD</em> and the
velocity autocorrelation function. Writing</p>
<div class="math">
<p><span class="math">d_{\alpha}{(t) = {\int\limits_{0}^{t}{\mathit{d\tau}v_{\alpha}(\tau)}}}</span></p>
</div><p>in Eq.</p>
<div class="math">
<p><span class="math">5</span></p>
</div><p><a class="reference external" href="#anchor-84">Error: Reference source not found</a> one can show (see
e.g. [<a class="reference external" href="#SignetBibliographie_011">11</a>]) that</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\mathrm{\Delta}_{\alpha}^{2}{(t) = 6}{\int\limits_{0}^{t}{\mathit{d\tau}\left( {t - \tau} \right)C_{\mathit{\upsilon\upsilon};\mathit{\alpha\alpha}}(t)}}.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}9} \right) \\
\end{matrix}</span></p>
</div><p>Using now the definition</p>
<div class="math">
<p><span class="math">8</span></p>
</div><p><a class="reference external" href="#anchor-85">Error: Reference source not found</a> of the diffusion
coefficient one obtains the relation</p>
<div class="math">
<p><span class="math">\begin{matrix}
{{D_{\alpha} = {\int\limits_{0}^{t}{\mathit{d\tau}C_{\mathit{\upsilon\upsilon};\mathit{\alpha\alpha}}(t)}}}.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}10} \right) \\
\end{matrix}</span></p>
</div><p>With Eq.</p>
<div class="math">
<p><span class="math">28</span></p>
</div><p><a class="reference external" href="#anchor-86">Error: Reference source not found</a> this can also be
written as</p>
<div class="math">
<p><span class="math">\begin{matrix}
{{D_{\alpha} = \pi}{\overset{\sim}{C}}_{\mathit{\upsilon\upsilon};\mathit{\alpha\alpha}}(0).} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}11} \right) \\
\end{matrix}</span></p>
</div><p>Computationally, the <em>MSD</em> is calculated using the Fast Correlation
Algorithm (<em>FCA</em>) [<a class="reference external" href="#SignetBibliographie_012">12</a>]. In this
framework, in the discrete case, the mean-square displacement of a
particle is given by</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\mathrm{\Delta}^{2}{(m) = \frac{1}{N_{t} - m}}{\sum\limits_{k = 0}^{N_{t} - m - 1}\left\lbrack {r{\left( {k + m} \right) - r}(k)} \right\rbrack^{2}},{m = 0.}..{N_{t} - 1}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}12} \right) \\
\end{matrix}</span></p>
</div><p>where r(k) is the particle trajectory and Nt is the number of frames of
the trajectory. We define now the auxiliary function</p>
<div class="math">
<p><span class="math">\begin{matrix}
{S(m)\doteq{\sum\limits_{k = 0}^{N_{t} - m - 1}\left\lbrack {r{\left( {k + m} \right) - r}(k)} \right\rbrack^{2}},{m = 0}...N{t - 1},} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}13} \right) \\
\end{matrix}</span></p>
</div><p>which is split as follows:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{S{(m) = S_{\mathit{AA} + \mathit{BB}}}{(m) - 2}S_{\mathit{AB}}(m),} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}14} \right) \\
\end{matrix}</span></p>
</div><div class="math">
<p><span class="math">\begin{matrix}
{S_{\mathit{AA} + \mathit{BB}}{(m) = \sum\limits_{k = 0}^{N_{t} - m - 1}}\left\lbrack {r^{2}{\left( {k + m} \right) + r^{2}}(k)} \right\rbrack,} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}15} \right) \\
\end{matrix}</span></p>
</div><div class="math">
<p><span class="math">\begin{matrix}
{S_{\mathit{AB}}{(m) = {\sum\limits_{k = 0}^{N_{t} - m - 1}{r(k)}}}\cdot r\left( {k + m} \right).} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}16} \right) \\
\end{matrix}</span></p>
</div><p>The function SAB(m) can be computed using the <em>FCA</em> method described in
the section on <a class="reference external" href="#_Theory_and_implementation">Spatial Density</a>. For
SAA+BB(m) the following recursion relation holds:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{S_{\mathit{AA} + \mathit{BB}}{(m) = S_{\mathit{AA} + \mathit{BB}}}{\left( {m - 1} \right) - r^{2}}{\left( {m - 1} \right) - r^{2}}\left( {N_{t} - m} \right),} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}17} \right) \\
\end{matrix}</span></p>
</div><div class="math">
<p><span class="math">\begin{matrix}
{S_{\mathit{AA} + \mathit{BB}}{(0) = {\sum\limits_{k = 0}^{N_{t} - 1}{r^{2}(k)}}}.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}18} \right) \\
\end{matrix}</span></p>
</div><p>This allows one to construct the following efficient scheme for the
computation of the <em>MSD</em>:</p>
<ol class="arabic">
<li><p>Compute</p>
<div class="math">
<p><span class="math">\mathit{DSQ}{{(k)} = r}2{(k)},{k = 0}...N{t - 1}</span></p>
</div><p>;</p>
<div class="math">
<p><span class="math">\mathit{DSQ}{{({- 1})} = \mathit{DSQ}}{{({Nt})} = 0}</span></p>
</div><p>.</p>
</li>
<li><p>Compute</p>
<div class="math">
<p><span class="math">{\mathit{SUMSQ} = 2}\cdot{\sum\limits_{k = 0}^{N_{t} - 1}{\mathit{DSQ}(k)}}</span></p>
</div></li>
<li><p>Compute SAB(m) using the Fast Fourier Transform (<em>FFT</em>) method.</p></li>
<li><p>Compute <em>MSD(m)</em> in the following loop:</p></li>
</ol>
<div class="math">
<p><span class="math">\mathit{SUMSQ}\leftarrow{\mathit{SUMSQ} - \mathit{DSQ}}{{({m - 1})} - \mathit{DSQ}}{({N{t - m}})}</span></p>
</div><div class="math">
<p><span class="math">\mathit{MSD}{(m)}\leftarrow{}</span></p>
</div><p>m running from 0 to Nt – 1</p>
<p>It should be noted that the efficiency of this algorithm is the same as
for the <em>FCA</em> computation</p>
<p>of time correlation functions since the number of operations in step
(1), (2), and (4) grows</p>
<p>linearly with Nt.</p>
<p id="gui-2">GUI</p>
<p><a class="reference internal" href="pages/Pictures/100000010000031F00000247259172131CFA3B36.png"><img alt="image18" src="pages/Pictures/100000010000031F00000247259172131CFA3B36.png" style="width: 15.921cm; height: 11.617cm;" /></a> <a class="reference internal" href="pages/Pictures/100000010000031F000001000B539E0E94164B2D.png"><img alt="image19" src="pages/Pictures/100000010000031F000001000B539E0E94164B2D.png" style="width: 15.921cm; height: 5.101cm;" /></a></p>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Project_coordinates">project coordinates</a></p></li>
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Group_coordinates_by">Group coordinates by</a></p></li>
<li><p><a class="reference external" href="#_Atom_Transmutation_1">atom transmutation</a></p></li>
<li><p><a class="reference external" href="#_Weights">weights</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="order-parameter">
<h5>Order Parameter<a class="headerlink" href="#order-parameter" title="Permalink to this heading"></a></h5>
<p id="theory-and-implementation-3">Theory and implementation</p>
<p>Adequate and accurate cross comparison of the NMR and <em>MD</em> simulation
data is of crucial importance in versatile studies conformational
dynamics of proteins. NMR relaxation spectroscopy has proven to be a
unique approach for a site-specific investigation of both global
tumbling and internal motions of proteins. The molecular motions
modulate the magnetic interactions between the nuclear spins and lead
for each nuclear spin to a relaxation behaviour which reflects its
environment. Since its first applications to the study of protein
dynamics, a wide variety of experiments has been proposed to investigate
backbone as well as side chain dynamics. Among them, the heteronuclear
relaxation measurement of amide backbone <sup>15</sup>N nuclei is one of
the most widespread techniques. The relationship between microscopic
motions and measured spin relaxation rates is given by Redfield’s theory
[<a class="reference external" href="#SignetBibliographie_013">13</a>]. Under the hypothesis that
<sup>15</sup>N relaxation occurs through dipole-dipole interactions with
the directly bonded <sup>1</sup>H atom and chemical shift anisotropy
(CSA), and assuming that the tensor describing the CSA is axially
symmetric with its axis parallel to the N-H bond, the relaxation rates
of the <sup>15</sup>N nuclei are determined by a time correlation
function,</p>
<div class="math">
<p><span class="math">\begin{matrix}
{C_{\mathit{ii}}{(t) = \left\langle {P_{2}\left( {\mu_{i}(0)\cdot\mu_{i}(t)} \right)} \right\rangle}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}19} \right) \\
\end{matrix}</span></p>
</div><p>which describes the dynamics of a unit vector μ<sub>i</sub>(t) pointing
along the <sup>15</sup>N-<sup>1</sup>H bond of the residue <em>i</em> in the
laboratory frame. Here P<sub>2</sub>(.) is the second order Legendre
polynomial. The Redfield theory shows that relaxation measurements probe
the relaxation dynamics of a selected nuclear spin only at a few
frequencies. Moreover, only a limited number of independent observables
are accessible. Hence, to relate relaxation data to protein dynamics one
has to postulate either a dynamical model for molecular motions or a
functional form for C<sub>ii</sub>(t), yet depending on a limited number
of adjustable parameters. Usually, the tumbling motion of proteins in
solution is assumed isotropic and uncorrelated with the internal
motions, such that:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{C_{\mathit{ii}}{(t) = C^{G}}(t)\cdot C_{\mathit{ii}}^{I}(t)} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}20} \right) \\
\end{matrix}</span></p>
</div><p>where C<sup>G</sup>(t) and</p>
<div class="math">
<p><span class="math">C_{\mathit{ii}}^{I}(t)</span></p>
</div><p>denote the global and the internal time correlation function,
respectively. Within the so-called model free approach
[<a class="reference external" href="#SignetBibliographie_014">14</a>], [<a class="reference external" href="#SignetBibliographie_015">15</a>]
the internal correlation function is modelled by an exponential,</p>
<div class="math">
<p><span class="math">\begin{matrix}
{C_{\mathit{ii}}^{I}{(t) = {S_{i}^{2} + \left( {1 - S_{i}^{2}} \right)}}\exp\left( \frac{- t}{\tau_{\mathit{eff},i}} \right)} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}21} \right) \\
\end{matrix}</span></p>
</div><p>Here the asymptotic value</p>
<div class="math">
<p><span class="math">{S_{i}^{2} = C_{\mathit{ii}}}\left( {+ \infty} \right)</span></p>
</div><p>is the so-called generalized order parameter, which indicates the
degree of spatial restriction of the internal motions of a bond vector,
while the characteristic time</p>
<div class="math">
<p><span class="math">\tau_{\mathit{eff},i}</span></p>
</div><p>is an effective correlation time, setting the time scale of the
internal relaxation processes.</p>
<div class="math">
<p><span class="math">S_{i}^{2}</span></p>
</div><p>can adopt values ranging from 0 (completely disordered) to 1 (fully
ordered). So,</p>
<div class="math">
<p><span class="math">S_{i}^{2}</span></p>
</div><p>is the appropriate indicator of protein backbone motions in
computationally feasible timescales as it describes the spatial aspects
of the reorientational motion of N-H peptidic bonds vector.</p>
<p>When performing Order Parameter analysis, <em>MDANSE</em> computes for each
residue <em>i</em> both</p>
<div class="math">
<p><span class="math">C_{\mathit{ii}}(t)</span></p>
</div><p>and</p>
<div class="math">
<p><span class="math">S_{i}^{2}</span></p>
</div><p>. It also computes a correlation function averaged over all the selected
bonds defined as:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{C^{I}{(t) = {\sum\limits_{i = 1}^{N_{\mathit{bonds}}}{C_{\mathit{ii}}^{I}(t)}}}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}22} \right) \\
\end{matrix}</span></p>
</div><p>where N<sub>bonds</sub> is the number of selected bonds for the analysis.</p>
<p id="gui-3">GUI</p>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<a class="reference internal image-reference" href="pages/Pictures/10000001000003220000027563B8CBFF70E2089C.png"><img alt="pages/Pictures/10000001000003220000027563B8CBFF70E2089C.png" src="pages/Pictures/10000001000003220000027563B8CBFF70E2089C.png" style="width: 15.921cm; height: 12.487cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Axis_Selection_1">axis selection</a></p></li>
<li><p>reference direction</p>
<ul>
<li><p><strong>x-component</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int or float</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> &lt;insert&gt;</p>
<ul class="simple">
<li><ul>
<li><p><strong>y-component</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int or float</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> &lt;insert&gt;</p>
<ul class="simple">
<li><ul>
<li><p><strong>z-component</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int or float</p>
<p><em>Default:</em> 1</p>
<p><em>Description:</em> &lt;insert&gt;</p>
<ul class="simple">
<li><p><a class="reference external" href="#_Output_contribution_per">output contribution per axis</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="position-autocorrelation-function">
<h5>Position AutoCorrelation Function<a class="headerlink" href="#position-autocorrelation-function" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<p><a class="reference internal" href="pages/Pictures/1000000100000320000001F34B3598CBB7D90098.png"><img alt="image20" src="pages/Pictures/1000000100000320000001F34B3598CBB7D90098.png" style="width: 15.921cm; height: 9.931cm;" /></a> <a class="reference internal" href="pages/Pictures/1000000100000322000001997BE6CF552F7A05D0.png"><img alt="image21" src="pages/Pictures/1000000100000322000001997BE6CF552F7A05D0.png" style="width: 15.921cm; height: 8.119cm;" /></a></p>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Normalize">normalize</a></p></li>
<li><p><a class="reference external" href="#_Project_coordinates">project coordinates</a></p></li>
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Group_coordinates_by">Group coordinates by</a></p></li>
<li><p><a class="reference external" href="#_Atom_Transmutation_1">atom transmutation</a></p></li>
<li><p><a class="reference external" href="#_Weights">weights</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="velocity-autocorrelation-function">
<h5>Velocity AutoCorrelation Function<a class="headerlink" href="#velocity-autocorrelation-function" title="Permalink to this heading"></a></h5>
<p id="theory-and-implementation-4">Theory and implementation</p>
<p>The Velocity AutoCorrelation Function (<em>VACF</em>) is another interesting
property describing the dynamics of a molecular system. Indeed, it
reveals the underlying nature of the forces acting on the system.</p>
<p>In a molecular system that would be made of non-interacting particles,
the velocities would be constant at any time triggering the <em>VACF</em> to be
a constant value. Now, if we think about a system with small
interactions such as in a gas-phase, the magnitude and direction of the
velocity of a particle will change gradually over time due to its
collision with the other particles of the molecular system. In such a
system, the <em>VACF</em> will be represented by a decaying exponential.</p>
<p>In the case of solid phase, the interactions are much stronger and, as a
results, the atoms are bound to a given position from which they will
move backwards and forwards oscillating between positive and negative
values of their velocity. The oscillations will not be of equal
magnitude however, but will decay in time, because there are still
perturbative forces acting on the atoms to disrupt the perfection of
their oscillatory motion. So, in that case the <em>VACF</em> will look like a
damped harmonic motion.</p>
<p>Finally, in the case of liquid phase, the atoms have more freedom than
in solid phase and because of the diffusion process, the oscillatory
motion seen in solid phase will be cancelled quite rapidly depending on
the density of the system. So, the <em>VACF</em> will just have one very damped
oscillation before decaying to zero. This decaying time can be
considered as the average time for a collision between two atoms to
occur before they diffuse away.</p>
<p>Mathematically, the <em>VACF</em> of atom α in an atomic or molecular system is
usually defined as</p>
<div class="math">
<p><span class="math">\begin{matrix}
{C_{\mathit{vv};\mathit{\alpha\alpha}}(t)\doteq\frac{1}{3}\left\langle {v_{\alpha}\left( t_{0} \right)\cdot v_{\alpha}\left( {t_{0} + t} \right)} \right\rangle_{t_{0}}.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}23} \right) \\
\end{matrix}</span></p>
</div><p>In some cases, e.g. for non-isotropic systems, it is useful to define
<em>VACF</em> along a given axis,</p>
<div class="math">
<p><span class="math">\begin{matrix}
{C_{\mathit{vv};\mathit{\alpha\alpha}}\left( {t;n} \right)\doteq\left\langle {v_{\alpha}\left( {t_{0};n} \right)v_{\alpha}\left( {{t_{0} + t};n} \right)} \right\rangle_{t_{0}},} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}24} \right) \\
\end{matrix}</span></p>
</div><p>where v<sub>α</sub>(t; <strong>n</strong>) is given by</p>
<div class="math">
<p><span class="math">\begin{matrix}
{v_{\alpha}\left( {t;n} \right)\doteq n\cdot v_{\alpha}(t).} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}25} \right) \\
\end{matrix}</span></p>
</div><p>The vector n is a unit vector defining a space-fixed axis.</p>
<p>The <em>VACF</em> of the particles in a many body system can be related to the
incoherent dynamic structure factor by the relation:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\mathit{li}m_{q\rightarrow 0}\frac{\omega^{2}}{q^{2}}S{\left( {q,\omega} \right) = G}(\omega),} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}26} \right) \\
\end{matrix}</span></p>
</div><p>where G(ω) is the Density Of States (<em>DOS</em>). For an isotropic system it
reads</p>
<div class="math">
<p><span class="math">\begin{matrix}
{G{(\omega) = {\sum\limits_{\alpha}{b_{\alpha,\mathit{inc}}^{2}{\overset{\sim}{C}}_{\mathit{vv};\mathit{\alpha\alpha}}(\omega)}}},} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}27} \right) \\
\end{matrix}</span></p>
</div><div class="math">
<p><span class="math">\begin{matrix}
{{\overset{\sim}{C}}_{\mathit{vv};\mathit{\alpha\alpha}}{(\omega) = \frac{1}{2\pi}}{\int\limits_{- \infty}^{+ \infty}\mathit{dt}}\exp\left\lbrack {{- i}\omega t} \right\rbrack C_{\mathit{vv};\mathit{\alpha\alpha}}(t).} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}28} \right) \\
\end{matrix}</span></p>
</div><p>For non-isotropic systems, relation</p>
<div class="math">
<p><span class="math">26</span></p>
</div><p><a class="reference external" href="#anchor-98">Error: Reference source not found</a> holds if the <em>DOS</em>
is computed from the atomic velocity autocorrelation functions</p>
<div class="math">
<p><span class="math">C_{\mathit{vv};\mathit{\alpha\alpha}}\left( {t;n_{q}} \right)</span></p>
</div><p>, where nq is the unit vector in the direction of q.</p>
<p id="gui-4">GUI</p>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<p><a class="reference internal" href="pages/Pictures/100000010000031F000001F4716D097EF0177F0B.png"><img alt="image22" src="pages/Pictures/100000010000031F000001F4716D097EF0177F0B.png" style="width: 15.921cm; height: 9.964cm;" /></a> <a class="reference internal" href="pages/Pictures/100000010000031F000001BDEA9E86A41E3EBCA6.png"><img alt="image23" src="pages/Pictures/100000010000031F000001BDEA9E86A41E3EBCA6.png" style="width: 15.921cm; height: 8.867cm;" /></a></p>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Interpolation_order">interpolation order</a></p></li>
<li><p><a class="reference external" href="#_Project_coordinates">project coordinates</a></p></li>
<li><p><a class="reference external" href="#_Normalize">normalize</a></p></li>
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Group_coordinates_by">Group coordinates by</a></p></li>
<li><p><a class="reference external" href="#_Atom_Transmutation_1">atom transmutation</a></p></li>
<li><p><a class="reference external" href="#_Weights">weights</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
</section>
<section id="infrared">
<h4>Infrared<a class="headerlink" href="#infrared" title="Permalink to this heading"></a></h4>
<section id="dipole-autocorrelation-function">
<h5>Dipole AutoCorrelation Function<a class="headerlink" href="#dipole-autocorrelation-function" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<a class="reference internal image-reference" href="pages/Pictures/10000001000003200000022889DD21920219B434.png"><img alt="pages/Pictures/10000001000003200000022889DD21920219B434.png" src="pages/Pictures/10000001000003200000022889DD21920219B434.png" style="width: 15.921cm; height: 10.986cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Atom_Charges_1">atom charges</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
</section>
<section id="macromolecules">
<h4>Macromolecules<a class="headerlink" href="#macromolecules" title="Permalink to this heading"></a></h4>
<p>This section has one subsection, Lipids, which contains following
Plugins:</p>
<ul class="simple">
<li><p>Refolded Membrane Trajectory</p></li>
</ul>
<section id="refolded-membrane-trajectory">
<h5>Refolded Membrane Trajectory<a class="headerlink" href="#refolded-membrane-trajectory" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<a class="reference internal image-reference" href="pages/Pictures/100000010000032200000202AC02A063F408C4F9.png"><img alt="pages/Pictures/100000010000032200000202AC02A063F408C4F9.png" src="pages/Pictures/100000010000032200000202AC02A063F408C4F9.png" style="width: 15.921cm; height: 10.204cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><strong>membrane axis</strong></p></li>
</ul>
<p><em>Format:</em> drop-down</p>
<p><em>Default:</em> c</p>
<p><em>Description:</em> the axis along which is used for the trajectory
manipulation, the normal to the membrane.</p>
<ul class="simple">
<li><p><strong>name of the lipid of the upper leaflet</strong></p></li>
</ul>
<p><em>Format:</em> str</p>
<p><em>Default:</em> DMPC</p>
<p><em>Description:</em> the name of the lipid positioned in the upper leaflet of
the membrane. It will be repositioned into the upper part of the
simulation box. The name must be the name with which MMTK refers to the
lipid.</p>
<ul class="simple">
<li><p><strong>name of the lipid of the lower leaflet</strong></p></li>
</ul>
<p><em>Format:</em> str</p>
<p><em>Default:</em> DMPC</p>
<p><em>Description:</em> the name of the lipid positioned in the lower leaflet of
the membrane. It will be repositioned into the lower part of the
simulation box. The name must be the name with which MMTK refers to the
lipid.</p>
<ul class="simple">
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
</ul>
</section>
</section>
<section id="scattering">
<h4>Scattering<a class="headerlink" href="#scattering" title="Permalink to this heading"></a></h4>
<p>Below is a list of Plugins contained in this section. They are all used
to calculate neutron spectroscopy observables from the trajectory.</p>
<ul class="simple">
<li><p><a class="reference external" href="#_Current_Correlation_Function">Current Correlation Function</a></p></li>
<li><p><a class="reference external" href="#_Dynamic_Coherent_Structure">Dynamic Coherent Structure Factor</a></p></li>
<li><p><a class="reference external" href="#_Dynamic_Incoherent_Structure">Dynamic Incoherent Structure
Factor</a></p></li>
<li><p><a class="reference external" href="#_Elastic_Incoherent_Structure">Elastic Incoherent Structure
Factor</a></p></li>
<li><p><a class="reference external" href="#_Gaussian_Dynamic_Incoherent">Gaussian Dynamic Incoherent Structure
Factor</a></p></li>
<li><p><a class="reference external" href="#_Neutron_Dynamic_Total">Neutron Dynamic Total Structure Factor</a></p></li>
<li><p><a class="reference external" href="#_Structure_Factor_From">Structure Factor From Scattering
Function</a></p></li>
</ul>
<p>These plugins will be explored in depth in further sections, however,
before that, it is important to understand how MDANSE performs these
analyses. A part of that are <a class="reference external" href="#_A3.4._Q_vectors">Q vectors</a>, which
are used to perform these analyses. An in-depth discussion of this
aspect is present in <a class="reference external" href="#_Appendix_2">Appendix 2</a>.</p>
<section id="theory-and-background">
<h5>Theory and background<a class="headerlink" href="#theory-and-background" title="Permalink to this heading"></a></h5>
<p>The quantity of interest in neutron scattering experiments with thermal
neutrons is the <em>dynamic structure factor</em>, S(<strong>q</strong>, ω), which is
closely related to the double differential cross-section [7],</p>
<div class="math">
<p><span class="math">d^{2}{\sigma/\mathit{d\Omega dE}}</span></p>
</div><p>. The double differential cross section is defined as the number of
neutrons which are scattered per unit time into the solid angle interval</p>
<div class="math">
<p><span class="math">\left\lbrack {\Omega,{\Omega + d}\Omega} \right\rbrack</span></p>
</div><p>and into the energy interval</p>
<div class="math">
<p><span class="math">{\lbrack{E,{E + \mathit{dE}}}\rbrack}.</span></p>
</div><p>It is normalized to d, <em>dE</em>, and the flux of the incoming neutrons,</p>
<div class="math">
<p><span class="math">\begin{matrix}
{{\frac{d^{2}\sigma}{d\Omega\mathit{dE}} = N}\cdot\frac{k}{k_{0}}S\left( {q,\omega} \right).} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}29} \right) \\
\end{matrix}</span></p>
</div><p>Here <em>N</em> is the number of atoms, and k ≡ |<strong>k</strong>| and k<sub>0</sub> ≡
|<strong>k</strong><sub>0</sub>| are the wave numbers of scattered and incident
neutrons, respectively. They are related to the corresponding neutron
energies by</p>
<div class="math">
<p><span class="math">{E = \hslash^{2}}k^{2}\text{/}2m</span></p>
</div><p>and</p>
<div class="math">
<p><span class="math">{E_{0} = \hslash^{2}}k_{0}^{2}\text{/}2m</span></p>
</div><p>where</p>
<div class="math">
<p><span class="math">m</span></p>
</div><p>is the neutron mass. The arguments of the dynamic structure factor,</p>
<div class="math">
<p><span class="math">q</span></p>
</div><p>and</p>
<div class="math">
<p><span class="math">\omega</span></p>
</div><p>, are the momentum and energy transfer in units of</p>
<div class="math">
<p><span class="math">\hslash</span></p>
</div><p>, respectively:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{{q = \frac{k_{0} - k}{\hslash}},} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}30} \right) \\
\end{matrix}</span></p>
</div><div class="math">
<p><span class="math">\begin{matrix}
{{\omega = \frac{E_{0} - E}{\hslash}}.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}31} \right) \\
\end{matrix}</span></p>
</div><p>The modulus of the momentum transfer can be expressed in the scattering
angle</p>
<div class="math">
<p><span class="math">\theta</span></p>
</div><p>, the energy transfer, and the energy of the incident neutrons:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{{q = \sqrt{{2 - \frac{\mathit{\hslash\omega}}{E_{0}} - 2}\cos{\theta\sqrt{2 - \frac{\mathit{\hslash\omega}}{E_{0}}}}}}.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}32} \right) \\
\end{matrix}</span></p>
</div><p>The dynamic structure factor contains information about the structure
and dynamics of the scattering system
[<a class="reference external" href="#SignetBibliographie_016">16</a>]. It can be written as</p>
<div class="math">
<p><span class="math">\begin{matrix}
{S{\left( {q,\omega} \right) = \frac{1}{2\pi}}{\int\limits_{- \infty}^{+ \infty}\mathit{dt}}\exp\left\lbrack {{- i}\omega t} \right\rbrack F\left( {q,t} \right).} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}33} \right) \\
\end{matrix}</span></p>
</div><p>F(<strong>q</strong>, t) is called the <em>intermediate scattering function</em> and is
defined as</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\text{F}{\left( {q,t} \right) = {\sum\limits_{\alpha,\beta}{\Gamma_{\mathit{\alpha\beta}}\left\langle {\exp\left\lbrack {{- i}q\cdot\hat{R_{\alpha}}(0)} \right\rbrack\exp\left\lbrack {iq\cdot\hat{R_{\beta}}(t)} \right\rbrack} \right\rangle}}},} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}34} \right) \\
\end{matrix}</span></p>
</div><div class="math">
<p><span class="math">\begin{matrix}
{{\Gamma_{\mathit{\alpha\beta}} = \frac{1}{N}}\left\lbrack {\overline{b_{\alpha}}{\overline{b_{\beta}} + \delta_{\mathit{\alpha\beta}}}\left( {\overline{b_{\alpha}^{2}} - {\overline{b_{\alpha}}}^{2}} \right)} \right\rbrack.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}35} \right) \\
\end{matrix}</span></p>
</div><p>The operators</p>
<div class="math">
<p><span class="math">\hat{R_{\alpha}}(t)</span></p>
</div><p>in Eq.</p>
<div class="math">
<p><span class="math">34</span></p>
</div><p><a class="reference external" href="#anchor-110">Error: Reference source not found</a> are the position
operators of the nuclei in the sample. The brackets</p>
<div class="math">
<p><span class="math">\langle\ldots\rangle</span></p>
</div><p>denote a quantum thermal average and the time dependence of the position
operators is defined by the Heisenberg picture. The quantities</p>
<div class="math">
<p><span class="math">b_{\alpha}</span></p>
</div><p>are the scattering lengths of the nuclei which depend on the isotope and
the relative orientation of the spin of the neutron and the spin of the
scattering nucleus. If the spins of the nuclei and the neutron are not
prepared in a special orientation one can assume a random relative
orientation and that spin and position of the nuclei are uncorrelated.
The symbol</p>
<div class="math">
<p><span class="math">\overline{...\mspace{9mu}}</span></p>
</div><p>appearing in</p>
<div class="math">
<p><span class="math">\Gamma_{\mathit{\alpha\beta}}</span></p>
</div><p>denotes an average over isotopes and relative spin orientations of
neutron and nucleus.</p>
<p>Usually, one splits the intermediate scattering function and the dynamic
structure factor into their <em>coherent</em> and <em>incoherent</em> parts which
describe collective and single particle motions, respectively. Defining</p>
<div class="math">
<p><span class="math">\begin{matrix}
{b_{\alpha,\mathit{coh}}\doteq\overline{b_{\alpha}},} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}36} \right) \\
\end{matrix}</span></p>
</div><div class="math">
<p><span class="math">\begin{matrix}
{b_{\alpha,\mathit{inc}}\doteq\sqrt{\overline{b_{\alpha}^{2}} - {\overline{b_{\alpha}}}^{2}},} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}37} \right) \\
\end{matrix}</span></p>
</div><p>the coherent and incoherent intermediate scattering functions can be
cast in the form</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\text{F}_{\text{coh}}{\left( {q,t} \right) = \frac{1}{N}}{\sum\limits_{\alpha,\beta}b_{\alpha,\mathit{coh}}}b_{\beta,\mathit{coh}}\left\langle {\exp\left\lbrack {{- i}q\cdot\hat{R_{\alpha}}(0)} \right\rbrack\exp\left\lbrack {iq\cdot\hat{R_{\beta}}(t)} \right\rbrack} \right\rangle,} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}38} \right) \\
\end{matrix}</span></p>
</div><div class="math">
<p><span class="math">\begin{matrix}
{\text{F}_{\text{inc}}{\left( {q,t} \right) = \frac{1}{N}}{\sum\limits_{\alpha}{b_{\alpha,\mathit{inc}}^{2}\left\langle {\exp\left\lbrack {{- i}q\cdot\hat{R_{\alpha}}(0)} \right\rbrack\exp\left\lbrack {iq\cdot\hat{R_{\alpha}}(t)} \right\rbrack} \right\rangle}}.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}39} \right) \\
\end{matrix}</span></p>
</div><p>Rewriting these formulas, <em>MDANSE</em> introduces the partial terms as:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\text{F}_{\text{coh}}{\left( {q,t} \right) = \sum\limits_{I,J\geq I}^{N_{\mathit{species}}}}\sqrt{n_{I}n_{J}\omega_{I,\text{coh}}\omega_{J,\text{coh}}}F_{\mathit{IJ},\text{coh}}\left( {q,t} \right),} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}40} \right) \\
\end{matrix}</span></p>
</div><div class="math">
<p><span class="math">\begin{matrix}
{\text{F}_{\text{inc}}{\left( {q,t} \right) = {\sum\limits_{I = 1}^{N_{\mathit{species}}}{n_{I}\omega_{I,\text{inc}}F_{I,\text{inc}}\left( {q,t} \right)}}}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}41} \right) \\
\end{matrix}</span></p>
</div><p>where:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\text{F}_{\mathit{IJ},\text{coh}}{\left( {q,t} \right) = \frac{1}{\sqrt{n_{I}n_{J}}}}{\sum\limits_{\alpha}^{n_{I}}{\sum\limits_{\beta}^{n_{J}}\left\langle {\exp\left\lbrack {{- i}q\cdot\hat{R_{\alpha}}\left( t_{0} \right)} \right\rbrack\exp\left\lbrack {iq\cdot\hat{R_{\beta}}\left( {t_{0} + t} \right)} \right\rbrack} \right\rangle_{t_{0}}}},} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}42} \right) \\
\end{matrix}</span></p>
</div><div class="math">
<p><span class="math">\begin{matrix}
{\text{F}_{I,\text{inc}}{\left( {q,t} \right) = \frac{1}{n_{I}}}{\sum\limits_{\alpha = 1}^{n_{I}}\left\langle {\exp\left\lbrack {{- i}q\cdot\hat{R_{\alpha}}\left( t_{0} \right)} \right\rbrack\exp\left\lbrack {iq\cdot\hat{R_{\alpha}}\left( {t_{0} + t} \right)} \right\rbrack} \right\rangle_{t_{0}}}.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}43} \right) \\
\end{matrix}</span></p>
</div><p>where n<sub>I</sub>, n<sub>J</sub>, N<sub>species</sub>, ω<sub>I,coh,inc</sub>
and ω<sub>J,coh,inc</sub> are defined in Section ??.</p>
<p>The corresponding dynamic structure factors are obtained by performing
the Fourier transformation defined in Eq.</p>
<div class="math">
<p><span class="math">33</span></p>
</div><p><a class="reference external" href="#anchor-111">Error: Reference source not found</a>.</p>
<p>An important quantity describing <em>structural</em> properties of liquids is
the <em>static structure factor</em>, which is defined as</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\text{S}(q)\doteq{\int\limits_{- \infty}^{+ \infty}{d\omega}}\text{S}_{\mathit{coh}}\left( {q,\omega} \right)\text{F}_{\mathit{coh}}\left( {q,0} \right).} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}44} \right) \\
\end{matrix}</span></p>
</div><p>In the classical framework the intermediate scattering functions are
interpreted as classical time correlation functions. The position
operators are replaced by time-dependent vector functions and quantum
thermal averages are replaced by classical <em>ensemble averages</em>. It is
well known that this procedure leads to a loss of the universal detailed
balance relation,</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\text{S}{\left( {q,\omega} \right) = \exp}\left\lbrack {\beta\hslash\omega} \right\rbrack\text{S}\left( {{- q}{, - \omega}} \right),} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}45} \right) \\
\end{matrix}</span></p>
</div><p>and also to a loss of all odd moments</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\left\langle \omega^{2{n + 1}} \right\rangle\doteq{\int\limits_{- \infty}^{+ \infty}{d\omega}}\omega^{2{n + 1}}S\left( {q,\omega} \right),{n = 1,2},\ldots.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}46} \right) \\
\end{matrix}</span></p>
</div><p>The odd moments vanish since the classical dynamic structure factor is
even in ω, assuming invariance of the scattering process with respect to
reflections in space. The first moment is also universal. For an atomic
liquid, containing only one sort of atoms, it reads</p>
<div class="math">
<p><span class="math">\begin{matrix}
{{\left\langle \omega \right\rangle = \frac{\hslash q^{2}}{2M}},} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}47} \right) \\
\end{matrix}</span></p>
</div><p>where M is the mass of the atoms. Formula</p>
<div class="math">
<p><span class="math">47</span></p>
</div><p><a class="reference external" href="#anchor-112">Error: Reference source not found</a> shows that the
first moment is given by the average kinetic energy (in units of</p>
<div class="math">
<p><span class="math">\hslash</span></p>
</div><p>) of a particle which receives a momentum transfer</p>
<div class="math">
<p><span class="math">\hslash q</span></p>
</div><p>. Therefore,</p>
<div class="math">
<p><span class="math">\langle\omega\rangle</span></p>
</div><p>is called the <em>recoil moment</em>. A number of ‘recipes’ has been suggested
to correct classical dynamic structure factors for detailed balance and
to describe recoil effects in an approximate way. The most popular one
has been suggested by Schofield [<a class="reference external" href="#SignetBibliographie_017">17</a>]</p>
<div class="math">
<p><span class="math">\begin{matrix}
{{\text{S}\left( {q,\omega} \right)\approx\exp\left\lbrack \frac{\beta\hslash\omega}{2} \right\rbrack}_{}\text{S}_{\mathit{cl}}\left( {q,\omega} \right)} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}48} \right) \\
\end{matrix}</span></p>
</div><p>One can easily verify that the resulting dynamic structure factor
fulfils the relation of detailed balance. Formally, the correction</p>
<div class="math">
<p><span class="math">48</span></p>
</div><p><a class="reference external" href="#anchor-113">Error: Reference source not found</a> is correct to
first order in</p>
<div class="math">
<p><span class="math">\hslash</span></p>
</div><p>. Therefore, it cannot be used for large <em>q</em>-values which correspond to
large momentum transfers</p>
<div class="math">
<p><span class="math">\hslash q</span></p>
</div><p>. This is actually true for all correction methods which have suggested
so far. For more details we refer to Ref.
[<a class="reference external" href="#SignetBibliographie_018">18</a>].</p>
<p>MDANSE computes the partial S(Q)’s as the Fourier transform of the
partial g(r), corresponding to the Faber-Ziman definition:</p>
<div class="math">
<p><span class="math">{S_{\mathit{\text{αβ}}}(Q{) = {1 + \frac{4\mathit{\text{πρ}_{\mathrm{0}}}}{Q}}}{\int\limits_{0}^{\infty}{r\left\lbrack {g_{\mathit{\text{αβ}}}(r{) - 1}} \right\rbrack\text{sin}(\mathit{\text{Qr}})\mathit{dr}}}}{}</span></p>
</div><p>(49)</p>
<p>The total S(Q) is computed as a weighted sum similar to the one used for
the total g(r). In the case of the analysis ‘X-ray Static structure
factor’, the Q-dependence of the atomic form factors is taken into
account in this weighted sum.</p>
<p>Again, Soper has provided experimental data (table 4 in <em>ISRN Physical
Chemistry</em>, 279463 (2013), given in file soper13_fx.dat). Here a source
of confusion is that the data can be normalized in different ways (see
Soper’s paper). Using the normalization II in that reference we have
that:</p>
<div class="math">
<p><span class="math">D_{x}{(Q) = \frac{\sum\limits_{\mathit{\alpha\beta}\geq\alpha}{\left( {2 - \delta_{\mathit{\alpha\beta}}} \right)\times c_{\alpha}c_{\beta}f_{\alpha}{(Q)}f_{\beta}{(Q)}\left\lbrack {S_{\mathit{\alpha\beta}}{(Q) - 1}} \right\rbrack}}{\sum\limits_{\alpha}{c_{\alpha}f_{\alpha}^{2}{(Q)}}} = \left\lbrack {S{(Q) - 1}} \right\rbrack}\times\frac{\sum\limits_{\mathit{\alpha\beta}}{c_{\alpha}c_{\beta}f_{\alpha}{(Q)}f_{\beta}{(Q)}}}{\sum\limits_{\alpha}{c_{\alpha}f_{\alpha}^{2}{(Q)}}}\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}50} \right)</span></p>
</div><p>Where S(Q) would be the static structure factor (going to 1 at large Q)
computed by MDANSE. Therefore, even after using MDANSE we should
recalculate the x-ray observable using the atomic factors.</p>
</section>
<section id="current-correlation-function">
<h5>Current Correlation Function<a class="headerlink" href="#current-correlation-function" title="Permalink to this heading"></a></h5>
<p id="theory-and-implementation-5">Theory and implementation</p>
<p>Current correlation function is typically used to study the propagation
of excitations in disordered systems. In MDANSE, its longitudinal and
transverse components are calculated, which are related to density
fluctuations and propagating shear modes respectively. Formalism and
other details can be found in Ref [<a class="reference external" href="#SignetBibliographie_019">19</a>].</p>
<p id="gui-5">GUI</p>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<a class="reference internal image-reference" href="pages/Pictures/100000010000030900000411E077B26494EE5017.png"><img alt="pages/Pictures/100000010000030900000411E077B26494EE5017.png" src="pages/Pictures/100000010000030900000411E077B26494EE5017.png" style="width: 11.883cm; height: 15.921cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Instrument_resolution">instrument resolution</a></p></li>
<li><p><a class="reference external" href="#_Interpolation_order">interpolation order</a></p></li>
<li><p><strong>interpolation mode</strong> (only applicable when interpolation order is
set to something different than ‘no interpolation’)</p></li>
</ul>
<p><em>Format:</em> str</p>
<p><em>Default:</em> automatic</p>
<p><em>Description:</em> the method that will be used to interpolate velocities.
All modes give identical results but differ in speed and memory usage.
The following modes are available:</p>
<ul class="simple">
<li><p><em>one-time in-memory interpolation</em></p></li>
</ul>
<p>In this mode, all velocities are interpolated once, at the beginning,
and stored in memory. This mode is the fastest but requires large
amounts of memory. It is recommended for use with small trajectories.
When used with large trajectories, it is advisable that a computer with
sufficient memory is used.</p>
<ul class="simple">
<li><p><em>repeated interpolation</em></p></li>
</ul>
<p>In this mode, all velocities are interpolated in each loop over
Q-shells. Therefore, it is slower, though less memory is required.
However, the largest memory usage depends on the composition of the
sample; it is most efficient when all elements have equal number of
particles in the sample, and the least when one element has the majority
of particles. Thus, it is advisable that this mode is used with medium
trajectories with even distribution of elements, especially when the
computer has only an HDD. When used with large trajectories, please
ensure that the computer has sufficient memory.</p>
<ul class="simple">
<li><p><em>one-time disk interpolation</em></p></li>
</ul>
<p>In this mode, all velocities are interpolated once, at the beginning,
and stored on disk. This makes it slow but with little memory
requirement. This balance of speed and memory can be further altered by
using the ‘number of preloaded frames’ option. This mode is meant for
when the computer has insufficient memory for the other modes and is
advisable to be used with large trajectories. Further, since disk is
involved, it is advisable that the computer has an SSD, and that the
operating system’s temp folder is on that disk.</p>
<ul class="simple">
<li><p><em>automatic</em></p></li>
</ul>
<p>In this mode, MDANSE selects one of the above modes to be used that
should be best given the hardware. It does this by estimating the memory
requirements and comparing them to the total memory of the computer.</p>
<ul class="simple">
<li><p><strong>number of preloaded frames</strong> (only applicable when ‘interpolation
mode’ is set to ‘one-time disk interpolation)</p></li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 50</p>
<p><em>Description:</em> this option allows for the optimisation of the ‘one-time
disk interpolation’ interpolation mode. It governs the number of frames
for which the velocities are loaded from disk to memory at once. Thus,
if it is set to 1, the interpolated velocities of all particles are
loaded into memory one frame at a time, and if it is 50, 50 frames worth
of interpolated velocities are loaded, and then no loading occurs for
the next 49 frames, after which the next 50 are loaded. This way, the
speed and memory usage can be adjusted; the larger the number, the
faster (though with diminishing returns) but the more memory required.</p>
<p>Please note that this option can be set to a value of -1, which will
cause all the interpolated velocities for all the particles of one
element to be loaded into memory at once. This way, the memory usage is
comparable to the ‘repeated interpolation’ interpolation mode. Further,
when SSD is used, the analysis can be faster than in the ‘repeated
interpolation’ mode.</p>
<ul class="simple">
<li><p><a class="reference external" href="#_A3.4._Q_vectors">q vectors</a></p></li>
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Normalize">normalize</a></p></li>
<li><p><a class="reference external" href="#_Atom_Transmutation_1">atom transmutation</a></p></li>
<li><p><a class="reference external" href="#_Weights">weights</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="dynamic-coherent-structure-factor">
<h5>Dynamic Coherent Structure Factor<a class="headerlink" href="#dynamic-coherent-structure-factor" title="Permalink to this heading"></a></h5>
<p id="theory-and-implementation-6">Theory and implementation</p>
<p>Please refer to <a class="reference external" href="#_Theory_and_background">Scattering Theory and
Background</a> for more details about the
theoretical background related to the dynamic coherent structure factor.
In this analysis, <em>MDANSE</em> proceeds in two steps. First, it computes the
partial and total intermediate coherent scattering function using
equation</p>
<div class="math">
<p><span class="math">40</span></p>
</div><p><a class="reference external" href="#anchor-121">Error: Reference source not found</a>. Then, the partial
and total dynamic coherent structure factors are obtained by performing
the Fourier Transformation, defined in Eq.</p>
<div class="math">
<p><span class="math">33</span></p>
</div><p><a class="reference external" href="#anchor-122">Error: Reference source not found</a>, respectively on
the total and partial intermediate coherent scattering functions.</p>
<p><em>MDANSE</em> computes the coherent intermediate scattering function on a
rectangular grid of equidistantly spaced points along the time-and the
<em>q</em>-axis, respectively:</p>
<p>F</p>
<div class="math">
<p><span class="math">{}_{\text{coh}}\left( {q_{m},k\cdot\Delta t} \right)\doteq{\sum\limits_{{I = 1},J\geq I}^{N_{\mathit{species}}}\sqrt{n_{I}n_{J}\omega_{I,\text{com}}\omega_{I,\text{com}}}}{\overline{\left\langle {\rho_{I}\left( {{-q},0} \right)\rho_{J}\left( {q,k\cdot\Delta t} \right)} \right\rangle}}^{q},</span></p>
</div><div class="math">
<p><span class="math">\begin{matrix}
{{k = 0}\ldots{N_{t} - 1},{m = 0}\ldots{N_{q} - 1.}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}51} \right) \\
\end{matrix}</span></p>
</div><p>where N<sub>t</sub> is the number of time steps in the coordinate time
series, N<sub>q</sub> is a user-defined number of <em>q</em>-shells,
N<sub>species</sub> is the number of selected species, n<sub>I</sub> the
number of atoms of species <em>I</em>, ω<sub>I</sub> the weight for specie <em>I</em>
(see Section ?? for more details) and</p>
<div class="math">
<p><span class="math">\rho_{I}\left( {q,k\cdot\Delta t} \right)</span></p>
</div><p>is the Fourier transformed particle density for specie <em>I</em> defined as,</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\rho_{I}{\left( {q,k\cdot\Delta t} \right) = \sum\limits_{\alpha}^{n_{I}}}\exp\left\lbrack {\mathit{iq}\cdot R_{\alpha}\left( {k\cdot\Delta t} \right)} \right\rbrack.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}52} \right) \\
\end{matrix}</span></p>
</div><p>The symbol</p>
<div class="math">
<p><span class="math">{\overline{...}}^{q}</span></p>
</div><p>in Eq.</p>
<div class="math">
<p><span class="math">51</span></p>
</div><p><a class="reference external" href="#anchor-123">Error: Reference source not found</a> denotes an average
over <em>q</em>-vectors having <em>approximately</em> the same modulus</p>
<div class="math">
<p><span class="math">{q_{m} = {q_{\mathit{\min}} + m}}\cdot\Delta q</span></p>
</div><p>. The particle density must not change if jumps in the particle
trajectories due to periodic boundary conditions occur. In addition, the
<em>average</em> particle density,</p>
<div class="math">
<p><span class="math">N/V</span></p>
</div><p>, must not change. This can be achieved by choosing <em>q</em>-vectors on a
lattice which is reciprocal to the lattice defined by the <em>MD</em> box. Let
<strong>b</strong><sub>1</sub>, <strong>b</strong><sub>2</sub>, <strong>b</strong><sub>3</sub> be the basis vectors
which span the <em>MD</em> cell. Any position vector in the <em>MD</em> cell can be
written as</p>
<div class="math">
<p><span class="math">\begin{matrix}
{{R = x^{'}}{b_{1} + y^{'}}{b_{2} + z^{'}}b_{3},} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}53} \right) \\
\end{matrix}</span></p>
</div><p>with x′, y′, z′ having values between 0 and 1. The primes indicate that
the coordinates are box coordinates. A jump due to periodic boundary
conditions causes x′, y′, z′ to jump by ∓1. The set of dual basis
vectors <strong>b</strong><sup>1</sup>, <strong>b</strong><sup>2</sup>, <strong>b</strong><sup>3</sup> is defined by
the relation</p>
<div class="math">
<p><span class="math">\begin{matrix}
{b_{i}{b^{j} = \delta_{i}^{j}}.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}54} \right) \\
\end{matrix}</span></p>
</div><p>If the q-vectors are now chosen as</p>
<div class="math">
<p><span class="math">\begin{matrix}
{{q = 2}\pi\left( {k{b^{1} + l}{b^{2} + m}b^{3}} \right),} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}55} \right) \\
\end{matrix}</span></p>
</div><p>where <em>k,l,m</em> are integer numbers, jumps in the particle trajectories
produce phase changes of multiples of 2π in the Fourier transformed
particle density, i.e. leave it unchanged. One can define a grid of
<em>q</em>-shells or a grid of <em>q</em>-vectors along a given direction or on a
given plane, giving in addition a <em>tolerance</em> for <em>q</em>. <em>MDANSE</em> looks
then for <em>q</em>-vectors of the form given in Eq.</p>
<div class="math">
<p><span class="math">61</span></p>
</div><p><a class="reference external" href="#anchor-124">Error: Reference source not found</a> whose moduli
deviate within the prescribed tolerance from the equidistant <em>q</em>-grid.
From these <em>q</em>-vectors only a maximum number per grid-point (called
generically <em>q</em>-shell also in the anisotropic case) is kept.</p>
<p>The <em>q</em>-vectors can be generated isotropically, anisotropically or along
user-defined directions. The</p>
<div class="math">
<p><span class="math">\sqrt{\omega_{I}}</span></p>
</div><p>may be negative if they represent normalized coherent scattering
lengths, i.e.</p>
<div class="math">
<p><span class="math">\begin{matrix}
{{\sqrt{\omega_{I}} = \frac{b_{I,\text{coh}}}{\sqrt{\sum\limits_{I = 1}^{N_{\mathit{species}}}{n_{I}b_{I,\text{coh}}^{2}}}}}.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}56} \right) \\
\end{matrix}</span></p>
</div><p>Negative coherent scattering lengths occur in hydrogenous materials
since</p>
<div class="math">
<p><span class="math">b_{\mathit{coh},H}</span></p>
</div><p>Is negative [<a class="reference external" href="#SignetBibliographie_020">20</a>]. The density-density
correlation is computed via the <em>FCA</em> technique described in the section
on <a class="reference external" href="#_Theory_and_implementation">Spatial Density</a>.</p>
<p id="gui-6">GUI</p>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<p><a class="reference internal" href="pages/Pictures/100000010000032200000261D8E9E9FE2C36FF14.png"><img alt="image24" src="pages/Pictures/100000010000032200000261D8E9E9FE2C36FF14.png" style="width: 15.921cm; height: 12.09cm;" /></a> <a class="reference internal" href="pages/Pictures/1000000100000320000000F8750817242922EC77.png"><img alt="image25" src="pages/Pictures/1000000100000320000000F8750817242922EC77.png" style="width: 15.921cm; height: 3.447cm;" /></a></p>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Instrument_resolution">instrument resolution</a></p></li>
<li><p><a class="reference external" href="#_A3.4._Q_vectors">q vectors</a></p></li>
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Atom_Transmutation_1">atom transmutation</a></p></li>
<li><p><a class="reference external" href="#_Weights">weights</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="dynamic-incoherent-structure-factor">
<h5>Dynamic Incoherent Structure Factor<a class="headerlink" href="#dynamic-incoherent-structure-factor" title="Permalink to this heading"></a></h5>
<p id="theory-and-implementation-7">Theory and implementation</p>
<p>Please refer to <a class="reference external" href="#_Q_Vectors">Scattering Theory and Background</a>
section for more details about the theoretical background related to the
dynamic incoherent structure factor. In this analysis, <em>MDANSE</em> proceeds
in two steps. First, it computes the partial and total intermediate
incoherent scattering function F<sub>inc</sub>(<strong>q</strong>, t) using equation</p>
<div class="math">
<p><span class="math">41</span></p>
</div><p><a class="reference external" href="#anchor-129">Error: Reference source not found</a>. Then, the partial
and total dynamic incoherent structure factors are obtained by
performing the Fourier Transformation, defined in Eq.</p>
<div class="math">
<p><span class="math">33</span></p>
</div><p><a class="reference external" href="#anchor-130">Error: Reference source not found</a>, respectively on
the total and partial intermediate incoherent scattering function.</p>
<p><em>MDANSE</em> computes the incoherent intermediate scattering function on a
rectangular grid of equidistantly spaced points along the time-and the
<em>q</em>-axis, respectively:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\text{F}_{\text{inc}}\left( {q_{m},k\cdot\Delta t} \right)\doteq{\sum\limits_{I = 1}^{N_{\mathit{species}}}{n_{I}\omega_{I,\text{inc}}}}\text{F}_{I,\text{inc}}\left( {q_{m},k\cdot\Delta t} \right),{k = 0}\ldots{N_{t} - 1},{m = 0}\ldots{N_{q} - 1.}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}57} \right) \\
\end{matrix}</span></p>
</div><p>where N<sub>t</sub> is the number of time steps in the coordinate time
series, N<sub>q</sub> is a user-defined number of <em>q</em>-shells,
N<sub>species</sub> is the number of selected species, n<sub>I</sub> the
number of atoms of species <em>I</em>, ω<sub>I</sub> the weight for specie <em>I</em>
(see Section ?? for more details) and</p>
<div class="math">
<p><span class="math">F_{I,\text{inc}}\left( {q_{m},k\cdot\Delta t} \right)</span></p>
</div><p>is defined as:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\text{F}_{I,\mathit{inc},\alpha}{\left( {q_{m},k\cdot\Delta t} \right) = \sum\limits_{\alpha = 1}^{n_{I}}}{\overline{\left\langle {\exp\left\lbrack {{-i}q\cdot R_{\alpha}(0)} \right\rbrack\exp\left\lbrack {iq\cdot R_{\alpha}(t)} \right\rbrack} \right\rangle}}^{q}.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}58} \right) \\
\end{matrix}</span></p>
</div><p>The symbol</p>
<div class="math">
<p><span class="math">{\overline{...}}^{q}</span></p>
</div><p>in Eq.</p>
<div class="math">
<p><span class="math">58</span></p>
</div><p><a class="reference external" href="#anchor-131">Error: Reference source not found</a> denotes an average
over <em>q</em>-vectors having <em>approximately</em> the same modulus</p>
<div class="math">
<p><span class="math">{q_{m} = {q_{\mathit{\min}} + m}}\cdot\Delta q</span></p>
</div><p>. The particle density must not change if jumps in the particle
trajectories due to periodic boundary conditions occur. In addition, the
<em>average</em> particle density, N/V, must not change. This can be achieved
by choosing <em>q</em>-vectors on a lattice which is reciprocal to the lattice
defined by the <em>MD</em> box. Let <strong>b</strong><sub>1</sub>, <strong>b</strong><sub>2</sub>,
<strong>b</strong><sub>3</sub> be the basis vectors which span the <em>MD</em> cell. Any
position vector in the <em>MD</em> cell can be written as</p>
<div class="math">
<p><span class="math">\begin{matrix}
{{R = x^{'}}{b_{1} + y^{'}}{b_{2} + z^{'}}b_{3},} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}59} \right) \\
\end{matrix}</span></p>
</div><p>with x′, y′, z′ having values between 0 and 1. The primes indicate that
the coordinates are box coordinates. A jump due to periodic boundary
conditions causes x′, y′, z′ to jump by ∓1. The set of dual basis
vectors <strong>b</strong><sup>1</sup>, <strong>b</strong><sup>2</sup>, <strong>b</strong><sup>3</sup> is defined by
the relation</p>
<div class="math">
<p><span class="math">\begin{matrix}
{b_{i}{b^{j} = \delta_{i}^{j}}.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}60} \right) \\
\end{matrix}</span></p>
</div><p>If the q-vectors are now chosen as</p>
<div class="math">
<p><span class="math">\begin{matrix}
{{q = 2}\pi\left( {k{b^{1} + l}{b^{2} + m}b^{3}} \right),} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}61} \right) \\
\end{matrix}</span></p>
</div><p>where <em>k,l,m</em> are integer numbers, jumps in the particle trajectories
produce phase changes of multiples of 2π in the Fourier transformed
particle density, i.e. leave it unchanged. One can define a grid of
<em>q</em>-shells or a grid of <em>q</em>-vectors along a given direction or on a
given plane, giving in addition a <em>tolerance</em> for <em>q</em>. <em>MDANSE</em> looks
then for <em>q</em>-vectors of the form given in Eq.</p>
<div class="math">
<p><span class="math">61</span></p>
</div><p><a class="reference external" href="#anchor-132">Error: Reference source not found</a> whose moduli
deviate within the prescribed tolerance from the equidistant <em>q</em>-grid.
From these <em>q</em>-vectors only a maximum number per grid-point (called
generically <em>q</em>-shell also in the anisotropic case) is kept.</p>
<p>The <em>q</em>-vectors can be generated isotropically, anisotropically or along
user-defined directions.</p>
<p>The correlation functions defined in</p>
<div class="math">
<p><span class="math">58</span></p>
</div><p><a class="reference external" href="#anchor-133">Error: Reference source not found</a> are computed via
the <em>FCA</em> technique described in <a class="reference external" href="#_Theory_and_implementation">Spatial
Density</a> section. Although the efficient
<em>FCA</em> technique is used to compute the atomic time correlation
functions, the program may consume a considerable amount of CPU-time
since the number of time correlation functions to be computed equals the
number of atoms times the total number of <em>q</em>-vectors. This analysis is
actually one of the most time-consuming among all the analysis available
in <em>MDANSE</em>.</p>
<p id="gui-7">GUI</p>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<p><a class="reference internal" href="pages/Pictures/10000001000003200000020ED42C0286B2E43D23.png"><img alt="image26" src="pages/Pictures/10000001000003200000020ED42C0286B2E43D23.png" style="width: 15.921cm; height: 10.469cm;" /></a> <a class="reference internal" href="pages/Pictures/1000000100000321000001BF1AACC92E311ED8D8.png"><img alt="image27" src="pages/Pictures/1000000100000321000001BF1AACC92E311ED8D8.png" style="width: 15.921cm; height: 8.885cm;" /></a></p>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Instrument_resolution">instrument resolution</a></p></li>
<li><p><a class="reference external" href="#_A3.4._Q_vectors">q vectors</a></p></li>
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Group_coordinates_by">Group coordinates by</a></p></li>
<li><p><a class="reference external" href="#_Atom_Transmutation_1">atom transmutation</a></p></li>
<li><p><a class="reference external" href="#_Project_coordinates">project coordinates</a></p></li>
<li><p><a class="reference external" href="#_Weights">weights</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="elastic-incoherent-structure-factor">
<h5>Elastic Incoherent Structure Factor<a class="headerlink" href="#elastic-incoherent-structure-factor" title="Permalink to this heading"></a></h5>
<p id="theory-and-implementation-8">Theory and implementation</p>
<p>The Elastic Incoherent Structure Factor (<em>EISF</em>) is defined as the limit
of the incoherent intermediate scattering function for infinite time,</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\mathit{EISF}(q)\doteq\lim\limits_{t\rightarrow\infty}\text{F}_{\mathit{inc}}\left( {q,t} \right).} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}62} \right) \\
\end{matrix}</span></p>
</div><p>Using the above definition of the EISF one can decompose the incoherent
intermediate scattering function as follows:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\text{F}_{\text{inc}}{\left( {q,t} \right) = \mathit{EISF}}{(q) + \text{F}_{\text{inc}}^{'}}\left( {q,t} \right),} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}63} \right) \\
\end{matrix}</span></p>
</div><p>where F<sub>inc</sub>’(<strong>q</strong>,t) decays to zero for infinite time. Taking
now the Fourier transform it follows immediately that</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\text{S}_{\text{inc}}{\left( {q,\omega} \right) = \mathit{EISF}}(q)\delta{(\omega) + \text{S}_{\text{inc}}^{'}}\left( {q,\omega} \right).} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}64} \right) \\
\end{matrix}</span></p>
</div><p>The <em>EISF</em> appears as the amplitude of the <em>elastic</em> line in the neutron
scattering spectrum. Elastic scattering is only present for systems in
which the atomic motion is confined in space, as for solids. To
understand which information is contained in the <em>EISF</em> we consider for
simplicity a system where only one sort of atoms is visible to the
neutrons. To a very good approximation this is the case for all systems
containing a large amount of hydrogen atoms, as biological systems.
Incoherent scattering from hydrogen dominates by far all other
contributions. Using the definition of the van Hove self-correlation
function G<sub>s</sub>(r, t) [<a class="reference external" href="#SignetBibliographie_020">20</a>],</p>
<div class="math">
<p><span class="math">\begin{matrix}
{b_{\text{inc}}^{2}G_{s}\left( {r,t} \right)\doteq\frac{1}{2\pi^{3}}{\int d^{3}}q\exp\left\lbrack {{- i}q\cdot r} \right\rbrack\text{F}_{\mathit{inc}}\left( {q,t} \right),} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}65} \right) \\
\end{matrix}</span></p>
</div><p>which can be interpreted as the conditional probability to find a tagged
particle at the position <strong>r</strong> at time t, given it started at <strong>r</strong> = 0,
one can write:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\mathit{EISF}{(q) = b_{\text{inc}}^{2{\int d^{3}}}}r\exp\left\lbrack {\mathit{iq}\cdot r} \right\rbrack G_{s}\left( {r,{t = \infty}} \right).} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}66} \right) \\
\end{matrix}</span></p>
</div><p>The <em>EISF</em> gives the sampling distribution of the points in space in the
limit of infinite time. In a real experiment this means times longer
than the time which is observable with a given instrument. The <em>EISF</em>
vanishes for all systems in which the particles can access an infinite
volume since G<sub>s</sub>(r, t) approaches 1/V for large times. This is
the case for molecules in liquids and gases.</p>
<p>For computational purposes it is convenient to use the following
representation of the <em>EISF</em> [<a class="reference external" href="#SignetBibliographie_021">21</a>]:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\mathit{EISF}{(q) = {\sum\limits_{I = 1}^{N_{\mathit{species}}}{n_{I}\omega_{I,\text{inc}}\mathit{EIS}F_{I}(q)}}}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}67} \right) \\
\end{matrix}</span></p>
</div><p>where N<sub>species</sub> is the number of selected species, n<sub>I</sub>
the number of atoms of species <em>I</em>, ω<sub>I,inc</sub> the weight for
specie <em>I</em> (see Section ?? for more details) and for each specie the
following expression for the elastic incoherent scattering function is</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\mathit{EIS}F_{I}{(q) = \frac{1}{n_{I}}}{\sum\limits_{\alpha}^{n_{I}}\left\langle {|{\exp\left\lbrack {\mathit{iq}\cdot R_{\alpha}} \right\rbrack\left. {} \right|^{2}}} \right\rangle}.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}68} \right) \\
\end{matrix}</span></p>
</div><p>This expression is derived from definition</p>
<div class="math">
<p><span class="math">62</span></p>
</div><p><a class="reference external" href="#anchor-138">Error: Reference source not found</a> of the <em>EISF</em> and
expression</p>
<div class="math">
<p><span class="math">41</span></p>
</div><p><a class="reference external" href="#anchor-139">Error: Reference source not found</a> for the
intermediate scattering function, using that for infinite time the
relation</p>
<div class="math">
<p><span class="math">\left\langle {\mathit{ex}p\left\lbrack {{- \mathit{iq}}\cdot R_{\alpha}(0)} \right\rbrack\mathit{ex}p\left\lbrack {\mathit{iq}\cdot R_{\alpha}(t)} \right\rbrack} \right\rangle = \left\langle {|{\mathit{ex}p\left\lbrack {\mathit{iq}\cdot R_{\alpha}} \right\rbrack\left. {} \right|^{2}}} \right\rangle</span></p>
</div><p>holds. In this way the computation of the <em>EISF</em> is reduced to the
computation of a static thermal average. We remark at this point that
the length of the <em>MD</em> trajectory from which the <em>EISF</em> is computed
should be long enough to allow for a representative sampling of the
conformational space.</p>
<p><em>MDANSE</em> allows one to compute the elastic incoherent structure factor
on a grid of equidistantly spaced points along the <em>q</em>-axis:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\mathit{EISF}\left( q_{m} \right)\doteq{\sum\limits_{I = 1}^{N_{\mathit{species}}}{n_{I}\omega_{I}\mathit{EIS}F_{I}\left( q_{m} \right)}},{m = 0}\ldots{N_{q} - 1.}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}69} \right) \\
\end{matrix}</span></p>
</div><p>where N<sub>q</sub> is a user-defined number of <em>q</em>-shells, the values for
q<sub>m</sub> are defined as</p>
<div class="math">
<p><span class="math">{q_{m} = {q_{\mathit{\min}} + m}}\cdot\Delta q</span></p>
</div><p>, and for each specie the following expression for the elastic
incoherent scattering function is:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\mathit{EIS}F_{I}{\left( q_{m} \right) = \frac{1}{n_{I}}}{\sum\limits_{\alpha}^{n_{I}}{\overline{\left\langle {|{\exp\left\lbrack {\mathit{iq}\cdot R_{\alpha}} \right\rbrack\left. {} \right|^{2}}} \right\rangle}}^{q}}.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}70} \right) \\
\end{matrix}</span></p>
</div><p>Here the symbol</p>
<div class="math">
<p><span class="math">{\overline{...}}^{q}</span></p>
</div><p>denotes an average over the <em>q</em>-vectors having the same modulus
q<sub>m</sub>. The program corrects the atomic input trajectories for
jumps due to periodic boundary conditions.</p>
<p id="gui-8">GUI</p>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<p><a class="reference internal" href="pages/Pictures/100000010000031F000001FD2749283C27712371.png"><img alt="image28" src="pages/Pictures/100000010000031F000001FD2749283C27712371.png" style="width: 15.921cm; height: 10.142cm;" /></a><a class="reference internal" href="pages/Pictures/100000010000032000000193F4C1E0DB6DC04C31.png"><img alt="image29" src="pages/Pictures/100000010000032000000193F4C1E0DB6DC04C31.png" style="width: 15.921cm; height: 8.019cm;" /></a></p>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_A3.4._Q_vectors">q vectors</a></p></li>
<li><p><a class="reference external" href="#_Project_coordinates">project coordinates</a></p></li>
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Group_coordinates_by">Group coordinates by</a></p></li>
<li><p><a class="reference external" href="#_Atom_Transmutation_1">atom transmutation</a></p></li>
<li><p><a class="reference external" href="#_Weights">weights</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="gaussian-dynamic-incoherent-structure-factor">
<h5>Gaussian Dynamic Incoherent Structure Factor<a class="headerlink" href="#gaussian-dynamic-incoherent-structure-factor" title="Permalink to this heading"></a></h5>
<p id="theory-and-implementation-9">Theory and implementation</p>
<p>The <em>MSD</em> can be related to the incoherent intermediate scattering
function via the cumulant expansion [<a class="reference external" href="#SignetBibliographie_011">11</a>],
[<a class="reference external" href="#SignetBibliographie_022">22</a>]</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\text{F}_{\text{inc}}^{g}{\left( {q,t} \right) = {\sum\limits_{I = 1}^{N_{\mathit{species}}}{n_{I}\omega_{I,\text{inc}}}}}\text{F}_{I,\text{inc}}^{g}\left( {q,t} \right)} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}71} \right) \\
\end{matrix}</span></p>
</div><p>where N<sub>species</sub> is the number of selected species, n<sub>I</sub>
the number of atoms of species <em>I</em>, ω<sub>I,inc</sub> the weight for
specie <em>I</em> (see Section ?? for more details) and</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\text{F}_{I,\text{inc}}^{g}{\left( {q,t} \right) = \frac{1}{n_{I}}}\sum\limits_{\alpha}^{n_{I}}\exp\left\lbrack {{- q^{2}}\rho_{\alpha,1}{(t) + q^{4}}\rho_{\alpha,2}(t)\mp\ldots} \right\rbrack.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}72} \right) \\
\end{matrix}</span></p>
</div><p>The cumulants</p>
<div class="math">
<p><span class="math">\rho_{\alpha,k}(t)</span></p>
</div><p>are identified as</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\rho_{\alpha,1}{(t) = \left\langle {d_{\alpha}^{2}\left( {t;n_{q}} \right)} \right\rangle}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}73} \right) \\
\end{matrix}</span></p>
</div><div class="math">
<p><span class="math">\begin{matrix}
{\rho_{\alpha,2}{(t) = \frac{1}{4!}}\left\lbrack {{\left\langle {d_{\alpha}^{4}\left( {t;n_{q}} \right)} \right\rangle - 3}\left\langle {d_{\alpha}^{2}\left( {t;n_{q}} \right)} \right\rangle^{2}} \right\rbrack} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}74} \right) \\
\end{matrix}</span></p>
</div><div class="math">
<p><span class="math">\vdots</span></p>
</div><p>The vector nq is the unit vector in the direction of q. In the Gaussian
approximation the above expansion is truncated after the
q<sup>2</sup>-term. For certain model systems like the ideal gas, the
harmonic oscillator, and a particle undergoing Einstein diffusion, this
is exact. For these systems the incoherent intermediate scattering
function is completely determined by the <em>MSD</em>. <em>MDANSE</em> allows one to
compute the total and partial incoherent intermediate scattering
function in the <em>Gaussian approximation</em> by discretizing equation</p>
<div class="math">
<p><span class="math">71</span></p>
</div><p><a class="reference external" href="#anchor-144">Error: Reference source not found</a>:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\text{F}_{\text{inc}}^{g}\left( {q_{m},k\cdot\Delta t} \right)\doteq{\sum\limits_{I = 1}^{N_{\mathit{species}}}{n_{I}\omega_{I,\text{inc}}\text{F}_{I,\text{inc}}^{g}\left( {q_{m},k\cdot\Delta t} \right)}},{k = 0}\ldots{N_{t} - 1},{m = 0}\ldots{N_{q} - 1.}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}75} \right) \\
\end{matrix}</span></p>
</div><p>with for each specie the following expression for the intermediate
scattering function:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\text{F}_{I,\alpha,\text{inc}}^{g}{\left( {q_{m},k\cdot\Delta t} \right) = \frac{1}{n_{I}}}\sum\limits_{\alpha}^{n_{I}}\exp\left\lbrack {\frac{- \left( q_{m} \right)^{2}}{6}\Delta_{\alpha}^{2}\left( {k\cdot\Delta t} \right)} \right\rbrack\mathit{isotropic}\mathit{system}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}76} \right) \\
\end{matrix}</span></p>
</div><div class="math">
<p><span class="math">\begin{matrix}
{\text{F}_{I,\alpha,\text{inc}}^{g}{\left( {q_{m},k\cdot\Delta t} \right) = \frac{1}{n_{I}}}\sum\limits_{\alpha}^{n_{I}}\exp\left\lbrack {\frac{- \left( q_{m} \right)^{2}}{2}\Delta_{\alpha}^{2}\left( {k\cdot\Delta t;n} \right)} \right\rbrack\mathit{isotropic}\mathit{system}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}77} \right) \\
\end{matrix}</span></p>
</div><p>N<sub>t</sub> is the total number of time steps in the coordinate time
series and N<sub>q</sub> is a user-defined number of <em>q</em>-shells. The (q,
t)-grid is the same as for the calculation of the intermediate
incoherent scattering function (see <a class="reference external" href="#_Dynamic_Incoherent_Structure">Dynamic Incoherent Structure
Factor</a>). The quantities</p>
<div class="math">
<p><span class="math">\Delta_{\alpha}^{2}(t)</span></p>
</div><p>and</p>
<div class="math">
<p><span class="math">\Delta_{\alpha}^{2}\left( {t;n} \right)</span></p>
</div><p>are the mean-square displacements, defined in Equations</p>
<div class="math">
<p><span class="math">5</span></p>
</div><p><a class="reference external" href="#anchor-145">Error: Reference source not found</a> and</p>
<div class="math">
<p><span class="math">6</span></p>
</div><p><a class="reference external" href="#anchor-146">Error: Reference source not found</a>, respectively.
They are computed by using the algorithm described in the <a class="reference external" href="#_Theory_and_implementation_2">Mean Square
Displacement</a> section. <em>MDANSE</em>
corrects the atomic input trajectories for jumps due to periodic
boundary conditions. It should be noted that the computation of the
intermediate scattering function in the Gaussian approximation is much
‘cheaper’ than the computation of the full intermediate scattering
function, F<sub>inc</sub>(q, t), since no averaging over different
<em>q</em>-vectors needs to be performed. It is sufficient to compute a single
mean-square displacement per atom.</p>
<p id="gui-9">GUI</p>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<p><a class="reference internal" href="pages/Pictures/1000000100000321000001FE1657294434127D8F.png"><img alt="image30" src="pages/Pictures/1000000100000321000001FE1657294434127D8F.png" style="width: 15.921cm; height: 10.137cm;" /></a> <a class="reference internal" href="pages/Pictures/1000000100000320000001E1A38060C427362263.png"><img alt="image31" src="pages/Pictures/1000000100000320000001E1A38060C427362263.png" style="width: 15.921cm; height: 9.573cm;" /></a></p>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p>q shells</p>
<ul>
<li><p><strong>from</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> &lt;insert&gt;</p>
<ul class="simple">
<li><ul>
<li><p><strong>to</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 10</p>
<p><em>Description:</em> &lt;insert&gt;</p>
<ul class="simple">
<li><ul>
<li><p><strong>by step of</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 1</p>
<p><em>Description:</em> determines the periodicity of which values are used and
which are skipped. 1 means that all values are used, 2 means every other
one is, etc.</p>
<ul class="simple">
<li><p><a class="reference external" href="#_Instrument_resolution">instrument resolution</a></p></li>
<li><p><a class="reference external" href="#_Project_coordinates">project coordinates</a></p></li>
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Group_coordinates_by">Group coordinates by</a></p></li>
<li><p><a class="reference external" href="#_Atom_Transmutation_1">atom transmutation</a></p></li>
<li><p><a class="reference external" href="#_Weights">weights</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="neutron-dynamic-total-structure-factor">
<h5>Neutron Dynamic Total Structure Factor<a class="headerlink" href="#neutron-dynamic-total-structure-factor" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<a class="reference internal image-reference" href="pages/Pictures/1000000100000322000002D4E0AD4E9A3996DE2A.png"><img alt="pages/Pictures/1000000100000322000002D4E0AD4E9A3996DE2A.png" src="pages/Pictures/1000000100000322000002D4E0AD4E9A3996DE2A.png" style="width: 15.921cm; height: 14.372cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Instrument_resolution">instrument resolution</a></p></li>
<li><p><a class="reference external" href="#_A3.4._Q_vectors">q vectors</a></p></li>
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Atom_Transmutation_1">atom transmutation</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="structure-factor-from-scattering-function">
<h5>Structure Factor From Scattering Function<a class="headerlink" href="#structure-factor-from-scattering-function" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p>available for analysis results only</p>
<ul>
<li><p>it appears in all analysis results, even for non-scattering
analyses which cannot be used to compute this</p></li>
</ul>
</li>
</ul>
<a class="reference internal image-reference" href="pages/Pictures/10000001000003220000013C4FCA0D96691C6F5F.png"><img alt="pages/Pictures/10000001000003220000013C4FCA0D96691C6F5F.png" src="pages/Pictures/10000001000003220000013C4FCA0D96691C6F5F.png" style="width: 15.921cm; height: 6.272cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Instrument_resolution">instrument resolution</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
</ul>
</section>
</section>
<section id="structure">
<h4>Structure<a class="headerlink" href="#structure" title="Permalink to this heading"></a></h4>
<p>This section has the following Plugins:</p>
<ul class="simple">
<li><p><a class="reference external" href="#_Area_Per_Molecule">Are Per Molecule</a></p></li>
<li><p><a class="reference external" href="#_Coordination_Number">Coordination Number</a></p></li>
<li><p><a class="reference external" href="#_Density_Profile">Density Profile</a></p></li>
<li><p><a class="reference external" href="#_Eccentricity">Eccentricity</a></p></li>
<li><p><a class="reference external" href="#_Molecular_Trace">Molecular Trace</a></p></li>
<li><p><a class="reference external" href="#_Pair_Distribution_Function">Pair Distribution Function</a></p></li>
<li><p><a class="reference external" href="#_Root_Mean_Square">Root Mean Square Deviation</a></p></li>
<li><p><a class="reference external" href="#_Root_Mean_Square_1">Root Mean Square Fluctuation</a></p></li>
<li><p><a class="reference external" href="#_Radius_Of_Gyration">Radius Of Gyration</a></p></li>
<li><p><a class="reference external" href="#_Solvent_Accessible_Surface">Solvent Accessible Surface</a></p></li>
<li><p><a class="reference external" href="#_Spatial_Density">Spatial Density</a></p></li>
<li><p><a class="reference external" href="#_Static_Structure_Factor">Static Structure Factor</a></p></li>
<li><p><a class="reference external" href="#_Voronoi">Voronoi</a></p></li>
<li><p><a class="reference external" href="#_Xray_Static_Structure">XRay Static Structure Factor</a></p></li>
</ul>
<section id="area-per-molecule">
<h5>Area Per Molecule<a class="headerlink" href="#area-per-molecule" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<a class="reference internal image-reference" href="pages/Pictures/100000010000032500000217C794C16C077B23E0.png"><img alt="pages/Pictures/100000010000032500000217C794C16C077B23E0.png" src="pages/Pictures/100000010000032500000217C794C16C077B23E0.png" style="width: 15.774cm; height: 10.582cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><strong>area vectors</strong></p></li>
</ul>
<p><em>Format:</em> drop-down</p>
<p><em>Default:</em> a, b</p>
<p><em>Description:</em> &lt;insert&gt;</p>
<ul class="simple">
<li><p><strong>molecule name</strong></p></li>
</ul>
<p><em>Format:</em> str</p>
<p><em>Default:</em> DMPC</p>
<p><em>Description:</em> the name of the molecules for which the calculation will
take place. The name inputted here must match a name that MMTK assigned
to inside the NetCDF file.</p>
<ul class="simple">
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="coordination-number">
<h5>Coordination Number<a class="headerlink" href="#coordination-number" title="Permalink to this heading"></a></h5>
<p id="theory-and-implementation-10">Theory and implementation</p>
<p>In chemistry, the Coordination Number (<em>CN</em>) is the total number of
neighbours of a central atom in a molecule or ion. The definition used
in <em>MDANSE</em> is somewhat different and can be seen as an extension of as
the former definition. Indeed, in <em>MDANSE</em>, the <em>CN</em> is not defined over
one defined central atom but around the centres of gravity of a set of
group of atoms. So, if only one group made of only atom is selected for
the analysis, then, the definition is the same as the original
definition. In that context, the <em>CN</em> is defined as:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{n{\left( {r,{r + \mathit{dr}}} \right) = \frac{1}{N_{G}}}{\sum\limits_{g = 1}^{N_{G}}{\sum\limits_{I = 1}^{N_{\mathit{species}}}{n_{\mathit{gI}}\left( {r,{r + \mathit{dr}}} \right)}}}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}78} \right) \\
\end{matrix}</span></p>
</div><p>where NG is the number of groups of atoms, N<sub>species</sub> is the
number of species found in the system and n<sub>gI</sub>(r) is the <em>CN</em>
defined for specie <em>I</em> defined as the number of atoms of species <em>I</em>
found in a shell of width <em>dr</em> at a distance <em>r</em> of the center of
gravity of the group of atom <em>g</em>.</p>
<p><em>MDANSE</em> allows one to compute the <em>CN</em> on a set of equidistantly spaced
distances at different times</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\mathit{CN}\left( r_{m} \right)\doteq\frac{1}{N_{\mathit{frames}}}\frac{1}{N_{G}}{\sum\limits_{f = 1}^{N_{\mathit{frames}}}{\sum\limits_{g = 1}^{N_{G}}{\sum\limits_{I = 1}^{N_{\mathit{species}}}{CN_{\mathit{gI}}\left( {r_{m},t_{f}} \right)}}}},{m = 0}\ldots{N_{r} - 1},{n = 0}\ldots{N_{\mathit{frames}} - 1.}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}79} \right) \\
\end{matrix}</span></p>
</div><p>where N<sub>r</sub> and N<sub>frames</sub> are respectively the number of
distances and times at which the <em>CN</em> is evaluated and</p>
<div class="math">
<p><span class="math">\begin{matrix}
{CN_{\mathit{gI}}{\left( {r_{m},t_{f}} \right) = n_{\mathit{gI}}}\left( {r_{m},t_{f}} \right),} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}80} \right) \\
\end{matrix}</span></p>
</div><p>is the number of atoms of specie <em>I</em> found within [rm, rm + dr] at frame
<em>f</em> from the centre of gravity of group <em>g</em>.</p>
<p>From these expressions, several remarks can be done. Firstly, the Eqs.</p>
<div class="math">
<p><span class="math">79</span></p>
</div><p><a class="reference external" href="#anchor-158">Error: Reference source not found</a> and</p>
<div class="math">
<p><span class="math">80</span></p>
</div><p><a class="reference external" href="#anchor-159">Error: Reference source not found</a> can be restricted
to intramolecular and intermolecular distances only. Secondly, these
equations can be averaged over the selected frames providing a time
averaged intra and intermolecular <em>CN</em>. Finally, the same equations
(time-dependent and time-averaged) can be integrated over r to provide a
cumulative <em>CN</em>. <em>MDANSE</em> computes all these variations.</p>
<p>The concept of <em>CN</em> is useful for structure-related analysis. It can
reveal for instance some packing effects that may have occurred during
the simulation.</p>
<p id="gui-10">GUI</p>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<a class="reference internal image-reference" href="pages/Pictures/100000010000031E000002773364C0C15571A8B0.png"><img alt="pages/Pictures/100000010000031E000002773364C0C15571A8B0.png" src="pages/Pictures/100000010000031E000002773364C0C15571A8B0.png" style="width: 15.921cm; height: 12.589cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p>r values</p>
<ul>
<li><p><strong>from</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> the minimum distance from a central particle in
nanometers taken into consideration. Only particles at that distance or
further will be counted.</p>
<ul class="simple">
<li><ul>
<li><p><strong>to</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 10</p>
<p><em>Description:</em> the maximum distance from a central particle in
nanometers. Only particles up to and including this distance will be
counted.</p>
<ul class="simple">
<li><ul>
<li><p><strong>by step of</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 1</p>
<p><em>Description:</em> the size of the step in nanometers used to generate a
range of values between the above two extremes above. Eg. using the
default r-values, the range will be {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10}.</p>
<ul class="simple">
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Atom_Transmutation_1">atom transmutation</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="density-profile">
<h5>Density Profile<a class="headerlink" href="#density-profile" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<a class="reference internal image-reference" href="pages/Pictures/1000000100000323000002F7066E8CC898B27610.png"><img alt="pages/Pictures/1000000100000323000002F7066E8CC898B27610.png" src="pages/Pictures/1000000100000323000002F7066E8CC898B27610.png" style="width: 15.921cm; height: 15.048cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Atom_Transmutation_1">atom transmutation</a></p></li>
<li><p><strong>axis</strong></p></li>
</ul>
<p><em>Format:</em> drop-down</p>
<p><em>Default:</em> c</p>
<p><em>Description:</em> the simulation box axis that Density Profile will be
calculated along.</p>
<ul class="simple">
<li><p><strong>dr</strong></p></li>
</ul>
<p><em>Format:</em> float</p>
<p><em>Default:</em> 0.01</p>
<p><em>Description:</em> during Density Profile calculation the axis specified in
the <strong>axis</strong> field is divided into a number of bins along its length.
<strong>dr</strong> specifies how large each of these bins will be.</p>
<ul class="simple">
<li><p><a class="reference external" href="#_Weights">weights</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="eccentricity">
<h5>Eccentricity<a class="headerlink" href="#eccentricity" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<a class="reference internal image-reference" href="pages/Pictures/100000010000032200000217EAF4D97A16B24CBA.png"><img alt="pages/Pictures/100000010000032200000217EAF4D97A16B24CBA.png" src="pages/Pictures/100000010000032200000217EAF4D97A16B24CBA.png" style="width: 15.921cm; height: 10.62cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Atom_Transmutation_1">atom transmutation</a></p></li>
<li><p><a class="reference external" href="#_Weights">weights</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
</ul>
</section>
<section id="molecular-trace">
<h5>Molecular Trace<a class="headerlink" href="#molecular-trace" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<a class="reference internal image-reference" href="pages/Pictures/100000010000032200000221CA1B5E3FC473217D.png"><img alt="pages/Pictures/100000010000032200000221CA1B5E3FC473217D.png" src="pages/Pictures/100000010000032200000221CA1B5E3FC473217D.png" style="width: 15.921cm; height: 10.82cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><strong>spatial resolution</strong></p></li>
</ul>
<p><em>Format:</em> float</p>
<p><em>Default:</em> 0.1</p>
<p><em>Description:</em> the resolution with which Molecular Trace is calculated.
It is used to determine how many grid points are used to represent a
unit of length.</p>
<ul class="simple">
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="pair-distribution-function">
<h5>Pair Distribution Function<a class="headerlink" href="#pair-distribution-function" title="Permalink to this heading"></a></h5>
<p id="theory-and-implementation-11">Theory and implementation</p>
<p>The Pair Distribution Function (<em>PDF</em>) is an example of a pair
correlation function, which describes how, on average, the atoms in a
system are radially packed around each other. This proves to be a
particularly effective way of describing the average structure of
disordered molecular systems such as liquids. Also in systems like
liquids, where there is continual movement of the atoms and a single
snapshot of the system shows only the instantaneous disorder, it is
extremely useful to be able to deal with the average structure.</p>
<p>The <em>PDF</em> is useful in other ways. For example, it is something that can
be deduced experimentally from x-ray or neutron diffraction studies,
thus providing a direct comparison between experiment and simulation. It
can also be used in conjunction with the interatomic pair potential
function to calculate the internal energy of the system, usually quite
accurately.</p>
<p>Mathematically, the <em>PDF</em> can be computed using the following formula:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\mathit{PDF}{(r) = {\sum\limits_{{I = 1},J\geq I}^{N_{\mathit{species}}}n_{I}}}n_{J}\omega_{I}\omega_{J}g_{\mathit{IJ}}(r)} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}81} \right) \\
\end{matrix}</span></p>
</div><p>where N<sub>species</sub> is the number of selected species, n<sub>I</sub>
and n<sub>J</sub> are respectively the numbers of atoms of species <em>I</em> and
<em>J</em>, ω<sub>I</sub> and ω<sub>J</sub> respectively the weights for species
<em>I</em> and <em>J</em> (see Section ?? for more details) and</p>
<div class="math">
<p><span class="math">\mathit{PD}F_{\mathit{\alpha\beta}}(r)</span></p>
</div><p>is the partial <em>PDF</em> for I and J species that can be defined as:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\mathit{PD}F_{\mathit{IJ}}{(r) = \frac{\left\langle {\sum\limits_{\alpha = 1}^{n_{I}}{n_{\alpha J}(r)}} \right\rangle}{n_{I}\rho_{J}4\pi r^{2}\mathit{dr}}}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}82} \right) \\
\end{matrix}</span></p>
</div><p>where ρ<sub>J</sub> is the density of atom of specie <em>J</em> and</p>
<div class="math">
<p><span class="math">n_{\alpha J}(r)</span></p>
</div><p>is the mean number of atoms of specie <em>J</em> in a shell of width <em>dr</em> at
distance <em>r</em> of the atom α of specie <em>I</em>.</p>
<p>From the computation of PDF, two related quantities are also calculated;
the Radial Distribution Function (RDF), defined as</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\mathit{RDF}{(r) = 4}\pi r^{2}\rho_{0}\mathit{PDF}(r),} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}83} \right) \\
\end{matrix}</span></p>
</div><p>and the Total Correlation Function (TCF), defined as</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\mathit{TCF}{(r) = 4}\pi r\rho_{0}\left( {\mathit{PDF}{(r) - 1}} \right),} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}83} \right) \\
\end{matrix}</span></p>
</div><p>where ρ<sub>0</sub> is the average atomic density, which is defined as</p>
<div class="math">
<p><span class="math">\begin{matrix}
{{\rho_{0} = \frac{N}{V}},} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}83} \right) \\
\end{matrix}</span></p>
</div><p>where N is the total number of atoms in the system and V the volume of
the simulation.</p>
<p>All these quantities are initially calculated as intramolecular and
intermolecular parts for each pair of atoms, which are then added to
create the total PDF/RDF/TCF for each pair of atoms, as well as the
total intramolecular and total intermolecular values. Lastly, the total
functions are computed. Please note, however, that in the case of TCF,
the below set of equations has been chosen, which will return results
that differ from those of nMOLDYN.</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\mathit{TCF}_{\mathit{intramolecular}}{(r) = 4}\pi r\rho_{0}\mathit{PDF}_{\mathit{intramolecular}}(r),} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}83} \right) \\
\end{matrix}</span></p>
</div><div class="math">
<p><span class="math">\begin{matrix}
{\mathit{TCF}_{\mathit{intermolecular}}{(r) = 4}\pi r\rho_{0}\left( {\mathit{PDF}_{\mathit{intermolecular}}{(r) - 1}} \right),} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}83} \right) \\
\end{matrix}</span></p>
</div><div class="math">
<p><span class="math">\begin{matrix}
{\mathit{TCF}_{\mathit{total}}{(r) = 4}\pi r\rho_{0}\left( {\mathit{PDF}_{\mathit{total}}{(r) - 1}} \right),} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}83} \right) \\
\end{matrix}</span></p>
</div><p id="gui-11">GUI</p>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<a class="reference internal image-reference" href="pages/Pictures/1000000100000321000002AF539D7E98B51D2ABC.png"><img alt="pages/Pictures/1000000100000321000002AF539D7E98B51D2ABC.png" src="pages/Pictures/1000000100000321000002AF539D7E98B51D2ABC.png" style="width: 15.921cm; height: 13.656cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p>r values</p>
<ul>
<li><p><strong>from</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> the minimum distance from a central particle in
nanometers taken into consideration. Only particles at that distance or
further will be counted.</p>
<ul class="simple">
<li><ul>
<li><p><strong>to</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 10</p>
<p><em>Description:</em> the maximum distance from a central particle in
nanometers. Only particles up to and including this distance will be
counted.</p>
<ul class="simple">
<li><ul>
<li><p><strong>by step of</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 1</p>
<p><em>Description:</em> the size of the step in nanometers used to generate a
range of values between the above two extremes above. Eg. using the
default r-values, the range will be {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10}.</p>
<ul class="simple">
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Atom_Transmutation_1">atom transmutation</a></p></li>
<li><p><a class="reference external" href="#_Weights">weights</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="root-mean-square-deviation">
<h5>Root Mean Square Deviation<a class="headerlink" href="#root-mean-square-deviation" title="Permalink to this heading"></a></h5>
<p id="theory-and-implementation-12">Theory and implementation</p>
<p>The Root Mean-Square Deviation (<em>RMSD</em>) is maybe the most popular
estimator of structural similarity. It is a numerical measure of the
difference between two structures that can be defined as:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\mathit{RMSD}{(t) = \sqrt{\frac{\sum\limits_{\alpha = 1}^{N_{\alpha}}\left( {r_{\alpha}{(t) - r_{\alpha}}\left( t_{\mathit{ref}} \right)} \right)}{N_{\alpha}}}}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}85} \right) \\
\end{matrix}</span></p>
</div><p>where N_ is the number of atoms of the system, and r_(t) and r_(tref )
are respectively the position of atom α at time t and tref where tref is
a reference time usually chosen as the first step of the simulation.
Typically, <em>RMSD</em> is used to quantify the structural evolution of the
system during the simulation. It can provide precious information about
the system especially if it reached equilibrium or conversely if major
structural changes occurred during the simulation.</p>
<p>In Molecular Dynamics Analysis for Neutron Scattering Experiments
(<em>MDANSE</em>), <em>RMSD</em> is computed using the discretized version of equation</p>
<div class="math">
<p><span class="math">83</span></p>
</div><p><a class="reference external" href="#anchor-174">Error: Reference source not found</a>:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\mathit{RMSD}{\left( {n\cdot\Delta t} \right) = \sqrt{\frac{\sum\limits_{\alpha = 1}^{N_{\alpha}}\left( {r_{\alpha}{(t) - r_{\mathit{ref}}}(t)} \right)}{N_{\alpha}}}},{n = 0}\ldots{N_{t} - 1}.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}86} \right) \\
\end{matrix}</span></p>
</div><p>where Nt is the number of frames and</p>
<div class="math">
<p><span class="math">\mathrm{\Delta}t</span></p>
</div><p>is the time step.</p>
<p id="gui-12">GUI</p>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<a class="reference internal image-reference" href="pages/Pictures/1000000100000320000002F9EA9ADCD8260F39E8.png"><img alt="pages/Pictures/1000000100000320000002F9EA9ADCD8260F39E8.png" src="pages/Pictures/1000000100000320000002F9EA9ADCD8260F39E8.png" style="width: 15.921cm; height: 15.145cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><strong>reference frame</strong></p></li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> the number of the frame which will be used as reference
for the calculation. The deviation will be calculated as how it deviates
from the values in this frame.</p>
<ul class="simple">
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Group_coordinates_by">Group coordinates by</a></p></li>
<li><p><a class="reference external" href="#_Atom_Transmutation_1">atom transmutation</a></p></li>
<li><p><a class="reference external" href="#_Weights">weights</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="root-mean-square-fluctuation">
<h5>Root Mean Square Fluctuation<a class="headerlink" href="#root-mean-square-fluctuation" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<a class="reference internal image-reference" href="pages/Pictures/100000010000031E0000021D3A0201B22A02F0F8.png"><img alt="pages/Pictures/100000010000031E0000021D3A0201B22A02F0F8.png" src="pages/Pictures/100000010000031E0000021D3A0201B22A02F0F8.png" style="width: 15.921cm; height: 10.793cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Group_coordinates_by">Group coordinates by</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="radius-of-gyration">
<h5>Radius Of Gyration<a class="headerlink" href="#radius-of-gyration" title="Permalink to this heading"></a></h5>
<p id="theory-and-implementation-13">Theory and implementation</p>
<p>Radius Of Gyration (<em>ROG</em>) is the name of several related measures of
the size of an object, a surface, or an ensemble of points. It is
calculated as the Root Mean Square Distance between the system and a
reference that can be either the centre of gravity of the system either
a given axis. In <em>MDANSE</em>, the reference is chosen to be the centre of
gravity of the system under study. Mathematically, it can be defined as:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\mathit{ROG}{(t) = \sqrt{\frac{\sum\limits_{\alpha = 1}^{N_{\alpha}}\left( {r_{\alpha}{(t) - r_{\mathit{cms}}}(t)} \right)}{N_{\alpha}}}}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}87} \right) \\
\end{matrix}</span></p>
</div><p>where</p>
<div class="math">
<p><span class="math">N_{\alpha}</span></p>
</div><p>is the number of atoms of the system, and r<sub>α</sub>(t) and
r<sub>cms</sub>(t) are respectively the position of atom α and the
centre of mass of the system at time t.</p>
<p><em>ROG</em> describes the overall spread of the molecule and as such is a good
measure for the molecule compactness. For example, it can be useful when
monitoring folding process.</p>
<p>In <em>MDANSE</em>, <em>ROG</em> is computed using the discretized version of equation</p>
<div class="math">
<p><span class="math">85</span></p>
</div><p><a class="reference external" href="#anchor-181">Error: Reference source not found</a>:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\mathit{ROG}{\left( {n\cdot\Delta t} \right) = \sqrt{\frac{\sum\limits_{\alpha = 1}^{N_{\alpha}}\left( {r_{\alpha}{(t) - r_{\mathit{cms}}}(t)} \right)}{N_{\alpha}}}},{n = 0}\ldots{N_{t} - 1.}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}88} \right) \\
\end{matrix}</span></p>
</div><p>where N<sub>t</sub> is the number of frames and Δt is the time step.</p>
<p id="gui-13">GUI</p>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<a class="reference internal image-reference" href="pages/Pictures/10000001000003210000021F447FD4560DD7995B.png"><img alt="pages/Pictures/10000001000003210000021F447FD4560DD7995B.png" src="pages/Pictures/10000001000003210000021F447FD4560DD7995B.png" style="width: 15.921cm; height: 10.793cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Weights">weights</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="solvent-accessible-surface">
<h5>Solvent Accessible Surface<a class="headerlink" href="#solvent-accessible-surface" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<a class="reference internal image-reference" href="pages/Pictures/1000000100000326000002790EB025922D724131.png"><img alt="pages/Pictures/1000000100000326000002790EB025922D724131.png" src="pages/Pictures/1000000100000326000002790EB025922D724131.png" style="width: 15.921cm; height: 12.504cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><strong>n sphere points</strong></p></li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 1000</p>
<p><em>Description:</em> Solvent Accessible Surface calculation involves the
creation of a mesh of points equidistant form each atom or molecule.
This field determines how many of these points should be created.</p>
<ul class="simple">
<li><p><strong>probe radius</strong></p></li>
</ul>
<p><em>Format:</em> float</p>
<p><em>Default:</em> 0.14</p>
<p><em>Description:</em> (in nanometers) affects the observed surface area.
Smaller probe radius detects more detail and therefore reports larger
surface area. The default value is approximately equal to the radius of
a water molecule.</p>
<ul class="simple">
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="spatial-density">
<h5>Spatial Density<a class="headerlink" href="#spatial-density" title="Permalink to this heading"></a></h5>
<p id="theory-and-implementation-14">Theory and implementation</p>
<p>The Spatial Density (<em>SD</em>) can be seen as a generalization of the pair
distribution function. Indeed, pair distribution functions are defined
as orientationally averaged distribution functions. Although these
correlation functions reflect many key features of the short-range order
in molecular systems, it should be realized that an average spatial
assembly of non-spherical particles cannot be uniquely characterized
from these one-dimensional functions. So, structural models postulated
for the molecular ordering in non-simple systems based only on
one-dimensional <em>PDF</em> will always be somewhat ambiguous. The goal of
<em>SD</em> analysis is to provide greater clarity in the structural analysis
of molecular systems by utilizing distribution function which span both
the radial and angular coordinates of the separation vector. This can
provide useful information about the average local structure in a
complex system.</p>
<p><em>MDANSE</em> allows one to compute the <em>SD</em> in spherical coordinates on a
set of concentric shells surrounding the centres of mass of selected
triplets of atoms using the formula:</p>
<div class="math">
<p><span class="math">\mathit{SD}\left( {r_{l},\theta_{m},\phi_{n}} \right)\doteq\frac{1}{N_{\mathit{triplets}N_{\mathit{groups}}}}{\sum\limits_{t = 1}^{N_{\mathit{triplets}}}{\sum\limits_{g = 1}^{N_{\mathit{groups}}}\left\langle {n_{\mathit{tg}}\left( {r_{l},\theta_{m},\phi_{n}} \right)} \right\rangle}},</span></p>
</div><div class="math">
<p><span class="math">\begin{matrix}
{{l = 0}\ldots{N_{r} - 1},{m = 0}\ldots{N_{\theta} - 1},{n = 0}\ldots{N_{\phi} - 1.}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}89} \right) \\
\end{matrix}</span></p>
</div><p>where N<sub>triplets</sub> and N<sub>groups</sub> are respectively the
number of triplets and groups, r<sub>l</sub>, θ<sub>m</sub> and φ<sub>n</sub>
are the spherical coordinates at which the <em>SD</em> is evaluated,
N<sub>r</sub>,</p>
<div class="math">
<p><span class="math">N_{\theta}</span></p>
</div><p>and</p>
<div class="math">
<p><span class="math">N_{\phi}</span></p>
</div><p>are respectively the number of discrete <em>r</em>, θ and φ values and
n<sub>tg</sub>(r<sub>l</sub>, θ<sub>m</sub>, φ<sub>n</sub>) is the number of
group of atoms of type <em>g</em> whose centres of mass is found to be in the
volume element defined by [r, r + dr], [θ, θ + dθ] and [φ, φ + dφ] in
the spherical coordinates basis cantered on the centre of mass of
triplet <em>t</em>. So technically, <em>MDANSE</em> proceeds more or less in the
following way:</p>
<ul>
<li><p>defines the centre of mass</p>
<div class="math">
<p><span class="math">c_{i}^{t}{i = 1},2\ldots N_{\mathit{triplets}}</span></p>
</div><p>for each triplet of atoms,</p>
</li>
<li><p>defines the centre of mass</p>
<div class="math">
<p><span class="math">c_{i}^{g}{i = 1},2\ldots N_{\mathit{groups}}</span></p>
</div><p>for each group of atoms,</p>
</li>
<li><p>constructs an oriented orthonormal basis</p>
<div class="math">
<p><span class="math">R_{i}^{t}{i = 1},2\ldots N_{\mathit{triplets}}</span></p>
</div><p>cantered on each c<sup>t</sup>, this basis is defined from the three
vectors <strong>v1</strong>, <strong>v2</strong>, <strong>v3</strong>,</p>
<ul>
<li><div class="math">
<p><span class="math">v_{1} = \frac{n_{1} + n_{2}}{\left| \left| {n_{1} + n_{2}} \right| \right|}</span></p>
</div><p>where <strong>n1</strong> and <strong>n2</strong> are respectively the normalized vectors
in (<strong>a1</strong>,<strong>a2</strong>) and (<strong>a1</strong>,<strong>a3</strong>) directions where
(<strong>a1</strong>,<strong>a2</strong>,<strong>a3</strong>) are the three atoms of the triplet <em>t</em>,</p>
</li>
<li><p>v<sub>2</sub> is defined as the clockwise normal vector orthogonal
to v1 that belongs to the plane defined by <strong>a1</strong>, <strong>a2</strong> and
<strong>a3</strong> atoms,</p></li>
<li><div class="math">
<p><span class="math">{\overrightarrow{v_{3}} = \overrightarrow{v_{1}}}\times\overrightarrow{v_{2}}</span></p>
</div></li>
</ul>
</li>
<li><p>expresses the cartesian coordinates of each c<sup>g</sup> in each
R<sup>t</sup>,</p></li>
<li><p>transforms these coordinates in spherical coordinates,</p></li>
<li><p>discretizes the spherical coordinates in r<sub>l</sub>, θ<sub>m</sub> and
φ<sub>n</sub>,</p></li>
<li><p>does</p>
<div class="math">
<p><span class="math">n_{\mathit{tg}}{\left( {r_{l},\theta_{m},\phi_{n}} \right) = n_{\mathit{tg}}}{\left( {r_{l},\theta_{m},\phi_{n}} \right) + 1}</span></p>
</div></li>
</ul>
<p id="gui-14">GUI</p>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<a class="reference internal image-reference" href="pages/Pictures/10000001000003200000027836715F0544BCA168.png"><img alt="pages/Pictures/10000001000003200000027836715F0544BCA168.png" src="pages/Pictures/10000001000003200000027836715F0544BCA168.png" style="width: 15.921cm; height: 12.578cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><strong>spatial resolution</strong></p></li>
</ul>
<p><em>Format:</em> float</p>
<p><em>Default:</em> 0.1</p>
<p><em>Description:</em> the resolution with which Spatial Density is calculated.
It is used to determine how many grid points are used to represent a
unit of length.</p>
<ul class="simple">
<li><p><strong>reference basis</strong></p></li>
</ul>
<p><em>Format:</em> drop-down</p>
<p><em>Default:</em> None</p>
<p><em>Description:</em> can be used exactly like <a class="reference external" href="#_Axis_Selection_1">Axis
Selection</a>. &lt;insert&gt; what it does</p>
<ul class="simple">
<li><p><strong>target molecule</strong></p></li>
</ul>
<p><em>Format:</em> drop-down</p>
<p><em>Default:</em> None</p>
<p><em>Description:</em> can be used exactly an Atom Selection. Allows for a
subset of particles to be selected on which the analysis will be
performed. More information in <a class="reference external" href="#_Atom_Selection_1">Atom Selection</a>.</p>
<ul class="simple">
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="static-structure-factor">
<h5>Static Structure Factor<a class="headerlink" href="#static-structure-factor" title="Permalink to this heading"></a></h5>
<p id="theory-and-implementation-15">Theory and implementation</p>
<p>This analysis is a shortcut to obtain the static coherent structure
factor defined as S(q) = F<sub>coh</sub>(q, t = 0). It uses exactly the
same procedure as the one defined in the <a class="reference external" href="#_Theory_and_implementation_3">Dynamic Coherent Structure
Factor</a> section.</p>
<p id="gui-15">GUI</p>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<a class="reference internal image-reference" href="pages/Pictures/1000000100000320000002FC939CE5AA59D4D2C7.png"><img alt="pages/Pictures/1000000100000320000002FC939CE5AA59D4D2C7.png" src="pages/Pictures/1000000100000320000002FC939CE5AA59D4D2C7.png" style="width: 15.921cm; height: 15.205cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p>r values</p>
<ul>
<li><p><strong>from</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> the minimum distance from a central particle in
nanometers taken into consideration. Only particles at that distance or
further will be counted.</p>
<ul class="simple">
<li><ul>
<li><p><strong>to</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 10</p>
<p><em>Description:</em> the maximum distance from a central particle in
nanometers. Only particles up to and including this distance will be
counted.</p>
<ul class="simple">
<li><ul>
<li><p><strong>by step of</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 1</p>
<p><em>Description:</em> the size of the step in nanometers used to generate a
range of values between the above two extremes above. Eg. using the
default r-values, the range will be {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10}.</p>
<ul class="simple">
<li><p>q values</p>
<ul>
<li><p><strong>from</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> the minimum value used to generate the range of q values.</p>
<ul class="simple">
<li><ul>
<li><p><strong>to</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 10</p>
<p><em>Description:</em> the maximum value used to generate the range of q values.</p>
<ul class="simple">
<li><ul>
<li><p><strong>by step of</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 1</p>
<p><em>Description:</em> the step size value used to generate the range of q
values.</p>
<ul class="simple">
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Atom_Transmutation_1">atom transmutation</a></p></li>
<li><p><a class="reference external" href="#_Weights">weights</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="voronoi">
<h5>Voronoi<a class="headerlink" href="#voronoi" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<a class="reference internal image-reference" href="pages/Pictures/1000000100000321000001B102EE53DCF2A6701F.png"><img alt="pages/Pictures/1000000100000321000001B102EE53DCF2A6701F.png" src="pages/Pictures/1000000100000321000001B102EE53DCF2A6701F.png" style="width: 15.921cm; height: 8.606cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><strong>apply periodic_boundary_condition</strong></p></li>
</ul>
<p><em>Format:</em> bool</p>
<p><em>Default:</em> True</p>
<p><em>Description:</em> determines if the periodic boundary conditions is applied
to the Voronoi cell.</p>
<ul class="simple">
<li><p><strong>pbc border size</strong></p></li>
</ul>
<p><em>Format:</em> float</p>
<p><em>Default:</em> 0.0</p>
<p><em>Description:</em> &lt;insert&gt;</p>
<ul class="simple">
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="xray-static-structure-factor">
<h5>Xray Static Structure Factor<a class="headerlink" href="#xray-static-structure-factor" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<a class="reference internal image-reference" href="pages/Pictures/1000000100000321000002B4804828B2E2D13E48.png"><img alt="pages/Pictures/1000000100000321000002B4804828B2E2D13E48.png" src="pages/Pictures/1000000100000321000002B4804828B2E2D13E48.png" style="width: 15.921cm; height: 13.755cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p>r values</p>
<ul>
<li><p><strong>from</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> the minimum distance from a central particle in
nanometers taken into consideration. Only particles at that distance or
further will be counted.</p>
<ul class="simple">
<li><ul>
<li><p><strong>to</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 10</p>
<p><em>Description:</em> the maximum distance from a central particle in
nanometers. Only particles up to and including this distance will be
counted.</p>
<ul class="simple">
<li><ul>
<li><p><strong>by step of</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 1</p>
<p><em>Description:</em> the size of the step in nanometers used to generate a
range of values between the above two extremes above. Eg. using the
default r-values, the range will be {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10}.</p>
<ul class="simple">
<li><p>q values</p>
<ul>
<li><p><strong>from</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> the minimum value used to generate the range of q values.</p>
<ul class="simple">
<li><ul>
<li><p><strong>to</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 10</p>
<p><em>Description:</em> the maximum value used to generate the range of q values.</p>
<ul class="simple">
<li><ul>
<li><p><strong>by step of</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 1</p>
<p><em>Description:</em> the step size value used to generate the range of q
values.</p>
<ul class="simple">
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Atom_Transmutation_1">atom transmutation</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
</section>
<section id="thermodynamics">
<h4>Thermodynamics<a class="headerlink" href="#thermodynamics" title="Permalink to this heading"></a></h4>
<p>This section contains the following Plugins:</p>
<ul class="simple">
<li><p><a class="reference external" href="#_Density">Density</a></p></li>
<li><p><a class="reference external" href="#_Temperature">Temperature</a></p></li>
</ul>
<section id="density">
<h5>Density<a class="headerlink" href="#density" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<a class="reference internal image-reference" href="pages/Pictures/1000000100000320000001955616A0F8950ADF86.png"><img alt="pages/Pictures/1000000100000320000001955616A0F8950ADF86.png" src="pages/Pictures/1000000100000320000001955616A0F8950ADF86.png" style="width: 15.921cm; height: 8.059cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="temperature">
<h5>Temperature<a class="headerlink" href="#temperature" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<a class="reference internal image-reference" href="pages/Pictures/10000001000003220000017A08B3789C04716632.png"><img alt="pages/Pictures/10000001000003220000017A08B3789C04716632.png" src="pages/Pictures/10000001000003220000017A08B3789C04716632.png" style="width: 15.921cm; height: 7.504cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Interpolation_order">interpolation order</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
</section>
<section id="trajectory">
<h4>Trajectory<a class="headerlink" href="#trajectory" title="Permalink to this heading"></a></h4>
<p>The Plugins within this section are listed below. They are used to
adjust the trajectory in some way.</p>
<ul class="simple">
<li><p><a class="reference external" href="#_Box_Translated_Trajectory">Box Translated Trajectory</a></p></li>
<li><p><a class="reference external" href="#_Center_Of_Masses">Centre Of Masses Trajectory</a></p></li>
<li><p><a class="reference external" href="#_Cropped_Trajectory">Cropped Trajectory</a></p></li>
<li><p><a class="reference external" href="#_Global_Motion_Filtered">Global Motion Filtered Trajectory</a></p></li>
<li><p><a class="reference external" href="#_Rigid_Body_Trajectory">Rigid Body Trajectory</a></p></li>
<li><p><a class="reference external" href="#_Unfolded_Trajectory">Unfolded Trajectory</a></p></li>
</ul>
<section id="box-translated-trajectory">
<h5>Box Translated Trajectory<a class="headerlink" href="#box-translated-trajectory" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<a class="reference internal image-reference" href="pages/Pictures/100000010000032000000182CFECE57E69B1E015.png"><img alt="pages/Pictures/100000010000032000000182CFECE57E69B1E015.png" src="pages/Pictures/100000010000032000000182CFECE57E69B1E015.png" style="width: 15.921cm; height: 7.682cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="center-of-masses-trajectory">
<h5>Center Of Masses Trajectory<a class="headerlink" href="#center-of-masses-trajectory" title="Permalink to this heading"></a></h5>
<p id="theory-and-implementation-16">Theory and implementation</p>
<p>The Center Of Mass Trajectory (<em>COMT</em>) analysis consists in deriving the
trajectory of the respective centres of mass of a set of groups of
atoms. In order to produce a visualizable trajectory, <em>MDANSE</em> assigns
the centres of mass to pseudo-hydrogen atoms whose mass is equal to the
mass of their associated group. Thus, the produced trajectory can be
reused for other analysis. In that sense, <em>COMT</em> analysis is a practical
way to reduce noticeably the dimensionality of a system.</p>
<p id="gui-16">GUI</p>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<a class="reference internal image-reference" href="pages/Pictures/1000000100000324000001CE931274740DA7326D.png"><img alt="pages/Pictures/1000000100000324000001CE931274740DA7326D.png" src="pages/Pictures/1000000100000324000001CE931274740DA7326D.png" style="width: 15.921cm; height: 9.148cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Group_coordinates_by">Group coordinates by</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="cropped-trajectory">
<h5>Cropped Trajectory<a class="headerlink" href="#cropped-trajectory" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<a class="reference internal image-reference" href="pages/Pictures/100000010000031E00000186B928A6B653B00BF5.png"><img alt="pages/Pictures/100000010000031E00000186B928A6B653B00BF5.png" src="pages/Pictures/100000010000031E00000186B928A6B653B00BF5.png" style="width: 15.921cm; height: 7.781cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="global-motion-filtered-trajectory">
<h5>Global Motion Filtered Trajectory<a class="headerlink" href="#global-motion-filtered-trajectory" title="Permalink to this heading"></a></h5>
<p id="theory-and-implementation-17">Theory and implementation</p>
<p>It is often of interest to separate global motion from internal motion,
both for quantitative analysis and for visualization by animated
display. Obviously, this can be done under the hypothesis that global
and internal motions are decoupled within the length and timescales of
the analysis. <em>MDANSE</em> can create Global Motion Filtered Trajectory
(<em>GMFT</em>) by filtering out global motions (made of the three
translational and rotational degrees of freedom), either on the whole
system or on a user-defined subset, by fitting it to a reference
structure (usually the first frame of the <em>MD</em>). Global motion filtering
uses a straightforward algorithm:</p>
<ul class="simple">
<li><p>for the first frame, find the linear transformation such that the
coordinate origin becomes the centre of mass of the system and its
principal axes of inertia are parallel to the three coordinates axes
(also called principal axes transformation),</p></li>
<li><p>this provides a reference configuration C<sub>ref</sub>,</p></li>
<li><p>for any other frames <em>f</em>, finds and applies the linear transformation
that minimizes the RMS distance between frame <em>f</em> and C<sub>ref</sub>.</p></li>
</ul>
<p>The result is stored in a new trajectory file that contains only
internal motions. This analysis can be useful in case where diffusive
motions are not of interest or simply not accessible to the experiment
(time resolution, powder analysis … ).</p>
<p id="gui-17">GUI</p>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<a class="reference internal image-reference" href="pages/Pictures/1000000100000322000002196544DE20D17020BF.png"><img alt="pages/Pictures/1000000100000322000002196544DE20D17020BF.png" src="pages/Pictures/1000000100000322000002196544DE20D17020BF.png" style="width: 15.921cm; height: 10.661cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><strong>reference basis</strong></p></li>
</ul>
<p><em>Format:</em> drop-down</p>
<p><em>Default:</em> None</p>
<p><em>Description:</em> can be used exactly like <a class="reference external" href="#_Axis_Selection_1">Axis
Selection</a>. &lt;insert&gt; what it does</p>
<ul class="simple">
<li><p><strong>Make the chemical object contiguous</strong></p></li>
</ul>
<p><em>Format:</em> bool</p>
<p><em>Default:</em> False</p>
<p><em>Description:</em> makes the configuration contiguous. This is done via MMTK
universe’s contiguousObjectConfiguration() method.</p>
<ul class="simple">
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="rigid-body-trajectory">
<h5>Rigid Body Trajectory<a class="headerlink" href="#rigid-body-trajectory" title="Permalink to this heading"></a></h5>
<p id="theory-and-implementation-18">Theory and implementation</p>
<p>To analyse the dynamics of complex molecular systems it is often
desirable to consider the overall motion of molecules or molecular
subunits. We will call this motion rigid-body motion in the following.
Rigid-body motions are fully determined by the dynamics of the centroid,
which may be the centre-of-mass, and the dynamics of the angular
coordinates describing the orientation of the rigid body. The angular
coordinates are the appropriate variables to compute angular correlation
functions of molecular systems in space and time. In most cases,
however, these variables are not directly available from <em>MD</em>
simulations since <em>MD</em> algorithms typically work in cartesian
coordinates. Molecules are either treated as flexible, or, if they are
treated as rigid, constraints are taken into account in the framework of
cartesian coordinates [<a class="reference external" href="#SignetBibliographie_023">23</a>]. In <em>MDANSE</em>,
Rigid-Body Trajectory (<em>RBT</em>) can be defined from a <em>MD</em> trajectory by
fitting rigid reference structures, defining a (sub)molecule, to the
corresponding structure in each time frame of the trajectory. Here ‘fit’
means the optimal superposition of the structures in a least-squares
sense. We will describe now how rigid body motions, i.e. global
translations and rotations of molecules or subunits of complex
molecules, can be extracted from a <em>MD</em> trajectory. A more detailed
presentation is given in [<a class="reference external" href="#SignetBibliographie_024">24</a>]. We define
an optimal rigid-body trajectory in the following way: for each time
frame of the trajectory the atomic positions of a rigid reference
structure, defined by the three cartesian components of its centroid
(e.g. the centre of mass) and three angles, are as close as possible to
the atomic positions of the corresponding structure in the <em>MD</em>
configuration. Here ‘as close as possible’ means as close as possible in
a least-squares sense.</p>
<p><strong>Optimal superposition.</strong> We consider a given time frame in which the
atomic positions of a (sub)molecule are given by</p>
<div class="math">
<p><span class="math">x_{\alpha},{\alpha = 1}\ldots N</span></p>
</div><p>. The corresponding positions in the reference structure are denoted as</p>
<div class="math">
<p><span class="math">x_{\alpha}^{(0)},{\alpha = 1}\ldots N</span></p>
</div><p>. For both the given structure and the reference structure we introduce
the yet undetermined centroids X and X<sup>(0)</sup>, respectively, and
define the deviation</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\Delta_{\alpha}\doteq D(q){\left\lbrack {x_{\alpha}^{(0)} - X^{(0)}} \right\rbrack - \left\lbrack {x_{\alpha} - X} \right\rbrack}.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}90} \right) \\
\end{matrix}</span></p>
</div><p>Here <strong>D(q)</strong> is a rotation matrix which depends on also yet
undetermined angular coordinates which we chose to be <em>quaternion
parameters</em>, abbreviated as vector <strong>q</strong> = (q<sub>0</sub>, q<sub>1</sub>,
q<sub>2</sub>, q<sub>3</sub>). The quaternion parameters fulfil the
normalization condition</p>
<div class="math">
<p><span class="math">q・{q = 1}</span></p>
</div><p>[<a class="reference external" href="#SignetBibliographie_025">25</a>]. The target function to be
minimized is now defined as</p>
<div class="math">
<p><span class="math">\begin{matrix}
{m{\left( {q;X,X^{(0)}} \right) = {\sum\limits_{\alpha}{\omega_{\alpha}|\Delta|_{\alpha}^{2}}}}.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}91} \right) \\
\end{matrix}</span></p>
</div><p>where ω<sub>α</sub> are atomic weights (see Section ??). The minimization
with respect to the centroids is decoupled from the minimization with
respect to the quaternion parameters and yields</p>
<div class="math">
<p><span class="math">\begin{matrix}
{{X = {\sum\limits_{\alpha}\omega_{\alpha}}}x_{\alpha},} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}92} \right) \\
\end{matrix}</span></p>
</div><div class="math">
<p><span class="math">\begin{matrix}
{{X^{(0)} = {\sum\limits_{\alpha}\omega_{\alpha}}}x_{\alpha}^{(0)}.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}93} \right) \\
\end{matrix}</span></p>
</div><p>We are now left with a minimization problem for the rotational part
which can be written as</p>
<div class="math">
<p><span class="math">\begin{matrix}
{m{(q) = {\sum\limits_{\alpha}{\omega_{\alpha}\left\lbrack {{D(q)r}_{\alpha}^{(0)} - r_{\alpha}} \right\rbrack^{2}}}\overset{!}{=}\mathit{Min}}.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}94} \right) \\
\end{matrix}</span></p>
</div><p>The relative position vectors</p>
<div class="math">
<p><span class="math">\begin{matrix}
{{r_{\alpha} = {x_{\alpha} - X}},} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}95} \right) \\
\end{matrix}</span></p>
</div><div class="math">
<p><span class="math">\begin{matrix}
{r_{\alpha}^{(0)} = {x_{\alpha}^{(0)} - X^{(0)}}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}96} \right) \\
\end{matrix}</span></p>
</div><p>are fixed and the rotation matrix reads
[<a class="reference external" href="#SignetBibliographie_025">25</a>]</p>
<div class="math">
<p><span class="math">\begin{matrix}
{D{(q) = \begin{pmatrix}
{q_{0}^{2} + q_{1}^{2} - q_{2}^{2} - q_{3}^{2}} &amp; {2\left( {{- q_{0}}{q_{3} + q_{1}}q_{2}} \right)} &amp; {2\left( {q_{0}{q_{2} + q_{1}}q_{3}} \right)} \\
{2\left( {q_{0}{q_{3} + q_{1}}q_{2}} \right)} &amp; {q_{0}^{2} + q_{2}^{2} - q_{1}^{2} - q_{3}^{2}} &amp; {2\left( {{- q_{0}}{q_{1} + q_{2}}q_{3}} \right)} \\
{2\left( {{- q_{0}}{q_{2} + q_{1}}q_{3}} \right)} &amp; {2\left( {q_{0}{q_{1} + q_{2}}q_{3}} \right)} &amp; {q_{0}^{2} + q_{3}^{2} - q_{1}^{2} - q_{2}^{2}} \\
\end{pmatrix}}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}97} \right) \\
\end{matrix}</span></p>
</div><p><strong>Quaternions and rotations.</strong> The rotational minimization problem can
be elegantly solved by using quaternion algebra. Quaternions are
so-called hypercomplex numbers, having a real unit, 1, and three
imaginary units, <strong>I</strong>, <strong>J</strong>, and <strong>K</strong>. Since <strong>IJ</strong> = <strong>K</strong> (cyclic),
quaternion multiplication is not commutative. A possible matrix
representation of an arbitrary quaternion,</p>
<div class="math">
<p><span class="math">\begin{matrix}
{{A = a_{0}}\cdot{1 + a_{1}}\cdot{I + a_{2}}\cdot{J + a_{3}}\cdot K,} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}98} \right) \\
\end{matrix}</span></p>
</div><p>reads</p>
<div class="math">
<p><span class="math">\begin{matrix}
{A = \begin{pmatrix}
a_{0} &amp; {- a_{1}} &amp; {- a_{2}} &amp; {- a_{3}} \\
a_{1} &amp; a_{0} &amp; {- a_{3}} &amp; a_{2} \\
a_{2} &amp; a_{3} &amp; a_{0} &amp; {- a_{1}} \\
a_{3} &amp; {- a_{2}} &amp; a_{1} &amp; a_{0} \\
\end{pmatrix}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}99} \right) \\
\end{matrix}</span></p>
</div><p>The components</p>
<div class="math">
<p><span class="math">a_{\upsilon}</span></p>
</div><p>are real numbers. Similarly, as normal complex numbers allow one to
represent rotations in a plane, quaternions allow one to represent
rotations in space. Consider the quaternion representation of a vector
r, which is given by</p>
<div class="math">
<p><span class="math">\begin{matrix}
{{R = x}\cdot{I + y}\cdot{J + z}\cdot K,} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}100} \right) \\
\end{matrix}</span></p>
</div><p>and perform the operation</p>
<div class="math">
<p><span class="math">\begin{matrix}
{{R^{'} = \mathit{QRQ}^{T}},} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}101} \right) \\
\end{matrix}</span></p>
</div><p>where Q is a normalised quaternion</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\text{|}Q\text{|}^{2}\doteq{{q_{0}^{2} + q_{1}^{2} + q_{2}^{2} + q_{3}^{2}} = \frac{1}{4}}\mathit{tr}\text{\textbackslash\{}Q^{T}Q{\text{\textbackslash\}} = 1.}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}102} \right) \\
\end{matrix}</span></p>
</div><p>The symbol <em>tr</em> stands for ‘trace’. We note that a normalized quaternion
is represented by an <em>orthogonal</em> 4 × 4 matrix. <strong>R′</strong> may then be
written as</p>
<div class="math">
<p><span class="math">\begin{matrix}
{{R^{'} = x^{'}}\cdot{I + y^{'}}\cdot{J + z^{'}}\cdot K,} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}103} \right) \\
\end{matrix}</span></p>
</div><p>where the components x′, y′, z′, abbreviated as r′, are given by</p>
<div class="math">
<p><span class="math">\begin{matrix}
{{r^{'} = D}(q)r.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}104} \right) \\
\end{matrix}</span></p>
</div><p>The matrix <strong>D</strong>(<strong>q</strong>) is the rotation matrix defined in</p>
<div class="math">
<p><span class="math">95</span></p>
</div><p><a class="reference external" href="#anchor-221">Error: Reference source not found</a>.</p>
<p><strong>Solution of the minimization problem</strong>. In quaternion algebra, the
rotational minimization problem may now be phrased as follows:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{m{(q) = {{\sum\limits_{\alpha}{{\omega_{\alpha}\text{|}\mathit{QR}}_{\alpha}^{(0)}Q}^{T}} - R_{\alpha}}}{\text{|}^{2}\overset{!}{=}\mathit{Min}}.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}105} \right) \\
\end{matrix}</span></p>
</div><p>Since the matrix Q representing a normalized quaternion is orthogonal
this may also be written as</p>
<div class="math">
<p><span class="math">\begin{matrix}
{{{m{(q) = {\sum\limits_{\alpha}\omega_{\alpha}}}\text{|}\mathit{QR}}_{\alpha}^{(0)} - R_{\alpha}}Q\text{|}^{2}{.\overset{!}{=}\mathit{Min}}.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}106} \right) \\
\end{matrix}</span></p>
</div><p>This follows from the simple fact that</p>
<div class="math">
<p><span class="math">\text{|}A{\text{|} = \text{|}}\mathit{AQ}\text{|}</span></p>
</div><p>, if Q is normalized. Eq.</p>
<div class="math">
<p><span class="math">104</span></p>
</div><p><a class="reference external" href="#anchor-222">Error: Reference source not found</a> shows that the
target function to be minimized can be written as a simple quadratic
form in the quaternion parameters [<a class="reference external" href="#SignetBibliographie_024">24</a>],</p>
<div class="math">
<p><span class="math">\begin{matrix}
{m{(q) = q}\cdot\mathit{Mq},} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}107} \right) \\
\end{matrix}</span></p>
</div><div class="math">
<p><span class="math">\begin{matrix}
{{M = {\sum\limits_{\alpha}{\omega_{\alpha}M_{\alpha}}}}.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}108} \right) \\
\end{matrix}</span></p>
</div><p>The matrices M_ are positive semi-definite matrices depending on the
positions</p>
<div class="math">
<p><span class="math">r_{\alpha}</span></p>
</div><p>and</p>
<div class="math">
<p><span class="math">r_{\alpha}^{(0)}</span></p>
</div><p>:</p>
<p><a class="reference internal" href="pages/Pictures/1000000000000226000000D8F0CF60C6C4938937.png"><img alt="image32" src="pages/Pictures/1000000000000226000000D8F0CF60C6C4938937.png" style="width: 13.123cm; height: 5.154cm;" /></a></p>
<div class="math">
<p><span class="math">({\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}109})</span></p>
</div><p>The rotational fit is now reduced to the problem of finding the minimum
of a quadratic form with the constraint that the quaternion to be
determined must be normalized. Using the method of Lagrange multipliers
to account for the normalization constraint we have</p>
<div class="math">
<p><span class="math">\begin{matrix}
{m^{'}{\left( {q,\lambda} \right) = q}\cdot{\mathit{Mq} - \lambda}{\left( {q\cdot{q - 1}} \right)\overset{!}{=}\mathit{Min}}.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}110} \right) \\
\end{matrix}</span></p>
</div><p>This leads immediately to the eigenvalue problem</p>
<div class="math">
<p><span class="math">\begin{matrix}
{{\mathit{Mq} = \lambda}q,} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}111} \right) \\
\end{matrix}</span></p>
</div><div class="math">
<p><span class="math">\begin{matrix}
{q\cdot{q = 1.}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}112} \right) \\
\end{matrix}</span></p>
</div><p>Now any normalized eigenvector <strong>q</strong> fulfils the relation</p>
<div class="math">
<p><span class="math">{\lambda = q}\cdot\mathit{Mq}\equiv m(q)</span></p>
</div><p>. Therefore, the eigenvector belonging to the smallest eigenvalue,
λ<sub>min</sub>, is the desired solution. At the same time λ<sub>min</sub>
gives the average error per atom. The result of <em>RBT</em> analysis is stored
in a new trajectory file that contains only <em>RBT</em> motions.</p>
<p id="gui-18">GUI</p>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<a class="reference internal image-reference" href="pages/Pictures/100000010000032200000275B155A2D4E67091F5.png"><img alt="pages/Pictures/100000010000032200000275B155A2D4E67091F5.png" src="pages/Pictures/100000010000032200000275B155A2D4E67091F5.png" style="width: 15.921cm; height: 12.487cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Group_coordinates_by">Group coordinates by</a></p></li>
<li><p><strong>reference</strong></p></li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> the number of the frame that is used as reference.</p>
<ul class="simple">
<li><p><strong>remove translation</strong></p></li>
</ul>
<p><em>Format:</em> bool</p>
<p><em>Default:</em> False</p>
<p><em>Description:</em> &lt;insert&gt;</p>
<ul class="simple">
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="unfolded-trajectory">
<h5>Unfolded Trajectory<a class="headerlink" href="#unfolded-trajectory" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<a class="reference internal image-reference" href="pages/Pictures/100000010000031F0000018EC02857C67CB357DA.png"><img alt="pages/Pictures/100000010000031F0000018EC02857C67CB357DA.png" src="pages/Pictures/100000010000031F0000018EC02857C67CB357DA.png" style="width: 15.921cm; height: 7.93cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
</section>
<section id="virtual-instruments">
<h4>Virtual Instruments<a class="headerlink" href="#virtual-instruments" title="Permalink to this heading"></a></h4>
<section id="mcstas-virtual-instrument">
<h5>McStas Virtual Instrument<a class="headerlink" href="#mcstas-virtual-instrument" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<p><a class="reference internal" href="pages/Pictures/100000010000031F00000203A1B6C4356C211C30.png"><img alt="image33" src="pages/Pictures/100000010000031F00000203A1B6C4356C211C30.png" style="width: 15.921cm; height: 10.262cm;" /></a> <a class="reference internal" href="pages/Pictures/10000001000003220000018769B28972812F81A2.png"><img alt="image34" src="pages/Pictures/10000001000003220000018769B28972812F81A2.png" style="width: 15.921cm; height: 7.761cm;" /></a></p>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><strong>MDANSE Coherent Structure Factor</strong></p></li>
</ul>
<p><em>Format:</em> str</p>
<p><em>Default:</em> ..\..\..\Data\NetCDF\dcsf_prot.nc</p>
<p><em>Description:</em> the path to a calculated Coherent Structure Factor. The
file must be in MMTK NetCDF file and should have been generated with
MDANSE’s Dynamic Coherent Structure Factor analysis &lt;link&gt;.</p>
<ul class="simple">
<li><p><strong>MDANSE Incoherent Structure Factor</strong></p></li>
</ul>
<p><em>Format:</em> str</p>
<p><em>Default:</em> ..\..\..\Data\NetCDF\disf_prot.nc</p>
<p><em>Description:</em> the path to a calculated Incoherent Structure Factor. The
file must be in MMTK NetCDF file and should have been generated with
MDANSE’s Dynamic Incoherent Structure Factor analysis &lt;link&gt;.</p>
<ul class="simple">
<li><p><strong>temperature</strong></p></li>
</ul>
<p><em>Format:</em> strictly positive float</p>
<p><em>Default:</em> 298.0</p>
<p><em>Description:</em> the temperature in Kelvin at which the MD simulation was
performed.</p>
<ul class="simple">
<li><p><strong>trace the 3D view of the simulation</strong></p></li>
</ul>
<p><em>Format:</em> bool</p>
<p><em>Default:</em> False</p>
<p><em>Description:</em> &lt;insert&gt;</p>
<ul class="simple">
<li><p><strong>mcstas instrument</strong></p></li>
</ul>
<p><em>Format:</em> drop-down</p>
<p><em>Default:</em> None</p>
<p><em>Description:</em> &lt;insert&gt;</p>
<ul class="simple">
<li><p>mcstas options</p>
<ul>
<li><p><strong>ncount</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 10000</p>
<p><em>Description:</em> &lt;insert&gt;</p>
<ul class="simple">
<li><ul>
<li><p><strong>dir</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> str</p>
<p><em>Default:</em> None</p>
<p><em>Description:</em> &lt;insert&gt;</p>
<ul class="simple">
<li><p>mcstas parameters – these options become visible once a McStas
instrument has been chosen.</p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
</section>
</section>
<section id="miscellaneous">
<h3>Miscellaneous<a class="headerlink" href="#miscellaneous" title="Permalink to this heading"></a></h3>
<p>This section normally contains only one Plugin, which is present for
both trajectories and analysis results. However, some other Plugins
appear under certain circumstances.</p>
<section id="data-info">
<h4>Data info<a class="headerlink" href="#data-info" title="Permalink to this heading"></a></h4>
<ul class="simple">
<li><p>available for trajectories and analysis results</p></li>
</ul>
<p>This plugin opens a window containing an overview of the data stored in
the selected NetCDF file. For trajectory files, it might look like the
picture below, while it may not be able to read any data from an
analysis result. Generally, the following information should be included
for a trajectory:</p>
<ul class="simple">
<li><p>Location of the trajectory on disk</p></li>
<li><p>Number of time steps</p></li>
<li><p>Universe (the MMTK object)</p></li>
<li><p>Direct cell at the beginning</p></li>
<li><p>Reciprocal cell at the beginning</p></li>
<li><p>List of molecules</p></li>
<li><p>List of variables contained in the trajectory</p></li>
</ul>
<a class="reference internal image-reference" href="pages/Pictures/100000010000025700000277AC41F1013CDDDC3D.png"><img alt="pages/Pictures/100000010000025700000277AC41F1013CDDDC3D.png" src="pages/Pictures/100000010000025700000277AC41F1013CDDDC3D.png" style="width: 11.441cm; height: 12.053cm;" /></a>
</section>
<section id="animation">
<h4>Animation<a class="headerlink" href="#animation" title="Permalink to this heading"></a></h4>
<ul class="simple">
<li><p>available for trajectories only</p></li>
<li><p>appears only when <a class="reference external" href="#_Molecular_Viewer">Molecular Viewer</a> is active</p></li>
</ul>
<p>Once double-clicked, it creates a new bar below Molecular Viewer that
allows you to watch the whole MD simulation.</p>
<a class="reference internal image-reference" href="pages/Pictures/10000001000004540000004B8ED7C35C8B494D1E.png"><img alt="pages/Pictures/10000001000004540000004B8ED7C35C8B494D1E.png" src="pages/Pictures/10000001000004540000004B8ED7C35C8B494D1E.png" style="width: 15.921cm; height: 1.078cm;" /></a>
<ul class="simple">
<li><p><strong>Skip to the beginning</strong> button (leftmost) sets the frame number (15
in the picture above) to 0.</p></li>
<li><p><strong>Play</strong> button starts the simulation at the speed determined by the
rightmost box (95 in the picture above)</p></li>
<li><p><strong>Skip to the end</strong> button (right of Play) sets the frame number to
the last frame in the trajectory.</p></li>
<li><p>The left sliding bar allows you to select any of the frames in the
trajectory. It displays the frame number by altering the Frame number
box to the left of itself.</p></li>
<li><p><strong>Frame number</strong> box allows you to view a frame by typing in its
index. Press enter to view the frame.</p></li>
<li><p>The right sliding bar allows you to alter the speed at which the
simulation is shown. It also shows the speed in the box to the left
of itself.</p></li>
<li><p><strong>Speed</strong> determines how fast the simulation is displayed. The higher
the number, the faster the playback.</p></li>
</ul>
</section>
<section id="density-superposition">
<h4>Density Superposition<a class="headerlink" href="#density-superposition" title="Permalink to this heading"></a></h4>
<ul class="simple">
<li><p>available for trajectories only</p></li>
<li><p>appears only when <a class="reference external" href="#_Molecular_Viewer">Molecular Viewer</a> is active
and you have left-clicked anywhere inside it</p></li>
</ul>
<p>Double-clicking this opens the following window:</p>
<a class="reference internal image-reference" href="pages/Pictures/100000010000011B00000149C792FEA0A3BBF869.png"><img alt="pages/Pictures/100000010000011B00000149C792FEA0A3BBF869.png" src="pages/Pictures/100000010000011B00000149C792FEA0A3BBF869.png" style="width: 6.168cm; height: 7.17cm;" /></a>
<ul class="simple">
<li><p><strong>Select file</strong></p></li>
</ul>
<p><em>Format:</em> drop-down</p>
<p><em>Default:</em> None</p>
<p><em>Description:</em> first, a file has to be found using the <strong>Browse</strong>
button, and then it can be found in the drop-down menu. This file has to
be the result of <a class="reference external" href="#_Molecular_Trace">Molecular Trace</a> analysis.</p>
<ul class="simple">
<li><p><strong>Shape</strong></p></li>
</ul>
<p><em>Format:</em> str</p>
<p><em>Default:</em> loaded from file</p>
<p><em>Description:</em> cannot be edited.</p>
<ul class="simple">
<li><p><strong>Rendering mode</strong></p></li>
</ul>
<p><em>Format:</em> drop-down</p>
<p><em>Default:</em> surface</p>
<p><em>Description:</em> determines the way in which the Density Superposition is
displayed.</p>
<ul class="simple">
<li><p><strong>Opacity level</strong></p></li>
</ul>
<p><em>Format:</em> float between 0 and 1</p>
<p><em>Default:</em> 0.5</p>
<p><em>Description:</em> the opacity/transparency of the Density Superposition.</p>
<ul class="simple">
<li><p><strong>Contour Level</strong></p></li>
</ul>
<p><em>Format:</em> sliding bar</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> determines the level of detail?&lt;insert&gt;</p>
<ul class="simple">
<li><p><strong>Clear</strong> button removes the Density Superposition from <a class="reference external" href="#_Molecular_Viewer">Molecular
Viewer</a>.</p></li>
<li><p><strong>Draw</strong> button add Density Superposition on top of <a class="reference external" href="#_Molecular_Viewer">Molecular
Viewer</a>.</p></li>
</ul>
</section>
<section id="trajectory-viewer">
<h4>Trajectory Viewer<a class="headerlink" href="#trajectory-viewer" title="Permalink to this heading"></a></h4>
<ul class="simple">
<li><p>Available for trajectories only</p></li>
<li><p>appears only when <a class="reference external" href="#_Molecular_Viewer">Molecular Viewer</a> is active</p></li>
</ul>
<p>This plugin was designed to help visualise the variables contained in a
trajectory. It can only plot the 3D trajectory variables, and nothing
else. It does this by separating the chosen 3D variable into its
constituent 1D parts and plotting those. This way, the x, y, or z
component of a chosen variable can be plotted for one atom against time.
Once it is double-clicked, the following window opens:</p>
<a class="reference internal image-reference" href="pages/Pictures/100000010000025700000213FCFF259FE25DE0B6.png"><img alt="pages/Pictures/100000010000025700000213FCFF259FE25DE0B6.png" src="pages/Pictures/100000010000025700000213FCFF259FE25DE0B6.png" style="width: 9.566cm; height: 8.453cm;" /></a>
<p>The plotting is controlled through the panel at the top, which is unique
to the Trajectory Viewer. The plot is visualised immediately after all
three fields are filled. It consists of these parameters:</p>
<ul class="simple">
<li><p><strong>Trajectory</strong></p></li>
</ul>
<p><em>Format</em>: drop-down</p>
<p><em>Default</em>: None</p>
<p><em>Description</em>: the variable that will be plotted. All 3D variables
present in the trajectory are available for plotting, meaning that
configuration (i.e., positions) can always be plotted, and velocities
and gradients if they are present.</p>
<ul class="simple">
<li><p><strong>Atom</strong></p></li>
</ul>
<p><em>Format:</em> positive int</p>
<p><em>Default:</em> 0</p>
<p><em>Description</em>: The atom for which the chosen variable will be plotted.
The number represents the index of the atom in the trajectory. The
arrows next to this box can be used to navigate the atoms one by one. If
a number larger than the number of atoms is inputted, the last atom will
instead be selected.</p>
<ul class="simple">
<li><p><strong>Dimension</strong></p></li>
</ul>
<p><em>Format:</em> drop-down</p>
<p><em>Default:</em> None</p>
<p><em>Description:</em> the spatial component of the selected variable which will
be plotted. For example, the change in position of a specific atom along
the x-axis over time can be plotted. The x, y, and z components of the
‘variable’ vectors are available for plotting.</p>
<p>The menu at the bottom of the plotter is identical to the one used in
<a class="reference external" href="#_Toolbar_1">Line Plotter</a>, and so the description of its function
can be found there. However, there is some difference in that; at the
very bottom of the Trajectory Viewer window are three options which work
differently here:</p>
<ul class="simple">
<li><p><strong>Clear</strong> button removes all the lines from the plot.</p></li>
<li><p><strong>Plot on same figure</strong></p></li>
</ul>
<p><em>Format:</em> Bool</p>
<p><em>Default:</em> False</p>
<p><em>Description:</em> controls the number of lines that can be plotted
simultaneously.</p>
<p>When it’s unticked (i.e., False) only one line can be plotted at a time.
Therefore, when a line is already plotted and any change is made in the
topmost toolbar, the current line is replaced by the new selection.</p>
<p>When it’s ticked (i.e., True), any number of lines can be plotted.
Therefore, when a line is already plotted and any change is made in the
topmost toolbar, a new line is added.</p>
<ul class="simple">
<li><p><strong>Show legend</strong></p></li>
</ul>
<p><em>Format:</em> Bool</p>
<p><em>Default:</em> False</p>
<p><em>Description:</em> Toggles the legend. When False, the legend is hidden.
When True, the legend appears in the location matplotlib determines as
‘best’.</p>
</section>
</section>
<section id="my-jobs">
<h3>My jobs<a class="headerlink" href="#my-jobs" title="Permalink to this heading"></a></h3>
<p>This section only appears if you have used the <a class="reference external" href="#save_analysis_template">Save analysis
template</a> button in the main window’s
toolbar. It contains all the analyses created this way and allows them
to be run.</p>
</section>
<section id="plotter">
<h3>Plotter<a class="headerlink" href="#plotter" title="Permalink to this heading"></a></h3>
<section id="d3d-plotter-1">
<span id="id6"></span><h4>2D/3D Plotter<a class="headerlink" href="#d3d-plotter-1" title="Permalink to this heading"></a></h4>
<ul class="simple">
<li><p>available for analysis results only</p></li>
</ul>
<p>Launches the 2D/3D Plotter inside the current tab of the working panel,
like below. For more information, please see <a class="reference external" href="#_2D/3D_Plotter">2D/3D
Plotter</a>.</p>
<a class="reference internal image-reference" href="pages/Pictures/1000000100000456000001F7F9358DAEDACCE259.png"><img alt="pages/Pictures/1000000100000456000001F7F9358DAEDACCE259.png" src="pages/Pictures/1000000100000456000001F7F9358DAEDACCE259.png" style="width: 15.921cm; height: 7.214cm;" /></a>
</section>
</section>
<section id="user-definition">
<h3>User definition<a class="headerlink" href="#user-definition" title="Permalink to this heading"></a></h3>
<p>This section contains all the
definitions/<a class="reference external" href="#_Creating_selections">selections</a> that have been made
for the selected NetCDF file, serving similar purpose to <a class="reference external" href="#user_definitions_editor">User
definition editor</a>.</p>
</section>
<section id="viewer">
<h3>Viewer<a class="headerlink" href="#viewer" title="Permalink to this heading"></a></h3>
<section id="molecular-viewer">
<h4>Molecular Viewer<a class="headerlink" href="#molecular-viewer" title="Permalink to this heading"></a></h4>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<p>Double-clicking on this option opens the Molecular Viewer plugin inside
the current tab of the <a class="reference external" href="#_Working_panel">Working panel</a>. This shows a
simulated 3D view of the first frame of the trajectory. The Viewer can
be interacted with by dragging the simulation and zooming in/out. It can
be closed using the x button in the top right corner:</p>
<a class="reference internal image-reference" href="pages/Pictures/1000000100000454000001F6A0725729E476539D.png"><img alt="pages/Pictures/1000000100000454000001F6A0725729E476539D.png" src="pages/Pictures/1000000100000454000001F6A0725729E476539D.png" style="width: 15.921cm; height: 7.213cm;" /></a>
<p>Clicking on an atom highlights it and prints out some basic information
about it in the Logger&lt;link&gt;. More options are available by
right-clicking anywhere inside the Molecular Viewer, which brings up the
following menu:</p>
<a class="reference internal image-reference" href="pages/Pictures/10000001000000E30000009A5B85D15F6882D700.png"><img alt="pages/Pictures/10000001000000E30000009A5B85D15F6882D700.png" src="pages/Pictures/10000001000000E30000009A5B85D15F6882D700.png" style="width: 6.008cm; height: 4.075cm;" /></a>
<ul class="simple">
<li><p><strong>Rendering</strong> brings up a menu of rendering options when hovered over
or clicked. These change the way the system is displayed and should
both self-explanatory and familiar from other molecular visualisation
software.</p></li>
<li><p><strong>Show/hide selection box</strong> creates a box around the whole system.
This disables your ability to move and rotate the system, but instead
you can move the faces of the box by dragging the large balls.
Everything inside the box is highlighted and considered selected.</p></li>
</ul>
<a class="reference internal image-reference" href="pages/Pictures/1000000100000456000001F44A4E1623C2FD5291.png"><img alt="pages/Pictures/1000000100000456000001F44A4E1623C2FD5291.png" src="pages/Pictures/1000000100000456000001F44A4E1623C2FD5291.png" style="width: 15.921cm; height: 7.172cm;" /></a>
<ul class="simple">
<li><p><strong>Save selection</strong> opens a window prompting you to enter a selection
name. Once that is done and OK is pressed, the selection will be
saved for the current trajectory using the atoms that have been
selected by either clicking on them or with the selection box above.</p></li>
<li><p><strong>Clear selection</strong> unselects all the selected atoms. It does not
hide the selection box, so interacting with it will once again select
all the atoms inside it.</p></li>
<li><p><strong>Parallel projection</strong> toggles on/off trimetric parallel projection
of the camera. According to Wikipedia
[<a class="reference external" href="#SignetBibliographie_026">26</a>], this means that three axes of
space should appear unequally foreshortened. The scale along each of
the three axes and the angles among them are determined separately as
dictated by the angle of viewing.</p></li>
<li><p><strong>Show/hide bounding box</strong> shows/hides the simulation box within
which the system is bound.</p></li>
</ul>
</section>
</section>
</section>
<section id="jobs">
<h2>Jobs<a class="headerlink" href="#jobs" title="Permalink to this heading"></a></h2>
<p>When an analysis is started by clicking on the Run button, it appears as
a job in this panel, like so:</p>
<a class="reference internal image-reference" href="pages/Pictures/10000001000007800000004AA7F683E25A4E52BB.png"><img alt="pages/Pictures/10000001000007800000004AA7F683E25A4E52BB.png" src="pages/Pictures/10000001000007800000004AA7F683E25A4E52BB.png" style="width: 15.921cm; height: 0.614cm;" /></a>
<ol class="arabic simple">
<li><p><strong>NAME</strong> field shows the unique name MDANSE assigned to the job. It
is also a button which shows the options that were selected for the
analysis:</p></li>
</ol>
<a class="reference internal image-reference" href="pages/Pictures/10000001000002A20000012C4E87306FF6F6DC3C.png"><img alt="pages/Pictures/10000001000002A20000012C4E87306FF6F6DC3C.png" src="pages/Pictures/10000001000002A20000012C4E87306FF6F6DC3C.png" style="width: 8.671cm; height: 3.859cm;" /></a>
<ol class="arabic simple">
<li><p><strong>PID</strong> field shows the process ID assigned by the operating system
to the job process.</p></li>
<li><p><strong>START</strong> field shows the exact date and time when this job was
started.</p></li>
<li><p><strong>ELAPSED</strong> field shows the time elapsed since the start of the job.</p></li>
<li><p><strong>STATE</strong> field shows the state of the job. This can be ‘running’,
indicating that MDANSE is in the process of performing the job,
‘finished’, indicating that the job was completed successfully, and
‘aborted’, indicating that the job failed due to an error. This field
is also a button which shows the traceback to the error that caused
the failure when clicked. This should provide all the information to
either correct your mistake or to inform us of a bug. When <a class="reference external" href="#_Toolbar">reporting
a bug</a>, please copy the entire traceback from here.</p></li>
</ol>
<a class="reference internal image-reference" href="pages/Pictures/100000010000077E00000029ED03FC61583BB04B.png"><img alt="pages/Pictures/100000010000077E00000029ED03FC61583BB04B.png" src="pages/Pictures/100000010000077E00000029ED03FC61583BB04B.png" style="width: 15.921cm; height: 0.34cm;" /></a>
<ol class="arabic simple">
<li><p><strong>PROGRESS</strong> field approximately shows the progress of the job. This
is not perfect, so it is not unusual if it appears to get stuck for a
long time, especially with large files. When that happens, it is
likely that MDANSE is performing a large and computationally
intensive stage. MDANSE performs jobs in four stages: initialisation,
run, combination, and finalisation. Of these, only the run stage is
composed of many steps, after each of which the progress bar is
updated. Of the other stages, any can be very computationally
intensive yet for them the bar is updated only at the beginning and
end of the stage.</p></li>
<li><p><strong>ETA</strong> field shows the estimated time until the completion of the
job. Similar to the progress field, this is not entirely accurate,
but it is a good rough estimate.</p></li>
<li><p><strong>KILL</strong> field contains a button that allows for the cancellation of
the job. This causes the job to be removed from this Jobs panel,
making space, visually, for more job. If the job was running when it
was killed, it will be stopped and no output file will be created.
First though, the button will make a notification prompt to appear,
asking if you are sure you want to kill the job.</p></li>
</ol>
<a class="reference internal image-reference" href="pages/Pictures/100000010000025C000000B1ACE43AF975D440AC.png"><img alt="pages/Pictures/100000010000025C000000B1ACE43AF975D440AC.png" src="pages/Pictures/100000010000025C000000B1ACE43AF975D440AC.png" style="width: 7.666cm; height: 2.245cm;" /></a>
</section>
</section>
<section id="using-mdanse-from-command-line">
<h1>Using MDANSE from command line<a class="headerlink" href="#using-mdanse-from-command-line" title="Permalink to this heading"></a></h1>
<div class="line-block">
<div class="line">In some situations a graphical interface cannot be used for technical
reasons (e.g., text-mode</div>
<div class="line">connection to remote machines or Tk not available) or it is not the
most convenient solution.</div>
<div class="line">This occurs typically when one needs to perform a large number of
similar calculations or when</div>
<div class="line">the subset, deuteration or group selections that are to be used for a
given analysis requires</div>
<div class="line">more flexibility than the MDANSE GUI selection dialogs can offer. For
these situations,</div>
<div class="line">MDANSE provides a command-line interface that reads all input
information from a single</div>
<div class="line">input file.</div>
</div>
<p>Windows, has a dedicated command line which can be run using
MDANSE_command_shell file, which sets some environment variables so
that, in it, MDANSE python is the default python. On other platforms,
you have to use a normal terminal and use MDANSE python by calling its
full path, which should be (if MDANSE is in default installation
location) /Applications/MDANSE.app/Contents/MacOS/python2 on MacOS, and
/usr/local/bin/python on Linux systems. Please only use the
python<strong>2</strong> file on MacOS, the other python file does not have some
environmental variables set up.</p>
<p>These pythons (as discussed in previous paragraph) can then be used to
run MDANSE python scripts like any other python script:</p>
<p>python script.py Windows</p>
<p>path/python2 script.py MacOS</p>
<p>path/python script.py Linux</p>
<p>The python can also be used to install other packages, run short code
(using the -c option), or to activate python REPL.</p>
<p>The last way to use MDANSE from the command line is to use default
MDANSE scripts to interface with select parts of MDANSE GUI. This is
described in a <a class="reference external" href="#_MDANSE_Scripts">this section</a>.</p>
<section id="custom-scripts">
<h2>Custom scripts<a class="headerlink" href="#custom-scripts" title="Permalink to this heading"></a></h2>
<p>It is possible to edit MDANSE scripts or even write new ones from
scratch. To run an analysis using the MDANSE python library, two steps
are necessary; first, set up the parameters that the analysis requires
(equivalent to filling in the fields in the GUI), then running the
analysis (equivalent to clicking the Run button). For both of these, it
is necessary to understand how the analysis’ class works. This can be
done by reading MDANSE documentation, either by clicking the analysis’
Help button or by clicking the <a class="reference external" href="#open_mdanse_api">Open MDANSE API</a>
button on the toolbar. An example script is below.</p>
<hr class="docutils" />
<p># Job parameters #</p>
<hr class="docutils" />
<p>parameters = {}</p>
<p>parameters[‘atom_charges’] = ‘’</p>
<p>parameters[‘atom_selection’] = None</p>
<p>parameters[‘frames’] = (0, 2258, 1)</p>
<p>parameters[‘output_files’] =
(u’C:\\Users\\TACHYON\\Downloads\\output_NaF’, (u’netcdf’,))</p>
<p>parameters[‘running_mode’] = (‘monoprocessor’,)</p>
<p>parameters[‘trajectory’] =
u’C:\\Users\\TACHYON\\Downloads\\NaF.nc’</p>
<hr class="docutils" />
<p># Setup and run the analysis #</p>
<hr class="docutils" />
<p># Create an instance of the class</p>
<p>dacf = REGISTRY[‘job’][‘dacf’]()</p>
<p># Run the analysis</p>
<p>dacf.run(parameters,status=True)</p>
</section>
<section id="mdanse-scripts-1">
<span id="id7"></span><h2>MDANSE Scripts<a class="headerlink" href="#mdanse-scripts-1" title="Permalink to this heading"></a></h2>
<p>When MDANSE is installed, multiple scripts come with it, installed into
the Scripts\ directory on Windows and bin/ directory on Unix systems.
They can be run with python, for example</p>
<p>python mdanse_gui</p>
<p>or by themselves (this mode might be unavailable on Windows):</p>
<p>mdanse_gui</p>
<p>The following scripts come with MDANSE, each of which is described in
the following subsections, though more information about a script can
also be gained by calling the script with -h, e.g.,</p>
<p>python mdanse_gui -h</p>
<ul class="simple">
<li><p>mdanse</p></li>
<li><p>mdanse_elements_database</p></li>
<li><p>mdanse_gui</p></li>
<li><p>mdanse_job</p></li>
<li><p>mdanse_periodic_table</p></li>
<li><p>mdanse_plotter</p></li>
<li><p>mdanse_ud_editor</p></li>
<li><p>mdanse_units_editor</p></li>
</ul>
<section id="mdanse">
<h3>mdanse<a class="headerlink" href="#mdanse" title="Permalink to this heading"></a></h3>
<p>This script is used to interface with the current installation of MDANSE
without running the GUI. It has the following options, where the
expected arguments should be inputted after the option as
space-separated values:</p>
<ul class="simple">
<li><p><strong>–version</strong></p></li>
</ul>
<p><em>Description:</em> displays the version of the installed MDANSE</p>
<p><em>Expected arguments:</em> None</p>
<ul class="simple">
<li><p><strong>–add-mmtk-def</strong></p></li>
</ul>
<p><em>Description:</em> adds the provided definition to the MMTK database</p>
<p><em>Expected arguments:</em> code, typ, filename</p>
<p><em>code</em>: the MMTK code for the molecule to register (i.e., HOH for water)</p>
<p><em>typ</em>: the molecular type; one of amino_acid, molecule, nucleic_acid</p>
<p><em>filename</em>: the path to the file that stores the MMTK definition of the
molecule being added</p>
<ul class="simple">
<li><p><strong>–database</strong> or <strong>-d</strong></p></li>
</ul>
<p><em>Description:</em> displays chemical information about the provided element</p>
<p><em>Expected arguments:</em> ename</p>
<p><em>ename</em>: the name of a registered element</p>
<ul class="simple">
<li><p><strong>–registry</strong> or <strong>-r</strong></p></li>
</ul>
<p><em>Description:</em> displays the contents of MDANSE classes registry</p>
<p><em>Expected arguments:</em> None or interface</p>
<p>None → information on all classes is displayed</p>
<p><em>interface</em>: the name of a class → information on only the subclasses of
the provided class is displayed</p>
<ul class="simple">
<li><p><strong>–traj</strong> or <strong>-t</strong></p></li>
</ul>
<p><em>Description:</em> displays the chemical contents of a trajectory</p>
<p><em>Expected arguments:</em> trajName</p>
<p><em>trajName</em>: the name of a trajectory that has been loaded into MDANSE</p>
<ul class="simple">
<li><p><strong>–jc</strong></p></li>
</ul>
<p><em>Description:</em> shows the status of the provided job</p>
<p><em>Expected arguments:</em> filename</p>
<p><em>filename</em>: the name (not path!) of a file representing an MDANSE job</p>
<ul class="simple">
<li><p><strong>–jl</strong></p></li>
</ul>
<p><em>Description:</em> displays the job list</p>
<p><em>Expected arguments:</em> None</p>
<ul class="simple">
<li><p><strong>–jr</strong></p></li>
</ul>
<p><em>Description:</em> runs the provided MDANSE job(s)</p>
<p><em>Expected arguments:</em> filename</p>
<p><em>filename</em>: the path to an MDANSE python script</p>
<ul class="simple">
<li><p><strong>–js</strong></p></li>
</ul>
<p><em>Description:</em> saves a job script for the provided job with default
parameters</p>
<p><em>Expected arguments:</em> name</p>
<p><em>name</em>: the name of a job (e.g., ccf for Current Correlation Function)</p>
<ul class="simple">
<li><p><strong>–jt</strong></p></li>
</ul>
<p><em>Description:</em> saves a new job template</p>
<p><em>Expected arguments:</em> classname, shortname</p>
<p><em>classname</em>: a full name for the new job (e.g., TXTConverter)</p>
<p><em>shortname</em>: a short name for the new job (e.g., txtc)</p>
</section>
<section id="mdanse-elements-database">
<h3>mdanse_elements_database<a class="headerlink" href="#mdanse-elements-database" title="Permalink to this heading"></a></h3>
<p>This script has no options. When run, it opens the <a class="reference external" href="#_Elements_database_editor">Elements Database
Editor</a> GUI window.</p>
</section>
<section id="mdanse-gui">
<h3>mdanse_gui<a class="headerlink" href="#mdanse-gui" title="Permalink to this heading"></a></h3>
<p>This script has no options. When run, it opens the main <a class="reference external" href="#_The_main_window">MDANSE
GUI</a> window.</p>
</section>
<section id="mdanse-job">
<h3>mdanse_job<a class="headerlink" href="#mdanse-job" title="Permalink to this heading"></a></h3>
<p>This script is used to run a <a class="reference external" href="#_Analysis">job</a>. It opens the GUI
window for the selected job without opening the main window. To do this,
two positional arguments are required (meaning only the values should be
placed after mdanse_job, no – options like for the mdanse script).
These two arguments are as follows:</p>
<ul class="simple">
<li><p><strong>job</strong> – the short name of the job to be run (e.g., pdf for Pair
Distribution Function).</p></li>
<li><p><strong>trajectory</strong> – (only required for analyses; should be left blank
for trajectory converters) the path to an MMTK trajectory file used
for the job.</p></li>
</ul>
</section>
<section id="mdanse-periodic-table">
<h3>mdanse_periodic_table<a class="headerlink" href="#mdanse-periodic-table" title="Permalink to this heading"></a></h3>
<p>This script has no options. When run, it opens the <a class="reference external" href="#_Periodic_table_viewer">Periodic
Table</a> GUI window.</p>
</section>
<section id="mdanse-plotter">
<h3>mdanse_plotter<a class="headerlink" href="#mdanse-plotter" title="Permalink to this heading"></a></h3>
<p>This script has no options. When run, it opens the <a class="reference external" href="#_2D/3D_Plotter">2D/3D
Plotter</a> GUI window.</p>
</section>
<section id="mdanse-ud-editor">
<h3>mdanse_ud_editor<a class="headerlink" href="#mdanse-ud-editor" title="Permalink to this heading"></a></h3>
<p>This script has no options. When run, it opens the <a class="reference external" href="#_User_definition">User Definitions
Editor</a> GUI window.</p>
</section>
<section id="mdanse-units-editor">
<h3>mdanse_units_editor<a class="headerlink" href="#mdanse-units-editor" title="Permalink to this heading"></a></h3>
<p>This script has no options. When run, it opens the Units Editor GUI
window.</p>
</section>
</section>
</section>
<section id="appendix-1">
<h1>Appendix 1<a class="headerlink" href="#appendix-1" title="Permalink to this heading"></a></h1>
<section id="trajectory-converters">
<h2>Trajectory Converters<a class="headerlink" href="#trajectory-converters" title="Permalink to this heading"></a></h2>
<p>Below is the list of converters present in MDANSE. These allow for the
outputs of a variety of MD simulation software to be able to be used in
MDANSE by converting the various file formats to MMTK NetCDF format that
can be used by MDANSE. All converters convert the positions and other
vital values such as unit cell parameters, but velocities and forces are
converted by only select converters.</p>
<p>Each converter requires different things to work and provides different
options. This is detailed in the sections below. The only things that
all converter windows have in common are the buttons (described in <a class="reference external" href="#_Trajectory_converter">main
text</a>) and the output files field. At the
beginning, that is just as the converter window is opened, this field
will appear as follows:</p>
<a class="reference internal image-reference" href="pages/Pictures/100000010000026200000041B5878AC6986B511E.png"><img alt="pages/Pictures/100000010000026200000041B5878AC6986B511E.png" src="pages/Pictures/100000010000026200000041B5878AC6986B511E.png" style="width: 15.921cm; height: 1.697cm;" /></a>
<ul class="simple">
<li><p><strong>Output files</strong></p></li>
</ul>
<p><em>Format:</em> string</p>
<p><em>Default:</em> ~\output.nc (where ~ is the home directory)</p>
<p><em>Description:</em> the path to and name of the file that will be created in
MMTK NetCDF format, containing all the information from the MD file
except velocities.</p>
<p>However, once an input file is selected (that is, Browse button next to
an input file field is clicked, a file is selected in the file browser,
and OK is clicked), MDANSE tries to generate a useful file name and
place it in the same folder as the input file. Therefore, the output
file field will appear as follows:</p>
<a class="reference internal image-reference" href="pages/Pictures/1000000100000300000000943C654743BE929242.png"><img alt="pages/Pictures/1000000100000300000000943C654743BE929242.png" src="pages/Pictures/1000000100000300000000943C654743BE929242.png" style="width: 15.921cm; height: 3.067cm;" /></a>
<ul class="simple">
<li><p><strong>Output files</strong></p></li>
</ul>
<p><em>Format:</em> string</p>
<p><em>Default:</em>
original_trajectory_directory_path\original_trajectory_file_name (where
original_trajectory_directory_path is the path where the trajectory
being converted is located, and original_trajectory_file_name is the
name of the trajectory being converted)</p>
<p>Also, (n) may be appended to the end of the proposed file name if a file
with the initial name already exists, where n is the lowest number for
which a file does not exist.</p>
<p><em>Description:</em> the path to and name of the file that will be created in
MMTK NetCDF format, containing all the information from the MD file
except velocities.</p>
<section id="castep-converter">
<h3>CASTEP converter<a class="headerlink" href="#castep-converter" title="Permalink to this heading"></a></h3>
<p>MDANSE can convert .md files generated by <strong>CA</strong>mbridge <strong>S</strong>erial
<strong>T</strong>otal <strong>E</strong>nergy <strong>P</strong>ackage (CASTEP)
[<a class="reference external" href="#SignetBibliographie_027">27</a>] of any version, and the header can
be of any length. The converter expects velocities and forces to be
written in the MD file. Clicking on the CASTEP button brings up this
window:</p>
<a class="reference internal image-reference" href="pages/Pictures/10000001000003150000015759A83DDB0249EC5C.png"><img alt="pages/Pictures/10000001000003150000015759A83DDB0249EC5C.png" src="pages/Pictures/10000001000003150000015759A83DDB0249EC5C.png" style="width: 12.638cm; height: 5.405cm;" /></a>
<ul class="simple">
<li><p><strong>castep file</strong></p></li>
</ul>
<p><em>Format:</em> string</p>
<p><em>Default:</em> ..\..\..\Data\Trajectories\CASTEP\PBAnew.md</p>
<p><em>Description:</em> the path to an MD file that contains the trajectory. The
Browse button can be used to search for the file using the file browser.</p>
<ul class="simple">
<li><p><strong>Output files</strong></p></li>
</ul>
<p><em>Format:</em> string</p>
<p><em>Default:</em> ~\output_trajectory_conversion (where ~ is the home
directory)</p>
<p><em>Description:</em> the path to and name of the file that will be created in
MMTK NetCDF format, containing all the information from the MD file
except velocities.</p>
</section>
<section id="charmm-converter">
<h3>CHARMM converter<a class="headerlink" href="#charmm-converter" title="Permalink to this heading"></a></h3>
<p>This converter allows the conversion from a trajectory generated with
<strong>C</strong>hemistry at <strong>HAR</strong>vard <strong>M</strong>acromolecular <strong>M</strong>echanics
(CHARMM) [<a class="reference external" href="#SignetBibliographie_028">28</a>]. Selecting CHARMM button
will open the following window:</p>
<a class="reference internal image-reference" href="pages/Pictures/10000001000003150000025696FDB61E670AE025.png"><img alt="pages/Pictures/10000001000003150000025696FDB61E670AE025.png" src="pages/Pictures/10000001000003150000025696FDB61E670AE025.png" style="width: 13.899cm; height: 10.534cm;" /></a>
<ul class="simple">
<li><p><strong>pdb file</strong></p></li>
</ul>
<p><em>Format:</em> string</p>
<p><em>Default:</em> ..\..\..\Data\Trajectories\CHARMM\2vb1.pdb</p>
<p><em>Description:</em> a PDB file of the system must be provided for the
conversion. This file is necessary to build up the MMTK universe related
to the MMTK trajectory. If you do not have a PDB file, you can generate
it in many ways, such as by using ‘gmx editconf’ Gromacs command.</p>
<p>Please note, however, that there are multiple ‘versions’ of PDB files,
but MDANSE is quite strict regarding which ones it can read. Therefore,
it is best to make sure the PDB complies with the specification in Ref
[<a class="reference external" href="#SignetBibliographie_029">29</a>]. Notably, the terminal oxygens on
the carboxylic acid end must be noted as OT1 and OT2; O1 and O2 will
result in an obscure error.</p>
<ul class="simple">
<li><p><strong>dcd file</strong></p></li>
</ul>
<p><em>Format:</em> string</p>
<p><em>Default:</em> ..\..\..\Data\Trajectories\CHARMM\2vb1.dcd</p>
<p><em>Description:</em> the CHARMM DCD trajectory file that stores the trajectory
frames.</p>
<ul class="simple">
<li><p><strong>Time step (ps)</strong></p></li>
</ul>
<p><em>Format:</em> strictly positive float</p>
<p><em>Default:</em> 1.0</p>
<p><em>Description:</em> the time step in picoseconds between two consecutive
frames of CHARMM trajectory.</p>
<ul class="simple">
<li><p><strong>Fold coordinates in to box</strong></p></li>
</ul>
<p><em>Format:</em> bool</p>
<p><em>Default:</em> False</p>
<p><em>Description:</em> &lt;insert&gt;</p>
<ul class="simple">
<li><p><strong>output files</strong></p></li>
</ul>
<p><em>Format:</em> string</p>
<p><em>Default:</em> ~\output_trajectory_conversion (where ~ is the home
directory)</p>
<p><em>Description:</em> the path to and name of the file that will be created in
MMTK NetCDF format, containing all the information from the PDB and DCD
files except velocities.</p>
</section>
<section id="dftb-converter">
<h3>DFTB converter<a class="headerlink" href="#dftb-converter" title="Permalink to this heading"></a></h3>
<p>Converts trajectories generated using software based on the
<strong>D</strong>ensity <strong>F</strong>unctional based <strong>T</strong>ight <strong>B</strong>inding (DFTB)
method [<a class="reference external" href="#SignetBibliographie_030">30</a>]. It should work with all the
related software, but if you have any issues, please let us know.</p>
<p>Selecting DFTB will open this window:</p>
<a class="reference internal image-reference" href="pages/Pictures/10000001000003140000015850B81A8826C6B772.png"><img alt="pages/Pictures/10000001000003140000015850B81A8826C6B772.png" src="pages/Pictures/10000001000003140000015850B81A8826C6B772.png" style="width: 13.106cm; height: 5.689cm;" /></a>
<ul class="simple">
<li><p><strong>xtd file</strong></p></li>
</ul>
<p><em>Format:</em> string</p>
<p><em>Default:</em>
..\..\..\Data\Trajectories\Forcite\nylon66_rho100_500K_v300K.xtd</p>
<p><em>Description:</em> a XTD file of the system must be provided for the
conversion. This file is necessary to build up the MMTK universe related
to the MMTK trajectory.</p>
<ul class="simple">
<li><p><strong>trj file</strong></p></li>
</ul>
<p><em>Format:</em> string</p>
<p><em>Default:</em>
..\..\..\Data\Trajectories\Forcite\nylon66_rho100_500K_v300K.trj</p>
<p><em>Description:</em> the DFTB TRJ trajectory file that stores the trajectory
frames.</p>
<ul class="simple">
<li><p><strong>output files</strong></p></li>
</ul>
<p><em>Format:</em> string</p>
<p><em>Default:</em> ~\output_trajectory_conversion (where ~ is the home
directory)</p>
<p><em>Description:</em> the path to and name of the file that will be created in
MMTK NetCDF format, containing all the information from the XTD and TRJ
files except velocities.</p>
</section>
<section id="discover-converter">
<h3>Discover converter<a class="headerlink" href="#discover-converter" title="Permalink to this heading"></a></h3>
<p>This converter allows the conversion from a trajectory generated with
Materials Studio [<a class="reference external" href="#SignetBibliographie_031">31</a>] Discover module to
a MMTK NetCDF trajectory. It converts velocities but not forces.
Clicking on Discover button will open this window:</p>
<a class="reference internal image-reference" href="pages/Pictures/10000001000003150000014DDFE5CA44B547B43C.png"><img alt="pages/Pictures/10000001000003150000014DDFE5CA44B547B43C.png" src="pages/Pictures/10000001000003150000014DDFE5CA44B547B43C.png" style="width: 12.903cm; height: 5.447cm;" /></a>
<ul class="simple">
<li><p><strong>xtd file</strong></p></li>
</ul>
<p><em>Format:</em> string</p>
<p><em>Default:</em> ..\..\..\Data\Trajectories\Discover\sushi.xtd</p>
<p><em>Description:</em> a XTD file of the system must be provided for the
conversion. This file is necessary to build up the MMTK universe related
to the MMTK trajectory.</p>
<ul class="simple">
<li><p><strong>his file</strong></p></li>
</ul>
<p><em>Format:</em> string</p>
<p><em>Default:</em> ..\..\..\Data\Trajectories\Discover\sushi.his</p>
<p><em>Description:</em> the Discover HIS trajectory file that stores the
trajectory frames.</p>
<ul class="simple">
<li><p><strong>output files</strong></p></li>
</ul>
<p><em>Format:</em> string</p>
<p><em>Default:</em> ~\output_trajectory_conversion (where ~ is the home
directory)</p>
<p><em>Description:</em> the path to and name of the file that will be created in
MMTK NetCDF format, containing all the information from the XTD and HIS
files except velocities.</p>
</section>
<section id="dl-poly-converter">
<h3>DL_POLY converter<a class="headerlink" href="#dl-poly-converter" title="Permalink to this heading"></a></h3>
<p>This converter allows the conversion from a trajectory generated with DL
POLY [<a class="reference external" href="#SignetBibliographie_032">32</a>] to a MMTK NetCDF trajectory. It
can convert both velocities and forces. Pressing the DL-POLY button will
open this window:</p>
<a class="reference internal image-reference" href="pages/Pictures/1000000100000317000001CD6129CD4A142CB73E.png"><img alt="pages/Pictures/1000000100000317000001CD6129CD4A142CB73E.png" src="pages/Pictures/1000000100000317000001CD6129CD4A142CB73E.png" style="width: 13.31cm; height: 7.826cm;" /></a>
<ul class="simple">
<li><p><strong>field file</strong></p></li>
</ul>
<p><em>Format:</em> string</p>
<p><em>Default:</em> ..\..\..\Data\Trajectories\DL_POLY\FIELD_cumen</p>
<p><em>Description:</em> the DL POLY FIELD file that stores the information about
the system. This file is necessary to build up the MMTK universe related
to the MMTK trajectory.</p>
<ul class="simple">
<li><p><strong>history file</strong></p></li>
</ul>
<p><em>Format:</em> string</p>
<p><em>Default:</em> ..\..\..\Data\Trajectories\DL_POLY\HISTORY_cumen</p>
<p><em>Description:</em> the DL POLY HISTORY file that stores the trajectory
frames.</p>
<ul class="simple">
<li><p><strong>atom aliases</strong></p></li>
</ul>
<p><em>Format:</em> string</p>
<p><em>Default:</em> {}</p>
<p><em>Description:</em> MDANSE will create the MMTK universe with the atom names
specified in the FIELD file. By default, MDANSE will interpret these
names directly as if they were a chemical symbol. If this fails, MDANSE
will remove the last character until it corresponds to a known chemical
symbol. For example, an atom defined in the FIELD file as CB, will first
be interpreted as an atom of chemical symbol CB. As it does not exist,
MDANSE will interpret it as an atom of chemical symbol C, namely a
carbon atom. Using this procedure, it can happen that some atom names
can be misunderstood, or event not understood at all by MMTK. For
example, aromatic carbons (CA) can be interpreted as calcium.</p>
<p>The aim of the Special atoms field is precisely to avoid such problems.
The format for the Special atoms field is</p>
<p><em>{atom_name1:element1 &lt;sep&gt; atom_name2:element2 etc.}</em></p>
<p>where &lt;sep&gt; can be a white space, a comma, or a semicolon. In the
example showed in figure 4.7, the string CS:C should be entered in the
Special atoms field. Interestingly, the Special atoms field can also be
used to specify united atoms. The syntax is exactly the same but, in
that case, the element name must be replaced by the MMTK united atom
code (e.g. CH3, CH2, CH, NH, NH2, NH3, OH, SH, etc.)</p>
<ul class="simple">
<li><p><strong>version</strong></p></li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 2</p>
<p><em>Description:</em> The version of DL POLY software. Different versions
format the HISTORY file differently, so it is necessary to select the
correct format.</p>
<ul class="simple">
<li><p><strong>output files</strong></p></li>
</ul>
<p><em>Format:</em> string</p>
<p><em>Default:</em> ~\output_trajectory_conversion (where ~ is the home
directory)</p>
<p><em>Description:</em> the path to and name of the file that will be created in
MMTK NetCDF format, containing all the information from the FIELD and
HISTORY files.</p>
</section>
<section id="dmol-converter">
<h3>DMol converter<a class="headerlink" href="#dmol-converter" title="Permalink to this heading"></a></h3>
<p>This converter allows the conversion from a trajectory generated with
Materials Studio [<a class="reference external" href="#SignetBibliographie_031">31</a>] DMol module to a
MMTK NetCDF trajectory. Clicking on DMol button will open this window:</p>
<a class="reference internal image-reference" href="pages/Pictures/100000010000031500000151C0FBAB90F30D0BF1.png"><img alt="pages/Pictures/100000010000031500000151C0FBAB90F30D0BF1.png" src="pages/Pictures/100000010000031500000151C0FBAB90F30D0BF1.png" style="width: 13.391cm; height: 5.719cm;" /></a>
<ul class="simple">
<li><p><strong>xtd file</strong></p></li>
</ul>
<p><em>Format:</em> string</p>
<p><em>Default:</em> ..\..\..\Data\Trajectories\Discover\sushi.xtd</p>
<p><em>Description:</em> an XTD file of the system must be provided for the
conversion. This file is necessary to build up the MMTK universe related
to the MMTK trajectory.</p>
<ul class="simple">
<li><p><strong>his file</strong></p></li>
</ul>
<p><em>Format:</em> string</p>
<p><em>Default:</em> ..\..\..\Data\Trajectories\Discover\sushi.his</p>
<p><em>Description:</em> the DMol HIS trajectory file that stores the trajectory
frames.</p>
<ul class="simple">
<li><p><strong>output files</strong></p></li>
</ul>
<p><em>Format:</em> string</p>
<p><em>Default:</em> ~\output_trajectory_conversion (where ~ is the home
directory)</p>
<p><em>Description:</em> the path to and name of the file that will be created in
MMTK NetCDF format, containing all the information from the XTD and HIS
files except velocities.</p>
</section>
<section id="forcite-converter">
<h3>Forcite converter<a class="headerlink" href="#forcite-converter" title="Permalink to this heading"></a></h3>
<p>This converter allows for the conversion from a trajectory generated
with Materials Studio [<a class="reference external" href="#SignetBibliographie_031">31</a>] Forcite module
to a MMTK NetCDF trajectory. It can convert both velocities and forces,
if present. Clicking on DMol button will open this window:</p>
<a class="reference internal image-reference" href="pages/Pictures/1000000100000316000001524D8DC11569DB0A6A.png"><img alt="pages/Pictures/1000000100000316000001524D8DC11569DB0A6A.png" src="pages/Pictures/1000000100000316000001524D8DC11569DB0A6A.png" style="width: 13.391cm; height: 5.72cm;" /></a>
<ul class="simple">
<li><p><strong>xtd file</strong></p></li>
</ul>
<p><em>Format:</em> string</p>
<p><em>Default:</em>
..\..\..\Data\Trajectories\Forcite\nylon66_rho100_500K_v300K.xtd</p>
<p><em>Description:</em> a XTD file of the system must be provided for the
conversion. This file is necessary to build up the MMTK universe related
to the MMTK trajectory.</p>
<ul class="simple">
<li><p><strong>trj file</strong></p></li>
</ul>
<p><em>Format:</em> string</p>
<p><em>Default:</em>
..\..\..\Data\Trajectories\Forcite\nylon66_rho100_500K_v300K.trj</p>
<p><em>Description:</em> the Forcite TRJ trajectory file that stores the
trajectory frames.</p>
<ul class="simple">
<li><p><strong>output files</strong></p></li>
</ul>
<p><em>Format:</em> string</p>
<p><em>Default:</em> ~\output_trajectory_conversion (where ~ is the home
directory)</p>
<p><em>Description:</em> the path to and name of the file that will be created in
MMTK NetCDF format, containing all the information from the XTD and HIS
files except velocities.</p>
</section>
<section id="generic-converter">
<h3>Generic converter<a class="headerlink" href="#generic-converter" title="Permalink to this heading"></a></h3>
<p>Converts a trajectory written in ASCII to an MMTK NetCDF file, including
both velocities and forces if present. This is useful if you have a
trajectory from a software not currently supported by MDANSE. An example
of such ASCII file can be found by clicking on Help in the window that
appears when Generic is selected:</p>
<a class="reference internal image-reference" href="pages/Pictures/100000010000031500000109AFEC778397C1B933.png"><img alt="pages/Pictures/100000010000031500000109AFEC778397C1B933.png" src="pages/Pictures/100000010000031500000109AFEC778397C1B933.png" style="width: 13.573cm; height: 4.558cm;" /></a>
<ul class="simple">
<li><p><strong>gt file</strong></p></li>
</ul>
<p><em>Format:</em> string</p>
<p><em>Default</em>: ..\..\..\Data\Trajectories\Generic\test.gt</p>
<p><em>Description: path to</em> an ASCII trajectory file that will be converted
to MMTK NetCDF format.</p>
<ul class="simple">
<li><p><strong>output files</strong></p></li>
</ul>
<p><em>Format:</em> string</p>
<p><em>Default:</em> ~\output_trajectory_conversion (where ~ is the home
directory)</p>
<p><em>Description:</em> the path to and name of the file that will be created in
MMTK NetCDF format, containing all the information from the XTD and HIS
files except velocities.</p>
</section>
<section id="gromacs-converter">
<h3>Gromacs converter<a class="headerlink" href="#gromacs-converter" title="Permalink to this heading"></a></h3>
<p>Converts a trajectory generated by the Gromacs software
[<a class="reference external" href="#SignetBibliographie_033">33</a>] into MMTK NetCDF format. A PDF file
containing the data about the initial configuration must be provided,
along with a trajectory in either an XTC, or, since version 1.6.0, a TRR
format. The latter format supports velocity reading. Selecting Gromacs
opens the following window:</p>
<a class="reference internal image-reference" href="pages/Pictures/100000010000030F00000180568EF39BEE35B86C.png"><img alt="pages/Pictures/100000010000030F00000180568EF39BEE35B86C.png" src="pages/Pictures/100000010000030F00000180568EF39BEE35B86C.png" style="width: 15.921cm; height: 7.807cm;" /></a>
<ul class="simple">
<li><p><strong>pdb file</strong></p></li>
</ul>
<p><em>Format:</em> string</p>
<p><em>Default:</em> ..\..\..\Data\Trajectories\Gromacs\md.pdb</p>
<p><em>Description:</em> a PDB file of the system must be provided for the
conversion. This file is necessary to build up the MMTK universe related
to the MMTK trajectory. If you do not have a PDB file, you can generate
it in many ways, such as by using ‘gmx editconf’ Gromacs command.</p>
<p>Please note, however, that there are multiple ‘versions’ of PDB files,
but MDANSE is quite strict regarding which ones it can read. Therefore,
it is best to make sure the PDB complies with the specification in Ref
[<a class="reference external" href="#SignetBibliographie_029">29</a>]. Notably, the terminal oxygens on
the carboxylic acid end must be noted as OT1 and OT2; O1 and O2 will
result in an obscure error.</p>
<ul class="simple">
<li><p><strong>xtc or trr file</strong></p></li>
</ul>
<p><em>Format:</em> string</p>
<p><em>Default:</em> ..\..\..\Data\Trajectories\Gromacs\md.xtc</p>
<p><em>Description:</em> the Gromacs XTC or TRR trajectory file that stores the
trajectory frames.</p>
<ul class="simple">
<li><p><strong>Fold coordinates in to box</strong></p></li>
</ul>
<p><em>Format:</em> bool</p>
<p><em>Default:</em> False</p>
<p><em>Description:</em> &lt;insert&gt;</p>
<ul class="simple">
<li><p><strong>output files</strong></p></li>
</ul>
<p><em>Format:</em> string</p>
<p><em>Default:</em> ~\output_trajectory_conversion (where ~ is the home
directory)</p>
<p><em>Description:</em> the path to and name of the file that will be created in
MMTK NetCDF format, containing all the information from the PDB and DCD
files except velocities.</p>
</section>
<section id="lammps-converter">
<h3>LAMMPS converter<a class="headerlink" href="#lammps-converter" title="Permalink to this heading"></a></h3>
<p>Converts trajectories generated by <strong>L</strong>arge-scale
<strong>A</strong>tomic/<strong>M</strong>olecular <strong>M</strong>assively <strong>P</strong>arallel
<strong>S</strong>imulator (LAMMPS) [<a class="reference external" href="#SignetBibliographie_034">34</a>] into MMTK
NetCDF format. Selecting LAMMPS opens the following window:</p>
<a class="reference internal image-reference" href="pages/Pictures/100000010000031600000256CA0AC56F060C39AD.png"><img alt="pages/Pictures/100000010000031600000256CA0AC56F060C39AD.png" src="pages/Pictures/100000010000031600000256CA0AC56F060C39AD.png" style="width: 15.162cm; height: 11.441cm;" /></a>
<ul class="simple">
<li><p><strong>LAMMPS configuration file</strong></p></li>
</ul>
<p><em>Format:</em> string</p>
<p><em>Default:</em>
..\..\..\Data\Trajectories\LAMMPS\glycyl_L_alanine_charmm.config</p>
<p><em>Description:</em> LAMMPS configuration file. It should contain box
dimensions and the masses block.</p>
<ul class="simple">
<li><p><strong>LAMMPS trajectory file</strong></p></li>
</ul>
<p><em>Format:</em> string</p>
<p><em>Default:</em>
..\..\..\Data\Trajectories\LAMMPS\glycyl_L_alanine_charmm.config</p>
<p><em>Description</em>: a .lammps file that stores the trajectory frames.</p>
<ul class="simple">
<li><p><strong>mass tolerance (uma)</strong></p></li>
</ul>
<p><em>Format:</em> float</p>
<p><em>Default:</em> 0.001</p>
<p><em>Description:</em> For LAMMPS trajectories, the parameter used to identify
the chemical elements present in the simulated system is the mass.
MDANSE compares the values present in the “Masses” block in the LAMMPS
configuration file with those stored in MDANSE’s own database and
identify an element when both agree between the mass tolerance (the
other input parameter available in the conversion interface). Naturally
the masses appearing in the configuration file should be close to those
in the database, but they are not necessarily the same. For example, the
mass for hydrogen in the database is 1.0079 uma, but you could have a
simulation done with a mass value of 1.008 or 1.01 or even just 1.</p>
<p>A possible solution may be to change the mass tolerance given using this
option. However, as the MDANSE database contains the masses of all the
isotopes, if the tolerance is such that more than one isotope can be
assigned, the converter will also fail. Therefore, the safest solution
is to check the values of the masses in the MDANSE database and modify
the LAMMPS configuration file to use the same masses.</p>
<ul class="simple">
<li><p><strong>smart mass association</strong></p></li>
</ul>
<p><em>Format:</em> bool</p>
<p><em>Default:</em> True</p>
<p><em>Description:</em> If this is set to True and there are two or more elements
in the MDANSE database within the tolerance of the LAMMPS mass (ie. If
there is more than one match), MDANSE will not fail with an error but
instead match the element from the database that most closely matches
the mass in the LAMMPS .config file.</p>
<ul class="simple">
<li><p><strong>Time step (fs)</strong></p></li>
</ul>
<p><em>Format:</em> strictly positive float</p>
<p><em>Default:</em> 1.0</p>
<p><em>Description:</em> the time step in <strong>femtoseconds</strong> between two consecutive
frames of the LAMMPS trajectory.</p>
<ul class="simple">
<li><p><strong>Number of time steps</strong></p></li>
</ul>
<p><em>Format:</em> strictly positive int</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> the number of steps you want to convert. If this is set
to 0, MDANSE will convert all the frames in the trajectory.</p>
<ul class="simple">
<li><p><strong>output files</strong></p></li>
</ul>
<p><em>Format:</em> string</p>
<p><em>Default:</em> ~\output_trajectory_conversion (where ~ is the home
directory)</p>
<p><em>Description:</em> the path to and name of the file that will be created in
MMTK NetCDF format, containing all the information from the PDB and DCD
files except velocities.</p>
</section>
<section id="namd-converter">
<h3>NAMD converter<a class="headerlink" href="#namd-converter" title="Permalink to this heading"></a></h3>
<p>Converts a trajectory generated with <strong>NA</strong>noscale <strong>M</strong>olecular
<strong>D</strong>ynamics (NAMD) [<a class="reference external" href="#SignetBibliographie_035">35</a>] to an MMTK
NetCDF trajectory. Selecting NAMD opens the following window:</p>
<a class="reference internal image-reference" href="pages/Pictures/1000000100000315000001D3B4813D4CD3F2A528.png"><img alt="pages/Pictures/1000000100000315000001D3B4813D4CD3F2A528.png" src="pages/Pictures/1000000100000315000001D3B4813D4CD3F2A528.png" style="width: 15.84cm; height: 9.423cm;" /></a>
<ul class="simple">
<li><p><strong>pdb file</strong></p></li>
</ul>
<p><em>Format:</em> string</p>
<p><em>Default:</em> ..\..\..\Data\Trajectories\CHARMM\2vb1.pdb</p>
<p><em>Description:</em> a PDB file of the system must be provided for the
conversion. This file is necessary to build up the MMTK universe related
to the MMTK trajectory.</p>
<p>Please note, however, that there are multiple ‘versions’ of PDB files,
but MDANSE is quite strict regarding which ones it can read. Therefore,
it is best to make sure the PDB complies with the specification in Ref
[<a class="reference external" href="#SignetBibliographie_029">29</a>]. Notably, the terminal oxygens on
the carboxylic acid end must be noted as OT1 and OT2; O1 and O2 will
result in an obscure error.</p>
<ul class="simple">
<li><p><strong>dcd file</strong></p></li>
</ul>
<p><em>Format:</em> string</p>
<p><em>Default:</em> ..\..\..\Data\Trajectories\CHARMM\2vb1.dcd</p>
<p><em>Description:</em> the NAMD DCD trajectory file that stores the trajectory
frames.</p>
<ul class="simple">
<li><p><strong>Time step (ps)</strong></p></li>
</ul>
<p><em>Format:</em> strictly positive float</p>
<p><em>Default:</em> 1.0</p>
<p><em>Description:</em> the time step in <strong>picoseconds</strong> between two consecutive
frames of CHARMM trajectory.</p>
<ul class="simple">
<li><p><strong>Fold coordinates in to box</strong></p></li>
</ul>
<p><em>Format:</em> bool</p>
<p><em>Default:</em> False</p>
<p><em>Description:</em> &lt;insert&gt;</p>
<ul class="simple">
<li><p><strong>output files</strong></p></li>
</ul>
<p><em>Format:</em> string</p>
<p><em>Default:</em> ~\output_trajectory_conversion (where ~ is the home
directory)</p>
<p><em>Description:</em> the path to and name of the file that will be created in
MMTK NetCDF format, containing all the information from the PDB and DCD
files except velocities.</p>
</section>
<section id="pdb-converter">
<h3>PDB converter<a class="headerlink" href="#pdb-converter" title="Permalink to this heading"></a></h3>
<p>MDANSE can convert standalone PDB files into MMTK NetCDF. However, of
the variety of PDB format, MMTK is capable of parsing only some; to
ensure that a PDB can be read, it should comply with the specification
in Ref [<a class="reference external" href="#SignetBibliographie_029">29</a>]. To do that, select PDB, and
the following window will open:</p>
<a class="reference internal image-reference" href="pages/Pictures/1000000100000317000001943BEFBB02AB5D45DD.png"><img alt="pages/Pictures/1000000100000317000001943BEFBB02AB5D45DD.png" src="pages/Pictures/1000000100000317000001943BEFBB02AB5D45DD.png" style="width: 13.189cm; height: 6.796cm;" /></a>
<ul class="simple">
<li><p><strong>pdb file</strong></p></li>
</ul>
<p><em>Format:</em> string</p>
<p><em>Default:</em> ..\..\..\Data\Trajectories\CHARMM\2vb1.pdb</p>
<p><em>Description:</em> a PDB file of the system must be provided for the
conversion. This file is necessary to build up the MMTK universe related
to the MMTK trajectory. If you do not have a PDB file, you can generate
it in many ways, such as by using ‘gmx editconf’ Gromacs command.</p>
<p>Please note, however, that there are multiple ‘versions’ of PDB files,
but MDANSE is quite strict regarding which ones it can read. Therefore,
it is best to make sure the PDB complies with the specification in Ref
[<a class="reference external" href="#SignetBibliographie_029">29</a>]. Notably, the terminal oxygens on
the carboxylic acid end must be noted as OT1 and OT2; O1 and O2 will
result in an obscure error.</p>
<ul class="simple">
<li><p><strong>nb frame</strong></p></li>
</ul>
<p><em>Format:</em> int int int</p>
<p><em>Default:</em> 0 2 1</p>
<p><em>Description:</em> The selection of frames that will be converted. The
frames specified in both ‘from’ and ‘to’ are included (ie. by default
frames 0, 1, and 2 are converted). The ‘by step of’ field specifies the
periodicity of which frames are skipped, ie. if it is 1, every frame is
converted, if it is 2, every other is converted, etc.</p>
<ul class="simple">
<li><p><strong>Time step (ps)</strong></p></li>
</ul>
<p><em>Format:</em> strictly positive float</p>
<p><em>Default:</em> 1.0</p>
<p><em>Description:</em> the time step in <strong>picoseconds</strong> between two consecutive
frames of CHARMM trajectory.</p>
<ul class="simple">
<li><p><strong>output files</strong></p></li>
</ul>
<p><em>Format:</em> string</p>
<p><em>Default:</em> ~\output_trajectory_conversion (where ~ is the home
directory)</p>
<p><em>Description:</em> the path to and name of the file that will be created in
MMTK NetCDF format, containing all the information from the PDB file
except velocities.</p>
</section>
<section id="vasp-converter">
<h3>VASP converter<a class="headerlink" href="#vasp-converter" title="Permalink to this heading"></a></h3>
<p>Converts a trajectory generated with <strong>V</strong>ienna <strong>A</strong>b-initio
<strong>S</strong>imulation <strong>P</strong>ackage (<a class="reference external" href="https://www.vasp.at/">VASP</a>) to an
MMTK NetCDF trajectory. Only trajectories created with VASP version 5 or
higher can be converted. Selecting VASP opens the following window:</p>
<a class="reference internal image-reference" href="pages/Pictures/100000010000031400000162FCE1F445A5063084.png"><img alt="pages/Pictures/100000010000031400000162FCE1F445A5063084.png" src="pages/Pictures/100000010000031400000162FCE1F445A5063084.png" style="width: 13.818cm; height: 6.205cm;" /></a>
<ul class="simple">
<li><p><strong>xdatcar file</strong></p></li>
</ul>
<p><em>Format:</em> string</p>
<p><em>Default:</em> ..\..\..\Data\Trajectories\VASP\XDATCAR_version5</p>
<p><em>Description:</em> an XDATCAR file storing a trajectory.</p>
<ul class="simple">
<li><p><strong>Time step (ps)</strong></p></li>
</ul>
<p><em>Format:</em> strictly positive float</p>
<p><em>Default:</em> 1.0</p>
<p><em>Description:</em> the time step in <strong>picoseconds</strong> between two consecutive
frames of CHARMM trajectory.</p>
<ul class="simple">
<li><p><strong>output files</strong></p></li>
</ul>
<p><em>Format:</em> string</p>
<p><em>Default:</em> ~\output_trajectory_conversion (where ~ is the home
directory)</p>
<p><em>Description:</em> the path to and name of the file that will be created in
MMTK NetCDF format, containing all the information from the PDB file
except velocities.</p>
</section>
<section id="xplor-converter">
<h3>XPLOR converter<a class="headerlink" href="#xplor-converter" title="Permalink to this heading"></a></h3>
<p>Converts a trajectory generated by X-PLOR into the MMTK NetCDF format.
Selecting XPLOR opens the following window:</p>
<a class="reference internal image-reference" href="pages/Pictures/1000000100000316000001DD1886B5FEBC0A0CA9.png"><img alt="pages/Pictures/1000000100000316000001DD1886B5FEBC0A0CA9.png" src="pages/Pictures/1000000100000316000001DD1886B5FEBC0A0CA9.png" style="width: 14.081cm; height: 8.5cm;" /></a>
<ul class="simple">
<li><p><strong>pdb file</strong></p></li>
</ul>
<p><em>Format:</em> string</p>
<p><em>Default:</em> ..\..\..\Data\Trajectories\CHARMM\2vb1.pdb</p>
<p><em>Description:</em> a PDB file of the system must be provided for the
conversion. This file is necessary to build up the MMTK universe related
to the MMTK trajectory.</p>
<p>Please note, however, that there are multiple ‘versions’ of PDB files,
but MDANSE is quite strict regarding which ones it can read. Therefore,
it is best to make sure the PDB complies with the specification in Ref
<em>[</em><a class="reference external" href="#SignetBibliographie_029">29</a><em>]</em>. Notably, the terminal
oxygens on the carboxylic acid end must be noted as OT1 and OT2; O1 and
O2 will result in an obscure error.</p>
<ul class="simple">
<li><p><strong>dcd file</strong></p></li>
</ul>
<p><em>Format:</em> string</p>
<p><em>Default:</em> ..\..\..\Data\Trajectories\CHARMM\2vb1.dcd</p>
<p><em>Description:</em> an X-PLOR DCD trajectory file that stores the trajectory
frames.</p>
<ul class="simple">
<li><p><strong>Time step (ps)</strong></p></li>
</ul>
<p><em>Format:</em> strictly positive float</p>
<p><em>Default:</em> 1.0</p>
<p><em>Description:</em> the time step in <strong>picoseconds</strong> between two consecutive
frames of CHARMM trajectory.</p>
<ul class="simple">
<li><p><strong>Fold coordinates in to box</strong></p></li>
</ul>
<p><em>Format:</em> bool</p>
<p><em>Default:</em> False</p>
<p><em>Description:</em> &lt;insert&gt;</p>
<ul class="simple">
<li><p><strong>output files</strong></p></li>
</ul>
<p><em>Format:</em> string</p>
<p><em>Default:</em> ~\output_trajectory_conversion (where ~ is the home
directory)</p>
<p><em>Description:</em> the path to and name of the file that will be created in
MMTK NetCDF format, containing all the information from the PDB and DCD
files except velocities.</p>
</section>
</section>
</section>
<section id="appendix-2">
<h1>Appendix 2<a class="headerlink" href="#appendix-2" title="Permalink to this heading"></a></h1>
<section id="parameters-for-analyses">
<h2>Parameters for Analyses<a class="headerlink" href="#parameters-for-analyses" title="Permalink to this heading"></a></h2>
<p>Each <a class="reference external" href="#_Analysis">analysis</a> window is different since each requires
different parameters to be configured before it can be run. However, all
of them have the same structure (example window below), consisting of
these parts:</p>
<ul class="simple">
<li><p><strong>trajectory</strong> box shows the path to the <a class="reference external" href="#_NetCDF_file_format">MMTK
NetCDF</a> trajectory that this analysis will
be performed on.</p></li>
<li><p><strong>Parameters</strong> are a group of options, all of which are explored in
the following sections. These are the options which vary from
analysis to analysis. The only parameters that exist on every
analysis are Frames and Output files.</p></li>
<li><p><strong>Buttons</strong> are situated at the bottom of each analysis and consist
of these options:</p>
<ul>
<li><p><strong>Help</strong> opens the source code documentation for the relevant
class in an MDANSE window.</p></li>
<li><p><strong>Save</strong> opens a file browser that allows you to save the current
analysis with the set options into a python script which can be
run from the command line. More information about scripts in
<a class="reference external" href="#_Using_MDANSE_from">Using MDANSE from command line.</a></p></li>
<li><p><strong>Run</strong> starts the analysis and prompts you whether you want to
close the window. The status of the analysis can be found in the
<a class="reference external" href="#_Jobs">Jobs</a> panel, though there is a known bug where
successful analyses do not show up.</p></li>
</ul>
</li>
</ul>
<a class="reference internal image-reference" href="pages/Pictures/10000001000003220000021BA346CFB73717C1BE.png"><img alt="pages/Pictures/10000001000003220000021BA346CFB73717C1BE.png" src="pages/Pictures/10000001000003220000021BA346CFB73717C1BE.png" style="width: 15.921cm; height: 10.7cm;" /></a>
<section id="frames">
<h3>Frames<a class="headerlink" href="#frames" title="Permalink to this heading"></a></h3>
<a class="reference internal image-reference" href="pages/Pictures/10000001000003220000021BA346CFB73717C1BE.png"><img alt="pages/Pictures/10000001000003220000021BA346CFB73717C1BE.png" src="pages/Pictures/10000001000003220000021BA346CFB73717C1BE.png" style="width: 15.921cm; height: 1.27cm;" /></a>
<p>This parameter is always situated at the top of the analysis window,
right below the trajectory box. It allows you to configure which frames
in the trajectory are to be analysed. It consists of these three boxes:</p>
<ul class="simple">
<li><p><strong>First frame</strong></p></li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> the frame from which the analysis will begin, the first
frame taken into account.</p>
<ul class="simple">
<li><p><strong>Last frame</strong></p></li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> the last frame in the trajectory</p>
<p><em>Description:</em> the frame until which the analysis proceeds. The last
frame taken into account.</p>
<ul class="simple">
<li><p><strong>Frame step</strong></p></li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 1</p>
<p><em>Description:</em> determines the periodicity of which steps are used and
which are skipped. 1 means that all frames are read, 2 means every other
is read, etc.</p>
</section>
<section id="output-files">
<h3>Output files<a class="headerlink" href="#output-files" title="Permalink to this heading"></a></h3>
<a class="reference internal image-reference" href="pages/Pictures/100000010000030400000042DC1FC2D755A00B07.png"><img alt="pages/Pictures/100000010000030400000042DC1FC2D755A00B07.png" src="pages/Pictures/100000010000030400000042DC1FC2D755A00B07.png" style="width: 15.921cm; height: 1.362cm;" /></a>
<p>This is one of the two parameters that are present in each analysis, the
other being <a class="reference external" href="#_Frames">Frames</a>. It usually appears at the bottom of
an <a class="reference external" href="#_A3.2._Analysis_window">analysis window</a>, right above the
buttons. It consists of these three parts:</p>
<ul class="simple">
<li><p><strong>output files</strong></p></li>
</ul>
<p><em>Format:</em> str</p>
<p><em>Default:</em>
mmtk_trajectory_directory_path\&lt;trajectory_filename&gt;_&lt;analysis_acronym&gt;</p>
<p>Here, mmtk_trajectory_directory_path is the path to the directory where
the NetCDF file that is being used for analysis is located. The
&lt;trajectory_filename&gt; is the name of the NetCDF file.
&lt;trajectory_filename&gt; is the shortened name of the analysis, e.g. disf
for dynamic incoherent structure factor. How this translates into
practice can be seen in the picture above.</p>
<p>Further, if the above path already exists, (n) will be appended to the
end of the file name, where n is the lowest number for which a file
doesn’t exist. This way, no overwriting occurs.</p>
<p><em>Description:</em> determines the location where the analysis results will
be stored. <strong>Browse</strong> button can be used to find the location using a
file browser.</p>
<ul class="simple">
<li><p><strong>Browse</strong> button opens a system file browser window, allowing the
navigation of the filesystem.</p></li>
<li><p><strong>output formats</strong></p></li>
</ul>
<p><em>Format:</em> drop-down</p>
<p><em>Default:</em> netcdf</p>
<p><em>Description:</em> specifies the <a class="reference external" href="#_Input_and_output">file formats</a> in
which the analysis results are saved. <a class="reference external" href="#_NetCDF_file_format">NetCDF</a>,
<a class="reference external" href="#_DAT_file_format">ASCII</a>, or both can be selected. The name of
these files is given in the ‘Basename’ string.</p>
</section>
<section id="creating-selections">
<h3>Creating selections<a class="headerlink" href="#creating-selections" title="Permalink to this heading"></a></h3>
<p>There are the following Selections in MDANSE, each of which provides a
variety of ways to alter the analysis:</p>
<ul class="simple">
<li><p><a class="reference external" href="#_Axis_Selection_1">Axis Selection</a></p></li>
<li><p><a class="reference external" href="#_Atom_Selection_1">Atom Selection</a></p></li>
<li><p><a class="reference external" href="#_Atom_Transmutation_1">Atom Transmutation</a></p></li>
<li><p><a class="reference external" href="#_Atom_Charges_1">Atom Charges</a></p></li>
<li><p>Q Vectors (explored separately in the <a class="reference external" href="#_A3.4._Q_vectors">next
section</a>)</p></li>
</ul>
<p>The ones relevant to the analysis are present in its window, but some
can also be performed from <a class="reference external" href="#_Molecular_Viewer">Molecular Viewer</a>. By
default, there are no Selections saved in MDANSE; they all have to be
created manually. Each selection is unique to a trajectory MMTK NetCDF
file, but all selections are stored in the same folder, $APPDATA/mdanse.
Therefore, if a selection is to be reuse, it is important to give
selections unique names even when creating the same selection for
multiple trajectories. To help with that, all existing saved selection
can be viewed in the User Definition Viewer which can be accessed from
the <a class="reference external" href="#_Toolbar">toolbar</a>. To save a selection, type a name in the
field next to the <strong>Save</strong> button, and then click on the button. This
will save the selection without closing the window.</p>
<section id="axis-selection-reference-basis">
<h4>Axis Selection/Reference Basis<a class="headerlink" href="#axis-selection-reference-basis" title="Permalink to this heading"></a></h4>
<p>Inside an analysis window, Axis Selection looks like this:</p>
<a class="reference internal image-reference" href="pages/Pictures/10000001000003090000003B6471CB689476B467.png"><img alt="pages/Pictures/10000001000003090000003B6471CB689476B467.png" src="pages/Pictures/10000001000003090000003B6471CB689476B467.png" style="width: 15.921cm; height: 1.208cm;" /></a>
<p>The drop-down menu is used to choose one of the existing definitions.
Only the definitions with the format matching the analysis, i.e. those
with the same number of selected atoms as the analysis expects, will
appear. New ones can be created by clicking on the <strong>New definition</strong>
button, which will open the window below. The details of the currently
selected definition can be viewed in the User Definition Viewer by
clicking on the <strong>View selected definition</strong>.</p>
<a class="reference internal image-reference" href="pages/Pictures/100000010000024A000002509C35D54A8D72A4C8.png"><img alt="pages/Pictures/100000010000024A000002509C35D54A8D72A4C8.png" src="pages/Pictures/100000010000024A000002509C35D54A8D72A4C8.png" style="width: 8.629cm; height: 8.717cm;" /></a>
<p>When this window is opened from an analysis window, the ‘Number of
atoms’ field at the top will be set to the number of atoms that must be
selected for the selection to work in the analysis from whose window it
was opened. The field will also not be editable. Thus, when the New
definition button is clicked in <a class="reference external" href="#_Angular_Correlation">Angular
Correlation</a> analysis, the field will be set
to 2, because that is how many it requires.</p>
<p>The number of atoms indicates how many atoms from one molecule must be
selected. To select an atom, click on the + button in the ‘Molecules’
list to show which atoms that molecule contains, and then double-click
the atom. That will cause the chosen atom to appear in the ‘Selected
atoms’ list, and its details in the box below. An atom can be removed
from selection by clicking on it in the ‘Selected atoms’ list and
hitting the Delete key on the keyboard.</p>
<a class="reference internal image-reference" href="pages/Pictures/100000010000024A0000024F4D31AD6A44D2DC96.png"><img alt="pages/Pictures/100000010000024A0000024F4D31AD6A44D2DC96.png" src="pages/Pictures/100000010000024A0000024F4D31AD6A44D2DC96.png" style="width: 8.412cm; height: 8.484cm;" /></a>
<p>Axis selection is available for <a class="reference external" href="#_Angular_Correlation">Angular
Correlation</a> and <a class="reference external" href="#_Order_Parameter">Order
Parameter</a> analyses, which both require 2 atoms to
be selected, and the <a class="reference external" href="#_Spatial_Density">Spatial Density</a> analysis,
which requires 3 atoms.</p>
<section id="output-contribution-per-axis">
<h5>Output contribution per axis<a class="headerlink" href="#output-contribution-per-axis" title="Permalink to this heading"></a></h5>
<a class="reference internal image-reference" href="pages/Pictures/10000001000003220000027563B8CBFF70E2089C.png"><img alt="pages/Pictures/10000001000003220000027563B8CBFF70E2089C.png" src="pages/Pictures/10000001000003220000027563B8CBFF70E2089C.png" style="width: 15.921cm; height: 1.147cm;" /></a>
<p>This is an option that is always and only available in analyses that use
<a class="reference external" href="#_Axis_Selection_1">Axis Selection</a>. It is a checkbox and is by
default unchecked. This represents that the analysis is performed
normally, ie. the calculated value is averaged over the selected axes.
If this box is checked, another output is generated by the analysis in
which the values calculated for each axis are saved separately. This can
then be plotted on a 3D graph.</p>
</section>
</section>
<section id="atom-selection">
<h4>Atom Selection<a class="headerlink" href="#atom-selection" title="Permalink to this heading"></a></h4>
<p>Atom Selection allows you to select any set of atoms and/or other
particles. These selected particles are then the ones that are made the
target of the analysis. There is no limit to which particles can be
included in a selection, or to how many selections can be used
simultaneously. There can even be none; Atom Selection is entirely
optional.</p>
<p>Inside an analysis window, Atom Selection appears thusly:</p>
<a class="reference internal image-reference" href="pages/Pictures/100000010000030800000047DA737593A6C8ED75.png"><img alt="pages/Pictures/100000010000030800000047DA737593A6C8ED75.png" src="pages/Pictures/100000010000030800000047DA737593A6C8ED75.png" style="width: 15.921cm; height: 1.457cm;" /></a>
<p>The green button adds a line for another selection, allowing you to
choose one more selection to apply to that analysis:</p>
<a class="reference internal image-reference" href="pages/Pictures/100000010000030200000070CC785E9ACCB53208.png"><img alt="pages/Pictures/100000010000030200000070CC785E9ACCB53208.png" src="pages/Pictures/100000010000030200000070CC785E9ACCB53208.png" style="width: 15.921cm; height: 2.316cm;" /></a>
<p>The line can be removed by clicking on the red button. The drop-down
menu and the <strong>View selected definition</strong> button work the way they do in
Axis Selection &lt;link&gt;. The <strong>Set new selection</strong> button opens the
following window:</p>
<a class="reference internal image-reference" href="pages/Pictures/100000010000024B00000251035B45CB484FE36D.png"><img alt="pages/Pictures/100000010000024B00000251035B45CB484FE36D.png" src="pages/Pictures/100000010000024B00000251035B45CB484FE36D.png" style="width: 8.871cm; height: 8.962cm;" /></a>
<p>The <strong>Filter by</strong> field contains different ways to access the various
particles in the loaded trajectory. Clicking on a filter will make all
the relevant particles appear in the top right box:</p>
<a class="reference internal image-reference" href="pages/Pictures/10000001000002480000024FA666A56C2A7CF8F5.png"><img alt="pages/Pictures/10000001000002480000024FA666A56C2A7CF8F5.png" src="pages/Pictures/10000001000002480000024FA666A56C2A7CF8F5.png" style="width: 10.421cm; height: 10.546cm;" /></a>
<p>Clicking on the particles/groups in that window will highlight them and
make them appear in the <strong>Selection</strong> box. Together with the buttons for
logical operations, it is possible to make complex selections, like so:</p>
<a class="reference internal image-reference" href="pages/Pictures/100000010000024900000255AD8D31ECFB0A37B1.png"><img alt="pages/Pictures/100000010000024900000255AD8D31ECFB0A37B1.png" src="pages/Pictures/100000010000024900000255AD8D31ECFB0A37B1.png" style="width: 10.663cm; height: 10.881cm;" /></a>
<p>The large box below the <strong>Selection</strong> box should show information about
your selection, but it is broken for complex selections. The box at the
very bottom, next to the <strong>Save</strong> button, is used for naming the
selection. Each selection must be named with a unique name. The <strong>Save</strong>
button saves the selection for the loaded trajectory, but it will not
close the Atom Selection window. Once selection has been saved, it
should appear in the drop-down menu in the analysis window.</p>
<p>Atom selection is available for all the analyses for which <a class="reference external" href="#_Atom_Transmutation_1">Atom
Transmutation</a> is available, as well as all
<a class="reference external" href="#_Trajectory">Trajectory</a> analyses, <a class="reference external" href="#_Dipole_AutoCorrelation_Function">Dipole Auto Correlation
Function</a>, <a class="reference external" href="#_Molecular_Trace">Molecular
Trace</a>, <a class="reference external" href="#_Root_Mean_Square_1">Root Mean Square
Fluctuation,</a> <a class="reference external" href="#_Radius_Of_Gyration">Radius of
Gyration</a>, <a class="reference external" href="#_Solvent_Accessible_Surface">Solvent Accessible
Surface</a>, and <a class="reference external" href="#_Spatial_Density">Spatial
Density</a>.</p>
</section>
<section id="atom-transmutation">
<h4>Atom Transmutation<a class="headerlink" href="#atom-transmutation" title="Permalink to this heading"></a></h4>
<p>Atom Transmutation can be used to simulate the effect of isotopic
substitution. By default, in the converted trajectory each chemical
element corresponds to the weighted sum (using the natural abundances)
of all its possible isotopes. You can use this option to force a given
atom to be a particular isotope.</p>
<p>This selection appears very similar to Atom Selection inside an analysis
window (as in figure below) and so can be operated the same way. In
fact, it requires an Atom Selection to function. That is because Atom
Transmutation gets applied to an Atom Selection.</p>
<a class="reference internal image-reference" href="pages/Pictures/10000001000003070000007D5FB1F7297C409C62.png"><img alt="pages/Pictures/10000001000003070000007D5FB1F7297C409C62.png" src="pages/Pictures/10000001000003070000007D5FB1F7297C409C62.png" style="width: 15.921cm; height: 2.568cm;" /></a>
<p>To use Atom Transmutation, simply select an Atom Selection in the grey
drop-down menu on the left, and then choose the element into which the
atoms in that Atom Selection will be transmuted from the white drop-down
menu next to the red button. For example, the below Atom Transmutation
will transmute all sodium ions into potassium ions:</p>
<a class="reference internal image-reference" href="pages/Pictures/10000001000002FC00000077E7EBAA5ADD00FF40.png"><img alt="pages/Pictures/10000001000002FC00000077E7EBAA5ADD00FF40.png" src="pages/Pictures/10000001000002FC00000077E7EBAA5ADD00FF40.png" style="width: 15.921cm; height: 2.48cm;" /></a>
<p>This parameter is available for the following analyses: <a class="reference external" href="#_Coordination_Number">Coordination
Number</a>, <a class="reference external" href="#_Current_Correlation_Function">Current Correlation
Function</a>, <a class="reference external" href="#_Density_Of_States">Density Of
States</a>, <a class="reference external" href="#_Density_Profile">Density
Profile</a>, <a class="reference external" href="#_Dynamic_Coherent_Structure">Dynamic Coherent Structure
Factor</a>, <a class="reference external" href="#_Dynamic_Incoherent_Structure">Dynamic Incoherent Structure
Factor</a>,
<a class="reference external" href="#_Eccentricity">Eccentricity</a>, <a class="reference external" href="#_Elastic_Incoherent_Structure">Elastic Incoherent Structure
Factor</a>, <a class="reference external" href="#_Gaussian_Dynamic_Incoherent">Gaussian Dynamic Incoherent
Structure Factor</a>, <a class="reference external" href="#_General_AutoCorrelation_Function">General Auto
Correlation Function</a>, <a class="reference external" href="#_Mean_Square_Displacement">Mean
Square Displacement</a>, <a class="reference external" href="#_Neutron_Dynamic_Total">Neutron Dynamic
Total Structure Factor</a>, <a class="reference external" href="#_Order_Parameter">Order
Parameter</a>, <a class="reference external" href="#_Pair_Distribution_Function">Pair Distribution
Function</a>, <a class="reference external" href="#_Position_AutoCorrelation_Function">Position Auto Correlation
Function</a>, <a class="reference external" href="#_Root_Mean_Square">Root Mean Square
Deviation</a>, <a class="reference external" href="#_Static_Structure_Factor">Static Structure
Factor</a>, <a class="reference external" href="#_Velocity_AutoCorrelation_Function">Velocity Auto Correlation
Function</a>, <a class="reference external" href="#_Xray_Static_Structure">X-Ray Static
Structure Factor</a>.</p>
</section>
<section id="atom-charges">
<h4>Atom Charges<a class="headerlink" href="#atom-charges" title="Permalink to this heading"></a></h4>
<p>This selection works inside an analysis window exactly the same as <a class="reference external" href="#_Axis_Selection">Axis
Selection</a>. The only difference is the window that
opens when <strong>Set new selection</strong> button is clicked. The Partial Charges
window appears as below, and allows you to edit the charges at each atom
inside the system. To do that, simply click on a field in the <strong>charge</strong>
column and type in a number. The change will be confirmed once you hit
enter or click outside the field. Once all changes have been made, name
the selection using the box at the bottom, then click the <strong>Save</strong>
button, and finally close the window.</p>
<a class="reference internal image-reference" href="pages/Pictures/100000010000024900000250A7ED210266718E94.png"><img alt="pages/Pictures/100000010000024900000250A7ED210266718E94.png" src="pages/Pictures/100000010000024900000250A7ED210266718E94.png" style="width: 9.945cm; height: 10.065cm;" /></a>
<p>This parameter is only available for the <a class="reference external" href="#_Dipole_AutoCorrelation_Function">Dipole Auto Correlation
Function</a> analysis.</p>
</section>
</section>
<section id="q-vectors">
<h3>Q vectors<a class="headerlink" href="#q-vectors" title="Permalink to this heading"></a></h3>
<p>Similar to the selections above but specific to <a class="reference external" href="#_Scattering">Scattering
Plugin</a>s, Q vectors give the opportunity to change
how the analysis is performed. Each window has a part like this:</p>
<a class="reference internal image-reference" href="pages/Pictures/10000001000003050000003F7D1CF6AF37C53021.png"><img alt="pages/Pictures/10000001000003050000003F7D1CF6AF37C53021.png" src="pages/Pictures/10000001000003050000003F7D1CF6AF37C53021.png" style="width: 15.921cm; height: 1.298cm;" /></a>
<p>This section must be filled for analysis to be able to run. Like for
other selections, there are no definitions by default. Therefore, one
has to be created by clicking on the <strong>New definition</strong> button. This
will open a window like in one of the following subsections, which show
how Q Vectors are defined for each type of Q Vector. There are many
types, and it is up to you to choose which is the best for a given
experiment.</p>
<p>Once a definition of choice exists, it can be selected from the
drop-down menu. The <strong>View selected definition</strong> opens the User
Definition viewer &lt;link&gt; at the currently selected definition.</p>
<section id="spherical-lattice-vectors">
<h4>Spherical Lattice Vectors<a class="headerlink" href="#spherical-lattice-vectors" title="Permalink to this heading"></a></h4>
<p>Generates a set of hkl vectors compatible with the simulation box and
groups them in shells going from the minimum and maximum values provided
by the user with the given step (the values have to be given in
nm<sup>-1</sup>). The maximum number of vectors in each shell must also be
given. Increasing the number of vectors will improve the statistics of
your result, but the calculation will also take longer. Note also that
for the lowest values of |Q|, the number of hkl vectors available may
be much smaller than this maximum number of vectors. The width defines
the accepted tolerance for a shell, so often the value for the width
will be the same as the step value. But it is also possible to give a
much smaller width in order to ensure a “high Q resolution” around
well-defined |Q| values.</p>
<p>This will be the usual choice whenever you want to compute the dynamical
coherent structure factor on an isotropic sample (a liquid or a
crystalline powder).</p>
<a class="reference internal image-reference" href="pages/Pictures/1000000100000312000002131D552DD432567B3E.png"><img alt="pages/Pictures/1000000100000312000002131D552DD432567B3E.png" src="pages/Pictures/1000000100000312000002131D552DD432567B3E.png" style="width: 15.921cm; height: 10.756cm;" /></a>
<ul class="simple">
<li><p><strong>seed</strong></p></li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description</em>: the RNG seed used to generate the vectors. This will
ensure that the same random numbers are generated when the same <strong>seed</strong>
is used, therefore making the calculation more reproducible.</p>
<ul class="simple">
<li><p>shells</p>
<ul>
<li><p><strong>from</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> the minimum value used to construct the range of shells.</p>
<ul class="simple">
<li><ul>
<li><p><strong>to</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> the maximum value used to construct the range of shells.</p>
<ul class="simple">
<li><ul>
<li><p><strong>by step of</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 1</p>
<p><em>Description:</em> the step used to construct the range of shells. If it is
1, every integer between <strong>from</strong> and <strong>to</strong> is placed into the range,
if it is 2, every other, etc.</p>
<ul class="simple">
<li><p><strong>n vectors</strong></p></li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 50</p>
<p><em>Description:</em> the number of hkl vectors in each shell. Higher values
result in higher accuracy but at the cost of longer computational time.</p>
<ul class="simple">
<li><p><strong>width</strong></p></li>
</ul>
<p><em>Format:</em> float</p>
<p><em>Default:</em> 1.0</p>
<p><em>Description:</em> the accepted tolerance of each shell. It is often
identical to <strong>by step of</strong>.</p>
<ul class="simple">
<li><p><strong>Generate</strong> button generates the hkl vectors based on the
specifications above. It must be clicked before the vectors can be
saved.</p></li>
<li><p><strong>Name</strong></p></li>
</ul>
<p><em>Format:</em> str</p>
<p><em>Default:</em> None</p>
<p><em>Description:</em> this is the empty box at the bottom of the window. It
allows you to name the generated vectors. This must be set before the
vectors can be saved.</p>
<ul class="simple">
<li><p><strong>Save</strong> button saves the generated vectors. It does not close the Q
Vectors window.</p></li>
</ul>
</section>
<section id="circular-lattice-vectors">
<h4>Circular Lattice Vectors<a class="headerlink" href="#circular-lattice-vectors" title="Permalink to this heading"></a></h4>
<p>Similar to Spherical Lattice Vectors, but in this case the vectors are
generated only in a plane perpendicular to the two axes given.</p>
<a class="reference internal image-reference" href="pages/Pictures/1000000100000313000002B80FE3D39AE365B8F3.png"><img alt="pages/Pictures/1000000100000313000002B80FE3D39AE365B8F3.png" src="pages/Pictures/1000000100000313000002B80FE3D39AE365B8F3.png" style="width: 15.921cm; height: 14.079cm;" /></a>
<ul class="simple">
<li><p><strong>seed</strong></p></li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description</em>: the RNG seed used to generate the vectors. This will
ensure that the same random numbers are generated when the same <strong>seed</strong>
is used, therefore making the calculation more reproducible.</p>
<ul class="simple">
<li><p>shells</p>
<ul>
<li><p><strong>from</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> the minimum value used to construct the range of shells.</p>
<ul class="simple">
<li><ul>
<li><p><strong>to</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> the maximum value used to construct the range of shells.</p>
<ul class="simple">
<li><ul>
<li><p><strong>by step of</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 1</p>
<p><em>Description:</em> the step used to construct the range of shells. If it is
1, every integer between <strong>from</strong> and <strong>to</strong> is placed into the range,
if it is 2, every other, etc.</p>
<ul class="simple">
<li><p><strong>n vectors</strong></p></li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 50</p>
<p><em>Description:</em> the number of hkl vectors in each shell. Higher values
result in higher accuracy but at the cost of longer computational time.</p>
<ul class="simple">
<li><p><strong>width</strong></p></li>
</ul>
<p><em>Format:</em> float</p>
<p><em>Default:</em> 1.0</p>
<p><em>Description:</em> the accepted tolerance of each shell. It is often
identical to <strong>by step of</strong>.</p>
<ul class="simple">
<li><p>axis 1</p>
<ul>
<li><p><strong>x-component</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 1</p>
<p><em>Description:</em> the x-components of the first axis used to specify the
plane.</p>
<ul class="simple">
<li><ul>
<li><p><strong>y-component</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> the y-components of the first axis used to specify the
plane.</p>
<ul class="simple">
<li><ul>
<li><p><strong>z-component</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> the z-components of the first axis used to specify the
plane.</p>
<ul class="simple">
<li><p>axis 2</p>
<ul>
<li><p><strong>x-component</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default: 0</em></p>
<p><em>Description:</em> the x-components of the second axis used to specify the
plane.</p>
<ul class="simple">
<li><ul>
<li><p><strong>y-component</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 1</p>
<p><em>Description:</em> the y-components of the second axis used to specify the
plane.</p>
<ul class="simple">
<li><ul>
<li><p><strong>z-component</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> the z-components of the second axis used to specify the
plane.</p>
<ul class="simple">
<li><p><strong>Generate</strong> button generates the hkl vectors based on the
specifications above. It must be clicked before the vectors can be
saved.</p></li>
<li><p><strong>Name</strong></p></li>
</ul>
<p><em>Format:</em> str</p>
<p><em>Default:</em> None</p>
<p><em>Description:</em> this is the empty box at the bottom of the window. It
allows you to name the generated vectors. This must be set before the
vectors can be saved.</p>
<ul class="simple">
<li><p><strong>Save</strong> button saves the generated vectors. It does not close the Q
Vectors window.</p></li>
</ul>
</section>
<section id="linear-lattice-vectors">
<h4>Linear Lattice Vectors<a class="headerlink" href="#linear-lattice-vectors" title="Permalink to this heading"></a></h4>
<p>Similar to Spherical Lattice Vectors and CircularLattice Vectors, but
now the vectors are generated only along a specific direction determined
by the axis given.</p>
<a class="reference internal image-reference" href="pages/Pictures/100000010000030F0000025C4113EA5B9835A7B9.png"><img alt="pages/Pictures/100000010000030F0000025C4113EA5B9835A7B9.png" src="pages/Pictures/100000010000030F0000025C4113EA5B9835A7B9.png" style="width: 15.921cm; height: 12.282cm;" /></a>
<ul class="simple">
<li><p><strong>seed</strong></p></li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description</em>: the RNG seed used to generate the vectors. This will
ensure that the same random numbers are generated when the same <strong>seed</strong>
is used, therefore making the calculation more reproducible.</p>
<ul class="simple">
<li><p>shells</p>
<ul>
<li><p><strong>from</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> the minimum value used to construct the range of shells.</p>
<ul class="simple">
<li><ul>
<li><p><strong>to</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> the maximum value used to construct the range of shells.</p>
<ul class="simple">
<li><ul>
<li><p><strong>by step of</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 1</p>
<p><em>Description:</em> the step used to construct the range of shells. If it is
1, every integer between <strong>from</strong> and <strong>to</strong> is placed into the range,
if it is 2, every other, etc.</p>
<ul class="simple">
<li><p><strong>n vectors</strong></p></li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 50</p>
<p><em>Description:</em> the number of hkl vectors in each shell. Higher values
result in higher accuracy but at the cost of longer computational time.</p>
<ul class="simple">
<li><p><strong>width</strong></p></li>
</ul>
<p><em>Format:</em> float</p>
<p><em>Default:</em> 1.0</p>
<p><em>Description:</em> the accepted tolerance of each shell. It is often
identical to <strong>by step of</strong>.</p>
<ul class="simple">
<li><p>axis</p>
<ul>
<li><p><strong>x-component</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 1</p>
<p><em>Description:</em> the x-components of the specified axis.</p>
<ul class="simple">
<li><ul>
<li><p><strong>y-component</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> the y-components of the specified axis..</p>
<ul class="simple">
<li><ul>
<li><p><strong>z-component</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> the z-components of the specified axis.</p>
<ul class="simple">
<li><p><strong>Generate</strong> button generates the hkl vectors based on the
specifications above. It must be clicked before the vectors can be
saved.</p></li>
<li><p><strong>Name</strong></p></li>
</ul>
<p><em>Format:</em> str</p>
<p><em>Default:</em> None</p>
<p><em>Description:</em> this is the empty box at the bottom of the window. It
allows you to name the generated vectors. This must be set before the
vectors can be saved.</p>
<ul class="simple">
<li><p><strong>Save</strong> button saves the generated vectors. It does not close the Q
Vectors window.</p></li>
</ul>
</section>
<section id="miller-indices-lattice-vectors">
<h4>Miller Indices Lattice Vectors<a class="headerlink" href="#miller-indices-lattice-vectors" title="Permalink to this heading"></a></h4>
<p>Similar to spherical_lattice, as it generates integer hkl vectors, but
provides extra flexibility in selecting the hkl values. For example, it
can be used to generate only h00 vectors.</p>
<a class="reference internal image-reference" href="pages/Pictures/100000010000031100000260CCD5B8A592078403.png"><img alt="pages/Pictures/100000010000031100000260CCD5B8A592078403.png" src="pages/Pictures/100000010000031100000260CCD5B8A592078403.png" style="width: 15.921cm; height: 12.331cm;" /></a>
<ul class="simple">
<li><p><strong>seed</strong></p></li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description</em>: the RNG seed used to generate the vectors. This will
ensure that the same random numbers are generated when the same <strong>seed</strong>
is used, therefore making the calculation more reproducible.</p>
<ul class="simple">
<li><p>shells</p>
<ul>
<li><p><strong>from</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> the minimum value used to construct the range of shells.</p>
<ul class="simple">
<li><ul>
<li><p><strong>to</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> the maximum value used to construct the range of shells.</p>
<ul class="simple">
<li><ul>
<li><p><strong>by step of</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 1</p>
<p><em>Description:</em> the step used to construct the range of shells. If it is
1, every integer between <strong>from</strong> and <strong>to</strong> is placed into the range,
if it is 2, every other, etc.</p>
<ul class="simple">
<li><p><strong>width</strong></p></li>
</ul>
<p><em>Format:</em> float</p>
<p><em>Default:</em> 1.0</p>
<p><em>Description:</em> the accepted tolerance of each shell. It is often
identical to <strong>by step of</strong>.</p>
<ul class="simple">
<li><p>h (and the same goes for k and l fields)</p>
<ul>
<li><p><strong>from</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> the minimum value used to construct the range of h
vectors.</p>
<ul class="simple">
<li><ul>
<li><p><strong>to</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> the maximum value used to construct the range of h
vectors.</p>
<ul class="simple">
<li><ul>
<li><p><strong>by step of</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 1</p>
<p><em>Description:</em> the step used to construct the range of h vectors. If it
is 1, every integer between <strong>from</strong> and <strong>to</strong> is placed into the
range, if it is 2, every other, etc.</p>
<ul class="simple">
<li><p><strong>Generate</strong> button generates the hkl vectors based on the
specifications above. It must be clicked before the vectors can be
saved.</p></li>
<li><p><strong>Name</strong></p></li>
</ul>
<p><em>Format:</em> str</p>
<p><em>Default:</em> None</p>
<p><em>Description:</em> this is the empty box at the bottom of the window. It
allows you to name the generated vectors. This must be set before the
vectors can be saved.</p>
<ul class="simple">
<li><p><strong>Save</strong> button saves the generated vectors. It does not close the Q
Vectors window.</p></li>
</ul>
</section>
<section id="spherical-vectors">
<h4>Spherical Vectors<a class="headerlink" href="#spherical-vectors" title="Permalink to this heading"></a></h4>
<p>Similar to Spherical Lattice Vectors, but the generated hkl are not
integers. This means that <strong>these vectors should never be used to
compute any coherent property!</strong> But you can use them if you are only
interested in single particle properties, as the dynamic incoherent or
the elastic incoherent structure factor. They have the advantage that
there are no limitations in the available values, so you will be able to
generate always as many vectors as you want, including at low |Q|.</p>
<p>However, if you are interested in computing and comparing/combining both
the dynamic coherent and incoherent structure factors, it is preferable
that you generate a single set of vectors using the Spherical_lattice
option and use the same set for both calculations.</p>
<a class="reference internal image-reference" href="pages/Pictures/10000001000003130000021078646D692A64AF83.png"><img alt="pages/Pictures/10000001000003130000021078646D692A64AF83.png" src="pages/Pictures/10000001000003130000021078646D692A64AF83.png" style="width: 15.921cm; height: 10.682cm;" /></a>
<ul class="simple">
<li><p><strong>seed</strong></p></li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description</em>: the RNG seed used to generate the vectors. This will
ensure that the same random numbers are generated when the same <strong>seed</strong>
is used, therefore making the calculation more reproducible.</p>
<ul class="simple">
<li><p>shells</p>
<ul>
<li><p><strong>from</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> the minimum value used to construct the range of shells.</p>
<ul class="simple">
<li><ul>
<li><p><strong>to</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> the maximum value used to construct the range of shells.</p>
<ul class="simple">
<li><ul>
<li><p><strong>by step of</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 1</p>
<p><em>Description:</em> the step used to construct the range of shells. If it is
1, every integer between <strong>from</strong> and <strong>to</strong> is placed into the range,
if it is 2, every other, etc.</p>
<ul class="simple">
<li><p><strong>n vectors</strong></p></li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 50</p>
<p><em>Description:</em> the number of hkl vectors in each shell. Higher values
result in higher accuracy but at the cost of longer computational time.</p>
<ul class="simple">
<li><p><strong>width</strong></p></li>
</ul>
<p><em>Format:</em> float</p>
<p><em>Default:</em> 1.0</p>
<p><em>Description:</em> the accepted tolerance of each shell. It is often
identical to <strong>by step of</strong>.</p>
<ul class="simple">
<li><p><strong>Generate</strong> button generates the hkl vectors based on the
specifications above. It must be clicked before the vectors can be
saved.</p></li>
<li><p><strong>Name</strong></p></li>
</ul>
<p><em>Format:</em> str</p>
<p><em>Default:</em> None</p>
<p><em>Description:</em> this is the empty box at the bottom of the window. It
allows you to name the generated vectors. This must be set before the
vectors can be saved.</p>
<ul class="simple">
<li><p><strong>Save</strong> button saves the generated vectors. It does not close the Q
Vectors window.</p></li>
</ul>
</section>
<section id="circular-vectors">
<h4>Circular Vectors<a class="headerlink" href="#circular-vectors" title="Permalink to this heading"></a></h4>
<p>Similar to Spherical Vectors, but in this case the vectors are generated
only in a plane perpendicular to the two axes given.</p>
<a class="reference internal image-reference" href="pages/Pictures/1000000100000312000002D77678DDABC09BFDCA.png"><img alt="pages/Pictures/1000000100000312000002D77678DDABC09BFDCA.png" src="pages/Pictures/1000000100000312000002D77678DDABC09BFDCA.png" style="width: 15.921cm; height: 14.727cm;" /></a>
<ul class="simple">
<li><p><strong>seed</strong></p></li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description</em>: the RNG seed used to generate the vectors. This will
ensure that the same random numbers are generated when the same <strong>seed</strong>
is used, therefore making the calculation more reproducible.</p>
<ul class="simple">
<li><p>shells</p>
<ul>
<li><p><strong>from</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> the minimum value used to construct the range of shells.</p>
<ul class="simple">
<li><ul>
<li><p><strong>to</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> the maximum value used to construct the range of shells.</p>
<ul class="simple">
<li><ul>
<li><p><strong>by step of</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 1</p>
<p><em>Description:</em> the step used to construct the range of shells. If it is
1, every integer between <strong>from</strong> and <strong>to</strong> is placed into the range,
if it is 2, every other, etc.</p>
<ul class="simple">
<li><p><strong>n vectors</strong></p></li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 50</p>
<p><em>Description:</em> the number of hkl vectors in each shell. Higher values
result in higher accuracy but at the cost of longer computational time.</p>
<ul class="simple">
<li><p><strong>width</strong></p></li>
</ul>
<p><em>Format:</em> float</p>
<p><em>Default:</em> 1.0</p>
<p><em>Description:</em> the accepted tolerance of each shell. It is often
identical to <strong>by step of</strong>.</p>
<ul class="simple">
<li><p>axis 1</p>
<ul>
<li><p><strong>x-component</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 1</p>
<p><em>Description:</em> the x-components of the first axis used to specify the
plane.</p>
<ul class="simple">
<li><ul>
<li><p><strong>y-component</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> the y-components of the first axis used to specify the
plane.</p>
<ul class="simple">
<li><ul>
<li><p><strong>z-component</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> the z-components of the first axis used to specify the
plane.</p>
<ul class="simple">
<li><p>axis 2</p>
<ul>
<li><p><strong>x-component</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default: 0</em></p>
<p><em>Description:</em> the x-components of the second axis used to specify the
plane.</p>
<ul class="simple">
<li><ul>
<li><p><strong>y-component</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 1</p>
<p><em>Description:</em> the y-components of the second axis used to specify the
plane.</p>
<ul class="simple">
<li><ul>
<li><p><strong>z-component</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> the z-components of the second axis used to specify the
plane.</p>
<ul class="simple">
<li><p><strong>Generate</strong> button generates the hkl vectors based on the
specifications above. It must be clicked before the vectors can be
saved.</p></li>
<li><p><strong>Name</strong></p></li>
</ul>
<p><em>Format:</em> str</p>
<p><em>Default:</em> None</p>
<p><em>Description:</em> this is the empty box at the bottom of the window. It
allows you to name the generated vectors. This must be set before the
vectors can be saved.</p>
<ul class="simple">
<li><p><strong>Save</strong> button saves the generated vectors. It does not close the Q
Vectors window.</p></li>
</ul>
</section>
<section id="linear-vectors">
<h4>Linear Vectors<a class="headerlink" href="#linear-vectors" title="Permalink to this heading"></a></h4>
<p>Similar to Spherical Vectors and Circular Vectors, but now the vectors
are generated only along a specific direction determined by the axis
given.</p>
<a class="reference internal image-reference" href="pages/Pictures/1000000100000312000002623129F3A7253B13AD.png"><img alt="pages/Pictures/1000000100000312000002623129F3A7253B13AD.png" src="pages/Pictures/1000000100000312000002623129F3A7253B13AD.png" style="width: 15.921cm; height: 12.356cm;" /></a>
<ul class="simple">
<li><p><strong>seed</strong></p></li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description</em>: the RNG seed used to generate the vectors. This will
ensure that the same random numbers are generated when the same <strong>seed</strong>
is used, therefore making the calculation more reproducible.</p>
<ul class="simple">
<li><p>shells</p>
<ul>
<li><p><strong>from</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> the minimum value used to construct the range of shells.</p>
<ul class="simple">
<li><ul>
<li><p><strong>to</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> the maximum value used to construct the range of shells.</p>
<ul class="simple">
<li><ul>
<li><p><strong>by step of</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 1</p>
<p><em>Description:</em> the step used to construct the range of shells. If it is
1, every integer between <strong>from</strong> and <strong>to</strong> is placed into the range,
if it is 2, every other, etc.</p>
<ul class="simple">
<li><p><strong>n vectors</strong></p></li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 50</p>
<p><em>Description:</em> the number of hkl vectors in each shell. Higher values
result in higher accuracy but at the cost of longer computational time.</p>
<ul class="simple">
<li><p><strong>width</strong></p></li>
</ul>
<p><em>Format:</em> float</p>
<p><em>Default:</em> 1.0</p>
<p><em>Description:</em> the accepted tolerance of each shell. It is often
identical to <strong>by step of</strong>.</p>
<ul class="simple">
<li><p>axis</p>
<ul>
<li><p><strong>x-component</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 1</p>
<p><em>Description:</em> the x-components of the specified axis.</p>
<ul class="simple">
<li><ul>
<li><p><strong>y-component</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> the y-components of the specified axis..</p>
<ul class="simple">
<li><ul>
<li><p><strong>z-component</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> the z-components of the specified axis.</p>
<ul class="simple">
<li><p><strong>Generate</strong> button generates the hkl vectors based on the
specifications above. It must be clicked before the vectors can be
saved.</p></li>
<li><p><strong>Name</strong></p></li>
</ul>
<p><em>Format:</em> str</p>
<p><em>Default:</em> None</p>
<p><em>Description:</em> this is the empty box at the bottom of the window. It
allows you to name the generated vectors. This must be set before the
vectors can be saved.</p>
<ul class="simple">
<li><p><strong>Save</strong> button saves the generated vectors. It does not close the Q
Vectors window.</p></li>
</ul>
</section>
<section id="grid-vectors">
<h4>Grid Vectors<a class="headerlink" href="#grid-vectors" title="Permalink to this heading"></a></h4>
<p>Generates hkl vectors in the given range. They are grouped together
according to the given qstep.</p>
<a class="reference internal image-reference" href="pages/Pictures/1000000100000312000002168C1C6AF89094EC7A.png"><img alt="pages/Pictures/1000000100000312000002168C1C6AF89094EC7A.png" src="pages/Pictures/1000000100000312000002168C1C6AF89094EC7A.png" style="width: 14.843cm; height: 10.084cm;" /></a>
<ul class="simple">
<li><p><strong>seed</strong></p></li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description</em>: the RNG seed used to generate the vectors. This will
ensure that the same random numbers are generated when the same <strong>seed</strong>
is used, therefore making the calculation more reproducible.</p>
<ul class="simple">
<li><p>hrange (and the same goes for krange and lrange fields)</p>
<ul>
<li><p><strong>from</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> the minimum value used to construct the range of h
vectors.</p>
<ul class="simple">
<li><ul>
<li><p><strong>to</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> the maximum value used to construct the range of h
vectors.</p>
<ul class="simple">
<li><ul>
<li><p><strong>by step of</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 1</p>
<p><em>Description:</em> the step used to construct the range of h vectors. If it
is 1, every integer between <strong>from</strong> and <strong>to</strong> is placed into the
range, if it is 2, every other, etc.</p>
<ul class="simple">
<li><p><strong>qstep</strong></p></li>
</ul>
<p><em>Format:</em> float</p>
<p><em>Default:</em> 0.01</p>
<p><em>Description:</em> determines how the hkl vectors are grouped.</p>
<ul class="simple">
<li><p><strong>Generate</strong> button generates the hkl vectors based on the
specifications above. It must be clicked before the vectors can be
saved.</p></li>
<li><p><strong>Name</strong></p></li>
</ul>
<p><em>Format:</em> str</p>
<p><em>Default:</em> None</p>
<p><em>Description:</em> this is the empty box at the bottom of the window. It
allows you to name the generated vectors. This must be set before the
vectors can be saved.</p>
<ul class="simple">
<li><p><strong>Save</strong> button saves the generated vectors. It does not close the Q
Vectors window.</p></li>
</ul>
</section>
<section id="approximated-dispersion-vectors">
<h4>Approximated Dispersion Vectors<a class="headerlink" href="#approximated-dispersion-vectors" title="Permalink to this heading"></a></h4>
<p>Generates Q vectors along the line joining the 2 Q-points given as
input.</p>
<a class="reference internal image-reference" href="pages/Pictures/1000000100000315000001D1BF3B69F011009E2F.png"><img alt="pages/Pictures/1000000100000315000001D1BF3B69F011009E2F.png" src="pages/Pictures/1000000100000315000001D1BF3B69F011009E2F.png" style="width: 15.921cm; height: 9.382cm;" /></a>
<ul class="simple">
<li><p><strong>generator</strong></p></li>
</ul>
<p><em>Format:</em> drop-down</p>
<p><em>Default:</em> circular_lattice</p>
<p><em>Description:</em> the selection of which type of Q Vectors is being
defined.</p>
<ul class="simple">
<li><p>Q start (nm^-1) – the first of the two Q points (the same goes for
the second one)</p>
<ul>
<li><p><strong>x-component</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 1</p>
<p><em>Description:</em> the x-component of this Q point.</p>
<ul class="simple">
<li><ul>
<li><p><strong>y-component</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> the y-component of this Q point.</p>
<ul class="simple">
<li><ul>
<li><p><strong>z-component</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> the z-component of this Q point.</p>
<ul class="simple">
<li><p><strong>Q step (nm^-1)</strong></p></li>
</ul>
<p><em>Format:</em> float</p>
<p><em>Default:</em> 0.1</p>
<p><em>Description:</em> the increment by which Q is increased when tracing the
line between the two points.</p>
<ul class="simple">
<li><p><strong>Generate</strong> button generates the hkl vectors based on the
specifications above. It must be clicked before the vectors can be
saved.</p></li>
<li><p><strong>Name</strong></p></li>
</ul>
<p><em>Format:</em> str</p>
<p><em>Default:</em> None</p>
<p><em>Description:</em> this is the empty box at the bottom of the window. It
allows you to name the generated vectors. This must be set before the
vectors can be saved.</p>
<ul class="simple">
<li><p><strong>Save</strong> button saves the generated vectors. It does not close the Q
Vectors window.</p></li>
</ul>
</section>
</section>
<section id="group-coordinates-by">
<h3>Group coordinates by<a class="headerlink" href="#group-coordinates-by" title="Permalink to this heading"></a></h3>
<a class="reference internal image-reference" href="pages/Pictures/1000000100000323000002D1329469D922AFA541.png"><img alt="pages/Pictures/1000000100000323000002D1329469D922AFA541.png" src="pages/Pictures/1000000100000323000002D1329469D922AFA541.png" style="width: 15.921cm; height: 1.27cm;" /></a>
<p>Most of the analyses provide the Group coordinates option. The default
value is atom, indicating that the calculation will be done using the
atomic positions of all the atoms currently selected. But you can use
this option to “merge” all the atoms belonging to a given group into a
single position, which will be used then in the calculation. For
example, this can be used to compute the mean square displacement of the
molecular centres. Naturally, the availability of the different group
options (group, residue, chain, molecule) will depend on the nature of
your system and how MDANSE interpreted during the conversion step.</p>
<p>This parameter is available in the following analyses: <a class="reference external" href="#_Center_Of_Masses">Centre of Masses
Trajectory</a>, <a class="reference external" href="#_Density_Of_States">Density of
States</a>, <a class="reference external" href="#_Dynamic_Incoherent_Structure">Dynamic Incoherent Structure
Factor</a>, <a class="reference external" href="#_Elastic_Incoherent_Structure">Elastic Incoherent
Structure Factor</a>, <a class="reference external" href="#_Gaussian_Dynamic_Incoherent">Gaussian Dynamic
Incoherent Structure Factor</a>, <a class="reference external" href="#_General_AutoCorrelation_Function">General
Auto Correlation Function</a>, <a class="reference external" href="#_Mean_Square_Displacement">Mean
Square Displacement</a>, <a class="reference external" href="#_Order_Parameter">Order
Parameter</a>, <a class="reference external" href="#_Rigid_Body_Trajectory">Rigid Body
Trajectory</a>, <a class="reference external" href="#_Root_Mean_Square">Root Mean Square
Deviation</a>, <a class="reference external" href="#_Root_Mean_Square_1">Root Mean Square
Fluctuation</a>, <a class="reference external" href="#_Velocity_AutoCorrelation_Function">Velocity Auto Correlation
Function</a>.</p>
</section>
<section id="instrument-resolution">
<h3>Instrument resolution<a class="headerlink" href="#instrument-resolution" title="Permalink to this heading"></a></h3>
<a class="reference internal image-reference" href="pages/Pictures/1000000100000323000002D1329469D922AFA541.png"><img alt="pages/Pictures/1000000100000323000002D1329469D922AFA541.png" src="pages/Pictures/1000000100000323000002D1329469D922AFA541.png" style="width: 15.921cm; height: 1.411cm;" /></a>
<p>This option is available in all the analyses performing a time Fourier
Transform, e.g. for the calculation of the density of states or the
dynamic structure factor. You can choose the shape of the resolution
(default is Gaussian), the position (default is at =0) and the
parameter defining the width of the function in frequency space ( for
the Gaussian resolution). Those parameters define a function R() and
its analytical Fourier Transform R(t) is then used to compute I(t)R(t),
where I(t) is the time-dependent property directly computed from the
trajectory (e.g. the velocity autocorrelation function for the DOS, or
the intermediate scattering function for the S(Q,)). The product is the
Fourier transformed to obtain the final result.</p>
<p>The main purpose of the instrument resolution is therefore to smooth the
function computed directly in time before performing its Fourier
Transform into frequency space, in order to avoid numerical artefacts
when FT noisy data. But it can be also used as an approximate way of
estimating instrument resolution effects if you give a value of 
similar to the one of the experimental resolutions. For example, if you
are going to compare your simulation with data measured on a
spectrometer having a resolution of 0.1 meV (FWHM), then use:</p>
<div class="math">
<p><span class="math">\sigma\approx\frac{\mathit{FWHM}{\lbrack\text{meV}\rbrack}}{2.35}\times 1.519\frac{\lbrack\text{ps}^{\text{-1}}\rbrack}{\lbrack\text{meV}\rbrack}\approx 0.065\text{ps}^{\text{-1}}</span></p>
</div><p>This parameter is available for the following analyses: <a class="reference external" href="#_Current_Correlation_Function">Current
Correlation Function</a>, <a class="reference external" href="#_Density_Of_States">Density of
States</a>, <a class="reference external" href="#_Dynamic_Coherent_Structure">Dynamic Coherent Structure
Factor</a>, <a class="reference external" href="#_Dynamic_Incoherent_Structure">Dynamic Incoherent Structure
Factor</a>, <a class="reference external" href="#_Gaussian_Dynamic_Incoherent">Gaussian Dynamic Incoherent
Structure Factor</a>, <a class="reference external" href="#_Neutron_Dynamic_Total">Neutron Dynamic
Total Structure Factor</a>, <a class="reference external" href="#_Structure_Factor_From">Structure Factor
From Scattering Function</a>.</p>
</section>
<section id="interpolation-order">
<h3>Interpolation order<a class="headerlink" href="#interpolation-order" title="Permalink to this heading"></a></h3>
<a class="reference internal image-reference" href="pages/Pictures/1000000100000323000002D1329469D922AFA541.png"><img alt="pages/Pictures/1000000100000323000002D1329469D922AFA541.png" src="pages/Pictures/1000000100000323000002D1329469D922AFA541.png" style="width: 15.921cm; height: 1.341cm;" /></a>
<p>Analyses that require atomic velocity data have an option to interpolate
this data from atomic positions. By default, no interpolation is
performed and instead MDANSE attempts to use the velocities stored int
the NetCDF trajectory. If an order is selected, MDANSE performs a
numerical differentiation of the positional data. There are options to
differentiate using 1<sup>st</sup> to 5<sup>th</sup> order.</p>
<ul class="simple">
<li><p>Order 1</p>
<ul>
<li><p>The first time-derivative of each point r(t<sub>i</sub>) is
calculated as</p></li>
</ul>
</li>
</ul>
<div class="math">
<p><span class="math">\begin{matrix}
{\overset{˙}{r}{\left( t_{i} \right) = \frac{r{\left( t_{i + 1} \right) - r}\left( t_{i} \right)}{\mathit{\Delta t}}}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}113} \right) \\
\end{matrix}</span></p>
</div><ul class="simple">
<li><ul>
<li><ul>
<li><p>Δt is the time step</p></li>
</ul>
</li>
</ul>
</li>
<li><p>Order N = {2, 3, 4, 5}</p>
<ul>
<li><p>MDANSE calculates the first time-derivative of each point
r(t<sub>i</sub>) (r = x,y,z) using the N-order polynomial,
interpolating the N+1 points across r(t<sub>i</sub>), where
r(t<sub>i</sub>) belongs to this set. Please see Ref
[<a class="reference external" href="#SignetBibliographie_036">36</a>] for more information.</p></li>
</ul>
</li>
</ul>
<p>Interpolation order is available for the following analyses: <a class="reference external" href="#_Current_Correlation_Function">Current
Correlation Function</a>, <a class="reference external" href="#_Density_Of_States">Density of
States</a>, <a class="reference external" href="#_Temperature">Temperature</a>,
<a class="reference external" href="#_Velocity_AutoCorrelation_Function">Velocity Auto Correlation
Function</a>. However, please note
that due to the nature of the <a class="reference external" href="#_Current_Correlation_Function">Current Correlation
Function</a> analysis, the interpolation
there is more complicated, the details of which can be found in its
<a class="reference external" href="#_GUI">section</a>.</p>
</section>
<section id="normalize">
<h3>Normalize<a class="headerlink" href="#normalize" title="Permalink to this heading"></a></h3>
<a class="reference internal image-reference" href="pages/Pictures/100000010000031F00000248D8781028790CCDA5.png"><img alt="pages/Pictures/100000010000031F00000248D8781028790CCDA5.png" src="pages/Pictures/100000010000031F00000248D8781028790CCDA5.png" style="width: 15.963cm; height: 1.094cm;" /></a>
<p>This parameter provides the option to normalise the results of the
analysis. By default, no normalisation is performed.</p>
<p>Normalisation is available for the following analyses: <a class="reference external" href="#_Current_Correlation_Function">Current
Correlation Function</a>, <a class="reference external" href="#_General_AutoCorrelation_Function">General Auto
Correlation Function</a>, <a class="reference external" href="#_Position_AutoCorrelation_Function">Position
Auto Correlation Function</a>,
<a class="reference external" href="#_Velocity_AutoCorrelation_Function">Velocity Auto Correlation
Function</a>.</p>
</section>
<section id="project-coordinates">
<h3>Project coordinates<a class="headerlink" href="#project-coordinates" title="Permalink to this heading"></a></h3>
<a class="reference internal image-reference" href="pages/Pictures/1000000100000323000002D1329469D922AFA541.png"><img alt="pages/Pictures/1000000100000323000002D1329469D922AFA541.png" src="pages/Pictures/1000000100000323000002D1329469D922AFA541.png" style="width: 15.552cm; height: 2.399cm;" /></a>
<p>Use this option to use only the projection of the atom coordinates on a
particular axis or plane. Note that the reference axis are the
orthonormal X, Y, Z axes, which in most cases correspond to the usual
axes of the simulation box. But if you have done a simulation using a
non-orthorombic box, remember that the projection is done using the
orthonormal X, Y, Z spatial axes as a reference, and not with the a, b,
c “crystal unit cell” ones.</p>
<p>This parameter is available for the following analyses: <a class="reference external" href="#_Density_Of_States">Density of
States</a>, <a class="reference external" href="#_Dynamic_Incoherent_Structure">Dynamic Incoherent Structure
Factor</a>, <a class="reference external" href="#_Elastic_Incoherent_Structure">Elastic Incoherent
Structure Factor</a>, <a class="reference external" href="#_Gaussian_Dynamic_Incoherent">Gaussian Dynamic
Incoherent Structure Factor</a>, <a class="reference external" href="#_Mean_Square_Displacement">Mean
Square Displacement</a>, <a class="reference external" href="#_Position_AutoCorrelation_Function">Position Auto
Correlation Function</a>, <a class="reference external" href="#_Velocity_AutoCorrelation_Function">Velocity
Auto Correlation Function</a>.</p>
</section>
<section id="weights">
<h3>Weights<a class="headerlink" href="#weights" title="Permalink to this heading"></a></h3>
<a class="reference internal image-reference" href="pages/Pictures/1000000100000323000002D1329469D922AFA541.png"><img alt="pages/Pictures/1000000100000323000002D1329469D922AFA541.png" src="pages/Pictures/1000000100000323000002D1329469D922AFA541.png" style="width: 15.921cm; height: 1.295cm;" /></a>
<p>Most of the analyses include a weights option. The default value depends
on the nature of the analysis. In many cases, it is set to ‘equal’,
indicating that all atoms in the system contribute with the same weight
to the computation of this property. But in scattering analysis, the
default is b<sub>coh</sub> for coherent and b<sup>2</sup><sub>inc</sub> for
incoherent analyses. In any case, if needed the user can select any
other numerical property from the MDANSE database to be used as
weighting factor.</p>
<p>The weights apply to the chemical elements present in the system and are
used to compute the total property. A particular analysis will compute
the desired property <em>P</em> either for all the different elements
identified in the system (in the case of a single particle analysis,
such as the mean square displacement, the velocity autocorrelation
function or the dynamic incoherent structure factor) or for all the
possible pairs of different elements (in the case of a collective
analysis such as the partial distribution function or the dynamic
coherent structure factor). The partials <em>P</em><sub>i</sub> or <em>P</em><sub>ij</sub>
are saved together with the total result, which is calculated as:</p>
<div class="math">
<p><span class="math">{P_{\mathit{total}} = \frac{\sum\limits_{i}{c_{i}w_{i}P}_{i}}{\sum\limits_{i}{c_{i}\left| w_{i} \right|}}}\text{or}{P_{\mathit{total}} = \frac{\sum\limits_{\mathit{ij}}{c_{i}{c_{j}w}_{i}w_{j}P}_{i}}{\sum\limits_{\mathit{ij}}{c_{i}c_{j}\left| w_{i} \right|\left| w_{j} \right|}}},</span></p>
</div><p>where the sum runs over the number of different chemical elements,
<em>c</em><sub>i</sub> is the number concentration of element <em>i</em> and
<em>w</em><sub>i</sub> its weight.</p>
<p>This parameter is available in the following analyses: <a class="reference external" href="#_Current_Correlation_Function">Current
Correlation Function</a>, <a class="reference external" href="#_Density_Of_States">Density of
States</a>, <a class="reference external" href="#_Density_Profile">Density
Profile</a>, <a class="reference external" href="#_Dynamic_Coherent_Structure">Dynamic Coherent Structure
Factor</a>, <a class="reference external" href="#_Dynamic_Incoherent_Structure">Dynamic Incoherent Structure
Factor</a>,
<a class="reference external" href="#_Eccentricity">Eccentricity</a>, <a class="reference external" href="#_Elastic_Incoherent_Structure">Elastic Incoherent Structure
Factor</a>, <a class="reference external" href="#_Gaussian_Dynamic_Incoherent">Gaussian Dynamic Incoherent
Structure Factor</a>, <a class="reference external" href="#_General_AutoCorrelation_Function">General Auto
Correlation Function</a>, <a class="reference external" href="#_Mean_Square_Displacement">Mean
Square Displacement</a>, <a class="reference external" href="#_Pair_Distribution_Function">Pair Distribution
Function</a>, <a class="reference external" href="#_Radius_Of_Gyration">Radius of
Gyration</a>, <a class="reference external" href="#_Rigid_Body_Trajectory">Rigid Body
Trajectory</a>, <a class="reference external" href="#_Root_Mean_Square">Root Mean Square
Deviation</a>, <a class="reference external" href="#_Static_Structure_Factor">Static Structure
Factor</a>, <a class="reference external" href="#_Velocity_AutoCorrelation_Function">Velocity Auto Correlation
Function</a>.</p>
</section>
<section id="running-mode">
<h3>Running mode<a class="headerlink" href="#running-mode" title="Permalink to this heading"></a></h3>
<a class="reference internal image-reference" href="pages/Pictures/10000001000003220000021BA346CFB73717C1BE.png"><img alt="pages/Pictures/10000001000003220000021BA346CFB73717C1BE.png" src="pages/Pictures/10000001000003220000021BA346CFB73717C1BE.png" style="width: 15.921cm; height: 1.605cm;" /></a>
<p>This parameter allows for the configuration of the number of processors
used to perform the analysis. By default, only one processor is used,
but if more are configured, MDANSE performs the analysis using parallel
processing, speeding it up.</p>
<p>Running mode is available for most analyses: all
<a class="reference external" href="#_Dynamics">Dynamics</a> analyses, all <a class="reference external" href="#_Trajectory">Trajectory</a>
analyses, all <a class="reference external" href="#_Thermodynamics">Thermodynamics</a> analyses, <a class="reference external" href="#_Area_Per_Molecule">Area Per
Molecule</a>, <a class="reference external" href="#_Coordination_Number">Coordination
Number</a>, <a class="reference external" href="#_Current_Correlation_Function">Current Correlation
Function</a>, <a class="reference external" href="#_Density_Profile">Density
Profile</a>, <a class="reference external" href="#_Dipole_AutoCorrelation_Function">Dipole Auto Correlation
Function</a>, <a class="reference external" href="#_Dynamic_Coherent_Structure">Dynamic Coherent
Structure Factor</a>, <a class="reference external" href="#_Dynamic_Incoherent_Structure">Dynamic Incoherent
Structure Factor</a>,
<a class="reference external" href="#_Eccentricity">Eccentricity</a>, <a class="reference external" href="#_Elastic_Incoherent_Structure">Elastic Incoherent Structure
Factor</a>, <a class="reference external" href="#_Gaussian_Dynamic_Incoherent">Gaussian Dynamic Incoherent
Structure Factor</a>, <a class="reference external" href="#_McStas_Virtual_Instrument">McStas Virtual
Instrument</a>, <a class="reference external" href="#_Molecular_Trace">Molecular
Trace</a>, <a class="reference external" href="#_Neutron_Dynamic_Total">Neutron Dynamic Total Structure
Factor</a>, <a class="reference external" href="#_Order_Parameter">Order
Parameter</a>, <a class="reference external" href="#_Pair_Distribution_Function">Pair Distribution
Function</a>, <a class="reference external" href="#_Radius_Of_Gyration">Radius of
Gyration</a>, <a class="reference external" href="#_Rigid_Body_Trajectory">Rigid Body
Trajectory</a>, <a class="reference external" href="#_Root_Mean_Square">Root Mean Square
Deviation</a>, <a class="reference external" href="#_Root_Mean_Square_1">Root Mean Square
Fluctuation</a>, <a class="reference external" href="#_Spatial_Density">Spatial
Density</a>, <a class="reference external" href="#_Static_Structure_Factor">Static Structure
Factor</a>, <a class="reference external" href="#_Voronoi">Voronoi</a>, <a class="reference external" href="#_Xray_Static_Structure">X-Ray
Static Structure Factor</a>.</p>
</section>
</section>
</section>
<section id="appendix-3">
<h1><strong>Appendix 3</strong><a class="headerlink" href="#appendix-3" title="Permalink to this heading"></a></h1>
<section id="plotting-options">
<h2>Plotting Options<a class="headerlink" href="#plotting-options" title="Permalink to this heading"></a></h2>
<section id="line-plotter">
<h3>Line Plotter<a class="headerlink" href="#line-plotter" title="Permalink to this heading"></a></h3>
<section id="toolbar-1">
<span id="id8"></span><h4>Toolbar<a class="headerlink" href="#toolbar-1" title="Permalink to this heading"></a></h4>
<p>Data plotted with the Line Plotter will have the following menu beneath
the graph:</p>
<a class="reference internal image-reference" href="pages/Pictures/10000001000002990000003D4AC033C3BBE338C0.png"><img alt="pages/Pictures/10000001000002990000003D4AC033C3BBE338C0.png" src="pages/Pictures/10000001000002990000003D4AC033C3BBE338C0.png" style="width: 15.921cm; height: 1.461cm;" /></a>
<p>The top-row buttons, going from left to right, have the following
functions:</p>
<ul class="simple">
<li><p><strong>Home</strong> restores the plot to the default position. Ie. if it has
been moved, zoomed in/out, axes adjusted, etc., it will be restored
to the position it was in when it was plotted. This position is one
MDANSE determined to be the best fit and shows all the data.</p></li>
</ul>
<p><a class="reference internal" href="pages/Pictures/10000001000004E6000002A73EEAE87D5C660F5C.png"><img alt="image35" src="pages/Pictures/10000001000004E6000002A73EEAE87D5C660F5C.png" style="width: 7.655cm; height: 4.159cm;" /></a><a class="reference internal" href="pages/Pictures/10000001000004E4000002A94202A3BFD79098BA.png"><img alt="image36" src="pages/Pictures/10000001000004E4000002A94202A3BFD79098BA.png" style="width: 7.465cm; height: 4.096cm;" /></a></p>
<ul class="simple">
<li><p><strong>Back</strong> undoes the latest action.</p></li>
<li><p><strong>Forward</strong> redoes the latest undone action.</p></li>
<li><p><strong>Pan</strong> gives the ability to use mouse to move the graph. After this
option is activated, you can drag the plot around to adjust what is
visible inside the axes. This mode can be disabled by clicking on its
icon again.</p></li>
<li><p><strong>Zoom</strong> gives the ability to zoom in. Once activated, you can select
an area inside the axes that will be zoomed in on. This mode can be
disabled by clicking on its icon again.</p></li>
<li><p><strong>Subplots</strong> opens the Configure subplots window, like the one below.
It can be used to adjust various parameters of the whole graph. The
red lines signify the original positions, while the blue bars show
the current value. The values can be adjusted by clicking inside the
relevant bar, and the blue bar will move to the clicked position.
PLEASE NOTE that whatever changes you make are automatically applied
and saved. There is no confirmation prompt when closing this window,
and when it is reopened, the red bars will move to the new positions.
The changes can only be reverted by using the <strong>Back</strong> or <strong>Home</strong>
buttons.</p></li>
</ul>
<a class="reference internal image-reference" href="pages/Pictures/10000001000002510000013F4553775FDA154299.png"><img alt="pages/Pictures/10000001000002510000013F4553775FDA154299.png" src="pages/Pictures/10000001000002510000013F4553775FDA154299.png" style="width: 13.033cm; height: 7.011cm;" /></a>
<ul class="simple">
<li><ul>
<li><p><strong>left</strong> moves the left vertical ax to change the size of the
plot.</p></li>
</ul>
</li>
</ul>
<a class="reference internal image-reference" href="pages/Pictures/10000001000005A3000003AC767D18B87ADC83B7.png"><img alt="pages/Pictures/10000001000005A3000003AC767D18B87ADC83B7.png" src="pages/Pictures/10000001000005A3000003AC767D18B87ADC83B7.png" style="width: 10.171cm; height: 6.625cm;" /></a>
<ul class="simple">
<li><ul>
<li><p><strong>bottom</strong> moves the bottom horizontal ax to change the size of
the plot.</p></li>
</ul>
</li>
</ul>
<a class="reference internal image-reference" href="pages/Pictures/10000001000005A5000003B1932A4B476DA84F50.png"><img alt="pages/Pictures/10000001000005A5000003B1932A4B476DA84F50.png" src="pages/Pictures/10000001000005A5000003B1932A4B476DA84F50.png" style="width: 10.202cm; height: 6.671cm;" /></a>
<ul class="simple">
<li><ul>
<li><p><strong>right</strong> moves the right vertical ax to change the size of the
plot.</p></li>
</ul>
</li>
</ul>
<a class="reference internal image-reference" href="pages/Pictures/10000001000005A5000003ABB1E8E9831A8AAA00.png"><img alt="pages/Pictures/10000001000005A5000003ABB1E8E9831A8AAA00.png" src="pages/Pictures/10000001000005A5000003ABB1E8E9831A8AAA00.png" style="width: 10.246cm; height: 6.659cm;" /></a>
<ul class="simple">
<li><ul>
<li><p><strong>top</strong> moves the top horizontal to change the size of the plot.</p></li>
</ul>
</li>
</ul>
<a class="reference internal image-reference" href="pages/Pictures/10000001000005A7000003ADE01DFF6A52D35724.png"><img alt="pages/Pictures/10000001000005A7000003ADE01DFF6A52D35724.png" src="pages/Pictures/10000001000005A7000003ADE01DFF6A52D35724.png" style="width: 10.388cm; height: 6.754cm;" /></a>
<ul class="simple">
<li><ul>
<li><p><strong>wspace</strong> changes the vertical spacing between multiple graphs
(matplotlib subplots)</p></li>
<li><p><strong>hspace</strong> changes the horizontal spacing between multiple graphs
(matplotlib subplots)</p></li>
</ul>
</li>
<li><p><strong>Save</strong> opens a file browser that allows you to save the graph in
one of these formats: EPS, PGF, PDF, PNG, PS, RAW, RGBA, SVG, or
SVGZ.</p></li>
</ul>
<p>Below this row of buttons is a field called Offset value, which allows
for changing the y-axis offset.</p>
</section>
<section id="right-click-menu">
<h4>Right-click menu<a class="headerlink" href="#right-click-menu" title="Permalink to this heading"></a></h4>
<p>Another way to adjust the plot is through a menu accessible through
right-clicking anywhere inside the tab:</p>
<a class="reference internal image-reference" href="pages/Pictures/10000001000000B60000008C820D1B058CFA1617.png"><img alt="pages/Pictures/10000001000000B60000008C820D1B058CFA1617.png" src="pages/Pictures/10000001000000B60000008C820D1B058CFA1617.png" style="width: 4.653cm; height: 3.514cm;" /></a>
<ul class="simple">
<li><p><strong>Clear</strong> removes all the lines from current graph. A prompt will
appear asking for confirmation before this happens.</p></li>
<li><p><strong>Export data</strong> opens a file browser that can be used to save the
data making up the graph. The exported data is in columns separated
by spaces. The adjustments made that affect the data itself, such as
changes in <a class="reference external" href="#_Units">units</a>, are applied. This option is useful if
you would like to plot the data using a software of your choice
rather than the MDANSE plotter.</p></li>
</ul>
</section>
<section id="general-settings">
<h4>General settings<a class="headerlink" href="#general-settings" title="Permalink to this heading"></a></h4>
<p>Clicking on General settings in the above menu opens this window:</p>
<a class="reference internal image-reference" href="pages/Pictures/100000010000021E0000013CBE1FC154D5CE9300.png"><img alt="pages/Pictures/100000010000021E0000013CBE1FC154D5CE9300.png" src="pages/Pictures/100000010000021E0000013CBE1FC154D5CE9300.png" style="width: 10.881cm; height: 6.244cm;" /></a>
<ul class="simple">
<li><p>Label</p>
<ul>
<li><p><strong>Title</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format;</em> str</p>
<p><em>Default:</em> None</p>
<p><em>Description:</em> sets a title for the graph. This will appear above the
figure.</p>
<ul class="simple">
<li><ul>
<li><p><strong>X Axis</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> str</p>
<p><em>Default:</em> the name of the variable plotted on the x-axis</p>
<p><em>Description:</em> sets the x-axis label. This will appear below the bottom
ax, to the left of the x-axis units. The <a class="reference external" href="#_Units">units</a> cannot be
formatted here, but they can be changed in <a class="reference external" href="#_Axes_settings">Axes
settings</a>.</p>
<ul class="simple">
<li><ul>
<li><p><strong>Y Axis</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> str</p>
<p><em>Default:</em> the name of the first plotted variable</p>
<p><em>Description:</em> sets the y-axis label. This will appear below the bottom
ax, to the left of the y-axis units. The <a class="reference external" href="#_Units">units</a> cannot be
formatted here, but they can be changed in <a class="reference external" href="#_Axes_settings">Axes
settings</a>.</p>
<ul class="simple">
<li><p>Legend</p>
<ul>
<li><p><strong>Show</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> bool</p>
<p><em>Default:</em> False</p>
<p><em>Description:</em> if ticked, causes the legend to appear.</p>
<ul class="simple">
<li><ul>
<li><p><strong>Location</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> drop-down</p>
<p><em>Default:</em> best</p>
<p><em>Description:</em> the location where the legend will appear on the graph.
Since MDANSE uses matplotlib for plotting, these options are all the
ones available in matplotlib and so function like those. For more
information, <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.legend.html">matplotlib
documentation</a>
might be of use.</p>
<ul class="simple">
<li><ul>
<li><p>Style</p>
<ul>
<li><p><strong>Frame on</strong></p></li>
</ul>
</li>
</ul>
</li>
</ul>
<p><em>Format:</em> bool</p>
<p><em>Default:</em> True</p>
<p><em>Description:</em> Adds a frame around the legend.</p>
<ul class="simple">
<li><ul>
<li><ul>
<li><p><strong>Fancy box</strong></p></li>
</ul>
</li>
</ul>
</li>
</ul>
<p><em>Format:</em> bool</p>
<p><em>Default:</em> False</p>
<p><em>Description:</em> Slightly changes the legend frame/shadow. Only works if
the frame is on.</p>
<ul class="simple">
<li><ul>
<li><ul>
<li><p><strong>Shadow</strong></p></li>
</ul>
</li>
</ul>
</li>
</ul>
<p><em>Format:</em> bool</p>
<p><em>Default:</em> True</p>
<p><em>Description:</em> Adds a shadow beneath the legend.</p>
<ul class="simple">
<li><p>Grid</p>
<ul>
<li><p><strong>Style</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> drop-down</p>
<p><em>Default:</em> None</p>
<p><em>Description:</em> decides how the grid should look.</p>
<ul class="simple">
<li><ul>
<li><p><strong>Width</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 1</p>
<p><em>Description:</em> the thickness of the lines making up the grid.</p>
<ul class="simple">
<li><ul>
<li><p><strong>Color</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> window</p>
<p><em>Default:</em> red</p>
<p><em>Description:</em> opens a window that allows for advanced colour selection.
The colour is the colour of the lines making up the grid.</p>
<ul class="simple">
<li><p><strong>Apply</strong> button applies the changes to the graph without closing the
window.</p></li>
</ul>
</section>
<section id="axes-settings">
<h4>Axes settings<a class="headerlink" href="#axes-settings" title="Permalink to this heading"></a></h4>
<p>The Axes settings button in the right-click menu opens the following
window:</p>
<a class="reference internal image-reference" href="pages/Pictures/100000010000028C000000C48CF73CD09B2E10B7.png"><img alt="pages/Pictures/100000010000028C000000C48CF73CD09B2E10B7.png" src="pages/Pictures/100000010000028C000000C48CF73CD09B2E10B7.png" style="width: 13.229cm; height: 3.866cm;" /></a>
<ul class="simple">
<li><p>Bounds</p>
<ul>
<li><p><strong>X Min</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> float</p>
<p><em>Default:</em> value corresponding to the best fit</p>
<p><em>Description:</em> the x value at which the y ax intercepts the x ax.</p>
<ul class="simple">
<li><ul>
<li><p><strong>Y Min</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> float</p>
<p><em>Default:</em> value corresponding to the best fit</p>
<p><em>Description:</em> the y value at which the x ax intercepts the y ax.</p>
<ul class="simple">
<li><ul>
<li><p><strong>X Max</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> float</p>
<p><em>Default:</em> value corresponding to the best fit</p>
<p><em>Description:</em> the x value denominating the right end of the graph</p>
<ul class="simple">
<li><ul>
<li><p><strong>Y Max</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> float</p>
<p><em>Default:</em> value corresponding to the best fit</p>
<p><em>Description:</em> the y value denominating the top end of the graph</p>
<ul class="simple">
<li><ul>
<li><p><strong>Auto fit</strong> button restores all the above values to their
defaults, ie. it adjusts the graph to the best fit, where all data
is visible and least white space is left. It automatically applies
the changes.</p></li>
</ul>
</li>
<li><p>Unit and Scale</p>
<ul>
<li><p><strong>X</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> str; drop-down</p>
<p><em>Default:</em> depends on physical quantity (more info in
<a class="reference external" href="#_Units">Units</a>); linear</p>
<p><em>Description:</em> the units that the data making up the graph is in. Both
the plot and the axis label are adjusted once Apply is pressed.</p>
<ul class="simple">
<li><ul>
<li><p><strong>Y</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> str; drop-down</p>
<p><em>Default:</em> depends on physical quantity (more info in
<a class="reference external" href="#_Units">Units</a>); linear</p>
<p><em>Description:</em> the units that the data making up the graph is in. Both
the plot and the axis label are adjusted once Apply is pressed.</p>
<ul class="simple">
<li><p><strong>Apply</strong> button applies the changes to the graph without closing the
window.</p></li>
</ul>
</section>
<section id="lines-settings">
<h4>Lines settings<a class="headerlink" href="#lines-settings" title="Permalink to this heading"></a></h4>
<p>The Lines settings button in the right-click menu opens the following
window:</p>
<a class="reference internal image-reference" href="pages/Pictures/10000001000001D0000001044A0C62B9A6078359.png"><img alt="pages/Pictures/10000001000001D0000001044A0C62B9A6078359.png" src="pages/Pictures/10000001000001D0000001044A0C62B9A6078359.png" style="width: 12.277cm; height: 6.879cm;" /></a>
<ul class="simple">
<li><p>The <strong>Lines</strong> box is a list of all lines in the figure. These lines
can be selected by clicking on them, which allows them to be
manipulated.</p></li>
<li><p><strong>Delete</strong> button deletes the line from the graph.</p></li>
<li><p><strong>Legend</strong></p></li>
</ul>
<p><em>Format:</em> str</p>
<p><em>Default:</em> the name of the selected line as it shows up in the Lines
block</p>
<p><em>Description:</em> the name of the line that appears in the legend.</p>
<ul class="simple">
<li><p><strong>Style</strong></p></li>
</ul>
<p><em>Format:</em> drop-down</p>
<p><em>Default:</em> -</p>
<p><em>Description:</em> determines how the line should look like.</p>
<ul class="simple">
<li><p><strong>Width</strong></p></li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 1</p>
<p><em>Description:</em> the width of the line.</p>
<ul class="simple">
<li><p><strong>Color</strong></p></li>
</ul>
<p><em>Format:</em> window</p>
<p><em>Default:</em> generated automatically by matplotlib</p>
<p><em>Description:</em> opens a window that allows for advanced colour selection.
Allows for changing the line colour.</p>
<ul class="simple">
<li><p><strong>Apply</strong> button applies the changes without closing the window.</p></li>
</ul>
</section>
</section>
<section id="image-plotter">
<h3>Image Plotter<a class="headerlink" href="#image-plotter" title="Permalink to this heading"></a></h3>
<p>At the bottom of an Image Plotter is the menu below. The functions of
the buttons, from left to right, is below that.</p>
<a class="reference internal image-reference" href="pages/Pictures/100000010000014A00000020C236E406689A15C0.png"><img alt="pages/Pictures/100000010000014A00000020C236E406689A15C0.png" src="pages/Pictures/100000010000014A00000020C236E406689A15C0.png" style="width: 8.731cm; height: 0.847cm;" /></a>
<ul class="simple">
<li><p><strong>Home</strong> restores the plot to the default position. Ie. if it has
been moved, zoomed in/out, axes adjusted, etc., it will be restored
to the position it was in when it was plotted. This position is one
MDANSE determined to be the best fit and shows all the data.</p></li>
</ul>
<p><a class="reference internal" href="pages/Pictures/1000000100000478000002C6F32754BFA135B144.png"><img alt="image37" src="pages/Pictures/1000000100000478000002C6F32754BFA135B144.png" style="width: 6.854cm; height: 4.255cm;" /></a><a class="reference internal" href="pages/Pictures/1000000100000483000002D2D853AC6BB7CFEA02.png"><img alt="image38" src="pages/Pictures/1000000100000483000002D2D853AC6BB7CFEA02.png" style="width: 6.791cm; height: 4.246cm;" /></a></p>
<ul class="simple">
<li><p><strong>Back</strong> undoes the latest action.</p></li>
<li><p><strong>Forward</strong> redoes the latest undone action.</p></li>
<li><p><strong>Pan</strong> gives the ability to use mouse to move the graph. After this
option is activated, you can drag the plot around to adjust what is
visible inside the axes. This mode can be disabled by clicking on its
icon again.</p></li>
<li><p><strong>Zoom</strong> gives the ability to zoom in. Once activated, you can select
an area inside the axes that will be zoomed in on. This mode can be
disabled by clicking on its icon again.</p></li>
<li><p><strong>Subplots</strong> opens the Configure subplots window, like the one below.
It can be used to adjust various parameters of the whole graph. The
red lines signify the original positions, while the blue bars show
the current value. The values can be adjusted by clicking inside the
relevant bar, and the blue bar will move to the clicked position.
PLEASE NOTE that whatever changes you make are automatically applied
and saved. There is no confirmation prompt when closing this window,
and when it is reopened, the red bars will move to the new positions.
The changes can only be reverted by using the <strong>Back</strong> or <strong>Home</strong>
buttons. (The illustrations are of a line plot, but exactly the same
happens to an Image Plot)</p></li>
</ul>
<a class="reference internal image-reference" href="pages/Pictures/10000001000002510000013F4553775FDA154299.png"><img alt="pages/Pictures/10000001000002510000013F4553775FDA154299.png" src="pages/Pictures/10000001000002510000013F4553775FDA154299.png" style="width: 13.033cm; height: 7.011cm;" /></a>
<ul class="simple">
<li><ul>
<li><p><strong>left</strong> moves the left vertical ax to change the size of the
plot.</p></li>
</ul>
</li>
</ul>
<a class="reference internal image-reference" href="pages/Pictures/10000001000005A7000003B03735117678BCB5D2.png"><img alt="pages/Pictures/10000001000005A7000003B03735117678BCB5D2.png" src="pages/Pictures/10000001000005A7000003B03735117678BCB5D2.png" style="width: 9.432cm; height: 6.152cm;" /></a>
<ul class="simple">
<li><ul>
<li><p><strong>bottom</strong> moves the bottom horizontal ax to change the size of
the plot.</p></li>
</ul>
</li>
</ul>
<a class="reference internal image-reference" href="pages/Pictures/10000001000005AB000003B801402409C04665A2.png"><img alt="pages/Pictures/10000001000005AB000003B801402409C04665A2.png" src="pages/Pictures/10000001000005AB000003B801402409C04665A2.png" style="width: 9.44cm; height: 6.195cm;" /></a>
<ul class="simple">
<li><ul>
<li><p><strong>right</strong> moves the right vertical ax to change the size of the
plot.</p></li>
</ul>
</li>
</ul>
<a class="reference internal image-reference" href="pages/Pictures/10000001000005A7000003B1D5499F0F48FF77D1.png"><img alt="pages/Pictures/10000001000005A7000003B1D5499F0F48FF77D1.png" src="pages/Pictures/10000001000005A7000003B1D5499F0F48FF77D1.png" style="width: 9.761cm; height: 6.375cm;" /></a>
<ul class="simple">
<li><ul>
<li><p><strong>top</strong> moves the top horizontal to change the size of the plot.</p></li>
</ul>
</li>
</ul>
<a class="reference internal image-reference" href="pages/Pictures/10000001000005A4000003B0CA26F7CCCE412711.png"><img alt="pages/Pictures/10000001000005A4000003B0CA26F7CCCE412711.png" src="pages/Pictures/10000001000005A4000003B0CA26F7CCCE412711.png" style="width: 9.931cm; height: 6.491cm;" /></a>
<ul class="simple">
<li><ul>
<li><p><strong>wspace</strong> changes the vertical spacing between multiple graphs
(matplotlib subplots)</p></li>
<li><p><strong>hspace</strong> changes the horizontal spacing between multiple graphs
(matplotlib subplots)</p></li>
</ul>
</li>
<li><p><strong>Save</strong> opens a file browser that allows you to save the graph in
one of these formats: EPS, PGF, PDF, PNG, PS, RAW, RGBA, SVG, or
SVGZ.</p></li>
<li><p><strong>Slicing mode</strong>, when ticked, allows you to select any point in the
plot. This point will remain marked by a cross (see below) on the
plot until Slicing mode is deactivated.</p></li>
</ul>
<a class="reference internal image-reference" href="pages/Pictures/1000000100000488000002C3774AD25EFC07291A.png"><img alt="pages/Pictures/1000000100000488000002C3774AD25EFC07291A.png" src="pages/Pictures/1000000100000488000002C3774AD25EFC07291A.png" style="width: 8.978cm; height: 5.472cm;" /></a>
<p>The selection also makes the following window to appear. There is no
limit to how many points may be selected, and each point will appear in
the window as different colour, corresponding to the colour of the
cross.</p>
<a class="reference internal image-reference" href="pages/Pictures/10000001000003C00000032DBE69F8276B9B91D5.png"><img alt="pages/Pictures/10000001000003C00000032DBE69F8276B9B91D5.png" src="pages/Pictures/10000001000003C00000032DBE69F8276B9B91D5.png" style="width: 9.253cm; height: 7.835cm;" /></a>
<p>The upper plot shows how value changes across the x-axis at the y-value
of the chosen point, while the bottom plot shows how the value changes
across the y-axis at the x-value of the chosen point.</p>
<p>The buttons in the bottom bar work the same as the corresponding buttons
in the Image Plot. The other buttons work thusly:</p>
<ul class="simple">
<li><p><strong>Auto Scale</strong> adjusts the y-axis so that it contains 0.</p></li>
<li><p><strong>Single target plot</strong> checkbox determines whether additional slices
should be added to the same ‘Cross slicing’ window. It does not take
effect immediately; if it is checked but the window is not closed,
additional cross slices will be added to the plots in the opened
window. However, if the box is checked then the window is closed, any
cross slices made will open a new window where all the previously
made slices are present plus the new one. In this case, the windows
corresponding to older slices are not altered.</p></li>
</ul>
<p>For illustration, if the box is unchecked or the window is not closed
after checking the box, only one ‘Cross slicing’ window will be open and
will change thusly (left to right) as further slices are performed:</p>
<p><a class="reference internal" href="pages/Pictures/10000001000003C2000003347082A5808C577BC7.png"><img alt="image39" src="pages/Pictures/10000001000003C2000003347082A5808C577BC7.png" style="width: 4.815cm; height: 4.105cm;" /></a><a class="reference internal" href="pages/Pictures/10000001000003C10000032F3AEF65741592C169.png"><img alt="image40" src="pages/Pictures/10000001000003C10000032F3AEF65741592C169.png" style="width: 4.904cm; height: 4.157cm;" /></a><a class="reference internal" href="pages/Pictures/10000001000003BF0000032F9CDC0562548E815A.png"><img alt="image41" src="pages/Pictures/10000001000003BF0000032F9CDC0562548E815A.png" style="width: 4.798cm; height: 4.076cm;" /></a></p>
<p>If the first window is closed after checking the box, new windows will
continue being created like so:</p>
<p><a class="reference internal" href="pages/Pictures/10000001000003C200000330E638C73D8C1D67D9.png"><img alt="image42" src="pages/Pictures/10000001000003C200000330E638C73D8C1D67D9.png" style="width: 5.239cm; height: 4.443cm;" /></a> <a class="reference internal" href="pages/Pictures/100000010000072F000003336ED265D0B6E3D58A.png"><img alt="image43" src="pages/Pictures/100000010000072F000003336ED265D0B6E3D58A.png" style="width: 9.844cm; height: 4.383cm;" /></a></p>
<section id="right-click-menu-1">
<span id="id9"></span><h4>Right-click menu<a class="headerlink" href="#right-click-menu-1" title="Permalink to this heading"></a></h4>
<p>By right-clicking anywhere inside the axes, the following menu will
appear:</p>
<a class="reference internal image-reference" href="pages/Pictures/10000001000000960000003931D40B39128A8083.png"><img alt="pages/Pictures/10000001000000960000003931D40B39128A8083.png" src="pages/Pictures/10000001000000960000003931D40B39128A8083.png" style="width: 3.969cm; height: 1.508cm;" /></a>
<ul class="simple">
<li><p><strong>Export data</strong> opens a file browser that can be used to save the
data making up the graph. The exported data is in columns separated
by spaces. The adjustments made that affect the data itself, such as
changes in <a class="reference external" href="#_Units">units</a>, are applied. This option is useful if
you would like to plot the data using a software of your choice
rather than the MDANSE plotter.</p></li>
</ul>
</section>
<section id="settings">
<h4>Settings<a class="headerlink" href="#settings" title="Permalink to this heading"></a></h4>
<p>By clicking on Setting, the following window will open:</p>
<a class="reference internal image-reference" href="pages/Pictures/100000010000014600000113C0E6204C6248BA0D.png"><img alt="pages/Pictures/100000010000014600000113C0E6204C6248BA0D.png" src="pages/Pictures/100000010000014600000113C0E6204C6248BA0D.png" style="width: 7.274cm; height: 6.137cm;" /></a>
<ul class="simple">
<li><p>Label</p>
<ul>
<li><p><strong>Title</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format;</em> str</p>
<p><em>Default:</em> None</p>
<p><em>Description:</em> sets a title for the graph. This will appear above the
figure.</p>
<ul class="simple">
<li><ul>
<li><p><strong>X Axis</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> str</p>
<p><em>Default:</em> the name of the variable plotted on the x-axis</p>
<p><em>Description:</em> sets the x-axis label. This will appear below the bottom
ax, to the left of the x-axis units. The <a class="reference external" href="#_Units">units</a> cannot be
formatted here, but they can be changed in <a class="reference external" href="#_Axes_settings">Axes
settings</a>.</p>
<ul class="simple">
<li><ul>
<li><p><strong>Y Axis</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> str</p>
<p><em>Default:</em> the name of the first plotted variable</p>
<p><em>Description:</em> sets the y-axis label. This will appear below the bottom
ax, to the left of the y-axis units. The <a class="reference external" href="#_Units">units</a> cannot be
formatted here, but they can be changed in <a class="reference external" href="#_Axes_settings">Axes
settings</a>.</p>
<ul class="simple">
<li><p>Aspect</p>
<ul>
<li><p><strong>Proportions</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> drop-down</p>
<p><em>Default:</em> auto</p>
<p>Description: changes how the scale of the x-axis and y-axis is related.
’auto’ automatically decides how to fit the plot, while ‘equal’ makes
both axes range between the same values.</p>
<ul class="simple">
<li><p><strong>interpolation order</strong></p></li>
</ul>
<p><em>Format:</em> drop-down</p>
<p><em>Default:</em> Nearest</p>
<p><em>Description:</em> the algorithm to use for image scaling. For more
information, see matplotlib documentation
[<a class="reference external" href="#SignetBibliographie_037">37</a>].</p>
<ul class="simple">
<li><ul>
<li><p><strong>Scale</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> drop-down</p>
<p><em>Default:</em> none</p>
<p><em>Description:</em> changes the scale of the axes.</p>
<ul class="simple">
<li><p>Units</p>
<ul>
<li><p><strong>X</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> str</p>
<p><em>Default:</em> depends on physical quantity (more info in
<a class="reference external" href="#_Units">Units</a>)</p>
<p><em>Description:</em> the units that the data making up the graph is in. Both
the plot and the axis label are adjusted once Apply is pressed.</p>
<ul class="simple">
<li><ul>
<li><p><strong>Y</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> str</p>
<p><em>Default:</em> depends on physical quantity (more info in
<a class="reference external" href="#_Units">Units</a>)</p>
<p><em>Description:</em> the units that the data making up the graph is in. Both
the plot and the axis label are adjusted once Apply is pressed.</p>
<ul class="simple">
<li><p><strong>Apply</strong> button applies the changes without closing the window.</p></li>
</ul>
</section>
</section>
<section id="elevation-plotter">
<h3>Elevation Plotter<a class="headerlink" href="#elevation-plotter" title="Permalink to this heading"></a></h3>
<p>An elevation plot should look like this when opened:</p>
<a class="reference internal image-reference" href="pages/Pictures/100000010000029600000246AC569286636CD2E9.png"><img alt="pages/Pictures/100000010000029600000246AC569286636CD2E9.png" src="pages/Pictures/100000010000029600000246AC569286636CD2E9.png" style="width: 11.158cm; height: 9.809cm;" /></a>
<p>You can use the mouse to drag the plot around to change the perspective,
a bit similar to how Pan would behave in Image Plotter when activated.
The plot can be zoomed in or out using the scrolling wheel or touchpad.</p>
<p>The <strong>Scaling Panel</strong> in the toolbar can be used to change the size of
the plot, either along x-axis or y-axis, depending on which part is
used. Please note, however, that it is possible that only a part of the
plot is initially visible, meaning the changes on screen are only a
side-effect of actual changes. Both the input field and the sliding bar
achieve the same purpose.</p>
<p>The <strong>Elevation Panel</strong> changes the contrast of the colours in the plot.
Both the input field and the sliding bar achieve the same purpose.</p>
<p>The <strong>Save current view</strong> button opens a file browse, allowing the
current contents of the screen (inside the plot, ie. not toolbar) to be
saved as a PNG file.</p>
</section>
<section id="d-slice-plotter">
<h3>2D Slice Plotter<a class="headerlink" href="#d-slice-plotter" title="Permalink to this heading"></a></h3>
<p>This plotter was created to help visualising the 3D trajectory
variables, configuration, velocities, and gradients. It creates a 2D
plot of a 3D variable. Therefore, extra setup is required before it can
be used, and so it looks as follows in the Data panel:</p>
<a class="reference internal image-reference" href="pages/Pictures/10000001000001880000005ADE46A25EFC1A049F.png"><img alt="pages/Pictures/10000001000001880000005ADE46A25EFC1A049F.png" src="pages/Pictures/10000001000001880000005ADE46A25EFC1A049F.png" style="width: 8.209cm; height: 1.886cm;" /></a>
<ul class="simple">
<li><p><strong>Dim</strong></p></li>
</ul>
<p><em>Format:</em> positive int</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> the dimension that will appear as the colour gradient in
the plot. The other two dimensions will be plotted on the x and y axes
of the plot. Only values 0, 1, and 2 are accepted. Which dimension is
which number can be determined from the ‘Axis’ column in the Data panel
if it is populated, or the ‘Size’ column if the former is not. The
dimensions are assigned number in the order in which they appear, so,
e.g., if ‘Axis’ column shows ‘time,atom,dim’, then time is 0, atom is 1,
and dim is 3.</p>
<ul class="simple">
<li><p><strong>Slice</strong></p></li>
</ul>
<p><em>Format:</em> positive int</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> the part of the dimension that is plotted. Only values
from 0 to the size of the dimension are accepted. For example, if Dim
corresponding to the dimension of the configuration variable (i.e., the
x, y, or z component) is selected, then the Slice field corresponds to
those x/y/z components. Thus, if in this example, we select Slice of 1
(i.e., the y component), then we get a 2D plot with time and the number
of atoms on the x and y axes, and the colour gradient corresponds to the
y-component of the position vectors (picture below).</p>
<p>When this plotter is configured with the above options and plotted, a
plot similar to below will be obtained.</p>
<a class="reference internal image-reference" href="pages/Pictures/10000001000005E8000003AB85875262BA140476.png"><img alt="pages/Pictures/10000001000005E8000003AB85875262BA140476.png" src="pages/Pictures/10000001000005E8000003AB85875262BA140476.png" style="width: 15.921cm; height: 9.887cm;" /></a>
<p>For the description of the various manipulations of this plot, please
see <a class="reference external" href="#_Image_Plotter">Image Plotter</a>. 2D Slice Plotter uses Image
Plotter under the hood, meaning that the various options are identical.</p>
</section>
<section id="iso-surface-plotter">
<h3>Iso Surface Plotter<a class="headerlink" href="#iso-surface-plotter" title="Permalink to this heading"></a></h3>
<p>When opened, this plotter might look like this:</p>
<a class="reference internal image-reference" href="pages/Pictures/100000010000029900000248508AD1513B39D1F0.png"><img alt="pages/Pictures/100000010000029900000248508AD1513B39D1F0.png" src="pages/Pictures/100000010000029900000248508AD1513B39D1F0.png" style="width: 12.965cm; height: 11.386cm;" /></a>
<p>You can use the mouse to drag the plot around to move the 3D picture.
The plot can be zoomed in or out using the scrolling wheel or touchpad.</p>
<ul class="simple">
<li><p><strong>Rendering mode</strong></p></li>
</ul>
<p><em>Format:</em> drop-down</p>
<p><em>Default:</em> line</p>
<p><em>Description:</em> changes which geometric shapes (points, lines, surface)
is used to display the surface.</p>
<ul class="simple">
<li><p><strong>Opacity level</strong></p></li>
</ul>
<p><em>Format:</em> float of value 0-1</p>
<p><em>Default:</em> 1.0</p>
<p><em>Description:</em> changes the opacity/transparency of the objects used to
display the surface.</p>
<ul class="simple">
<li><p><strong>Contour Level</strong></p></li>
</ul>
<p><em>Format:</em> sliding bar</p>
<p><em>Default:</em> middle</p>
<p><em>Description:</em> changes how much space the shapes making the surface
take. &lt;insert&gt;</p>
<ul class="simple">
<li><p><strong>Slice orientation</strong></p></li>
</ul>
<p><em>Format:</em> multiple choice</p>
<p><em>Default:</em> None</p>
<p><em>Description:</em> adds a coloured plane described by the shown axes that
slices through the surface. After clicking on the plot, the plane can be
moved along the axis not mentioned in the chosen plane’s name by using +
and – keys.</p>
<ul class="simple">
<li><p><strong>Save current view</strong> button opens a file browser that allows the
current view to be saved as a PNG file.</p></li>
</ul>
</section>
<section id="scalar-field-plotter">
<h3>Scalar-Field Plotter<a class="headerlink" href="#scalar-field-plotter" title="Permalink to this heading"></a></h3>
<p>&lt;insert&gt;</p>
</section>
</section>
<section id="units">
<h2>Units<a class="headerlink" href="#units" title="Permalink to this heading"></a></h2>
<p>The units used by MDANSE are nm for length and ps for time, and their
inverses for Q (nm<sup>1</sup>) and angular frequencies, 
(ps<sup>1</sup>). Any input must be given using these units, and the
output files do also employ the same units. The 2D/3D plotter includes
the Python magnitude module, so you can modify the units when plotting
the results using the <a class="reference external" href="#_Axes_settings">Axes settings</a> (available
from the context menu that appears by right clicking on the plot). If
you use the export option in the graphic after having changed the units,
your output file will be saved with the desired units. But remember that
the original output file (typically a netCDF4) is written using the
original standard units.</p>
<p>The list of prefixes to physical quantities is listed in <a class="reference external" href="#anchor-339">Table
1</a>. The leftmost column is what can be written in front
of the symbol of a physical quantity.</p>
<p>Table 1: A list of prefixes that can be used to modify units.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 38%" />
<col style="width: 31%" />
<col style="width: 31%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Symbol</p></td>
<td><p>Name</p></td>
<td><p>Value</p></td>
</tr>
<tr class="row-even"><td><p>y</p></td>
<td><p>yocto</p></td>
<td><p>1e-24</p></td>
</tr>
<tr class="row-odd"><td><p>z</p></td>
<td><p>zepto</p></td>
<td><p>1e-21</p></td>
</tr>
<tr class="row-even"><td><p>a</p></td>
<td><p>atto</p></td>
<td><p>1e-18</p></td>
</tr>
<tr class="row-odd"><td><p>f</p></td>
<td><p>femto</p></td>
<td><p>1e-15</p></td>
</tr>
<tr class="row-even"><td><p>p</p></td>
<td><p>pico</p></td>
<td><p>1e-12</p></td>
</tr>
<tr class="row-odd"><td><p>n</p></td>
<td><p>nano</p></td>
<td><p>1e-9</p></td>
</tr>
<tr class="row-even"><td><p>u</p></td>
<td><p>micro</p></td>
<td><p>1e-6</p></td>
</tr>
<tr class="row-odd"><td><p>m</p></td>
<td><p>mili</p></td>
<td><p>1e-3</p></td>
</tr>
<tr class="row-even"><td><p>c</p></td>
<td><p>centi</p></td>
<td><p>1e-2</p></td>
</tr>
<tr class="row-odd"><td><p>d</p></td>
<td><p>deci</p></td>
<td><p>1e-1</p></td>
</tr>
<tr class="row-even"><td><p>da</p></td>
<td><p>deca</p></td>
<td><p>1e1</p></td>
</tr>
<tr class="row-odd"><td><p>h</p></td>
<td><p>hecto</p></td>
<td><p>1e2</p></td>
</tr>
<tr class="row-even"><td><p>k</p></td>
<td><p>kilo</p></td>
<td><p>1e3</p></td>
</tr>
<tr class="row-odd"><td><p>M</p></td>
<td><p>mega</p></td>
<td><p>1e6</p></td>
</tr>
<tr class="row-even"><td><p>G</p></td>
<td><p>giga</p></td>
<td><p>1e9</p></td>
</tr>
<tr class="row-odd"><td><p>T</p></td>
<td><p>tera</p></td>
<td><p>1e12</p></td>
</tr>
<tr class="row-even"><td><p>P</p></td>
<td><p>peta</p></td>
<td><p>1e15</p></td>
</tr>
<tr class="row-odd"><td><p>E</p></td>
<td><p>exa</p></td>
<td><p>1e18</p></td>
</tr>
<tr class="row-even"><td><p>Z</p></td>
<td><p>zetta</p></td>
<td><p>1e21</p></td>
</tr>
<tr class="row-odd"><td><p>Y</p></td>
<td><p>yotta</p></td>
<td><p>1e24</p></td>
</tr>
</tbody>
</table>
<p>All these prefixes can be used with any of the units from <a class="reference external" href="#anchor-340">Table
2</a>. All these units can also be accessed through the
<a class="reference external" href="#_Unites_Editor">Units Editor</a>.</p>
<p>Table 2: A list of all units that can be used in MDANSE.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 26%" />
<col style="width: 26%" />
<col style="width: 26%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>Symbol</strong></p></td>
<td><p><strong>Unit</strong></p></td>
<td><p><strong>Value in SI
units</strong></p></td>
<td><p><strong>Physical
quantity</strong></p></td>
</tr>
<tr class="row-even"><td><p>au</p></td>
<td><p>atomic unit</p></td>
<td><p>0</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>m</p></td>
<td><p>meter</p></td>
<td><p>1 m</p></td>
<td><p>length</p></td>
</tr>
<tr class="row-even"><td><p>ang</p></td>
<td><p>Angstrom</p></td>
<td><p>1 *
10<sup>-10</sup>
m</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>ft</p></td>
<td><p>foot</p></td>
<td><p>0.3048 m</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>inch</p></td>
<td><p>inch</p></td>
<td><p>0.0254 m</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>ly</p></td>
<td><p>light year</p></td>
<td><p>9.
460,730,472,58
*
10<sup>15</sup>
m</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>b</p></td>
<td><p>Barn</p></td>
<td><p>1 *
10<sup>-28</sup>
m<sup>2</sup></p></td>
<td><p>surface</p></td>
</tr>
<tr class="row-odd"><td><p>l</p></td>
<td><p>litre</p></td>
<td><p>1 *
10<sup>-3</sup>
m<sup>3</sup></p></td>
<td><p>volume</p></td>
</tr>
<tr class="row-even"><td><p>s</p></td>
<td><p>second</p></td>
<td><p>1 s</p></td>
<td><p>time</p></td>
</tr>
<tr class="row-odd"><td><p>year</p></td>
<td><p>year</p></td>
<td><p>3
1,556,925.9747
s</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>day</p></td>
<td><p>day</p></td>
<td><p>86400 s</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>h</p></td>
<td><p>hour</p></td>
<td><p>3600 s</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>min</p></td>
<td><p>minute</p></td>
<td><p>60 s</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>kg</p></td>
<td><p>kilogram</p></td>
<td><p>1 kg</p></td>
<td><p>mass</p></td>
</tr>
<tr class="row-even"><td><p>g</p></td>
<td><p>gram</p></td>
<td><p>1 *
10<sup>-3</sup>
kg</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>uma</p></td>
<td><p>unified mass
unit</p></td>
<td><p>1.660,540,2 *
10<sup>-27</sup>
kg</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>mol</p></td>
<td><p>mole</p></td>
<td><p>1 mol</p></td>
<td><p>amount of mass</p></td>
</tr>
<tr class="row-odd"><td><p>J</p></td>
<td><p>Joule</p></td>
<td><p>1 kg
m<sup>2</sup>
s<sup>-2</sup></p></td>
<td><p>energy</p></td>
</tr>
<tr class="row-even"><td><p>eV</p></td>
<td><p>electron volt</p></td>
<td><p>1.602,176,49
*
10<sup>-19</sup>
kg m<sup>2</sup>
s<sup>-2</sup></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>cal</p></td>
<td><p>calorie</p></td>
<td><p>4.184 kg
m<sup>2</sup>
s<sup>-2</sup></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>cal_per_mole</p></td>
<td><p>calorie per
mole</p></td>
<td><p>6.947,78 *
10<sup>-24</sup>
kg m<sup>2</sup>
s<sup>-2</sup>
mol<sup>-1</sup></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>J_per_mole</p></td>
<td><p>Joule per mole</p></td>
<td><p>1.
660,559,273,42
*
10<sup>-24</sup>
kg m<sup>2</sup>
s<sup>-2</sup>
mol<sup>-1</sup></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Ha</p></td>
<td><p>Hartree</p></td>
<td><p>4.359,743,94
*
10<sup>-18</sup>
kg m<sup>2</sup>
s<sup>-2</sup></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>K</p></td>
<td><p>Kelvin</p></td>
<td><p>1 K</p></td>
<td><p>temperature</p></td>
</tr>
<tr class="row-even"><td><p>N</p></td>
<td><p>Newton</p></td>
<td><p>1 kg m
s<sup>-2</sup></p></td>
<td><p>force</p></td>
</tr>
<tr class="row-odd"><td><p>Pa</p></td>
<td><p>Pascal</p></td>
<td><p>1 kg
m<sup>-1</sup>
s<sup>-2</sup></p></td>
<td><p>pressure</p></td>
</tr>
<tr class="row-even"><td><p>W</p></td>
<td><p>Watt</p></td>
<td><p>1 kg
m<sup>2</sup>
s<sup>-3</sup></p></td>
<td><p>power</p></td>
</tr>
<tr class="row-odd"><td><p>Hz</p></td>
<td><p>Hertz</p></td>
<td><p>1 s<sup>-1</sup></p></td>
<td><p>frequency</p></td>
</tr>
<tr class="row-even"><td><p>A</p></td>
<td><p>Ampere</p></td>
<td><p>1 A</p></td>
<td><p>electric
current</p></td>
</tr>
<tr class="row-odd"><td><p>C</p></td>
<td><p>Coulomb</p></td>
<td><p>1 A s</p></td>
<td><p>charge</p></td>
</tr>
<tr class="row-even"><td><p>V</p></td>
<td><p>Volt</p></td>
<td><p>1 kg
m<sup>2</sup>
s<sup>-3</sup>
A<sup>-1</sup></p></td>
<td><p>voltage</p></td>
</tr>
<tr class="row-odd"><td><p>F</p></td>
<td><p>Farad</p></td>
<td><p>1 s<sup>4</sup>
A<sup>2</sup>
kg<sup>-1</sup>
m<sup>-2</sup></p></td>
<td><p>capacitance</p></td>
</tr>
<tr class="row-even"><td><p>ohm</p></td>
<td><p>Ohm</p></td>
<td><p>1 kg
m<sup>2</sup>
s<sup>-3</sup>
A<sup>-2</sup></p></td>
<td><p>resistance</p></td>
</tr>
<tr class="row-odd"><td><p>S</p></td>
<td><p>Siemens</p></td>
<td><p>1 s<sup>3</sup>
A<sup>2</sup>
kg<sup>-1</sup>
m<sup>-2</sup></p></td>
<td><p>conductance</p></td>
</tr>
<tr class="row-even"><td><p>Wb</p></td>
<td><p>Weber</p></td>
<td><p>1 kg
m<sup>2</sup>
s<sup>-2</sup>
A<sup>-1</sup></p></td>
<td><p>magnetic flux</p></td>
</tr>
<tr class="row-odd"><td><p>T</p></td>
<td><p>Tesla</p></td>
<td><p>1 kg
s<sup>-2</sup>
A<sup>-1</sup></p></td>
<td><p>flux density</p></td>
</tr>
<tr class="row-even"><td><p>H</p></td>
<td><p>Henry</p></td>
<td><p>1 kg
m<sup>2</sup>
s<sup>-2</sup>
A<sup>-2</sup></p></td>
<td><p>inductance</p></td>
</tr>
<tr class="row-odd"><td><p>cd</p></td>
<td><p>Candela</p></td>
<td><p>1 cd</p></td>
<td><p>luminous
intensity</p></td>
</tr>
<tr class="row-even"><td><p>lm</p></td>
<td><p>Lumen</p></td>
<td><p>1 cd sr</p></td>
<td><p>luminous flux</p></td>
</tr>
<tr class="row-odd"><td><p>lux</p></td>
<td><p>lux</p></td>
<td><p>1 cd sr
m<sup>-2</sup></p></td>
<td><p>illuminance</p></td>
</tr>
<tr class="row-even"><td><p>Bq</p></td>
<td><p>Becquerel</p></td>
<td><p>1 s<sup>-1</sup></p></td>
<td><p>radioactivity</p></td>
</tr>
<tr class="row-odd"><td><p>Gy</p></td>
<td><p>gray</p></td>
<td><p>1 m<sup>2</sup>
s<sup>-2</sup></p></td>
<td><p>ionising
radiation</p></td>
</tr>
<tr class="row-even"><td><p>kat</p></td>
<td><p>Katal</p></td>
<td><p>1 mol
s<sup>-1</sup></p></td>
<td><p>catalytic
activity</p></td>
</tr>
<tr class="row-odd"><td><p>dpi</p></td>
<td><p>inches in
meter</p></td>
<td><p>39.370,
078,740,157,48
m<sup>-1</sup></p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>gravity</p></td>
<td><p>gravitational
constant</p></td>
<td><p>9.80665 m
s<sup>-2</sup></p></td>
<td><p>acceleration</p></td>
</tr>
<tr class="row-odd"><td><p>c</p></td>
<td><p>speed of light</p></td>
<td><p>2.997,924,58
*
10<sup>8</sup> m
s<sup>-1</sup></p></td>
<td><p>velocity</p></td>
</tr>
<tr class="row-even"><td><p>rad</p></td>
<td><p>radian</p></td>
<td><p>1 rad</p></td>
<td><p>angle</p></td>
</tr>
<tr class="row-odd"><td><p>cyc</p></td>
<td><p>cycle</p></td>
<td><p>6.283,1
85,307,179,586
rad</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>sr</p></td>
<td><p>steradian</p></td>
<td><p>1 sr</p></td>
<td><p>solid angle</p></td>
</tr>
<tr class="row-odd"><td><p>inv_nm</p></td>
<td><p>inverse nm</p></td>
<td><p>1 *
10<sup>9</sup>
m<sup>-1</sup></p></td>
<td><p>Inverse length</p></td>
</tr>
<tr class="row-even"><td><p>akma_time</p></td>
<td><p>AKMA time</p></td>
<td><p>20.454,
829,497,745,98
*
10<sup>-12</sup>
s</p></td>
<td><p>time</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="appendix-4">
<span id="section-1"></span><h1>Appendix 4<a class="headerlink" href="#appendix-4" title="Permalink to this heading"></a></h1>
<section id="building-mdanse-from-source-code">
<h2>Building MDANSE from source code<a class="headerlink" href="#building-mdanse-from-source-code" title="Permalink to this heading"></a></h2>
<p>MDANSE is an open-source software, and so the source code is widely
available. Currently, it is hosted by ISIS at GitHub
[<a class="reference external" href="#SignetBibliographie_038">38</a>]. The code can be freely altered and
distributed as per the GPL-3.0 license that it is licensed under. All
the necessary information is present in the repository. In any case
though, to access the very latest features that have not been released
via an executable, or to make custom alterations to the code, it is
necessary to build MDANSE from source code. Below are instructions on
how to do that on major platforms using Python 2. Please note that as of
writing this guide, MDANSE is compatible only with Python 2, but works
are under way to transfer MDANSE to Python 3, so in the future the code
in the repository may require different compilation instructions.</p>
<section id="windows-2">
<span id="id10"></span><h3>Windows<a class="headerlink" href="#windows-2" title="Permalink to this heading"></a></h3>
<p>To build MDANSE on Windows, the following software will have to be
downloaded and installed. All three programs have executables which can
be used in the typical windows fashion.</p>
<ul class="simple">
<li><p>Miniconda [<a class="reference external" href="#SignetBibliographie_039">39</a>] (or any other conda
installation)</p></li>
<li><p>Microsoft Visual Studio 2008 [<a class="reference external" href="#SignetBibliographie_040">40</a>]</p>
<ul>
<li><p>If MDANSE is to be built on an x64 system, during this
installation, the ‘x64 Compilers and Tools’ option has to be
selected. Alternatively, the complete installation can be
selected, which will install all parts including this one.</p></li>
</ul>
</li>
</ul>
<p>Then, download the following wheels from Ref
[<a class="reference external" href="#SignetBibliographie_041">41</a>], selecting the appropriate version
based on your architecture. The asterisks in the names stand for
architecture.</p>
<ul class="simple">
<li><p>wxPython_common‑3.0.2.0‑py2‑none‑any.whl</p></li>
<li><p>wxPython‑3.0.2.0‑cp27‑none‑win*.whl</p></li>
<li><p>PyQt4-4.11.4-cp27-cp27m-win*.whl</p></li>
<li><p>VTK-6.3.0-cp27-cp27m-win*.whl</p></li>
</ul>
<p>Afterwards, a virtual environment can be created and the wheels as well
as other dependencies can be installed into it.</p>
<p>conda create –name envname python=2.7</p>
<p>conda activate envname</p>
<p>conda install h5py netCDF4</p>
<p>pip install numpy==1.16.6 matplotlib==2.2.5 Cython==0.29.24 Pyro
wxPython_common‑3.0.2.0‑py2‑none‑any.whl
wxPython‑3.0.2.0‑cp27‑none‑win_amd64.whl
VTK‑6.3.0‑cp27‑cp27m‑win_amd64.whl PyQt4‑4.11.4‑cp27‑cp27m‑win_amd64.whl</p>
<p>Then, ScientificPython can be installed into the virtual environment.
This has to be done from source, using an ILL version of
ScientificPython.</p>
<p>git clone <a class="reference external" href="https://code.ill.fr/scientific-software/scientific-python.git">https://code.ill.fr/scientific-software/scientific-python.git</a></p>
<p>cd scientific-python</p>
<p>python setup.py –netcdf_prefix=dir_h –netcdf_dll=dir_dll build install</p>
<p>In the second line, dir_h stands for the directory where the netcdf.h
file exists, and dir_dll for the location of netcdf.dll. The location of
both these files is inside the environment. If Miniconda was installed
into the default location, the .h file should be located in
C:\Users\username\Miniconda\envs\envname\Library\include\ and
.dll in C:\Users\username\Miniconda\envs\envname\Library\bin\
where username and envname are variable.</p>
<p>If an error is encountered pointing out that the location of netcdf.lib
file cannot be found, then the setup.py file has to be edited. Changing
the line 86, which should read netcdf_lib = netcdf_dll, to netcdf_lib =
r’path’, where path is the path to said file should fix the issue.
Alternatively, the line can be replaced with the following code:</p>
<p>if os.path.exists(os.path.join(netcdf_dll, ‘netcdf.lib’)):</p>
<p>netcdf_lib = netcdf_dll</p>
<p>elif os.path.exists(os.path.join(os.path.dirname(netcdf_dll), ‘lib’,
‘netcdf.lib’)):</p>
<p>netcdf_lib = os.path.join(os.path.dirname(netcdf_dll), ‘lib’)</p>
<p>else:</p>
<p>print “netcdf.lib could not be found”</p>
<p>raise SystemExit</p>
<p>Any other errors can be attempted to be solved by running “C:\Program
Files (x86)\Microsoft Visual Studio 9.0\VC\bin\vcvars32.bat” on x32
systems and “C:\Program Files (x86)\Microsoft Visual Studio
9.0\VC\bin\amd64\vcvarsamd64.bat” on x64 systems. If a missing
vcvarsall.bat error is encountered after that, Visual Studio 2008 might
have to be reinstalled (not to forget to install the x64 Tools).</p>
<p>Once ScientificPython is installed successfully, MMTK and MDANSE can be
built and installed from source.</p>
<p>git clone <a class="reference external" href="https://code.ill.fr/scientific-software/mmtk.git">https://code.ill.fr/scientific-software/mmtk.git</a></p>
<p>cd mmtk</p>
<p>python setup.py install</p>
<p>git clone <a class="reference external" href="https://github.com/ISISNeutronMuon/MDANSE.git">https://github.com/ISISNeutronMuon/MDANSE.git</a></p>
<p>cd MDANSE</p>
<p>python setup.py build install</p>
<p>After that, MDANSE can be used from command line as per usual, and the
GUI can be started by running</p>
<p>python path\envname\Scripts\mdanse_gui</p>
</section>
<section id="macos-2">
<span id="id11"></span><h3>MacOS<a class="headerlink" href="#macos-2" title="Permalink to this heading"></a></h3>
<p>Like on Windows, on MacOS the easiest way to build MDANSE is to use
conda all the way, which can be downloaded from Ref
[<a class="reference external" href="#SignetBibliographie_042">42</a>]. A virtualenv/venv environment can
be used but conda still has to be used to download multiple packages
unless they are built from source. This guide uses conda fully.</p>
<p>First, create a conda virtual environment and install dependencies
(envname can be whatever name desirable for the environment).</p>
<p>conda create –name envname python=2.7</p>
<p>conda activate envname</p>
<p>conda install h5py netCDF4</p>
<p>pip install numpy==1.16.6 matplotlib==2.2.5 Cython==0.29.24 Pyro pyyaml</p>
<p>sudo conda install -y -c daf wxpython</p>
<p>sudo conda install -y -c ccordoba12 vtk</p>
<p>Afterwards, ScientificPython, MMTK, and MDANSE can be built and
installed from source code. Please note that the NETCDF_HEADER_FILE_PATH
below has to be set to the location of the directory of netcdf.h.</p>
<p>export
NETCDF_HEADER_FILE_PATH=/Users/username/Miniconda/envs/envname/include</p>
<p>git clone <a class="reference external" href="https://code.ill.fr/scientific-software/scientific-python.git">https://code.ill.fr/scientific-software/scientific-python.git</a></p>
<p>cd scientific-python/</p>
<p>python setup.py install</p>
<p>git clone <a class="reference external" href="https://code.ill.fr/scientific-software/mmtk.git">https://code.ill.fr/scientific-software/mmtk.git</a></p>
<p>cd mmtk</p>
<p>spython setup.py install</p>
<p>git clone <a class="reference external" href="https://github.com/ISISNeutronMuon/MDANSE.git">https://github.com/ISISNeutronMuon/MDANSE.git</a></p>
<p>cd MDANSE</p>
<p>python setup.py install</p>
<p>If there are any permission issues, the installation will have to be
performed with elevated privileges and full path to python, ie.
path/envname/bin/python. Afterwards, MDANSE can be used from command
line like normal, and the GUI can be started by running:</p>
<p>path/envname/bin/mdanse_gui</p>
</section>
<section id="linux-2">
<span id="id12"></span><h3>Linux<a class="headerlink" href="#linux-2" title="Permalink to this heading"></a></h3>
<p>The installation on various linux platforms is similar to that on MacOS,
with the main difference being what the required libraries are called.
This also differs a lot between various linux distributions, and many
may already be installed. Further, which libraries have to be installed
depends if you plan to build Python, wxpython, and VTK from source. In
any case, what is always required is a C compiler, preferably GTK2, and
netcdf. A development version of netcdf, something like netcdf-devel,
may also be necessary. An exact guide for when everything is built from
source on CentOS 7 is on MDANSE GitHub issue #8
[<a class="reference external" href="#SignetBibliographie_005">5</a>]. Other than that, we do not keep
instructions specific to any other distributions, though inspiration can
be taken from our continuous integration pipeline at
.github/workflows/CI.yml.</p>
<p>Given this complexity and other reasons, it is advisable that conda is
used for building MDANSE, which makes installing packages much simpler
and should reduce the dependence on distribution somewhat. The steps to
follow are such:</p>
<p>conda create –name envname python=2.7</p>
<p>conda activate envname</p>
<p>conda install h5py netCDF4</p>
<p>pip install numpy==1.16.6 matplotlib==2.2.5 Cython==0.29.24 Pyro pyyaml</p>
<p>sudo conda install -y -c daf wxpython</p>
<p>sudo conda install -y -c ccordoba12 vtk</p>
<p>export NETCDF_HEADER_FILE_PATH=/usr/include/</p>
<p>git clone <a class="reference external" href="https://code.ill.fr/scientific-software/scientific-python.git">https://code.ill.fr/scientific-software/scientific-python.git</a></p>
<p>cd scientific-python/</p>
<p>python setup.py install</p>
<p>git clone <a class="reference external" href="https://code.ill.fr/scientific-software/mmtk.git">https://code.ill.fr/scientific-software/mmtk.git</a></p>
<p>cd mmtk</p>
<p>spython setup.py install</p>
<p>git clone <a class="reference external" href="https://github.com/ISISNeutronMuon/MDANSE.git">https://github.com/ISISNeutronMuon/MDANSE.git</a></p>
<p>cd MDANSE</p>
<p>python setup.py install</p>
</section>
</section>
</section>
<section id="references">
<h1>References<a class="headerlink" href="#references" title="Permalink to this heading"></a></h1>
<p>[1] G. Goret, B. Aoun, and E. Pellegrini, “MDANSE: An Interactive
Analysis Environment for Molecular Dynamics Simulations,” <em>J. Chem. Inf.
Model.</em>, vol. 57, no. 1, pp. 1–5, Jan. 2017, doi:
10.1021/acs.jcim.6b00571.</p>
<p>[2] “MDANSE GitHub Actions.”
<a class="reference external" href="https://github.com/ISISNeutronMuon/MDANSE/actions">https://github.com/ISISNeutronMuon/MDANSE/actions</a>.</p>
<p>[3] “Open a Mac app from an unidentified developer.”
<a class="reference external" href="https://support.apple.com/en-gb/guide/mac-help/mh40616/mac">https://support.apple.com/en-gb/guide/mac-help/mh40616/mac</a>).</p>
<p>[4] K. Haslam, “How to open a Mac app from an unidentified developer.”
<a class="reference external" href="https://www.macworld.co.uk/how-to/mac-app-unidentified-developer-3669596/">https://www.macworld.co.uk/how-to/mac-app-unidentified-developer-3669596/</a>.</p>
<p>[5] “MDANSE GitHub Issue #8.”
<a class="reference external" href="https://github.com/ISISNeutronMuon/MDANSE/issues/8">https://github.com/ISISNeutronMuon/MDANSE/issues/8</a>.</p>
<p>[6] “University Corporation for Atmospheric Research.”
<a class="reference external" href="http://www.ucar.edu/">http://www.ucar.edu/</a>.</p>
<p>[7] “The HDF Group.” <a class="reference external" href="https://www.hdfgroup.org/">https://www.hdfgroup.org/</a>.</p>
<p>[8] “MDANSE.” <a class="reference external" href="https://mdanse.org/">https://mdanse.org/</a>.</p>
<p>[9] “MDANSE GitHub Issues.”
<a class="reference external" href="https://github.com/ISISNeutronMuon/MDANSE/issues">https://github.com/ISISNeutronMuon/MDANSE/issues</a>.</p>
<p>[10] F. J. Harris, “On the use of windows for harmonic analysis with the
discrete Fourier transform,” <em>Proc. IEEE</em>, vol. 66, no. 1, pp. 51–83,
1978, doi: 10.1109/PROC.1978.10837.</p>
<p>[11] J. P. Boon and S. Yip, <em>Molecular Hydrodynamics</em>. New York:
McGraw-Hill, 1980.</p>
<p>[12] G. R. Kneller, “Technical Report Jül 2215,” Jülich, Germany.</p>
<p>[13] A. G. Redfield, “On the Theory of Relaxation Processes,” <em>IBM J.
Res. Dev.</em>, vol. 1, no. 1, pp. 19–31, 1957, doi: 10.1147/rd.11.0019.</p>
<p>[14] G. Lipari and A. Szabo, “Model-free approach to the interpretation
of nuclear magnetic resonance relaxation in macromolecules. 1. Theory
and range of validity,” <em>J. Am. Chem. Soc.</em>, vol. 104, no. 17, pp.
4546–4559, Aug. 1982, doi: 10.1021/ja00381a009.</p>
<p>[15] G. Lipari and A. Szabo, “Model-free approach to the interpretation
of nuclear magnetic resonance relaxation in macromolecules. 2. Analysis
of experimental results,” <em>J. Am. Chem. Soc.</em>, vol. 104, no. 17, pp.
4559–4570, Aug. 1982, doi: 10.1021/ja00381a010.</p>
<p>[16] L. Van Hove, “Correlations in Space and Time and Born Approximation
Scattering in Systems of Interacting Particles,” <em>Phys. Rev.</em>, vol. 95,
no. 1, pp. 249–262, Jul. 1954, doi: 10.1103/PhysRev.95.249.</p>
<p>[17] P. Schofield, “Space-Time Correlation Function Formalism for Slow
Neutron Scattering,” <em>Phys. Rev. Lett.</em>, vol. 4, no. 5, pp. 239–240,
Mar. 1960, doi: 10.1103/PhysRevLett.4.239.</p>
<p>[18] G. R. Kneller, “Inelastic neutron scattering from classical
systems,” <em>Mol. Phys.</em>, vol. 83, no. 1, pp. 63–87, Sep. 1994, doi:
10.1080/00268979400101081.</p>
<p>[19] J.-. P. Hansen and I. R. McDonald, “Correlations in Space and
Time,” in <em>Theory of Simple Liquids</em>, 3rd ed., Elsevier, 2006, pp.
195–201.</p>
<p>[20] S. W. Lovesey, <em>Theory of Neutron Scattering from Condensed
Matter</em>, vol. 1. Oxford: Clarendon Press, 1986.</p>
<p>[21] G. R. Kneller, W. Doster, M. Settles, S. Cusack, and J. C. Smith,
“Methyl group dynamics in the crystalline alanine dipeptide: A combined
computer simulation and inelastic neutron scattering analysis,” <em>J.
Chem. Phys.</em>, vol. 97, no. 12, pp. 8864–8879, Dec. 1992, doi:
10.1063/1.463361.</p>
<p>[22] A. Rahman, K. S. Singwi, and A. Sjölander, “Theory of Slow Neutron
Scattering by Liquids. I,” <em>Phys. Rev.</em>, vol. 126, no. 3, pp. 986–996,
May 1962, doi: 10.1103/PhysRev.126.986.</p>
<p>[23] J.-P. Ryckaert, G. Ciccotti, and H. J. C. Berendsen, “Numerical
integration of the cartesian equations of motion of a system with
constraints: molecular dynamics of n-alkanes,” <em>J. Comput. Phys.</em>, vol.
23, no. 3, pp. 327–341, 1977, doi:
<a class="reference external" href="https://doi.org/10.1016/0021-9991(77)90098-5">https://doi.org/10.1016/0021-9991(77)90098-5</a>.</p>
<p>[24] G. R. Kneller, “Superposition of Molecular Structures using
Quaternions,” <em>Mol. Simul.</em>, vol. 7, no. 1–2, pp. 113–119, May 1991,
doi: 10.1080/08927029108022453.</p>
<p>[25] S. L. Altmann, <em>Rotations, quaternions, and double groups</em>. Oxford:
Clarendon Press, 1986.</p>
<p>[26] “Axonometric Projection.”
<a class="reference external" href="https://en.wikipedia.org/wiki/Axonometric_projection#:~:text=In">https://en.wikipedia.org/wiki/Axonometric_projection#:~:text=In</a>
trimetric projection%2C the direction,by the angle of viewing.</p>
<p>[27] “CASTEP.” <a class="reference external" href="http://www.castep.org/">http://www.castep.org/</a>.</p>
<p>[28] “CHARMM.” <a class="reference external" href="http://www.charmm.org/">http://www.charmm.org/</a>.</p>
<p>[29] “PDB specification.”
<a class="reference external" href="http://www.wwpdb.org/documentation/file-format.php">http://www.wwpdb.org/documentation/file-format.php</a>.</p>
<p>[30] “DFTB.” <a class="reference external" href="https://dftb.org/">https://dftb.org/</a>.</p>
<p>[31] “Materials Studio.”
<a class="reference external" href="https://www.3ds.com/products-services/biovia/products/molecular-modeling-simulation/biovia-materials-studio/">https://www.3ds.com/products-services/biovia/products/molecular-modeling-simulation/biovia-materials-studio/</a>.</p>
<p>[32] “DL_POLY.” <a class="reference external" href="https://www.scd.stfc.ac.uk/Pages/DL_POLY.aspx">https://www.scd.stfc.ac.uk/Pages/DL_POLY.aspx</a>.</p>
<p>[33] “Gromacs.” <a class="reference external" href="https://www.gromacs.org/">https://www.gromacs.org/</a>.</p>
<p>[34] “LAMMPS.” <a class="reference external" href="https://www.lammps.org/">https://www.lammps.org/</a>.</p>
<p>[35] “NAMD.” <a class="reference external" href="http://www.ks.uiuc.edu/Research/namd/">http://www.ks.uiuc.edu/Research/namd/</a>.</p>
<p>[36] M. Abramowitz and I. A. Stegun, <em>Handbook of Mathematical
Functions</em>. New York: Dover, 1972.</p>
<p>[37] “Interpolations for imshow.”
<a class="reference external" href="https://matplotlib.org/stable/gallery/images_contours_and_fields/interpolation_methods.html">https://matplotlib.org/stable/gallery/images_contours_and_fields/interpolation_methods.html</a>.</p>
<p>[38] “MDANSE GitHub.” <a class="reference external" href="https://github.com/ISISNeutronMuon/MDANSE">https://github.com/ISISNeutronMuon/MDANSE</a>.</p>
<p>[39] “Miniconda Windows.”
<a class="reference external" href="https://docs.conda.io/en/latest/miniconda.html">https://docs.conda.io/en/latest/miniconda.html</a>.</p>
<p>[40] “Microsoft Visual Studio 2008.”
<a class="reference external" href="http://download.microsoft.com/download/8/1/d/81d3f35e-fa03-485b-953b-ff952e402520/VS2008ProEdition90dayTrialENUX1435622.iso">http://download.microsoft.com/download/8/1/d/81d3f35e-fa03-485b-953b-ff952e402520/VS2008ProEdition90dayTrialENUX1435622.iso</a>.</p>
<p>[41] C. Gohlke, “Unofficial Windows Binaries for Python Extension
Packages.” <a class="reference external" href="https://www.lfd.uci.edu/~gohlke/pythonlibs/#wxpython">https://www.lfd.uci.edu/~gohlke/pythonlibs/#wxpython</a>.</p>
<p>[42] “Conda MacOS.”
<a class="reference external" href="https://docs.conda.io/projects/conda/en/latest/user-guide/install/macos.html">https://docs.conda.io/projects/conda/en/latest/user-guide/install/macos.html</a>.</p>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2015, Gael Goret, Bachir Aoun and Eric C. Pellegrini.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>