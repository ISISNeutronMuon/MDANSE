<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>7. Using MDANSE Graphical User Interface &mdash; MDANSE 1.5.2 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="8. Using MDANSE from command line" href="cmd.html" />
    <link rel="prev" title="6. Input and output files" href="files.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> MDANSE
            <img src="../_static/mdanse_logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.5
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">MDANSE User Manual</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="opening.html">1. MDANSE User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="authors.html">2. Acknowledgements</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">3. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">4. Installing MDANSE</a></li>
<li class="toctree-l1"><a class="reference internal" href="build.html">5. Building MDANSE from source code</a></li>
<li class="toctree-l1"><a class="reference internal" href="files.html">6. Input and output files</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">7. Using MDANSE Graphical User Interface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#opening-mdanse-gui">7.1. Opening MDANSE GUI</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#windows">7.1.1. Windows</a></li>
<li class="toctree-l3"><a class="reference internal" href="#macos">7.1.2. MacOS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#linux">7.1.3. Linux</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#the-main-window">7.2. The main window</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-file-menu">7.3. The File menu</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#load-data">7.3.1. Load data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#trajectory-converter">7.3.2. Trajectory converter</a></li>
<li class="toctree-l3"><a class="reference internal" href="#quit">7.3.3. Quit</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#the-view-menu">7.4. The View menu</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-help-menu">7.5. The Help menu</a></li>
<li class="toctree-l2"><a class="reference internal" href="#toolbar">7.6. Toolbar</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#periodic-table-viewer">7.6.1. Periodic table viewer</a></li>
<li class="toctree-l3"><a class="reference internal" href="#elements-database-editor">7.6.2. Elements database editor</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#file-menu">7.6.2.1. File menu</a></li>
<li class="toctree-l4"><a class="reference internal" href="#database-menu">7.6.2.2. Database menu</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#d-3d-plotter">7.6.3. 2D/3D Plotter</a></li>
<li class="toctree-l3"><a class="reference internal" href="#units-editor">7.6.4. Units Editor</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#data-panel">7.7. Data panel</a></li>
<li class="toctree-l2"><a class="reference internal" href="#working-panel">7.8. Working panel</a></li>
<li class="toctree-l2"><a class="reference internal" href="#plugins-panel">7.9. Plugins panel</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#analysis">7.9.1. Analysis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#dynamics">7.9.1.1. Dynamics</a></li>
<li class="toctree-l4"><a class="reference internal" href="#infrared">7.9.1.2. Infrared</a></li>
<li class="toctree-l4"><a class="reference internal" href="#macromolecules">7.9.1.3. Macromolecules</a></li>
<li class="toctree-l4"><a class="reference internal" href="#scattering">7.9.1.4. Scattering</a></li>
<li class="toctree-l4"><a class="reference internal" href="#structure">7.9.1.5. Structure</a></li>
<li class="toctree-l4"><a class="reference internal" href="#thermodynamics">7.9.1.6. Thermodynamics</a></li>
<li class="toctree-l4"><a class="reference internal" href="#trajectory">7.9.1.7. Trajectory</a></li>
<li class="toctree-l4"><a class="reference internal" href="#virtual-instruments">7.9.1.8. Virtual Instruments</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#miscellaneous">7.9.2. Miscellaneous</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#data-info">7.9.2.1. Data info</a></li>
<li class="toctree-l4"><a class="reference internal" href="#animation">7.9.2.2. Animation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#density-superposition">7.9.2.3. Density Superposition</a></li>
<li class="toctree-l4"><a class="reference internal" href="#trajectory-viewer">7.9.2.4. Trajectory Viewer</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#my-jobs">7.9.3. My jobs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#plotter">7.9.4. Plotter</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#d3d-plotter-1">7.9.4.1. 2D/3D Plotter</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#user-definition">7.9.5. User definition</a></li>
<li class="toctree-l3"><a class="reference internal" href="#viewer">7.9.6. Viewer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#molecular-viewer">7.9.6.1. Molecular Viewer</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#jobs">7.10. Jobs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cmd.html">8. Using MDANSE from command line</a></li>
<li class="toctree-l1"><a class="reference internal" href="trajectory.html">9. Trajectory Converters</a></li>
<li class="toctree-l1"><a class="reference internal" href="plotting.html">10. Plotting Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="parameters.html">11. Glossary of Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html">12. References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MDANSE</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li><span class="section-number">7. </span>Using MDANSE Graphical User Interface</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/pages/gui.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="using-mdanse-graphical-user-interface">
<h1><span class="section-number">7. </span>Using MDANSE Graphical User Interface<a class="headerlink" href="#using-mdanse-graphical-user-interface" title="Permalink to this heading"></a></h1>
<p>Through the MDANSE graphical user interface (GUI), you will usually open
a trajectory, then specify the parameters for the analysis you wish to
perform and finally start the calculation itself. In this interface you
can also perform some other actions such as plotting the results of an
analysis, performing some file conversions, and view the geometrical
structure of your calculations. The GUI gives access to most of the
functionalities of MDANSE. Moreover, from the GUI it is possible to
create an input file for the command-line interface or an auto-start
analysis python script. Both kind of files provide a convenient starting
point to set up and run new analysis directly from the <a class="reference external" href="#_Using_MDANSE_from">command
line</a>.</p>
<section id="opening-mdanse-gui">
<h2><span class="section-number">7.1. </span>Opening MDANSE GUI<a class="headerlink" href="#opening-mdanse-gui" title="Permalink to this heading"></a></h2>
<p>On all platforms, the GUI can be started either through an icon, or from
the command line. Below are outlined the subtleties connected to each
platform. In each case, it might take some time before the GUI opens, so
please be patient.</p>
<section id="windows">
<span id="windows-1"></span><h3><span class="section-number">7.1.1. </span>Windows<a class="headerlink" href="#windows" title="Permalink to this heading"></a></h3>
<p>If, during the installation, you selected to create a desktop shortcut,
you can use that to start MDANSE. Otherwise, you will have to open the
folder where you installed MDANSE (C:\Program Files\MDANSE by
default). Inside you can double click on the file called MDANSE with the
MDANSE icon:</p>
<a class="reference internal image-reference" href="../_images/10000001000000730000006F64D69D1EB0E5B5D7.png"><img alt="../_images/10000001000000730000006F64D69D1EB0E5B5D7.png" src="../_images/10000001000000730000006F64D69D1EB0E5B5D7.png" style="width: 1.789cm; height: 1.727cm;" /></a>
<a class="reference internal image-reference" href="../_images/100000010000025800000014D95D6D39C9FE12CE.png"><img alt="../_images/100000010000025800000014D95D6D39C9FE12CE.png" src="../_images/100000010000025800000014D95D6D39C9FE12CE.png" style="width: 14.021cm; height: 0.467cm;" /></a>
<p>Alternatively, you can double click the file called MDANSE_launcher.bat.
If you want to start MDANSE GUI from the command line, you just have to
type in the path to this batch file, not forgetting to use “ if there
are spaces in the path.</p>
</section>
<section id="macos">
<span id="macos-1"></span><h3><span class="section-number">7.1.2. </span>MacOS<a class="headerlink" href="#macos" title="Permalink to this heading"></a></h3>
<p>If you installed it normally, MDANSE icon should appear in Applications
like any other app. However, starting it the first time is a bit more
complicated since Apple implements stricter protections and we are not
registered as trusted developers. Therefore, you might have to change
some settings (see Ref [<a class="reference external" href="#SignetBibliographie_004">4</a>] for a guide).
Before you do that though, try simply opening MDANSE from the right
click menu (see Ref [<a class="reference external" href="#SignetBibliographie_003">3</a>] for a guide).</p>
<p>To start MDANSE GUI from terminal, you will have to run the following
command (change /Applications if you installed MDANSE elsewhere):</p>
<p>/Applications/MDANSE.app/Contents/MacOS/MDANSE</p>
</section>
<section id="linux">
<span id="linux-1"></span><h3><span class="section-number">7.1.3. </span>Linux<a class="headerlink" href="#linux" title="Permalink to this heading"></a></h3>
<p>If your distribution has an applications menu of some sort, like below,
you should be able to find an MDANSE icon in there that can be used to
start the GUI.</p>
<a class="reference internal image-reference" href="../_images/100000010000055100000301A9B5B198B0D6FEE6.png"><img alt="../_images/100000010000055100000301A9B5B198B0D6FEE6.png" src="../_images/100000010000055100000301A9B5B198B0D6FEE6.png" style="width: 12.314cm; height: 6.959cm;" /></a>
<p>Otherwise, you will need to use the terminal. First, try running:</p>
<p>mdanse_gui</p>
<p>If that doesn’t work, you will need to know where MDANSE got installed.
By default, it should be in /usr/local, so try looking if the above
script is inside /usr/local/bin. If it isn’t there, the best bet is
searching for it with find / -name mdanse_gui. Once you know the path
(let’s call it mdanse_bin), run the following:</p>
<p>mdanse_bin/mdanse_gui</p>
</section>
</section>
<section id="the-main-window">
<h2><span class="section-number">7.2. </span>The main window<a class="headerlink" href="#the-main-window" title="Permalink to this heading"></a></h2>
<p>Below is an image of the window you will see when you open MDANSE GUI.
All the parts have been marked and their short descriptions can be found
below. Further information on all parts is in the following sections.</p>
<p>Please note that all pictures come from Windows 10, so the GUI will look
very slightly different on other platforms. However, MDANSE works
equally well, bugs notwithstanding, on all platforms.</p>
<a class="reference internal image-reference" href="../_images/100000000000035A00000225D9D9B30259888397.jpg"><img alt="../_images/100000000000035A00000225D9D9B30259888397.jpg" src="../_images/100000000000035A00000225D9D9B30259888397.jpg" style="width: 15.921cm; height: 10.186cm;" /></a>
<ol class="arabic simple">
<li><p><a class="reference external" href="#_The_File_menu">File menu</a> handles file manipulation. It can be
used to load NetCDF trajectories or to convert other trajectories
into the NetCDF format.</p></li>
<li><p><a class="reference external" href="#_The_View_menu">View menu</a> allows you to hide/show various
parts of MDANSE.</p></li>
<li><p><a class="reference external" href="#_The_Help_menu">Help menu</a> contains access to files that you
can use to better understand MDANSE and the theory behind it.</p></li>
<li><p><a class="reference external" href="#_Load_data">Load trajectory button</a> can be used to load a
NetCDF trajectory.</p></li>
<li><p><a class="reference external" href="#_Periodic_table_viewer">Periodic table viewer</a> opens a periodic
table containing the constants and data that MDANSE uses for
calculations.</p></li>
<li><p><a class="reference external" href="#_Elements_database_editor">Elements database editor</a> allows you
to change the atomic constants that MDANSE uses for calculations.</p></li>
<li><p><a class="reference external" href="#_2D/3D_Plotter">2D/3D Plotter</a> launches a window where the
calculated data can be plotted, and the plots formatted.</p></li>
<li><p><strong>User definitions editor</strong> opens a window where you can view the
definitions that have been created for each trajectory. More on
definitions in <a class="reference external" href="#_Creating_selections">Selections</a>.</p></li>
<li><p><a class="reference external" href="#_Unites_Editor">Units editor</a> opens a window where the units
used in MDANSE can be managed.</p></li>
<li><p><strong>MDANSE classes framework</strong> allows you to peruse the documentation
for the classes that make up MDANSE. This is useful if you want to
use MDANSE from the command line.</p></li>
<li><p><strong>Save analysis template</strong> allows you to create a new analysis. This
will be available in My jobs inside the Plugins panel and can be run
like the native analyses.</p></li>
<li><p><strong>Open MDANSE API</strong> opens MDANSE documentation in a browser. This is
very similar to MDANSE classes framework.</p></li>
<li><p><strong>Open MDANSE website</strong> opens the MDANSE
website[<a class="reference external" href="#SignetBibliographie_008">8</a>] in a browser.</p></li>
<li><p><strong>About</strong> launches a window with very basic information about the
MDANSE you have installed.</p></li>
<li><p><strong>Bug report</strong> opens your default mail application. Please use this
or create an issue on MDANSE
GitHub[<a class="reference external" href="#SignetBibliographie_009">9</a>] to inform us of any issues
you have come across.</p></li>
<li><p><a class="reference external" href="#_Quit">Quit MDANSE</a> closes the MDANSE window.</p></li>
<li><p><a class="reference external" href="#_Data_panel">Data panel</a> contains any NetCDF files you loaded
into MDANSE using either #4 Load trajectory button, or from #1 File
menu &gt; Load trajectory.</p></li>
<li><p><a class="reference external" href="#_Plugins_panel">Plugins panel</a> contains all the options you can
do with the selected trajectory.</p></li>
<li><p><a class="reference external" href="#_Working_panel">Working panel</a> shows the trajectories you have
opened. To open a trajectory, double click a trajectory in #16 Data
panel. You can then inspect the system described by the trajectory.</p></li>
<li><p><strong>Logger</strong> shows all the messages generated by MDANSE. These can be
errors or information messages, such as ones confirming you saved a
script etc.</p></li>
<li><p><strong>Console</strong> is a Python shell. It can be used like normal when
python is being used from the command line, i.e.. when python is
typed and executed in an OS shell. It contains all the bundled
modules, but you will need to import them first.</p></li>
<li><p><a class="reference external" href="#_Jobs">Jobs</a> shows the status of all current jobs. Once you
start an analysis or trajectory conversion, you can view its
progress here.</p></li>
</ol>
</section>
<section id="the-file-menu">
<h2><span class="section-number">7.3. </span>The File menu<a class="headerlink" href="#the-file-menu" title="Permalink to this heading"></a></h2>
<p>Pressing the <strong>File</strong> menu button brings up the following menu:</p>
<a class="reference internal image-reference" href="../_images/10000001000000C70000006E1539438FACE07774.png"><img alt="../_images/10000001000000C70000006E1539438FACE07774.png" src="../_images/10000001000000C70000006E1539438FACE07774.png" style="width: 3.759cm; height: 2.078cm;" /></a>
<section id="load-data">
<h3><span class="section-number">7.3.1. </span>Load data<a class="headerlink" href="#load-data" title="Permalink to this heading"></a></h3>
<p>This option allows you to select an MMTK NetCDF file. Once you click the
Load data button, a standard (platform-specific) file browser will open,
like the one below:</p>
<a class="reference internal image-reference" href="../_images/10000001000003B4000002564F3D2836EB0B6495.png"><img alt="../_images/10000001000003B4000002564F3D2836EB0B6495.png" src="../_images/10000001000003B4000002564F3D2836EB0B6495.png" style="width: 10.315cm; height: 6.509cm;" /></a>
<p>Use it as per normal, and the file you selected will appear in the <a class="reference external" href="#_Data_panel">Data
panel</a>. While it says in the file browser that you can
load mvi trace file format, this is not currently implemented. Please
only load NetCDF files that have been generated using MMTK or MMTK-based
software. If you have a trajectory from elsewhere, it must be converted
first. For more information about converting trajectories, please see
the <a class="reference external" href="#_Trajectory_converter">next section</a>.</p>
</section>
<section id="trajectory-converter">
<h3><span class="section-number">7.3.2. </span>Trajectory converter<a class="headerlink" href="#trajectory-converter" title="Permalink to this heading"></a></h3>
<p>This option allows to convert a trajectory derived with a non MMTK-based
program to the NetCDF MMTK trajectory format. Hovering over the
Trajectory converter brings up the following menu:</p>
<a class="reference internal image-reference" href="../_images/100000010000015B0000016E3E986405A542C06F.png"><img alt="../_images/100000010000015B0000016E3E986405A542C06F.png" src="../_images/100000010000015B0000016E3E986405A542C06F.png" style="width: 6.909cm; height: 7.287cm;" /></a>
<p>Clicking on any button opens a window of that converter. Each converter
contains these three buttons at the bottom:</p>
<ul class="simple">
<li><p><strong>Help</strong> will open MDANSE documentation for the converter class.</p></li>
<li><p><strong>Save</strong> creates a python script with the values of all the fields
set the way they were when the button is clicked. This script can be
used to quickly run this conversion again in the future.</p></li>
<li><p><strong>Run</strong> initiates the conversion. Its progress can be seen in
<a class="reference external" href="#_Jobs">Jobs</a>. After a successful Run, the converted trajectory
is saved in the location specified in the field “output files” in the
converter interface.</p></li>
</ul>
<p>The descriptions of all converters will be found in <a class="reference external" href="#_Appendix_1">Appendix
1</a>.</p>
</section>
<section id="quit">
<h3><span class="section-number">7.3.3. </span>Quit<a class="headerlink" href="#quit" title="Permalink to this heading"></a></h3>
<p>Selecting this option opens a confirmation prompt. If you select yes,
MDANSE will close.</p>
</section>
</section>
<section id="the-view-menu">
<h2><span class="section-number">7.4. </span>The View menu<a class="headerlink" href="#the-view-menu" title="Permalink to this heading"></a></h2>
<p>This menu contains several options to hide/show various parts of MDANSE:</p>
<a class="reference internal image-reference" href="../_images/10000001000000BE0000007FCAA964E78A90519D.png"><img alt="../_images/10000001000000BE0000007FCAA964E78A90519D.png" src="../_images/10000001000000BE0000007FCAA964E78A90519D.png" style="width: 3.962cm; height: 2.649cm;" /></a>
<ul class="simple">
<li><p><strong>Toggle data tree</strong> shows/hides the <a class="reference external" href="#_Data_panel">Data panel</a>:</p></li>
</ul>
<p><a class="reference internal" href="../_images/100000010000028D000001F1F632B1C1173DE220.png"><img alt="image1" src="../_images/100000010000028D000001F1F632B1C1173DE220.png" style="width: 7.096cm; height: 5.426cm;" /></a><a class="reference internal" href="../_images/100000010000028D000001F583E3D2D6B25FED29.png"><img alt="image2" src="../_images/100000010000028D000001F583E3D2D6B25FED29.png" style="width: 7.131cm; height: 5.452cm;" /></a></p>
<ul class="simple">
<li><p><strong>Toggle plugins tree</strong> shows/hides the <a class="reference external" href="#_Plugins_panel">Plugins
panel</a>:</p></li>
</ul>
<p><a class="reference internal" href="../_images/100000010000028D000001F1F632B1C1173DE220.png"><img alt="image3" src="../_images/100000010000028D000001F1F632B1C1173DE220.png" style="width: 7.096cm; height: 5.426cm;" /></a><a class="reference internal" href="../_images/100000010000028C000001F092B9EB9B1E48AB9D.png"><img alt="image4" src="../_images/100000010000028C000001F092B9EB9B1E48AB9D.png" style="width: 7.193cm; height: 5.466cm;" /></a></p>
<ul class="simple">
<li><p><strong>Toggle controller</strong> shows/hides the bottom bar containing Logger,
Console, and Jobs:</p></li>
</ul>
<p><a class="reference internal" href="../_images/100000010000028D000001F1F632B1C1173DE220.png"><img alt="image5" src="../_images/100000010000028D000001F1F632B1C1173DE220.png" style="width: 7.096cm; height: 5.426cm;" /></a><a class="reference internal" href="../_images/100000010000028C000001F40D7333B09A10BBF0.png"><img alt="image6" src="../_images/100000010000028C000001F40D7333B09A10BBF0.png" style="width: 7.131cm; height: 5.445cm;" /></a></p>
<ul class="simple">
<li><p><strong>Toggle toolbar</strong> should show/hide the <a class="reference external" href="#_Toolbar">toolbar</a>:</p></li>
</ul>
<p><a class="reference internal" href="../_images/100000010000025E000001C3AC39A36717DC7EE3.png"><img alt="image7" src="../_images/100000010000025E000001C3AC39A36717DC7EE3.png" style="width: 6.959cm; height: 5.156cm;" /></a><a class="reference internal" href="../_images/100000010000025D000001C0F8379C92EEE1C895.png"><img alt="image8" src="../_images/100000010000025D000001C0F8379C92EEE1C895.png" style="width: 7.011cm; height: 5.191cm;" /></a></p>
</section>
<section id="the-help-menu">
<h2><span class="section-number">7.5. </span>The Help menu<a class="headerlink" href="#the-help-menu" title="Permalink to this heading"></a></h2>
<p>Pressing the Help button brings up the following menu:</p>
<a class="reference internal image-reference" href="../_images/10000001000000DB00000099F6B730A10B6BD3B5.png"><img alt="../_images/10000001000000DB00000099F6B730A10B6BD3B5.png" src="../_images/10000001000000DB00000099F6B730A10B6BD3B5.png" style="width: 5.741cm; height: 4.048cm;" /></a>
<ul class="simple">
<li><p><strong>About</strong> opens a window containing information about MDANSE version,
a short summary, and a list of authors.</p></li>
<li><p><strong>Simple help</strong> opens a window with a brief summary of MDANSE
workflow and the various options that can be encountered.</p></li>
<li><p><strong>Theoretical background</strong> opens, in a browser, a document
summarising the theory behind many of the analyses.</p></li>
<li><p><strong>User guide</strong> opens the DOI to this user guide in the default
browser, showing a RAL Technical Report webpage. From there, this
user guide can be downloaded as a pdf.</p></li>
<li><p><strong>Bug report</strong> opens the default email app so that you can send us an
email, informing us of any issue you have encountered. When reporting
an issue, please include a picture or copy of the error, such as the
<a class="reference external" href="#STATE">traceback from job failure</a>.</p></li>
</ul>
</section>
<section id="toolbar">
<h2><span class="section-number">7.6. </span>Toolbar<a class="headerlink" href="#toolbar" title="Permalink to this heading"></a></h2>
<p>This is a set of pictographic buttons that you can use to quickly
perform many important actions. Below is a brief overview of all of
them, going left to right, and after that we will take a look at the
more complex ones.</p>
<a class="reference internal image-reference" href="../_images/10000001000001FB0000002B44E7FF7987426A26.png"><img alt="../_images/10000001000001FB0000002B44E7FF7987426A26.png" src="../_images/10000001000001FB0000002B44E7FF7987426A26.png" style="width: 13.416cm; height: 1.138cm;" /></a>
<ol class="arabic simple">
<li><p><strong>Load trajectory button</strong> can be used to load a NetCDF trajectory.
More information in <a class="reference external" href="#_Load_data">Load data</a>.</p></li>
<li><p><a class="reference external" href="#_Periodic_table_viewer">Periodic table viewer</a> opens a periodic
table containing the constants and data that MDANSE uses for
calculations.</p></li>
<li><p><a class="reference external" href="#_Elements_database_editor">Elements database editor</a> allows you
to change the atomic constants that MDANSE uses for calculations.</p></li>
<li><p><a class="reference external" href="#_2D/3D_Plotter">2D/3D Plotter</a> launches a window where the
calculated data can be plotted, and the plots formatted.</p></li>
<li><p><strong>User definitions editor</strong> opens a window where you can view the
definitions that have been created for each trajectory. More on
definitions in <a class="reference external" href="#_Creating_selections">Selections</a>.</p></li>
<li><p><a class="reference external" href="#_Unites_Editor">Units editor</a> opens a window where the units
used in MDANSE can be managed.</p></li>
<li><p><strong>MDANSE classes framework</strong> allows you to peruse the documentation
for the classes that make up MDANSE. This is useful if you want to
use MDANSE from the command line.</p></li>
<li><p><strong>Save analysis template</strong> allows you to create a new analysis. This
will be available in My jobs inside the Plugins panel and can be run
like the native analyses.</p></li>
<li><p><strong>Open MDANSE API</strong> opens MDANSE documentation in a browser. This is
very similar to MDANSE classes framework.</p></li>
<li><p><strong>Open MDANSE website</strong> opens the MDANSE website in a browser.</p></li>
<li><p><strong>About</strong> launches a window with very basic information about the
MDANSE you have installed.</p></li>
<li><p><strong>Bug report</strong> opens your default mail application. Please use this
or our GitHub[<a class="reference external" href="#SignetBibliographie_009">9</a>] to inform us of any
issues you have come across. When reporting an issue, please include
a picture or copy of the error, such as the <a class="reference external" href="#STATE">traceback from job
failure</a>.</p></li>
<li><p><strong>Quit MDANSE</strong> closes MDANSE.</p></li>
</ol>
<section id="periodic-table-viewer">
<h3><span class="section-number">7.6.1. </span>Periodic table viewer<a class="headerlink" href="#periodic-table-viewer" title="Permalink to this heading"></a></h3>
<p>Once launched, it will open this window:</p>
<a class="reference internal image-reference" href="../_images/100000010000031E000001EB8316D84CE16D60A9.png"><img alt="../_images/100000010000031E000001EB8316D84CE16D60A9.png" src="../_images/100000010000031E000001EB8316D84CE16D60A9.png" style="width: 15.806cm; height: 9.733cm;" /></a>
<p>By hovering over an element, detailed information from MDANSE elements
database will show up at the top. By clicking on an element, a list of
its isotopes will appear as a menu:</p>
<a class="reference internal image-reference" href="../_images/100000010000007B00000072BD990BE2296AF016.png"><img alt="../_images/100000010000007B00000072BD990BE2296AF016.png" src="../_images/100000010000007B00000072BD990BE2296AF016.png" style="width: 3.254cm; height: 3.016cm;" /></a>
<p>When an isotope is selected, all the information that is stored in the
database will be displayed:</p>
<a class="reference internal image-reference" href="../_images/100000010000024600000333543D0D0EC0A01C7E.png"><img alt="../_images/100000010000024600000333543D0D0EC0A01C7E.png" src="../_images/100000010000024600000333543D0D0EC0A01C7E.png" style="width: 7.509cm; height: 10.566cm;" /></a>
<p>Clicking on the link at the bottom opens a Wikipedia article about that
element. Other than that, you cannot interact with this page in any way.
If you would like to change any of the displayed data, you will have to
use the Elements database editor.</p>
</section>
<section id="elements-database-editor">
<h3><span class="section-number">7.6.2. </span>Elements database editor<a class="headerlink" href="#elements-database-editor" title="Permalink to this heading"></a></h3>
<p>Clicking on this button opens this window:</p>
<a class="reference internal image-reference" href="../_images/10000001000003160000018C76F0FE861E14A12B.png"><img alt="../_images/10000001000003160000018C76F0FE861E14A12B.png" src="../_images/10000001000003160000018C76F0FE861E14A12B.png" style="width: 15.789cm; height: 7.895cm;" /></a>
<p>It can be interacted with like a normal spreadsheet; click (or double
click) on a field you want to edit and type the new value. Once you are
done with making changes, don’t forget to save them before closing. You
can do that through the file menu.</p>
<section id="file-menu">
<h4><span class="section-number">7.6.2.1. </span>File menu<a class="headerlink" href="#file-menu" title="Permalink to this heading"></a></h4>
<a class="reference internal image-reference" href="../_images/10000001000001000000004B8B80A954F09BBF56.png"><img alt="../_images/10000001000001000000004B8B80A954F09BBF56.png" src="../_images/10000001000001000000004B8B80A954F09BBF56.png" style="width: 6.773cm; height: 1.984cm;" /></a>
<ul class="simple">
<li><p><strong>Save database</strong> overwrites the current database, so it is best to
be careful. Due to that, you will need to confirm a prompt before the
changes are saved.</p></li>
<li><p><strong>Save database as</strong> opens a file browser which can be used to save
the changes in a new file.</p></li>
</ul>
</section>
<section id="database-menu">
<h4><span class="section-number">7.6.2.2. </span>Database menu<a class="headerlink" href="#database-menu" title="Permalink to this heading"></a></h4>
<p>Clicking on Database opens this menu:</p>
<a class="reference internal image-reference" href="../_images/10000001000000A900000052FEACFDD7C67801BA.png"><img alt="../_images/10000001000000A900000052FEACFDD7C67801BA.png" src="../_images/10000001000000A900000052FEACFDD7C67801BA.png" style="width: 4.329cm; height: 1.99cm;" /></a>
<ul class="simple">
<li><p><strong>New element</strong> allows you to add a new element.</p></li>
<li><p><strong>New property</strong> allows you to add a new property.</p></li>
</ul>
</section>
</section>
<section id="d-3d-plotter">
<h3><span class="section-number">7.6.3. </span>2D/3D Plotter<a class="headerlink" href="#d-3d-plotter" title="Permalink to this heading"></a></h3>
<p>Upon clicking on the icon, this window will open:</p>
<a class="reference internal image-reference" href="../_images/10000001000003DA000002B772D53BC965757606.png"><img alt="../_images/10000001000003DA000002B772D53BC965757606.png" src="../_images/10000001000003DA000002B772D53BC965757606.png" style="width: 12.173cm; height: 8.58cm;" /></a>
<p>To use it, a file has to be loaded first. This can be done using the
File menu → Load, which will open a file browser. Only NetCDF files
(ending in .nc, .cdf, or .netcdf) and HDF5 files (extension .h5 or .hdf)
can be loaded; other file formats will result in an error.</p>
<a class="reference internal image-reference" href="../_images/1000000100000079000000510978F762503F30F6.png"><img alt="../_images/1000000100000079000000510978F762503F30F6.png" src="../_images/1000000100000079000000510978F762503F30F6.png" style="width: 3.201cm; height: 2.081cm;" /></a>
<p>Once a file is loaded, it will appear in the data panel. This is a table
listing all the files loaded in the Plotter, showing the name MDANSE
assigned to the loaded instance (i.e. a key to e.g. distinguish between
files with the same name), the name of the file, and the full path to
the file.</p>
<a class="reference internal image-reference" href="../_images/1000000100000130000000AFA255BACE473AB186.png"><img alt="../_images/1000000100000130000000AFA255BACE473AB186.png" src="../_images/1000000100000130000000AFA255BACE473AB186.png" style="width: 6.645cm; height: 3.826cm;" /></a>
<p>Clicking on a loaded file will show all the variables that can be
plotted in the box below, though the whole Plotter window might have to
be resized so that more than one variable shows up at a time. A preview
of the plot of the first variable will also be shown at the bottom, but
only for 1D and 2D plots.</p>
<p><a class="reference internal" href="../_images/10000001000001C9000003B286D7BAECC84888DA.png"><img alt="image9" src="../_images/10000001000001C9000003B286D7BAECC84888DA.png" style="width: 7.191cm; height: 14.887cm;" /></a></p>
<p>Once you have selected a variable from the second box, you can select a
plotter from the Select Plotter drop-down menu. The following plotters
are available in MDANSE:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 42%" />
<col style="width: 17%" />
<col style="width: 42%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Plotter</p></td>
<td><p>Dimension</p></td>
<td><p>Description</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="#_Line_Plotter">Line</a></p></td>
<td><p>1D</p></td>
<td><p>A simple plot depicting
the dependence of one
variable on another. It
consists of a single
line. Uses normal plot()
function from matplotlib.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="#_Image_Plotter">I
mage</a></p></td>
<td><p>2D</p></td>
<td><p>Plots data as an image,
i.e. on a 2D regular
raster. Uses matplotlib
imshow() function.</p></td>
</tr>
<tr class="row-even"><td><dl class="simple">
<dt><a href="#id1"><span class="problematic" id="id2">`</span></a>Elevation</dt><dd><p>&lt;#_Elevation_Plotter&gt;`__</p>
</dd>
</dl>
</td>
<td><p>2D</p></td>
<td><p>Plots data as an image.
Uses VTK.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="#_2D_Slice_Plotter">2D
Slic
e</a></p></td>
<td><p>2D</p></td>
<td><p>Plots a subset of a 3D
variable.</p></td>
</tr>
<tr class="row-even"><td><p><a href="#id4"><span class="problematic" id="id5">`Iso
Surface &lt;
#_Iso_Surface_Plotter&gt;`__</span></a></p></td>
<td><p>3D</p></td>
<td><p>A 3D plot depicting a
surface through lines or
one continuous surface.
Uses VTK.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="#_Scalar-Field_Plotter">Scalar-Field</a></p></td>
<td><p>3D</p></td>
<td></td>
</tr>
</tbody>
</table>
<p>After all that is selected, the data can be plotted. There are two
options for this, represented by the two buttons:</p>
<ul class="simple">
<li><p><strong>Plot in new window</strong> creates a new tab, ie. a separate plot, inside
the Multiple Plot Window.</p></li>
</ul>
<p><a class="reference internal" href="../_images/10000001000002A10000027D14B28490295A59FA.png"><img alt="image10" src="../_images/10000001000002A10000027D14B28490295A59FA.png" style="width: 7.728cm; height: 7.313cm;" /></a><a class="reference internal" href="../_images/100000010000029E000002771B2359A8E105AC9F.png"><img alt="image11" src="../_images/100000010000029E000002771B2359A8E105AC9F.png" style="width: 7.798cm; height: 7.345cm;" /></a></p>
<ul class="simple">
<li><p><strong>Plot in current figure</strong> plots the chosen data in the currently
selected tab of the Multiple Plot Window, ie. it will create a plot
with multiple lines etc.</p></li>
</ul>
<p><a class="reference internal" href="../_images/100000010000029E000002771B2359A8E105AC9F.png"><img alt="image12" src="../_images/100000010000029E000002771B2359A8E105AC9F.png" style="width: 7.798cm; height: 7.345cm;" /></a><a class="reference internal" href="../_images/100000010000029D0000027A5511D91E20AFD9A5.png"><img alt="image13" src="../_images/100000010000029D0000027A5511D91E20AFD9A5.png" style="width: 7.765cm; height: 7.357cm;" /></a></p>
<p>As can be seen, the plot automatically adjusts the axes so that all
plots fit. More details on plotting options is in <a class="reference external" href="#_Appendix_3_1">Appendix
3</a>.</p>
</section>
<section id="units-editor">
<h3><span class="section-number">7.6.4. </span>Units Editor<a class="headerlink" href="#units-editor" title="Permalink to this heading"></a></h3>
<p>When opened, this window will appear:</p>
<a class="reference internal image-reference" href="../_images/1000000100000248000001ECCC3F9A11E0472AF2.png"><img alt="../_images/1000000100000248000001ECCC3F9A11E0472AF2.png" src="../_images/1000000100000248000001ECCC3F9A11E0472AF2.png" style="width: 9.693cm; height: 8.167cm;" /></a>
<p>Here, the units that MDANSE uses can be managed. The white box on the
left is a list of all the defined units, which includes both the units
that come together with MDANSE as well as any user-defined units. More
information on how units work is in the <a class="reference external" href="#_Units">Units</a> section.
This list is interactive; any unit in it can be clicked on, which
displays its details, like so:</p>
<a class="reference internal image-reference" href="../_images/1000000100000247000001E9C7FFA85698785E9D.png"><img alt="../_images/1000000100000247000001E9C7FFA85698785E9D.png" src="../_images/1000000100000247000001E9C7FFA85698785E9D.png" style="width: 9.804cm; height: 8.142cm;" /></a>
<p>The fields in the middle and right of the window show the definition of
the selected unit using SI units. The selected unit is equivalent to
<strong>Factor</strong> * the product of the SI units listed on the right, where the
values inside the fields are the powers of the SI units. Therefore, the
unit shown in the above example, J_per_mole, is in MDANSE defined as
1.66055927342 * 10<sup>-24</sup> kg m<sup>2</sup> mol<sup>-1</sup>.</p>
<p>There are four buttons in the Units Editor window:</p>
<ul class="simple">
<li><p><strong>Cancel</strong> closes the window without saving any changes made.</p></li>
<li><p><strong>Save</strong> saves the changes for future use; they can be used in the
current session and in any future ones. The Units Editor window is
also closed.</p></li>
<li><p><strong>OK</strong> saves the changes for the current session; they can be used
until the main MDANSE window is closed. When MDANSE is closed and
opened again, the changes will not appear. The Units Editor window is
also closed.</p></li>
<li><p><strong>Add unit</strong> opens the following window, which can be used to add new
units or edit existing ones.</p></li>
</ul>
<a class="reference internal image-reference" href="../_images/10000001000000C10000017909613E0AF9D5EED0.png"><img alt="../_images/10000001000000C10000017909613E0AF9D5EED0.png" src="../_images/10000001000000C10000017909613E0AF9D5EED0.png" style="width: 2.84cm; height: 5.547cm;" /></a>
<ul class="simple">
<li><p><strong>Unit name</strong></p></li>
</ul>
<p><em>Format:</em> str</p>
<p><em>Default:</em> None</p>
<p><em>Description:</em> the name of the unit. If a name not yet registered is
inputted, a new unit will be created. Please note that the names are
case-sensitive, and that already existing units cannot be overwritten.</p>
<ul class="simple">
<li><p><strong>Factor</strong></p></li>
</ul>
<p><em>Format:</em> float</p>
<p><em>Default:</em> 1.0</p>
<p><em>Description:</em></p>
<ul class="simple">
<li><p><strong>unit</strong> (any of the displayed SI basic units)</p></li>
</ul>
<p><em>Format:</em> int (it must lie in the interval )</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> the power of the SI unit.</p>
<ul class="simple">
<li><p><strong>OK</strong> adds the new definition to the unit registry, but the change
has to be saved in the Units Editor window to be useable in the rest
of MDANSE. Please not that once, a new unit is added, it cannot be
changed only removed.</p></li>
<li><p><strong>Cancel</strong> closes the window without saving the changes.</p></li>
</ul>
<p>Further, existing units can be deleted from the Units Editor window. To
do this, the unit to be deleted has to be selected by clicking on it,
and then the ‘Delete’ button has to be clicked. This will show a prompt
for confirmation, and once that is accepted, the unit will be removed,
though the change has to be saved by clicking on either the OK or Cancel
button.</p>
</section>
</section>
<section id="data-panel">
<h2><span class="section-number">7.7. </span>Data panel<a class="headerlink" href="#data-panel" title="Permalink to this heading"></a></h2>
<p>This is where files loaded into MDANSE are displayed. Trajectories and
results of analyses are distinctly separated as ‘mmtk trajectory’ and
‘netcdf data’ respectively. To proceed, you need to double-click on a
file name here to bring it to the Working panel. This can be done
multiple times for each file.</p>
<a class="reference internal image-reference" href="../_images/10000001000000FD000001112D4B60FF74FCFC13.png"><img alt="../_images/10000001000000FD000001112D4B60FF74FCFC13.png" src="../_images/10000001000000FD000001112D4B60FF74FCFC13.png" style="width: 6.696cm; height: 7.223cm;" /></a>
</section>
<section id="working-panel">
<h2><span class="section-number">7.8. </span>Working panel<a class="headerlink" href="#working-panel" title="Permalink to this heading"></a></h2>
<p>The selected files appear in the Working panel as tabs. The currently
opened tab is the one that whose file is going to be used for analysis
and other operations when using the Plugins panel.</p>
<a class="reference internal image-reference" href="../_images/100000010000010C0000002EFF8582524B23620C.png"><img alt="../_images/100000010000010C0000002EFF8582524B23620C.png" src="../_images/100000010000010C0000002EFF8582524B23620C.png" style="width: 7.093cm; height: 1.217cm;" /></a>
<p>The Working panel is also the space which some of the plugins use to do
their job. <a class="reference external" href="#_Molecular_Viewer">The Molecular Viewer</a>,
<a class="reference external" href="#_Animation">Animation</a>, and <a class="reference external" href="#_Plotter">2D/3D Plotter</a> plugins
all load into the <a class="reference external" href="#_Working_panel">Working panel</a>. Furthermore, it
is possible to bring the windows opened by the other plugins into the
working panel, like below. To do that, you have to drag the window so
that its top is near the top of the working panel, where the tabs are.
An indicator will appear when you got it right.</p>
<a class="reference internal image-reference" href="../_images/100000010000039B00000223E26E6A96BBCAA5F7.png"><img alt="../_images/100000010000039B00000223E26E6A96BBCAA5F7.png" src="../_images/100000010000039B00000223E26E6A96BBCAA5F7.png" style="width: 13.376cm; height: 7.927cm;" /></a>
<a class="reference internal image-reference" href="../_images/10000001000003A4000000F537A5F4FDE03228C0.png"><img alt="../_images/10000001000003A4000000F537A5F4FDE03228C0.png" src="../_images/10000001000003A4000000F537A5F4FDE03228C0.png" style="width: 15.921cm; height: 4.186cm;" /></a>
</section>
<section id="plugins-panel">
<h2><span class="section-number">7.9. </span>Plugins panel<a class="headerlink" href="#plugins-panel" title="Permalink to this heading"></a></h2>
<p>This is the heart of MDANSE, where all the analyses as well as other
important features can be found. If the selected tab in the Working
panel is from a trajectory, the Plugins panel will look like this:</p>
<a class="reference internal image-reference" href="../_images/10000001000000FA0000011803C2A7616D0C2E95.png"><img alt="../_images/10000001000000FA0000011803C2A7616D0C2E95.png" src="../_images/10000001000000FA0000011803C2A7616D0C2E95.png" style="width: 6.616cm; height: 7.408cm;" /></a>
<p>If it is from the result of an analysis, it will look like this:</p>
<a class="reference internal image-reference" href="../_images/10000001000000F700000112DF7A4DFE4F638571.png"><img alt="../_images/10000001000000F700000112DF7A4DFE4F638571.png" src="../_images/10000001000000F700000112DF7A4DFE4F638571.png" style="width: 6.535cm; height: 7.251cm;" /></a>
<p>There are far fewer options available for analysis results.
Nevertheless, in each of the sections below, it will be stated if the
plugin appears for trajectories, results, or both.</p>
<p>All the options in above are just headings. To get to the actual
plugins, click on the ‘plus’ buttons next to the text to unhide the
options. If there is no such button next to a text, that means that that
is a plugin and can be launched by double-clicking on the text.</p>
<section id="analysis">
<h3><span class="section-number">7.9.1. </span>Analysis<a class="headerlink" href="#analysis" title="Permalink to this heading"></a></h3>
<p>This menu contains all data manipulations and appears as in the picture
below when a trajectory is loaded. As indicated by the plus buttons,
each of these options is a menu in itself.</p>
<a class="reference internal image-reference" href="../_images/10000001000000F9000000B9A79707AE37EC9465.png"><img alt="../_images/10000001000000F9000000B9A79707AE37EC9465.png" src="../_images/10000001000000F9000000B9A79707AE37EC9465.png" style="width: 6.588cm; height: 4.895cm;" /></a>
<p>They are explored in greater depth in the following sections, and the
analyses are in turn explored in their subsections. Some contain a
discussion of the theory behind the computation, and all show the
analysis window of that analysis, the one that is launched by
double-clicking the option in this Plugins panel.</p>
<p>Each analysis window is different since each requires different
parameters to be configured before it can be run. However, all of them
have the same structure (example window below), consisting of these
parts:</p>
<ul class="simple">
<li><p><strong>trajectory</strong> box shows the path to the <a class="reference external" href="#_NetCDF_file_format">MMTK
NetCDF</a> trajectory that this analysis will
be performed on.</p></li>
<li><p><strong>Parameters</strong> are a group of options, of which the common ones are
discussed in depth in <a class="reference external" href="#_Appendix_2">Appendix 2</a>. These are the
options which vary from analysis to analysis. The only parameters
that exist on every analysis are Frames and Output files.</p></li>
<li><p><strong>Buttons</strong> are situated at the bottom of each analysis and consist
of these options:</p>
<ul>
<li><p><strong>Help</strong> opens the source code documentation for the relevant
class in an MDANSE window.</p></li>
<li><p><strong>Save</strong> opens a file browser that allows you to save the current
analysis with the set options into a python script which can be
run from the command line. More information about scripts in
<a class="reference external" href="#_Using_MDANSE_from">Using MDANSE from command line.</a></p></li>
<li><p><strong>Run</strong> starts the analysis and prompts you whether you want to
close the window. The status of the analysis can be found in the
<a class="reference external" href="#_Jobs">Jobs</a> panel, though there is a known bug where
successful analyses do not show up.</p></li>
</ul>
</li>
</ul>
<section id="dynamics">
<h4><span class="section-number">7.9.1.1. </span>Dynamics<a class="headerlink" href="#dynamics" title="Permalink to this heading"></a></h4>
<p>This section contains the following Plugins:</p>
<ul class="simple">
<li><p><a class="reference external" href="#_Angular_Correlation">Angular Correlation</a></p></li>
<li><p><a class="reference external" href="#_Density_Of_States">Density Of States</a></p></li>
<li><p><a class="reference external" href="#_General_AutoCorrelation_Function">General AutoCorrelation
Function</a></p></li>
<li><p><a class="reference external" href="#_Mean_Square_Displacement">Mean Square Displacement</a></p></li>
<li><p><a class="reference external" href="#_Order_Parameter">Order Parameter</a></p></li>
<li><p><a class="reference external" href="#_Position_AutoCorrelation_Function">Position AutoCorrelation
Function</a></p></li>
<li><p><a class="reference external" href="#_Velocity_AutoCorrelation_Function">Velocity AutoCorrelation
Function</a></p></li>
</ul>
<section id="angular-correlation">
<h5><span class="section-number">7.9.1.1.1. </span>Angular Correlation<a class="headerlink" href="#angular-correlation" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p>Available for trajectories only</p></li>
</ul>
<p>Theory and implementation</p>
<p>The angular correlation analysis computes the autocorrelation of a set
of vectors describing the extent of a molecule in three orthogonal
directions. This kind of analysis can be useful when trying to highlight
the fact that a molecule is constrained in a given direction.</p>
<p>For a given triplet of non-colinear atoms <em>g</em>=(a1,a2,a3), one can
derive an orthonormal set of three vectors v1, v2, v3 using the
following scheme:</p>
<ul>
<li><div class="math">
<p><span class="math">v_{1} = \frac{n_{1} + n_{2}}{\left| \left| {n_{1} + n_{2}} \right| \right|}</span></p>
</div><p>where <strong>n</strong><sub>1</sub> and <strong>n</strong><sub>2</sub> are respectively the
normalized vectors along (<strong>a1,a2</strong>) and (<strong>a1,a3</strong>) directions.</p>
</li>
<li><p>v2 is defined as the clockwise normal vector orthogonal to v1 that
belongs to the plane defined by a1, a2 and a3 atoms</p></li>
<li><div class="math">
<p><span class="math">{\overrightarrow{v_{3}} = \overrightarrow{v_{1}}}\times\overrightarrow{v_{2}}</span></p>
</div></li>
</ul>
<p>Thus, one can define the following autocorrelation functions for the
vectors v1, v2 and v3 defined on triplet t :</p>
<div class="math">
<p><span class="math">\begin{matrix}
{AC_{g,i}{(t) = \left\langle {v_{t,i}(0)\cdot v_{t,i}(t)} \right\rangle},{i = 1,2,3}} \\
{({\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}1})} \\
\end{matrix}</span></p>
</div><p>And the angular correlation averaged over all triplets is:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{AC_{i}{(t) = {\sum\limits_{g = 1}^{N_{\mathit{triplets}}}{AC_{g,i}(t)}}},{i = 1,2,3}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}2} \right) \\
\end{matrix}</span></p>
</div><p>where N<sub>triplets</sub> is the number of selected triplets.</p>
<p>GUI</p>
<a class="reference internal image-reference" href="../_images/10000001000003220000021BA346CFB73717C1BE.png"><img alt="../_images/10000001000003220000021BA346CFB73717C1BE.png" src="../_images/10000001000003220000021BA346CFB73717C1BE.png" style="width: 15.921cm; height: 10.7cm;" /></a>
<p>Parameters:</p>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Axis_Selection_1">axis selection</a></p></li>
<li><p><a class="reference external" href="#_Output_contribution_per">output contribution per axis</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="density-of-states">
<h5><span class="section-number">7.9.1.1.2. </span>Density Of States<a class="headerlink" href="#density-of-states" title="Permalink to this heading"></a></h5>
<p id="theory-and-implementation-1">Theory and implementation</p>
<p><em>MDANSE</em> calculates the power spectrum of the <em>VACF</em>, which in case of
the mass-weighted <em>VACF</em> defines the phonon discrete <em>DOS</em>, (see the
section on <a class="reference external" href="#_Theory_and_implementation_1">VACF</a>) defined as:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\mathit{DOS}\left( {n\cdot\mathit{\Delta\nu}} \right)\doteq{\sum\limits_{\alpha}\omega_{\alpha}}{\overset{\sim}{C}}_{\mathit{vv};\mathit{\alpha\alpha}}\left( {n\cdot\mathit{\Delta\nu}} \right),{n = 0}\ldots{N_{t} - 1.}} \\
(3) \\
\end{matrix}</span></p>
</div><p>N<sub>t</sub> is the total number of time steps and</p>
<div class="math">
<p><span class="math">{\mathit{\Delta\nu} = 1}\text{/}\left( {2N_{t}\Delta t} \right)</span></p>
</div><p>is the frequency step.</p>
<div class="math">
<p><span class="math">\mathit{DOS}\left( {n\cdot\mathit{\Delta\nu}} \right)</span></p>
</div><p>can be computed either for the isotropic case or with respect to a
user-defined axis. The spectrum</p>
<div class="math">
<p><span class="math">\mathit{DOS}\left( {n\cdot\Delta\nu} \right)</span></p>
</div><p>is computed from the <em>unnormalized VACF</em>, such that <em>DOS(0)</em> gives an
approximate value for the diffusion constant</p>
<div class="math">
<p><span class="math">D = {\sum\limits_{\alpha}D_{\alpha}}</span></p>
</div><p>(see Eqs.</p>
<div class="math">
<p><span class="math">10</span></p>
</div><p><a class="reference external" href="#anchor-73">Error: Reference source not found</a> and</p>
<div class="math">
<p><span class="math">11</span></p>
</div><p><a class="reference external" href="#anchor-74">Error: Reference source not found</a>).</p>
<div class="math">
<p><span class="math">\mathit{DOS}\left( {n\cdot\Delta\nu} \right)</span></p>
</div><p>is smoothed by applying a Gaussian window in the time domain
[<a class="reference external" href="#SignetBibliographie_010">10</a>] (see the section on <a class="reference external" href="#_Theory_and_implementation">Spatial
Density</a>). Its width in the time domain
is</p>
<div class="math">
<p><span class="math">{\sigma_{t} = \alpha}\text{/}T</span></p>
</div><p>, where T is the length of the simulation. We remark that the diffusion
constant obtained from <em>DOS</em> is biased due to the spectral smoothing
procedure since the <em>VACF</em> is weighted by this window Gaussian function.
<em>MDANSE</em> computes the density of states starting from both atomic
velocities and atomic coordinates. In this case the velocities are
computed by numerical differentiation of the coordinate trajectories
correcting first for possible jumps due to periodic boundary conditions.</p>
<p id="gui-1">GUI</p>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<p><a class="reference internal" href="../_images/1000000100000323000002D1329469D922AFA541.png"><img alt="image14" src="../_images/1000000100000323000002D1329469D922AFA541.png" style="width: 15.921cm; height: 14.295cm;" /></a> <a class="reference internal" href="../_images/100000010000031E000000F3118920C50EDE8CB0.png"><img alt="image15" src="../_images/100000010000031E000000F3118920C50EDE8CB0.png" style="width: 15.921cm; height: 4.847cm;" /></a></p>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Instrument_resolution">instrument resolution</a></p></li>
<li><p><a class="reference external" href="#_Interpolation_order">interpolation order</a></p></li>
<li><p><a class="reference external" href="#_Project_coordinates">project coordinates</a></p></li>
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Group_coordinates_by">Group coordinates by</a></p></li>
<li><p><a class="reference external" href="#_Atom_Transmutation_1">atom transmutation</a></p></li>
<li><p><a class="reference external" href="#_Weights">weights</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="general-autocorrelation-function">
<h5><span class="section-number">7.9.1.1.3. </span>General AutoCorrelation Function<a class="headerlink" href="#general-autocorrelation-function" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<p><a class="reference internal" href="../_images/100000010000031F00000248D8781028790CCDA5.png"><img alt="image16" src="../_images/100000010000031F00000248D8781028790CCDA5.png" style="width: 15.921cm; height: 11.636cm;" /></a> <a class="reference internal" href="../_images/100000010000031E00000105F69265329BBA5756.png"><img alt="image17" src="../_images/100000010000031E00000105F69265329BBA5756.png" style="width: 15.921cm; height: 5.207cm;" /></a></p>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Group_coordinates_by">Group coordinates by</a></p></li>
<li><p><a class="reference external" href="#_Atom_Transmutation_1">atom transmutation</a></p></li>
<li><p><strong>trajectory variable</strong></p></li>
</ul>
<p><em>Format:</em> drop-down</p>
<p><em>Default:</em> configuration</p>
<p><em>Description:</em> determines the variable for which the autocorrelation
function is calculated. Therefore, if the selected variable is
‘configuration’, essentially position autocorrelation function is
calculated.</p>
<ul class="simple">
<li><p><a class="reference external" href="#_Normalize">normalize</a></p></li>
<li><p><a class="reference external" href="#_Weights">weights</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="mean-square-displacement">
<h5><span class="section-number">7.9.1.1.4. </span>Mean Square Displacement<a class="headerlink" href="#mean-square-displacement" title="Permalink to this heading"></a></h5>
<p id="theory-and-implementation-2">Theory and implementation</p>
<p>Molecules in liquids and gases do not stay in the same place but move
constantly. This process is called diffusion and it happens quite
naturally in fluids at equilibrium. During this process, the motion of
an individual molecule does not follow a simple path. As it travels, the
molecule undergoes some collisions with other molecules which prevent it
from following a straight line. If the path is examined in close detail,
it will be seen to be a good approximation to a random walk.
Mathematically, a random walk is a series of steps where each step is
taken in a completely random direction from the one before. This kind of
path was famously analysed by Albert Einstein in a study of Brownian
motion. He showed that the Mean-Square Displacement (<em>MSD</em>) of a
particle following a random walk is proportional to the time elapsed.
This relationship can be written as</p>
<div class="math">
<p><span class="math">\begin{matrix}
{{\left\langle r^{2} \right\rangle = 6}{\mathit{Dt} + C}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}3} \right) \\
\end{matrix}</span></p>
</div><p>where &lt; r2 &gt; is the <em>MSD</em> and <em>t</em> is the time. <em>D</em> and <em>C</em> are
constants. The constant <em>D</em> defines the so-called diffusion coefficient.</p>
<p>The <a class="reference external" href="#figure1">Figure 1</a> shows an example of an <em>MSD</em> analysis
performed on a water box of 768 water molecules. To get the diffusion
coefficient out of this plot, the slope of the linear part of the plot
should be calculated.</p>
<a class="reference internal image-reference" href="../_images/10000000000001BC00000163C18A769B32940652.png"><img alt="../_images/10000000000001BC00000163C18A769B32940652.png" src="../_images/10000000000001BC00000163C18A769B32940652.png" style="width: 11.748cm; height: 9.393cm;" /></a>
<p>Figure 1: <em>MSD</em> calculated for a 100 ps MD simulation of 256 water
molecules using NPT condition at 1 bar and 300 K.</p>
<p>Defining</p>
<div class="math">
<p><span class="math">\begin{matrix}
{d_{\alpha}\left( {t,t_{0}} \right)\doteq R_{\alpha}{\left( {t_{0} + t} \right) - R_{\alpha}}\left( t_{0} \right),} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}4} \right) \\
\end{matrix}</span></p>
</div><p>the <em>MSD</em> of particle α can be defined as:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\mathrm{\Delta}_{\alpha}^{2}{(t) = \left\langle {d_{\alpha}^{2}\left( {t,t_{0}} \right)} \right\rangle_{t_{0}}}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}5} \right) \\
\end{matrix}</span></p>
</div><p>where R_(t0) and R_(t0 + t) are respectively the position of particle α
at times t0 and t0 + t. One can introduce an <em>MSD</em> with respect to a
given axis n:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\mathrm{\Delta}_{\alpha}^{2}\left( {t,t_{0};n} \right)\doteq\left\langle {d_{\alpha}^{2}\left( {t,\tau;n} \right)} \right\rangle_{t_{0}}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}6} \right) \\
\end{matrix}</span></p>
</div><p>with</p>
<div class="math">
<p><span class="math">\begin{matrix}
{d_{\alpha}^{}\left( {t,\tau;n} \right)\doteq n\bullet d_{\alpha}^{}\left( {t,t_{0}} \right).} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}7} \right) \\
\end{matrix}</span></p>
</div><p>The calculation of <em>MSD</em> is the standard way to obtain diffusion
coefficients from Molecular Dynamics (<em>MD</em>) simulations. Assuming
Einstein-diffusion in the long time limit one has for isotropic systems</p>
<div class="math">
<p><span class="math">\begin{matrix}
{{D_{\alpha} = {\lim\limits_{t\rightarrow\infty}{\frac{1}{6t}\mathrm{\Delta}_{\alpha}^{2}(t)}}}.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}8} \right) \\
\end{matrix}</span></p>
</div><p>There exists also a well-known relation between the <em>MSD</em> and the
velocity autocorrelation function. Writing</p>
<div class="math">
<p><span class="math">d_{\alpha}{(t) = {\int\limits_{0}^{t}{\mathit{d\tau}v_{\alpha}(\tau)}}}</span></p>
</div><p>in Eq.</p>
<div class="math">
<p><span class="math">5</span></p>
</div><p><a class="reference external" href="#anchor-84">Error: Reference source not found</a> one can show (see
e.g. [<a class="reference external" href="#SignetBibliographie_011">11</a>]) that</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\mathrm{\Delta}_{\alpha}^{2}{(t) = 6}{\int\limits_{0}^{t}{\mathit{d\tau}\left( {t - \tau} \right)C_{\mathit{\upsilon\upsilon};\mathit{\alpha\alpha}}(t)}}.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}9} \right) \\
\end{matrix}</span></p>
</div><p>Using now the definition</p>
<div class="math">
<p><span class="math">8</span></p>
</div><p><a class="reference external" href="#anchor-85">Error: Reference source not found</a> of the diffusion
coefficient one obtains the relation</p>
<div class="math">
<p><span class="math">\begin{matrix}
{{D_{\alpha} = {\int\limits_{0}^{t}{\mathit{d\tau}C_{\mathit{\upsilon\upsilon};\mathit{\alpha\alpha}}(t)}}}.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}10} \right) \\
\end{matrix}</span></p>
</div><p>With Eq.</p>
<div class="math">
<p><span class="math">28</span></p>
</div><p><a class="reference external" href="#anchor-86">Error: Reference source not found</a> this can also be
written as</p>
<div class="math">
<p><span class="math">\begin{matrix}
{{D_{\alpha} = \pi}{\overset{\sim}{C}}_{\mathit{\upsilon\upsilon};\mathit{\alpha\alpha}}(0).} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}11} \right) \\
\end{matrix}</span></p>
</div><p>Computationally, the <em>MSD</em> is calculated using the Fast Correlation
Algorithm (<em>FCA</em>) [<a class="reference external" href="#SignetBibliographie_012">12</a>]. In this
framework, in the discrete case, the mean-square displacement of a
particle is given by</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\mathrm{\Delta}^{2}{(m) = \frac{1}{N_{t} - m}}{\sum\limits_{k = 0}^{N_{t} - m - 1}\left\lbrack {r{\left( {k + m} \right) - r}(k)} \right\rbrack^{2}},{m = 0.}..{N_{t} - 1}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}12} \right) \\
\end{matrix}</span></p>
</div><p>where r(k) is the particle trajectory and Nt is the number of frames of
the trajectory. We define now the auxiliary function</p>
<div class="math">
<p><span class="math">\begin{matrix}
{S(m)\doteq{\sum\limits_{k = 0}^{N_{t} - m - 1}\left\lbrack {r{\left( {k + m} \right) - r}(k)} \right\rbrack^{2}},{m = 0}...N{t - 1},} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}13} \right) \\
\end{matrix}</span></p>
</div><p>which is split as follows:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{S{(m) = S_{\mathit{AA} + \mathit{BB}}}{(m) - 2}S_{\mathit{AB}}(m),} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}14} \right) \\
\end{matrix}</span></p>
</div><div class="math">
<p><span class="math">\begin{matrix}
{S_{\mathit{AA} + \mathit{BB}}{(m) = \sum\limits_{k = 0}^{N_{t} - m - 1}}\left\lbrack {r^{2}{\left( {k + m} \right) + r^{2}}(k)} \right\rbrack,} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}15} \right) \\
\end{matrix}</span></p>
</div><div class="math">
<p><span class="math">\begin{matrix}
{S_{\mathit{AB}}{(m) = {\sum\limits_{k = 0}^{N_{t} - m - 1}{r(k)}}}\cdot r\left( {k + m} \right).} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}16} \right) \\
\end{matrix}</span></p>
</div><p>The function SAB(m) can be computed using the <em>FCA</em> method described in
the section on <a class="reference external" href="#_Theory_and_implementation">Spatial Density</a>. For
SAA+BB(m) the following recursion relation holds:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{S_{\mathit{AA} + \mathit{BB}}{(m) = S_{\mathit{AA} + \mathit{BB}}}{\left( {m - 1} \right) - r^{2}}{\left( {m - 1} \right) - r^{2}}\left( {N_{t} - m} \right),} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}17} \right) \\
\end{matrix}</span></p>
</div><div class="math">
<p><span class="math">\begin{matrix}
{S_{\mathit{AA} + \mathit{BB}}{(0) = {\sum\limits_{k = 0}^{N_{t} - 1}{r^{2}(k)}}}.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}18} \right) \\
\end{matrix}</span></p>
</div><p>This allows one to construct the following efficient scheme for the
computation of the <em>MSD</em>:</p>
<ol class="arabic">
<li><p>Compute</p>
<div class="math">
<p><span class="math">\mathit{DSQ}{{(k)} = r}2{(k)},{k = 0}...N{t - 1}</span></p>
</div><p>;</p>
<div class="math">
<p><span class="math">\mathit{DSQ}{{({- 1})} = \mathit{DSQ}}{{({Nt})} = 0}</span></p>
</div><p>.</p>
</li>
<li><p>Compute</p>
<div class="math">
<p><span class="math">{\mathit{SUMSQ} = 2}\cdot{\sum\limits_{k = 0}^{N_{t} - 1}{\mathit{DSQ}(k)}}</span></p>
</div></li>
<li><p>Compute SAB(m) using the Fast Fourier Transform (<em>FFT</em>) method.</p></li>
<li><p>Compute <em>MSD(m)</em> in the following loop:</p></li>
</ol>
<div class="math">
<p><span class="math">\mathit{SUMSQ}\leftarrow{\mathit{SUMSQ} - \mathit{DSQ}}{{({m - 1})} - \mathit{DSQ}}{({N{t - m}})}</span></p>
</div><div class="math">
<p><span class="math">\mathit{MSD}{(m)}\leftarrow{}</span></p>
</div><p>m running from 0 to Nt – 1</p>
<p>It should be noted that the efficiency of this algorithm is the same as
for the <em>FCA</em> computation</p>
<p>of time correlation functions since the number of operations in step
(1), (2), and (4) grows</p>
<p>linearly with Nt.</p>
<p id="gui-2">GUI</p>
<p><a class="reference internal" href="../_images/100000010000031F00000247259172131CFA3B36.png"><img alt="image18" src="../_images/100000010000031F00000247259172131CFA3B36.png" style="width: 15.921cm; height: 11.617cm;" /></a> <a class="reference internal" href="../_images/100000010000031F000001000B539E0E94164B2D.png"><img alt="image19" src="../_images/100000010000031F000001000B539E0E94164B2D.png" style="width: 15.921cm; height: 5.101cm;" /></a></p>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Project_coordinates">project coordinates</a></p></li>
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Group_coordinates_by">Group coordinates by</a></p></li>
<li><p><a class="reference external" href="#_Atom_Transmutation_1">atom transmutation</a></p></li>
<li><p><a class="reference external" href="#_Weights">weights</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="order-parameter">
<h5><span class="section-number">7.9.1.1.5. </span>Order Parameter<a class="headerlink" href="#order-parameter" title="Permalink to this heading"></a></h5>
<p id="theory-and-implementation-3">Theory and implementation</p>
<p>Adequate and accurate cross comparison of the NMR and <em>MD</em> simulation
data is of crucial importance in versatile studies conformational
dynamics of proteins. NMR relaxation spectroscopy has proven to be a
unique approach for a site-specific investigation of both global
tumbling and internal motions of proteins. The molecular motions
modulate the magnetic interactions between the nuclear spins and lead
for each nuclear spin to a relaxation behaviour which reflects its
environment. Since its first applications to the study of protein
dynamics, a wide variety of experiments has been proposed to investigate
backbone as well as side chain dynamics. Among them, the heteronuclear
relaxation measurement of amide backbone <sup>15</sup>N nuclei is one of
the most widespread techniques. The relationship between microscopic
motions and measured spin relaxation rates is given by Redfield’s theory
[<a class="reference external" href="#SignetBibliographie_013">13</a>]. Under the hypothesis that
<sup>15</sup>N relaxation occurs through dipole-dipole interactions with
the directly bonded <sup>1</sup>H atom and chemical shift anisotropy
(CSA), and assuming that the tensor describing the CSA is axially
symmetric with its axis parallel to the N-H bond, the relaxation rates
of the <sup>15</sup>N nuclei are determined by a time correlation
function,</p>
<div class="math">
<p><span class="math">\begin{matrix}
{C_{\mathit{ii}}{(t) = \left\langle {P_{2}\left( {\mu_{i}(0)\cdot\mu_{i}(t)} \right)} \right\rangle}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}19} \right) \\
\end{matrix}</span></p>
</div><p>which describes the dynamics of a unit vector μ<sub>i</sub>(t) pointing
along the <sup>15</sup>N-<sup>1</sup>H bond of the residue <em>i</em> in the
laboratory frame. Here P<sub>2</sub>(.) is the second order Legendre
polynomial. The Redfield theory shows that relaxation measurements probe
the relaxation dynamics of a selected nuclear spin only at a few
frequencies. Moreover, only a limited number of independent observables
are accessible. Hence, to relate relaxation data to protein dynamics one
has to postulate either a dynamical model for molecular motions or a
functional form for C<sub>ii</sub>(t), yet depending on a limited number
of adjustable parameters. Usually, the tumbling motion of proteins in
solution is assumed isotropic and uncorrelated with the internal
motions, such that:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{C_{\mathit{ii}}{(t) = C^{G}}(t)\cdot C_{\mathit{ii}}^{I}(t)} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}20} \right) \\
\end{matrix}</span></p>
</div><p>where C<sup>G</sup>(t) and</p>
<div class="math">
<p><span class="math">C_{\mathit{ii}}^{I}(t)</span></p>
</div><p>denote the global and the internal time correlation function,
respectively. Within the so-called model free approach
[<a class="reference external" href="#SignetBibliographie_014">14</a>], [<a class="reference external" href="#SignetBibliographie_015">15</a>]
the internal correlation function is modelled by an exponential,</p>
<div class="math">
<p><span class="math">\begin{matrix}
{C_{\mathit{ii}}^{I}{(t) = {S_{i}^{2} + \left( {1 - S_{i}^{2}} \right)}}\exp\left( \frac{- t}{\tau_{\mathit{eff},i}} \right)} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}21} \right) \\
\end{matrix}</span></p>
</div><p>Here the asymptotic value</p>
<div class="math">
<p><span class="math">{S_{i}^{2} = C_{\mathit{ii}}}\left( {+ \infty} \right)</span></p>
</div><p>is the so-called generalized order parameter, which indicates the
degree of spatial restriction of the internal motions of a bond vector,
while the characteristic time</p>
<div class="math">
<p><span class="math">\tau_{\mathit{eff},i}</span></p>
</div><p>is an effective correlation time, setting the time scale of the
internal relaxation processes.</p>
<div class="math">
<p><span class="math">S_{i}^{2}</span></p>
</div><p>can adopt values ranging from 0 (completely disordered) to 1 (fully
ordered). So,</p>
<div class="math">
<p><span class="math">S_{i}^{2}</span></p>
</div><p>is the appropriate indicator of protein backbone motions in
computationally feasible timescales as it describes the spatial aspects
of the reorientational motion of N-H peptidic bonds vector.</p>
<p>When performing Order Parameter analysis, <em>MDANSE</em> computes for each
residue <em>i</em> both</p>
<div class="math">
<p><span class="math">C_{\mathit{ii}}(t)</span></p>
</div><p>and</p>
<div class="math">
<p><span class="math">S_{i}^{2}</span></p>
</div><p>. It also computes a correlation function averaged over all the selected
bonds defined as:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{C^{I}{(t) = {\sum\limits_{i = 1}^{N_{\mathit{bonds}}}{C_{\mathit{ii}}^{I}(t)}}}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}22} \right) \\
\end{matrix}</span></p>
</div><p>where N<sub>bonds</sub> is the number of selected bonds for the analysis.</p>
<p id="gui-3">GUI</p>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<a class="reference internal image-reference" href="../_images/10000001000003220000027563B8CBFF70E2089C.png"><img alt="../_images/10000001000003220000027563B8CBFF70E2089C.png" src="../_images/10000001000003220000027563B8CBFF70E2089C.png" style="width: 15.921cm; height: 12.487cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Axis_Selection_1">axis selection</a></p></li>
<li><p>reference direction</p>
<ul>
<li><p><strong>x-component</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int or float</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> &lt;insert&gt;</p>
<ul class="simple">
<li><ul>
<li><p><strong>y-component</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int or float</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> &lt;insert&gt;</p>
<ul class="simple">
<li><ul>
<li><p><strong>z-component</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int or float</p>
<p><em>Default:</em> 1</p>
<p><em>Description:</em> &lt;insert&gt;</p>
<ul class="simple">
<li><p><a class="reference external" href="#_Output_contribution_per">output contribution per axis</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="position-autocorrelation-function">
<h5><span class="section-number">7.9.1.1.6. </span>Position AutoCorrelation Function<a class="headerlink" href="#position-autocorrelation-function" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<p><a class="reference internal" href="../_images/1000000100000320000001F34B3598CBB7D90098.png"><img alt="image20" src="../_images/1000000100000320000001F34B3598CBB7D90098.png" style="width: 15.921cm; height: 9.931cm;" /></a> <a class="reference internal" href="../_images/1000000100000322000001997BE6CF552F7A05D0.png"><img alt="image21" src="../_images/1000000100000322000001997BE6CF552F7A05D0.png" style="width: 15.921cm; height: 8.119cm;" /></a></p>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Normalize">normalize</a></p></li>
<li><p><a class="reference external" href="#_Project_coordinates">project coordinates</a></p></li>
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Group_coordinates_by">Group coordinates by</a></p></li>
<li><p><a class="reference external" href="#_Atom_Transmutation_1">atom transmutation</a></p></li>
<li><p><a class="reference external" href="#_Weights">weights</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="velocity-autocorrelation-function">
<h5><span class="section-number">7.9.1.1.7. </span>Velocity AutoCorrelation Function<a class="headerlink" href="#velocity-autocorrelation-function" title="Permalink to this heading"></a></h5>
<p id="theory-and-implementation-4">Theory and implementation</p>
<p>The Velocity AutoCorrelation Function (<em>VACF</em>) is another interesting
property describing the dynamics of a molecular system. Indeed, it
reveals the underlying nature of the forces acting on the system.</p>
<p>In a molecular system that would be made of non-interacting particles,
the velocities would be constant at any time triggering the <em>VACF</em> to be
a constant value. Now, if we think about a system with small
interactions such as in a gas-phase, the magnitude and direction of the
velocity of a particle will change gradually over time due to its
collision with the other particles of the molecular system. In such a
system, the <em>VACF</em> will be represented by a decaying exponential.</p>
<p>In the case of solid phase, the interactions are much stronger and, as a
results, the atoms are bound to a given position from which they will
move backwards and forwards oscillating between positive and negative
values of their velocity. The oscillations will not be of equal
magnitude however, but will decay in time, because there are still
perturbative forces acting on the atoms to disrupt the perfection of
their oscillatory motion. So, in that case the <em>VACF</em> will look like a
damped harmonic motion.</p>
<p>Finally, in the case of liquid phase, the atoms have more freedom than
in solid phase and because of the diffusion process, the oscillatory
motion seen in solid phase will be cancelled quite rapidly depending on
the density of the system. So, the <em>VACF</em> will just have one very damped
oscillation before decaying to zero. This decaying time can be
considered as the average time for a collision between two atoms to
occur before they diffuse away.</p>
<p>Mathematically, the <em>VACF</em> of atom α in an atomic or molecular system is
usually defined as</p>
<div class="math">
<p><span class="math">\begin{matrix}
{C_{\mathit{vv};\mathit{\alpha\alpha}}(t)\doteq\frac{1}{3}\left\langle {v_{\alpha}\left( t_{0} \right)\cdot v_{\alpha}\left( {t_{0} + t} \right)} \right\rangle_{t_{0}}.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}23} \right) \\
\end{matrix}</span></p>
</div><p>In some cases, e.g. for non-isotropic systems, it is useful to define
<em>VACF</em> along a given axis,</p>
<div class="math">
<p><span class="math">\begin{matrix}
{C_{\mathit{vv};\mathit{\alpha\alpha}}\left( {t;n} \right)\doteq\left\langle {v_{\alpha}\left( {t_{0};n} \right)v_{\alpha}\left( {{t_{0} + t};n} \right)} \right\rangle_{t_{0}},} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}24} \right) \\
\end{matrix}</span></p>
</div><p>where v<sub>α</sub>(t; <strong>n</strong>) is given by</p>
<div class="math">
<p><span class="math">\begin{matrix}
{v_{\alpha}\left( {t;n} \right)\doteq n\cdot v_{\alpha}(t).} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}25} \right) \\
\end{matrix}</span></p>
</div><p>The vector n is a unit vector defining a space-fixed axis.</p>
<p>The <em>VACF</em> of the particles in a many body system can be related to the
incoherent dynamic structure factor by the relation:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\mathit{li}m_{q\rightarrow 0}\frac{\omega^{2}}{q^{2}}S{\left( {q,\omega} \right) = G}(\omega),} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}26} \right) \\
\end{matrix}</span></p>
</div><p>where G(ω) is the Density Of States (<em>DOS</em>). For an isotropic system it
reads</p>
<div class="math">
<p><span class="math">\begin{matrix}
{G{(\omega) = {\sum\limits_{\alpha}{b_{\alpha,\mathit{inc}}^{2}{\overset{\sim}{C}}_{\mathit{vv};\mathit{\alpha\alpha}}(\omega)}}},} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}27} \right) \\
\end{matrix}</span></p>
</div><div class="math">
<p><span class="math">\begin{matrix}
{{\overset{\sim}{C}}_{\mathit{vv};\mathit{\alpha\alpha}}{(\omega) = \frac{1}{2\pi}}{\int\limits_{- \infty}^{+ \infty}\mathit{dt}}\exp\left\lbrack {{- i}\omega t} \right\rbrack C_{\mathit{vv};\mathit{\alpha\alpha}}(t).} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}28} \right) \\
\end{matrix}</span></p>
</div><p>For non-isotropic systems, relation</p>
<div class="math">
<p><span class="math">26</span></p>
</div><p><a class="reference external" href="#anchor-98">Error: Reference source not found</a> holds if the <em>DOS</em>
is computed from the atomic velocity autocorrelation functions</p>
<div class="math">
<p><span class="math">C_{\mathit{vv};\mathit{\alpha\alpha}}\left( {t;n_{q}} \right)</span></p>
</div><p>, where nq is the unit vector in the direction of q.</p>
<p id="gui-4">GUI</p>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<p><a class="reference internal" href="../_images/100000010000031F000001F4716D097EF0177F0B.png"><img alt="image22" src="../_images/100000010000031F000001F4716D097EF0177F0B.png" style="width: 15.921cm; height: 9.964cm;" /></a> <a class="reference internal" href="../_images/100000010000031F000001BDEA9E86A41E3EBCA6.png"><img alt="image23" src="../_images/100000010000031F000001BDEA9E86A41E3EBCA6.png" style="width: 15.921cm; height: 8.867cm;" /></a></p>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Interpolation_order">interpolation order</a></p></li>
<li><p><a class="reference external" href="#_Project_coordinates">project coordinates</a></p></li>
<li><p><a class="reference external" href="#_Normalize">normalize</a></p></li>
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Group_coordinates_by">Group coordinates by</a></p></li>
<li><p><a class="reference external" href="#_Atom_Transmutation_1">atom transmutation</a></p></li>
<li><p><a class="reference external" href="#_Weights">weights</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
</section>
<section id="infrared">
<h4><span class="section-number">7.9.1.2. </span>Infrared<a class="headerlink" href="#infrared" title="Permalink to this heading"></a></h4>
<section id="dipole-autocorrelation-function">
<h5><span class="section-number">7.9.1.2.1. </span>Dipole AutoCorrelation Function<a class="headerlink" href="#dipole-autocorrelation-function" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<a class="reference internal image-reference" href="../_images/10000001000003200000022889DD21920219B434.png"><img alt="../_images/10000001000003200000022889DD21920219B434.png" src="../_images/10000001000003200000022889DD21920219B434.png" style="width: 15.921cm; height: 10.986cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Atom_Charges_1">atom charges</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
</section>
<section id="macromolecules">
<h4><span class="section-number">7.9.1.3. </span>Macromolecules<a class="headerlink" href="#macromolecules" title="Permalink to this heading"></a></h4>
<p>This section has one subsection, Lipids, which contains following
Plugins:</p>
<ul class="simple">
<li><p>Refolded Membrane Trajectory</p></li>
</ul>
<section id="refolded-membrane-trajectory">
<h5><span class="section-number">7.9.1.3.1. </span>Refolded Membrane Trajectory<a class="headerlink" href="#refolded-membrane-trajectory" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<a class="reference internal image-reference" href="../_images/100000010000032200000202AC02A063F408C4F9.png"><img alt="../_images/100000010000032200000202AC02A063F408C4F9.png" src="../_images/100000010000032200000202AC02A063F408C4F9.png" style="width: 15.921cm; height: 10.204cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><strong>membrane axis</strong></p></li>
</ul>
<p><em>Format:</em> drop-down</p>
<p><em>Default:</em> c</p>
<p><em>Description:</em> the axis along which is used for the trajectory
manipulation, the normal to the membrane.</p>
<ul class="simple">
<li><p><strong>name of the lipid of the upper leaflet</strong></p></li>
</ul>
<p><em>Format:</em> str</p>
<p><em>Default:</em> DMPC</p>
<p><em>Description:</em> the name of the lipid positioned in the upper leaflet of
the membrane. It will be repositioned into the upper part of the
simulation box. The name must be the name with which MMTK refers to the
lipid.</p>
<ul class="simple">
<li><p><strong>name of the lipid of the lower leaflet</strong></p></li>
</ul>
<p><em>Format:</em> str</p>
<p><em>Default:</em> DMPC</p>
<p><em>Description:</em> the name of the lipid positioned in the lower leaflet of
the membrane. It will be repositioned into the lower part of the
simulation box. The name must be the name with which MMTK refers to the
lipid.</p>
<ul class="simple">
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
</ul>
</section>
</section>
<section id="scattering">
<h4><span class="section-number">7.9.1.4. </span>Scattering<a class="headerlink" href="#scattering" title="Permalink to this heading"></a></h4>
<p>Below is a list of Plugins contained in this section. They are all used
to calculate neutron spectroscopy observables from the trajectory.</p>
<ul class="simple">
<li><p><a class="reference external" href="#_Current_Correlation_Function">Current Correlation Function</a></p></li>
<li><p><a class="reference external" href="#_Dynamic_Coherent_Structure">Dynamic Coherent Structure Factor</a></p></li>
<li><p><a class="reference external" href="#_Dynamic_Incoherent_Structure">Dynamic Incoherent Structure
Factor</a></p></li>
<li><p><a class="reference external" href="#_Elastic_Incoherent_Structure">Elastic Incoherent Structure
Factor</a></p></li>
<li><p><a class="reference external" href="#_Gaussian_Dynamic_Incoherent">Gaussian Dynamic Incoherent Structure
Factor</a></p></li>
<li><p><a class="reference external" href="#_Neutron_Dynamic_Total">Neutron Dynamic Total Structure Factor</a></p></li>
<li><p><a class="reference external" href="#_Structure_Factor_From">Structure Factor From Scattering
Function</a></p></li>
</ul>
<p>These plugins will be explored in depth in further sections, however,
before that, it is important to understand how MDANSE performs these
analyses. A part of that are <a class="reference external" href="#_A3.4._Q_vectors">Q vectors</a>, which
are used to perform these analyses. An in-depth discussion of this
aspect is present in <a class="reference external" href="#_Appendix_2">Appendix 2</a>.</p>
<section id="theory-and-background">
<h5><span class="section-number">7.9.1.4.1. </span>Theory and background<a class="headerlink" href="#theory-and-background" title="Permalink to this heading"></a></h5>
<p>The quantity of interest in neutron scattering experiments with thermal
neutrons is the <em>dynamic structure factor</em>, S(<strong>q</strong>, ω), which is
closely related to the double differential cross-section [7],</p>
<div class="math">
<p><span class="math">d^{2}{\sigma/\mathit{d\Omega dE}}</span></p>
</div><p>. The double differential cross section is defined as the number of
neutrons which are scattered per unit time into the solid angle interval</p>
<div class="math">
<p><span class="math">\left\lbrack {\Omega,{\Omega + d}\Omega} \right\rbrack</span></p>
</div><p>and into the energy interval</p>
<div class="math">
<p><span class="math">{\lbrack{E,{E + \mathit{dE}}}\rbrack}.</span></p>
</div><p>It is normalized to d, <em>dE</em>, and the flux of the incoming neutrons,</p>
<div class="math">
<p><span class="math">\begin{matrix}
{{\frac{d^{2}\sigma}{d\Omega\mathit{dE}} = N}\cdot\frac{k}{k_{0}}S\left( {q,\omega} \right).} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}29} \right) \\
\end{matrix}</span></p>
</div><p>Here <em>N</em> is the number of atoms, and k ≡ |<strong>k</strong>| and k<sub>0</sub> ≡
|<strong>k</strong><sub>0</sub>| are the wave numbers of scattered and incident
neutrons, respectively. They are related to the corresponding neutron
energies by</p>
<div class="math">
<p><span class="math">{E = \hslash^{2}}k^{2}\text{/}2m</span></p>
</div><p>and</p>
<div class="math">
<p><span class="math">{E_{0} = \hslash^{2}}k_{0}^{2}\text{/}2m</span></p>
</div><p>where</p>
<div class="math">
<p><span class="math">m</span></p>
</div><p>is the neutron mass. The arguments of the dynamic structure factor,</p>
<div class="math">
<p><span class="math">q</span></p>
</div><p>and</p>
<div class="math">
<p><span class="math">\omega</span></p>
</div><p>, are the momentum and energy transfer in units of</p>
<div class="math">
<p><span class="math">\hslash</span></p>
</div><p>, respectively:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{{q = \frac{k_{0} - k}{\hslash}},} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}30} \right) \\
\end{matrix}</span></p>
</div><div class="math">
<p><span class="math">\begin{matrix}
{{\omega = \frac{E_{0} - E}{\hslash}}.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}31} \right) \\
\end{matrix}</span></p>
</div><p>The modulus of the momentum transfer can be expressed in the scattering
angle</p>
<div class="math">
<p><span class="math">\theta</span></p>
</div><p>, the energy transfer, and the energy of the incident neutrons:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{{q = \sqrt{{2 - \frac{\mathit{\hslash\omega}}{E_{0}} - 2}\cos{\theta\sqrt{2 - \frac{\mathit{\hslash\omega}}{E_{0}}}}}}.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}32} \right) \\
\end{matrix}</span></p>
</div><p>The dynamic structure factor contains information about the structure
and dynamics of the scattering system
[<a class="reference external" href="#SignetBibliographie_016">16</a>]. It can be written as</p>
<div class="math">
<p><span class="math">\begin{matrix}
{S{\left( {q,\omega} \right) = \frac{1}{2\pi}}{\int\limits_{- \infty}^{+ \infty}\mathit{dt}}\exp\left\lbrack {{- i}\omega t} \right\rbrack F\left( {q,t} \right).} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}33} \right) \\
\end{matrix}</span></p>
</div><p>F(<strong>q</strong>, t) is called the <em>intermediate scattering function</em> and is
defined as</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\text{F}{\left( {q,t} \right) = {\sum\limits_{\alpha,\beta}{\Gamma_{\mathit{\alpha\beta}}\left\langle {\exp\left\lbrack {{- i}q\cdot\hat{R_{\alpha}}(0)} \right\rbrack\exp\left\lbrack {iq\cdot\hat{R_{\beta}}(t)} \right\rbrack} \right\rangle}}},} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}34} \right) \\
\end{matrix}</span></p>
</div><div class="math">
<p><span class="math">\begin{matrix}
{{\Gamma_{\mathit{\alpha\beta}} = \frac{1}{N}}\left\lbrack {\overline{b_{\alpha}}{\overline{b_{\beta}} + \delta_{\mathit{\alpha\beta}}}\left( {\overline{b_{\alpha}^{2}} - {\overline{b_{\alpha}}}^{2}} \right)} \right\rbrack.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}35} \right) \\
\end{matrix}</span></p>
</div><p>The operators</p>
<div class="math">
<p><span class="math">\hat{R_{\alpha}}(t)</span></p>
</div><p>in Eq.</p>
<div class="math">
<p><span class="math">34</span></p>
</div><p><a class="reference external" href="#anchor-110">Error: Reference source not found</a> are the position
operators of the nuclei in the sample. The brackets</p>
<div class="math">
<p><span class="math">\langle\ldots\rangle</span></p>
</div><p>denote a quantum thermal average and the time dependence of the position
operators is defined by the Heisenberg picture. The quantities</p>
<div class="math">
<p><span class="math">b_{\alpha}</span></p>
</div><p>are the scattering lengths of the nuclei which depend on the isotope and
the relative orientation of the spin of the neutron and the spin of the
scattering nucleus. If the spins of the nuclei and the neutron are not
prepared in a special orientation one can assume a random relative
orientation and that spin and position of the nuclei are uncorrelated.
The symbol</p>
<div class="math">
<p><span class="math">\overline{...\mspace{9mu}}</span></p>
</div><p>appearing in</p>
<div class="math">
<p><span class="math">\Gamma_{\mathit{\alpha\beta}}</span></p>
</div><p>denotes an average over isotopes and relative spin orientations of
neutron and nucleus.</p>
<p>Usually, one splits the intermediate scattering function and the dynamic
structure factor into their <em>coherent</em> and <em>incoherent</em> parts which
describe collective and single particle motions, respectively. Defining</p>
<div class="math">
<p><span class="math">\begin{matrix}
{b_{\alpha,\mathit{coh}}\doteq\overline{b_{\alpha}},} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}36} \right) \\
\end{matrix}</span></p>
</div><div class="math">
<p><span class="math">\begin{matrix}
{b_{\alpha,\mathit{inc}}\doteq\sqrt{\overline{b_{\alpha}^{2}} - {\overline{b_{\alpha}}}^{2}},} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}37} \right) \\
\end{matrix}</span></p>
</div><p>the coherent and incoherent intermediate scattering functions can be
cast in the form</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\text{F}_{\text{coh}}{\left( {q,t} \right) = \frac{1}{N}}{\sum\limits_{\alpha,\beta}b_{\alpha,\mathit{coh}}}b_{\beta,\mathit{coh}}\left\langle {\exp\left\lbrack {{- i}q\cdot\hat{R_{\alpha}}(0)} \right\rbrack\exp\left\lbrack {iq\cdot\hat{R_{\beta}}(t)} \right\rbrack} \right\rangle,} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}38} \right) \\
\end{matrix}</span></p>
</div><div class="math">
<p><span class="math">\begin{matrix}
{\text{F}_{\text{inc}}{\left( {q,t} \right) = \frac{1}{N}}{\sum\limits_{\alpha}{b_{\alpha,\mathit{inc}}^{2}\left\langle {\exp\left\lbrack {{- i}q\cdot\hat{R_{\alpha}}(0)} \right\rbrack\exp\left\lbrack {iq\cdot\hat{R_{\alpha}}(t)} \right\rbrack} \right\rangle}}.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}39} \right) \\
\end{matrix}</span></p>
</div><p>Rewriting these formulas, <em>MDANSE</em> introduces the partial terms as:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\text{F}_{\text{coh}}{\left( {q,t} \right) = \sum\limits_{I,J\geq I}^{N_{\mathit{species}}}}\sqrt{n_{I}n_{J}\omega_{I,\text{coh}}\omega_{J,\text{coh}}}F_{\mathit{IJ},\text{coh}}\left( {q,t} \right),} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}40} \right) \\
\end{matrix}</span></p>
</div><div class="math">
<p><span class="math">\begin{matrix}
{\text{F}_{\text{inc}}{\left( {q,t} \right) = {\sum\limits_{I = 1}^{N_{\mathit{species}}}{n_{I}\omega_{I,\text{inc}}F_{I,\text{inc}}\left( {q,t} \right)}}}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}41} \right) \\
\end{matrix}</span></p>
</div><p>where:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\text{F}_{\mathit{IJ},\text{coh}}{\left( {q,t} \right) = \frac{1}{\sqrt{n_{I}n_{J}}}}{\sum\limits_{\alpha}^{n_{I}}{\sum\limits_{\beta}^{n_{J}}\left\langle {\exp\left\lbrack {{- i}q\cdot\hat{R_{\alpha}}\left( t_{0} \right)} \right\rbrack\exp\left\lbrack {iq\cdot\hat{R_{\beta}}\left( {t_{0} + t} \right)} \right\rbrack} \right\rangle_{t_{0}}}},} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}42} \right) \\
\end{matrix}</span></p>
</div><div class="math">
<p><span class="math">\begin{matrix}
{\text{F}_{I,\text{inc}}{\left( {q,t} \right) = \frac{1}{n_{I}}}{\sum\limits_{\alpha = 1}^{n_{I}}\left\langle {\exp\left\lbrack {{- i}q\cdot\hat{R_{\alpha}}\left( t_{0} \right)} \right\rbrack\exp\left\lbrack {iq\cdot\hat{R_{\alpha}}\left( {t_{0} + t} \right)} \right\rbrack} \right\rangle_{t_{0}}}.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}43} \right) \\
\end{matrix}</span></p>
</div><p>where n<sub>I</sub>, n<sub>J</sub>, N<sub>species</sub>, ω<sub>I,coh,inc</sub>
and ω<sub>J,coh,inc</sub> are defined in Section ??.</p>
<p>The corresponding dynamic structure factors are obtained by performing
the Fourier transformation defined in Eq.</p>
<div class="math">
<p><span class="math">33</span></p>
</div><p><a class="reference external" href="#anchor-111">Error: Reference source not found</a>.</p>
<p>An important quantity describing <em>structural</em> properties of liquids is
the <em>static structure factor</em>, which is defined as</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\text{S}(q)\doteq{\int\limits_{- \infty}^{+ \infty}{d\omega}}\text{S}_{\mathit{coh}}\left( {q,\omega} \right)\text{F}_{\mathit{coh}}\left( {q,0} \right).} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}44} \right) \\
\end{matrix}</span></p>
</div><p>In the classical framework the intermediate scattering functions are
interpreted as classical time correlation functions. The position
operators are replaced by time-dependent vector functions and quantum
thermal averages are replaced by classical <em>ensemble averages</em>. It is
well known that this procedure leads to a loss of the universal detailed
balance relation,</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\text{S}{\left( {q,\omega} \right) = \exp}\left\lbrack {\beta\hslash\omega} \right\rbrack\text{S}\left( {{- q}{, - \omega}} \right),} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}45} \right) \\
\end{matrix}</span></p>
</div><p>and also to a loss of all odd moments</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\left\langle \omega^{2{n + 1}} \right\rangle\doteq{\int\limits_{- \infty}^{+ \infty}{d\omega}}\omega^{2{n + 1}}S\left( {q,\omega} \right),{n = 1,2},\ldots.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}46} \right) \\
\end{matrix}</span></p>
</div><p>The odd moments vanish since the classical dynamic structure factor is
even in ω, assuming invariance of the scattering process with respect to
reflections in space. The first moment is also universal. For an atomic
liquid, containing only one sort of atoms, it reads</p>
<div class="math">
<p><span class="math">\begin{matrix}
{{\left\langle \omega \right\rangle = \frac{\hslash q^{2}}{2M}},} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}47} \right) \\
\end{matrix}</span></p>
</div><p>where M is the mass of the atoms. Formula</p>
<div class="math">
<p><span class="math">47</span></p>
</div><p><a class="reference external" href="#anchor-112">Error: Reference source not found</a> shows that the
first moment is given by the average kinetic energy (in units of</p>
<div class="math">
<p><span class="math">\hslash</span></p>
</div><p>) of a particle which receives a momentum transfer</p>
<div class="math">
<p><span class="math">\hslash q</span></p>
</div><p>. Therefore,</p>
<div class="math">
<p><span class="math">\langle\omega\rangle</span></p>
</div><p>is called the <em>recoil moment</em>. A number of ‘recipes’ has been suggested
to correct classical dynamic structure factors for detailed balance and
to describe recoil effects in an approximate way. The most popular one
has been suggested by Schofield [<a class="reference external" href="#SignetBibliographie_017">17</a>]</p>
<div class="math">
<p><span class="math">\begin{matrix}
{{\text{S}\left( {q,\omega} \right)\approx\exp\left\lbrack \frac{\beta\hslash\omega}{2} \right\rbrack}_{}\text{S}_{\mathit{cl}}\left( {q,\omega} \right)} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}48} \right) \\
\end{matrix}</span></p>
</div><p>One can easily verify that the resulting dynamic structure factor
fulfils the relation of detailed balance. Formally, the correction</p>
<div class="math">
<p><span class="math">48</span></p>
</div><p><a class="reference external" href="#anchor-113">Error: Reference source not found</a> is correct to
first order in</p>
<div class="math">
<p><span class="math">\hslash</span></p>
</div><p>. Therefore, it cannot be used for large <em>q</em>-values which correspond to
large momentum transfers</p>
<div class="math">
<p><span class="math">\hslash q</span></p>
</div><p>. This is actually true for all correction methods which have suggested
so far. For more details we refer to Ref.
[<a class="reference external" href="#SignetBibliographie_018">18</a>].</p>
<p>MDANSE computes the partial S(Q)’s as the Fourier transform of the
partial g(r), corresponding to the Faber-Ziman definition:</p>
<div class="math">
<p><span class="math">{S_{\mathit{\text{αβ}}}(Q{) = {1 + \frac{4\mathit{\text{πρ}_{\mathrm{0}}}}{Q}}}{\int\limits_{0}^{\infty}{r\left\lbrack {g_{\mathit{\text{αβ}}}(r{) - 1}} \right\rbrack\text{sin}(\mathit{\text{Qr}})\mathit{dr}}}}{}</span></p>
</div><p>(49)</p>
<p>The total S(Q) is computed as a weighted sum similar to the one used for
the total g(r). In the case of the analysis ‘X-ray Static structure
factor’, the Q-dependence of the atomic form factors is taken into
account in this weighted sum.</p>
<p>Again, Soper has provided experimental data (table 4 in <em>ISRN Physical
Chemistry</em>, 279463 (2013), given in file soper13_fx.dat). Here a source
of confusion is that the data can be normalized in different ways (see
Soper’s paper). Using the normalization II in that reference we have
that:</p>
<div class="math">
<p><span class="math">D_{x}{(Q) = \frac{\sum\limits_{\mathit{\alpha\beta}\geq\alpha}{\left( {2 - \delta_{\mathit{\alpha\beta}}} \right)\times c_{\alpha}c_{\beta}f_{\alpha}{(Q)}f_{\beta}{(Q)}\left\lbrack {S_{\mathit{\alpha\beta}}{(Q) - 1}} \right\rbrack}}{\sum\limits_{\alpha}{c_{\alpha}f_{\alpha}^{2}{(Q)}}} = \left\lbrack {S{(Q) - 1}} \right\rbrack}\times\frac{\sum\limits_{\mathit{\alpha\beta}}{c_{\alpha}c_{\beta}f_{\alpha}{(Q)}f_{\beta}{(Q)}}}{\sum\limits_{\alpha}{c_{\alpha}f_{\alpha}^{2}{(Q)}}}\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}50} \right)</span></p>
</div><p>Where S(Q) would be the static structure factor (going to 1 at large Q)
computed by MDANSE. Therefore, even after using MDANSE we should
recalculate the x-ray observable using the atomic factors.</p>
</section>
<section id="current-correlation-function">
<h5><span class="section-number">7.9.1.4.2. </span>Current Correlation Function<a class="headerlink" href="#current-correlation-function" title="Permalink to this heading"></a></h5>
<p id="theory-and-implementation-5">Theory and implementation</p>
<p>Current correlation function is typically used to study the propagation
of excitations in disordered systems. In MDANSE, its longitudinal and
transverse components are calculated, which are related to density
fluctuations and propagating shear modes respectively. Formalism and
other details can be found in Ref [<a class="reference external" href="#SignetBibliographie_019">19</a>].</p>
<p id="gui-5">GUI</p>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<a class="reference internal image-reference" href="../_images/100000010000030900000411E077B26494EE5017.png"><img alt="../_images/100000010000030900000411E077B26494EE5017.png" src="../_images/100000010000030900000411E077B26494EE5017.png" style="width: 11.883cm; height: 15.921cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Instrument_resolution">instrument resolution</a></p></li>
<li><p><a class="reference external" href="#_Interpolation_order">interpolation order</a></p></li>
<li><p><strong>interpolation mode</strong> (only applicable when interpolation order is
set to something different than ‘no interpolation’)</p></li>
</ul>
<p><em>Format:</em> str</p>
<p><em>Default:</em> automatic</p>
<p><em>Description:</em> the method that will be used to interpolate velocities.
All modes give identical results but differ in speed and memory usage.
The following modes are available:</p>
<ul class="simple">
<li><p><em>one-time in-memory interpolation</em></p></li>
</ul>
<p>In this mode, all velocities are interpolated once, at the beginning,
and stored in memory. This mode is the fastest but requires large
amounts of memory. It is recommended for use with small trajectories.
When used with large trajectories, it is advisable that a computer with
sufficient memory is used.</p>
<ul class="simple">
<li><p><em>repeated interpolation</em></p></li>
</ul>
<p>In this mode, all velocities are interpolated in each loop over
Q-shells. Therefore, it is slower, though less memory is required.
However, the largest memory usage depends on the composition of the
sample; it is most efficient when all elements have equal number of
particles in the sample, and the least when one element has the majority
of particles. Thus, it is advisable that this mode is used with medium
trajectories with even distribution of elements, especially when the
computer has only an HDD. When used with large trajectories, please
ensure that the computer has sufficient memory.</p>
<ul class="simple">
<li><p><em>one-time disk interpolation</em></p></li>
</ul>
<p>In this mode, all velocities are interpolated once, at the beginning,
and stored on disk. This makes it slow but with little memory
requirement. This balance of speed and memory can be further altered by
using the ‘number of preloaded frames’ option. This mode is meant for
when the computer has insufficient memory for the other modes and is
advisable to be used with large trajectories. Further, since disk is
involved, it is advisable that the computer has an SSD, and that the
operating system’s temp folder is on that disk.</p>
<ul class="simple">
<li><p><em>automatic</em></p></li>
</ul>
<p>In this mode, MDANSE selects one of the above modes to be used that
should be best given the hardware. It does this by estimating the memory
requirements and comparing them to the total memory of the computer.</p>
<ul class="simple">
<li><p><strong>number of preloaded frames</strong> (only applicable when ‘interpolation
mode’ is set to ‘one-time disk interpolation)</p></li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 50</p>
<p><em>Description:</em> this option allows for the optimisation of the ‘one-time
disk interpolation’ interpolation mode. It governs the number of frames
for which the velocities are loaded from disk to memory at once. Thus,
if it is set to 1, the interpolated velocities of all particles are
loaded into memory one frame at a time, and if it is 50, 50 frames worth
of interpolated velocities are loaded, and then no loading occurs for
the next 49 frames, after which the next 50 are loaded. This way, the
speed and memory usage can be adjusted; the larger the number, the
faster (though with diminishing returns) but the more memory required.</p>
<p>Please note that this option can be set to a value of -1, which will
cause all the interpolated velocities for all the particles of one
element to be loaded into memory at once. This way, the memory usage is
comparable to the ‘repeated interpolation’ interpolation mode. Further,
when SSD is used, the analysis can be faster than in the ‘repeated
interpolation’ mode.</p>
<ul class="simple">
<li><p><a class="reference external" href="#_A3.4._Q_vectors">q vectors</a></p></li>
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Normalize">normalize</a></p></li>
<li><p><a class="reference external" href="#_Atom_Transmutation_1">atom transmutation</a></p></li>
<li><p><a class="reference external" href="#_Weights">weights</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="dynamic-coherent-structure-factor">
<h5><span class="section-number">7.9.1.4.3. </span>Dynamic Coherent Structure Factor<a class="headerlink" href="#dynamic-coherent-structure-factor" title="Permalink to this heading"></a></h5>
<p id="theory-and-implementation-6">Theory and implementation</p>
<p>Please refer to <a class="reference external" href="#_Theory_and_background">Scattering Theory and
Background</a> for more details about the
theoretical background related to the dynamic coherent structure factor.
In this analysis, <em>MDANSE</em> proceeds in two steps. First, it computes the
partial and total intermediate coherent scattering function using
equation</p>
<div class="math">
<p><span class="math">40</span></p>
</div><p><a class="reference external" href="#anchor-121">Error: Reference source not found</a>. Then, the partial
and total dynamic coherent structure factors are obtained by performing
the Fourier Transformation, defined in Eq.</p>
<div class="math">
<p><span class="math">33</span></p>
</div><p><a class="reference external" href="#anchor-122">Error: Reference source not found</a>, respectively on
the total and partial intermediate coherent scattering functions.</p>
<p><em>MDANSE</em> computes the coherent intermediate scattering function on a
rectangular grid of equidistantly spaced points along the time-and the
<em>q</em>-axis, respectively:</p>
<p>F</p>
<div class="math">
<p><span class="math">{}_{\text{coh}}\left( {q_{m},k\cdot\Delta t} \right)\doteq{\sum\limits_{{I = 1},J\geq I}^{N_{\mathit{species}}}\sqrt{n_{I}n_{J}\omega_{I,\text{com}}\omega_{I,\text{com}}}}{\overline{\left\langle {\rho_{I}\left( {{-q},0} \right)\rho_{J}\left( {q,k\cdot\Delta t} \right)} \right\rangle}}^{q},</span></p>
</div><div class="math">
<p><span class="math">\begin{matrix}
{{k = 0}\ldots{N_{t} - 1},{m = 0}\ldots{N_{q} - 1.}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}51} \right) \\
\end{matrix}</span></p>
</div><p>where N<sub>t</sub> is the number of time steps in the coordinate time
series, N<sub>q</sub> is a user-defined number of <em>q</em>-shells,
N<sub>species</sub> is the number of selected species, n<sub>I</sub> the
number of atoms of species <em>I</em>, ω<sub>I</sub> the weight for specie <em>I</em>
(see Section ?? for more details) and</p>
<div class="math">
<p><span class="math">\rho_{I}\left( {q,k\cdot\Delta t} \right)</span></p>
</div><p>is the Fourier transformed particle density for specie <em>I</em> defined as,</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\rho_{I}{\left( {q,k\cdot\Delta t} \right) = \sum\limits_{\alpha}^{n_{I}}}\exp\left\lbrack {\mathit{iq}\cdot R_{\alpha}\left( {k\cdot\Delta t} \right)} \right\rbrack.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}52} \right) \\
\end{matrix}</span></p>
</div><p>The symbol</p>
<div class="math">
<p><span class="math">{\overline{...}}^{q}</span></p>
</div><p>in Eq.</p>
<div class="math">
<p><span class="math">51</span></p>
</div><p><a class="reference external" href="#anchor-123">Error: Reference source not found</a> denotes an average
over <em>q</em>-vectors having <em>approximately</em> the same modulus</p>
<div class="math">
<p><span class="math">{q_{m} = {q_{\mathit{\min}} + m}}\cdot\Delta q</span></p>
</div><p>. The particle density must not change if jumps in the particle
trajectories due to periodic boundary conditions occur. In addition, the
<em>average</em> particle density,</p>
<div class="math">
<p><span class="math">N/V</span></p>
</div><p>, must not change. This can be achieved by choosing <em>q</em>-vectors on a
lattice which is reciprocal to the lattice defined by the <em>MD</em> box. Let
<strong>b</strong><sub>1</sub>, <strong>b</strong><sub>2</sub>, <strong>b</strong><sub>3</sub> be the basis vectors
which span the <em>MD</em> cell. Any position vector in the <em>MD</em> cell can be
written as</p>
<div class="math">
<p><span class="math">\begin{matrix}
{{R = x^{'}}{b_{1} + y^{'}}{b_{2} + z^{'}}b_{3},} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}53} \right) \\
\end{matrix}</span></p>
</div><p>with x′, y′, z′ having values between 0 and 1. The primes indicate that
the coordinates are box coordinates. A jump due to periodic boundary
conditions causes x′, y′, z′ to jump by ∓1. The set of dual basis
vectors <strong>b</strong><sup>1</sup>, <strong>b</strong><sup>2</sup>, <strong>b</strong><sup>3</sup> is defined by
the relation</p>
<div class="math">
<p><span class="math">\begin{matrix}
{b_{i}{b^{j} = \delta_{i}^{j}}.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}54} \right) \\
\end{matrix}</span></p>
</div><p>If the q-vectors are now chosen as</p>
<div class="math">
<p><span class="math">\begin{matrix}
{{q = 2}\pi\left( {k{b^{1} + l}{b^{2} + m}b^{3}} \right),} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}55} \right) \\
\end{matrix}</span></p>
</div><p>where <em>k,l,m</em> are integer numbers, jumps in the particle trajectories
produce phase changes of multiples of 2π in the Fourier transformed
particle density, i.e. leave it unchanged. One can define a grid of
<em>q</em>-shells or a grid of <em>q</em>-vectors along a given direction or on a
given plane, giving in addition a <em>tolerance</em> for <em>q</em>. <em>MDANSE</em> looks
then for <em>q</em>-vectors of the form given in Eq.</p>
<div class="math">
<p><span class="math">61</span></p>
</div><p><a class="reference external" href="#anchor-124">Error: Reference source not found</a> whose moduli
deviate within the prescribed tolerance from the equidistant <em>q</em>-grid.
From these <em>q</em>-vectors only a maximum number per grid-point (called
generically <em>q</em>-shell also in the anisotropic case) is kept.</p>
<p>The <em>q</em>-vectors can be generated isotropically, anisotropically or along
user-defined directions. The</p>
<div class="math">
<p><span class="math">\sqrt{\omega_{I}}</span></p>
</div><p>may be negative if they represent normalized coherent scattering
lengths, i.e.</p>
<div class="math">
<p><span class="math">\begin{matrix}
{{\sqrt{\omega_{I}} = \frac{b_{I,\text{coh}}}{\sqrt{\sum\limits_{I = 1}^{N_{\mathit{species}}}{n_{I}b_{I,\text{coh}}^{2}}}}}.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}56} \right) \\
\end{matrix}</span></p>
</div><p>Negative coherent scattering lengths occur in hydrogenous materials
since</p>
<div class="math">
<p><span class="math">b_{\mathit{coh},H}</span></p>
</div><p>Is negative [<a class="reference external" href="#SignetBibliographie_020">20</a>]. The density-density
correlation is computed via the <em>FCA</em> technique described in the section
on <a class="reference external" href="#_Theory_and_implementation">Spatial Density</a>.</p>
<p id="gui-6">GUI</p>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<p><a class="reference internal" href="../_images/100000010000032200000261D8E9E9FE2C36FF14.png"><img alt="image24" src="../_images/100000010000032200000261D8E9E9FE2C36FF14.png" style="width: 15.921cm; height: 12.09cm;" /></a> <a class="reference internal" href="../_images/1000000100000320000000F8750817242922EC77.png"><img alt="image25" src="../_images/1000000100000320000000F8750817242922EC77.png" style="width: 15.921cm; height: 3.447cm;" /></a></p>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Instrument_resolution">instrument resolution</a></p></li>
<li><p><a class="reference external" href="#_A3.4._Q_vectors">q vectors</a></p></li>
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Atom_Transmutation_1">atom transmutation</a></p></li>
<li><p><a class="reference external" href="#_Weights">weights</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="dynamic-incoherent-structure-factor">
<h5><span class="section-number">7.9.1.4.4. </span>Dynamic Incoherent Structure Factor<a class="headerlink" href="#dynamic-incoherent-structure-factor" title="Permalink to this heading"></a></h5>
<p id="theory-and-implementation-7">Theory and implementation</p>
<p>Please refer to <a class="reference external" href="#_Q_Vectors">Scattering Theory and Background</a>
section for more details about the theoretical background related to the
dynamic incoherent structure factor. In this analysis, <em>MDANSE</em> proceeds
in two steps. First, it computes the partial and total intermediate
incoherent scattering function F<sub>inc</sub>(<strong>q</strong>, t) using equation</p>
<div class="math">
<p><span class="math">41</span></p>
</div><p><a class="reference external" href="#anchor-129">Error: Reference source not found</a>. Then, the partial
and total dynamic incoherent structure factors are obtained by
performing the Fourier Transformation, defined in Eq.</p>
<div class="math">
<p><span class="math">33</span></p>
</div><p><a class="reference external" href="#anchor-130">Error: Reference source not found</a>, respectively on
the total and partial intermediate incoherent scattering function.</p>
<p><em>MDANSE</em> computes the incoherent intermediate scattering function on a
rectangular grid of equidistantly spaced points along the time-and the
<em>q</em>-axis, respectively:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\text{F}_{\text{inc}}\left( {q_{m},k\cdot\Delta t} \right)\doteq{\sum\limits_{I = 1}^{N_{\mathit{species}}}{n_{I}\omega_{I,\text{inc}}}}\text{F}_{I,\text{inc}}\left( {q_{m},k\cdot\Delta t} \right),{k = 0}\ldots{N_{t} - 1},{m = 0}\ldots{N_{q} - 1.}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}57} \right) \\
\end{matrix}</span></p>
</div><p>where N<sub>t</sub> is the number of time steps in the coordinate time
series, N<sub>q</sub> is a user-defined number of <em>q</em>-shells,
N<sub>species</sub> is the number of selected species, n<sub>I</sub> the
number of atoms of species <em>I</em>, ω<sub>I</sub> the weight for specie <em>I</em>
(see Section ?? for more details) and</p>
<div class="math">
<p><span class="math">F_{I,\text{inc}}\left( {q_{m},k\cdot\Delta t} \right)</span></p>
</div><p>is defined as:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\text{F}_{I,\mathit{inc},\alpha}{\left( {q_{m},k\cdot\Delta t} \right) = \sum\limits_{\alpha = 1}^{n_{I}}}{\overline{\left\langle {\exp\left\lbrack {{-i}q\cdot R_{\alpha}(0)} \right\rbrack\exp\left\lbrack {iq\cdot R_{\alpha}(t)} \right\rbrack} \right\rangle}}^{q}.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}58} \right) \\
\end{matrix}</span></p>
</div><p>The symbol</p>
<div class="math">
<p><span class="math">{\overline{...}}^{q}</span></p>
</div><p>in Eq.</p>
<div class="math">
<p><span class="math">58</span></p>
</div><p><a class="reference external" href="#anchor-131">Error: Reference source not found</a> denotes an average
over <em>q</em>-vectors having <em>approximately</em> the same modulus</p>
<div class="math">
<p><span class="math">{q_{m} = {q_{\mathit{\min}} + m}}\cdot\Delta q</span></p>
</div><p>. The particle density must not change if jumps in the particle
trajectories due to periodic boundary conditions occur. In addition, the
<em>average</em> particle density, N/V, must not change. This can be achieved
by choosing <em>q</em>-vectors on a lattice which is reciprocal to the lattice
defined by the <em>MD</em> box. Let <strong>b</strong><sub>1</sub>, <strong>b</strong><sub>2</sub>,
<strong>b</strong><sub>3</sub> be the basis vectors which span the <em>MD</em> cell. Any
position vector in the <em>MD</em> cell can be written as</p>
<div class="math">
<p><span class="math">\begin{matrix}
{{R = x^{'}}{b_{1} + y^{'}}{b_{2} + z^{'}}b_{3},} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}59} \right) \\
\end{matrix}</span></p>
</div><p>with x′, y′, z′ having values between 0 and 1. The primes indicate that
the coordinates are box coordinates. A jump due to periodic boundary
conditions causes x′, y′, z′ to jump by ∓1. The set of dual basis
vectors <strong>b</strong><sup>1</sup>, <strong>b</strong><sup>2</sup>, <strong>b</strong><sup>3</sup> is defined by
the relation</p>
<div class="math">
<p><span class="math">\begin{matrix}
{b_{i}{b^{j} = \delta_{i}^{j}}.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}60} \right) \\
\end{matrix}</span></p>
</div><p>If the q-vectors are now chosen as</p>
<div class="math">
<p><span class="math">\begin{matrix}
{{q = 2}\pi\left( {k{b^{1} + l}{b^{2} + m}b^{3}} \right),} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}61} \right) \\
\end{matrix}</span></p>
</div><p>where <em>k,l,m</em> are integer numbers, jumps in the particle trajectories
produce phase changes of multiples of 2π in the Fourier transformed
particle density, i.e. leave it unchanged. One can define a grid of
<em>q</em>-shells or a grid of <em>q</em>-vectors along a given direction or on a
given plane, giving in addition a <em>tolerance</em> for <em>q</em>. <em>MDANSE</em> looks
then for <em>q</em>-vectors of the form given in Eq.</p>
<div class="math">
<p><span class="math">61</span></p>
</div><p><a class="reference external" href="#anchor-132">Error: Reference source not found</a> whose moduli
deviate within the prescribed tolerance from the equidistant <em>q</em>-grid.
From these <em>q</em>-vectors only a maximum number per grid-point (called
generically <em>q</em>-shell also in the anisotropic case) is kept.</p>
<p>The <em>q</em>-vectors can be generated isotropically, anisotropically or along
user-defined directions.</p>
<p>The correlation functions defined in</p>
<div class="math">
<p><span class="math">58</span></p>
</div><p><a class="reference external" href="#anchor-133">Error: Reference source not found</a> are computed via
the <em>FCA</em> technique described in <a class="reference external" href="#_Theory_and_implementation">Spatial
Density</a> section. Although the efficient
<em>FCA</em> technique is used to compute the atomic time correlation
functions, the program may consume a considerable amount of CPU-time
since the number of time correlation functions to be computed equals the
number of atoms times the total number of <em>q</em>-vectors. This analysis is
actually one of the most time-consuming among all the analysis available
in <em>MDANSE</em>.</p>
<p id="gui-7">GUI</p>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<p><a class="reference internal" href="../_images/10000001000003200000020ED42C0286B2E43D23.png"><img alt="image26" src="../_images/10000001000003200000020ED42C0286B2E43D23.png" style="width: 15.921cm; height: 10.469cm;" /></a> <a class="reference internal" href="../_images/1000000100000321000001BF1AACC92E311ED8D8.png"><img alt="image27" src="../_images/1000000100000321000001BF1AACC92E311ED8D8.png" style="width: 15.921cm; height: 8.885cm;" /></a></p>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Instrument_resolution">instrument resolution</a></p></li>
<li><p><a class="reference external" href="#_A3.4._Q_vectors">q vectors</a></p></li>
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Group_coordinates_by">Group coordinates by</a></p></li>
<li><p><a class="reference external" href="#_Atom_Transmutation_1">atom transmutation</a></p></li>
<li><p><a class="reference external" href="#_Project_coordinates">project coordinates</a></p></li>
<li><p><a class="reference external" href="#_Weights">weights</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="elastic-incoherent-structure-factor">
<h5><span class="section-number">7.9.1.4.5. </span>Elastic Incoherent Structure Factor<a class="headerlink" href="#elastic-incoherent-structure-factor" title="Permalink to this heading"></a></h5>
<p id="theory-and-implementation-8">Theory and implementation</p>
<p>The Elastic Incoherent Structure Factor (<em>EISF</em>) is defined as the limit
of the incoherent intermediate scattering function for infinite time,</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\mathit{EISF}(q)\doteq\lim\limits_{t\rightarrow\infty}\text{F}_{\mathit{inc}}\left( {q,t} \right).} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}62} \right) \\
\end{matrix}</span></p>
</div><p>Using the above definition of the EISF one can decompose the incoherent
intermediate scattering function as follows:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\text{F}_{\text{inc}}{\left( {q,t} \right) = \mathit{EISF}}{(q) + \text{F}_{\text{inc}}^{'}}\left( {q,t} \right),} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}63} \right) \\
\end{matrix}</span></p>
</div><p>where F<sub>inc</sub>’(<strong>q</strong>,t) decays to zero for infinite time. Taking
now the Fourier transform it follows immediately that</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\text{S}_{\text{inc}}{\left( {q,\omega} \right) = \mathit{EISF}}(q)\delta{(\omega) + \text{S}_{\text{inc}}^{'}}\left( {q,\omega} \right).} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}64} \right) \\
\end{matrix}</span></p>
</div><p>The <em>EISF</em> appears as the amplitude of the <em>elastic</em> line in the neutron
scattering spectrum. Elastic scattering is only present for systems in
which the atomic motion is confined in space, as for solids. To
understand which information is contained in the <em>EISF</em> we consider for
simplicity a system where only one sort of atoms is visible to the
neutrons. To a very good approximation this is the case for all systems
containing a large amount of hydrogen atoms, as biological systems.
Incoherent scattering from hydrogen dominates by far all other
contributions. Using the definition of the van Hove self-correlation
function G<sub>s</sub>(r, t) [<a class="reference external" href="#SignetBibliographie_020">20</a>],</p>
<div class="math">
<p><span class="math">\begin{matrix}
{b_{\text{inc}}^{2}G_{s}\left( {r,t} \right)\doteq\frac{1}{2\pi^{3}}{\int d^{3}}q\exp\left\lbrack {{- i}q\cdot r} \right\rbrack\text{F}_{\mathit{inc}}\left( {q,t} \right),} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}65} \right) \\
\end{matrix}</span></p>
</div><p>which can be interpreted as the conditional probability to find a tagged
particle at the position <strong>r</strong> at time t, given it started at <strong>r</strong> = 0,
one can write:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\mathit{EISF}{(q) = b_{\text{inc}}^{2{\int d^{3}}}}r\exp\left\lbrack {\mathit{iq}\cdot r} \right\rbrack G_{s}\left( {r,{t = \infty}} \right).} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}66} \right) \\
\end{matrix}</span></p>
</div><p>The <em>EISF</em> gives the sampling distribution of the points in space in the
limit of infinite time. In a real experiment this means times longer
than the time which is observable with a given instrument. The <em>EISF</em>
vanishes for all systems in which the particles can access an infinite
volume since G<sub>s</sub>(r, t) approaches 1/V for large times. This is
the case for molecules in liquids and gases.</p>
<p>For computational purposes it is convenient to use the following
representation of the <em>EISF</em> [<a class="reference external" href="#SignetBibliographie_021">21</a>]:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\mathit{EISF}{(q) = {\sum\limits_{I = 1}^{N_{\mathit{species}}}{n_{I}\omega_{I,\text{inc}}\mathit{EIS}F_{I}(q)}}}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}67} \right) \\
\end{matrix}</span></p>
</div><p>where N<sub>species</sub> is the number of selected species, n<sub>I</sub>
the number of atoms of species <em>I</em>, ω<sub>I,inc</sub> the weight for
specie <em>I</em> (see Section ?? for more details) and for each specie the
following expression for the elastic incoherent scattering function is</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\mathit{EIS}F_{I}{(q) = \frac{1}{n_{I}}}{\sum\limits_{\alpha}^{n_{I}}\left\langle {|{\exp\left\lbrack {\mathit{iq}\cdot R_{\alpha}} \right\rbrack\left. {} \right|^{2}}} \right\rangle}.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}68} \right) \\
\end{matrix}</span></p>
</div><p>This expression is derived from definition</p>
<div class="math">
<p><span class="math">62</span></p>
</div><p><a class="reference external" href="#anchor-138">Error: Reference source not found</a> of the <em>EISF</em> and
expression</p>
<div class="math">
<p><span class="math">41</span></p>
</div><p><a class="reference external" href="#anchor-139">Error: Reference source not found</a> for the
intermediate scattering function, using that for infinite time the
relation</p>
<div class="math">
<p><span class="math">\left\langle {\mathit{ex}p\left\lbrack {{- \mathit{iq}}\cdot R_{\alpha}(0)} \right\rbrack\mathit{ex}p\left\lbrack {\mathit{iq}\cdot R_{\alpha}(t)} \right\rbrack} \right\rangle = \left\langle {|{\mathit{ex}p\left\lbrack {\mathit{iq}\cdot R_{\alpha}} \right\rbrack\left. {} \right|^{2}}} \right\rangle</span></p>
</div><p>holds. In this way the computation of the <em>EISF</em> is reduced to the
computation of a static thermal average. We remark at this point that
the length of the <em>MD</em> trajectory from which the <em>EISF</em> is computed
should be long enough to allow for a representative sampling of the
conformational space.</p>
<p><em>MDANSE</em> allows one to compute the elastic incoherent structure factor
on a grid of equidistantly spaced points along the <em>q</em>-axis:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\mathit{EISF}\left( q_{m} \right)\doteq{\sum\limits_{I = 1}^{N_{\mathit{species}}}{n_{I}\omega_{I}\mathit{EIS}F_{I}\left( q_{m} \right)}},{m = 0}\ldots{N_{q} - 1.}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}69} \right) \\
\end{matrix}</span></p>
</div><p>where N<sub>q</sub> is a user-defined number of <em>q</em>-shells, the values for
q<sub>m</sub> are defined as</p>
<div class="math">
<p><span class="math">{q_{m} = {q_{\mathit{\min}} + m}}\cdot\Delta q</span></p>
</div><p>, and for each specie the following expression for the elastic
incoherent scattering function is:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\mathit{EIS}F_{I}{\left( q_{m} \right) = \frac{1}{n_{I}}}{\sum\limits_{\alpha}^{n_{I}}{\overline{\left\langle {|{\exp\left\lbrack {\mathit{iq}\cdot R_{\alpha}} \right\rbrack\left. {} \right|^{2}}} \right\rangle}}^{q}}.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}70} \right) \\
\end{matrix}</span></p>
</div><p>Here the symbol</p>
<div class="math">
<p><span class="math">{\overline{...}}^{q}</span></p>
</div><p>denotes an average over the <em>q</em>-vectors having the same modulus
q<sub>m</sub>. The program corrects the atomic input trajectories for
jumps due to periodic boundary conditions.</p>
<p id="gui-8">GUI</p>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<p><a class="reference internal" href="../_images/100000010000031F000001FD2749283C27712371.png"><img alt="image28" src="../_images/100000010000031F000001FD2749283C27712371.png" style="width: 15.921cm; height: 10.142cm;" /></a><a class="reference internal" href="../_images/100000010000032000000193F4C1E0DB6DC04C31.png"><img alt="image29" src="../_images/100000010000032000000193F4C1E0DB6DC04C31.png" style="width: 15.921cm; height: 8.019cm;" /></a></p>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_A3.4._Q_vectors">q vectors</a></p></li>
<li><p><a class="reference external" href="#_Project_coordinates">project coordinates</a></p></li>
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Group_coordinates_by">Group coordinates by</a></p></li>
<li><p><a class="reference external" href="#_Atom_Transmutation_1">atom transmutation</a></p></li>
<li><p><a class="reference external" href="#_Weights">weights</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="gaussian-dynamic-incoherent-structure-factor">
<h5><span class="section-number">7.9.1.4.6. </span>Gaussian Dynamic Incoherent Structure Factor<a class="headerlink" href="#gaussian-dynamic-incoherent-structure-factor" title="Permalink to this heading"></a></h5>
<p id="theory-and-implementation-9">Theory and implementation</p>
<p>The <em>MSD</em> can be related to the incoherent intermediate scattering
function via the cumulant expansion [<a class="reference external" href="#SignetBibliographie_011">11</a>],
[<a class="reference external" href="#SignetBibliographie_022">22</a>]</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\text{F}_{\text{inc}}^{g}{\left( {q,t} \right) = {\sum\limits_{I = 1}^{N_{\mathit{species}}}{n_{I}\omega_{I,\text{inc}}}}}\text{F}_{I,\text{inc}}^{g}\left( {q,t} \right)} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}71} \right) \\
\end{matrix}</span></p>
</div><p>where N<sub>species</sub> is the number of selected species, n<sub>I</sub>
the number of atoms of species <em>I</em>, ω<sub>I,inc</sub> the weight for
specie <em>I</em> (see Section ?? for more details) and</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\text{F}_{I,\text{inc}}^{g}{\left( {q,t} \right) = \frac{1}{n_{I}}}\sum\limits_{\alpha}^{n_{I}}\exp\left\lbrack {{- q^{2}}\rho_{\alpha,1}{(t) + q^{4}}\rho_{\alpha,2}(t)\mp\ldots} \right\rbrack.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}72} \right) \\
\end{matrix}</span></p>
</div><p>The cumulants</p>
<div class="math">
<p><span class="math">\rho_{\alpha,k}(t)</span></p>
</div><p>are identified as</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\rho_{\alpha,1}{(t) = \left\langle {d_{\alpha}^{2}\left( {t;n_{q}} \right)} \right\rangle}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}73} \right) \\
\end{matrix}</span></p>
</div><div class="math">
<p><span class="math">\begin{matrix}
{\rho_{\alpha,2}{(t) = \frac{1}{4!}}\left\lbrack {{\left\langle {d_{\alpha}^{4}\left( {t;n_{q}} \right)} \right\rangle - 3}\left\langle {d_{\alpha}^{2}\left( {t;n_{q}} \right)} \right\rangle^{2}} \right\rbrack} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}74} \right) \\
\end{matrix}</span></p>
</div><div class="math">
<p><span class="math">\vdots</span></p>
</div><p>The vector nq is the unit vector in the direction of q. In the Gaussian
approximation the above expansion is truncated after the
q<sup>2</sup>-term. For certain model systems like the ideal gas, the
harmonic oscillator, and a particle undergoing Einstein diffusion, this
is exact. For these systems the incoherent intermediate scattering
function is completely determined by the <em>MSD</em>. <em>MDANSE</em> allows one to
compute the total and partial incoherent intermediate scattering
function in the <em>Gaussian approximation</em> by discretizing equation</p>
<div class="math">
<p><span class="math">71</span></p>
</div><p><a class="reference external" href="#anchor-144">Error: Reference source not found</a>:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\text{F}_{\text{inc}}^{g}\left( {q_{m},k\cdot\Delta t} \right)\doteq{\sum\limits_{I = 1}^{N_{\mathit{species}}}{n_{I}\omega_{I,\text{inc}}\text{F}_{I,\text{inc}}^{g}\left( {q_{m},k\cdot\Delta t} \right)}},{k = 0}\ldots{N_{t} - 1},{m = 0}\ldots{N_{q} - 1.}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}75} \right) \\
\end{matrix}</span></p>
</div><p>with for each specie the following expression for the intermediate
scattering function:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\text{F}_{I,\alpha,\text{inc}}^{g}{\left( {q_{m},k\cdot\Delta t} \right) = \frac{1}{n_{I}}}\sum\limits_{\alpha}^{n_{I}}\exp\left\lbrack {\frac{- \left( q_{m} \right)^{2}}{6}\Delta_{\alpha}^{2}\left( {k\cdot\Delta t} \right)} \right\rbrack\mathit{isotropic}\mathit{system}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}76} \right) \\
\end{matrix}</span></p>
</div><div class="math">
<p><span class="math">\begin{matrix}
{\text{F}_{I,\alpha,\text{inc}}^{g}{\left( {q_{m},k\cdot\Delta t} \right) = \frac{1}{n_{I}}}\sum\limits_{\alpha}^{n_{I}}\exp\left\lbrack {\frac{- \left( q_{m} \right)^{2}}{2}\Delta_{\alpha}^{2}\left( {k\cdot\Delta t;n} \right)} \right\rbrack\mathit{isotropic}\mathit{system}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}77} \right) \\
\end{matrix}</span></p>
</div><p>N<sub>t</sub> is the total number of time steps in the coordinate time
series and N<sub>q</sub> is a user-defined number of <em>q</em>-shells. The (q,
t)-grid is the same as for the calculation of the intermediate
incoherent scattering function (see <a class="reference external" href="#_Dynamic_Incoherent_Structure">Dynamic Incoherent Structure
Factor</a>). The quantities</p>
<div class="math">
<p><span class="math">\Delta_{\alpha}^{2}(t)</span></p>
</div><p>and</p>
<div class="math">
<p><span class="math">\Delta_{\alpha}^{2}\left( {t;n} \right)</span></p>
</div><p>are the mean-square displacements, defined in Equations</p>
<div class="math">
<p><span class="math">5</span></p>
</div><p><a class="reference external" href="#anchor-145">Error: Reference source not found</a> and</p>
<div class="math">
<p><span class="math">6</span></p>
</div><p><a class="reference external" href="#anchor-146">Error: Reference source not found</a>, respectively.
They are computed by using the algorithm described in the <a class="reference external" href="#_Theory_and_implementation_2">Mean Square
Displacement</a> section. <em>MDANSE</em>
corrects the atomic input trajectories for jumps due to periodic
boundary conditions. It should be noted that the computation of the
intermediate scattering function in the Gaussian approximation is much
‘cheaper’ than the computation of the full intermediate scattering
function, F<sub>inc</sub>(q, t), since no averaging over different
<em>q</em>-vectors needs to be performed. It is sufficient to compute a single
mean-square displacement per atom.</p>
<p id="gui-9">GUI</p>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<p><a class="reference internal" href="../_images/1000000100000321000001FE1657294434127D8F.png"><img alt="image30" src="../_images/1000000100000321000001FE1657294434127D8F.png" style="width: 15.921cm; height: 10.137cm;" /></a> <a class="reference internal" href="../_images/1000000100000320000001E1A38060C427362263.png"><img alt="image31" src="../_images/1000000100000320000001E1A38060C427362263.png" style="width: 15.921cm; height: 9.573cm;" /></a></p>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p>q shells</p>
<ul>
<li><p><strong>from</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> &lt;insert&gt;</p>
<ul class="simple">
<li><ul>
<li><p><strong>to</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 10</p>
<p><em>Description:</em> &lt;insert&gt;</p>
<ul class="simple">
<li><ul>
<li><p><strong>by step of</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 1</p>
<p><em>Description:</em> determines the periodicity of which values are used and
which are skipped. 1 means that all values are used, 2 means every other
one is, etc.</p>
<ul class="simple">
<li><p><a class="reference external" href="#_Instrument_resolution">instrument resolution</a></p></li>
<li><p><a class="reference external" href="#_Project_coordinates">project coordinates</a></p></li>
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Group_coordinates_by">Group coordinates by</a></p></li>
<li><p><a class="reference external" href="#_Atom_Transmutation_1">atom transmutation</a></p></li>
<li><p><a class="reference external" href="#_Weights">weights</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="neutron-dynamic-total-structure-factor">
<h5><span class="section-number">7.9.1.4.7. </span>Neutron Dynamic Total Structure Factor<a class="headerlink" href="#neutron-dynamic-total-structure-factor" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<a class="reference internal image-reference" href="../_images/1000000100000322000002D4E0AD4E9A3996DE2A.png"><img alt="../_images/1000000100000322000002D4E0AD4E9A3996DE2A.png" src="../_images/1000000100000322000002D4E0AD4E9A3996DE2A.png" style="width: 15.921cm; height: 14.372cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Instrument_resolution">instrument resolution</a></p></li>
<li><p><a class="reference external" href="#_A3.4._Q_vectors">q vectors</a></p></li>
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Atom_Transmutation_1">atom transmutation</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="structure-factor-from-scattering-function">
<h5><span class="section-number">7.9.1.4.8. </span>Structure Factor From Scattering Function<a class="headerlink" href="#structure-factor-from-scattering-function" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p>available for analysis results only</p>
<ul>
<li><p>it appears in all analysis results, even for non-scattering
analyses which cannot be used to compute this</p></li>
</ul>
</li>
</ul>
<a class="reference internal image-reference" href="../_images/10000001000003220000013C4FCA0D96691C6F5F.png"><img alt="../_images/10000001000003220000013C4FCA0D96691C6F5F.png" src="../_images/10000001000003220000013C4FCA0D96691C6F5F.png" style="width: 15.921cm; height: 6.272cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Instrument_resolution">instrument resolution</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
</ul>
</section>
</section>
<section id="structure">
<h4><span class="section-number">7.9.1.5. </span>Structure<a class="headerlink" href="#structure" title="Permalink to this heading"></a></h4>
<p>This section has the following Plugins:</p>
<ul class="simple">
<li><p><a class="reference external" href="#_Area_Per_Molecule">Are Per Molecule</a></p></li>
<li><p><a class="reference external" href="#_Coordination_Number">Coordination Number</a></p></li>
<li><p><a class="reference external" href="#_Density_Profile">Density Profile</a></p></li>
<li><p><a class="reference external" href="#_Eccentricity">Eccentricity</a></p></li>
<li><p><a class="reference external" href="#_Molecular_Trace">Molecular Trace</a></p></li>
<li><p><a class="reference external" href="#_Pair_Distribution_Function">Pair Distribution Function</a></p></li>
<li><p><a class="reference external" href="#_Root_Mean_Square">Root Mean Square Deviation</a></p></li>
<li><p><a class="reference external" href="#_Root_Mean_Square_1">Root Mean Square Fluctuation</a></p></li>
<li><p><a class="reference external" href="#_Radius_Of_Gyration">Radius Of Gyration</a></p></li>
<li><p><a class="reference external" href="#_Solvent_Accessible_Surface">Solvent Accessible Surface</a></p></li>
<li><p><a class="reference external" href="#_Spatial_Density">Spatial Density</a></p></li>
<li><p><a class="reference external" href="#_Static_Structure_Factor">Static Structure Factor</a></p></li>
<li><p><a class="reference external" href="#_Voronoi">Voronoi</a></p></li>
<li><p><a class="reference external" href="#_Xray_Static_Structure">XRay Static Structure Factor</a></p></li>
</ul>
<section id="area-per-molecule">
<h5><span class="section-number">7.9.1.5.1. </span>Area Per Molecule<a class="headerlink" href="#area-per-molecule" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<a class="reference internal image-reference" href="../_images/100000010000032500000217C794C16C077B23E0.png"><img alt="../_images/100000010000032500000217C794C16C077B23E0.png" src="../_images/100000010000032500000217C794C16C077B23E0.png" style="width: 15.774cm; height: 10.582cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><strong>area vectors</strong></p></li>
</ul>
<p><em>Format:</em> drop-down</p>
<p><em>Default:</em> a, b</p>
<p><em>Description:</em> &lt;insert&gt;</p>
<ul class="simple">
<li><p><strong>molecule name</strong></p></li>
</ul>
<p><em>Format:</em> str</p>
<p><em>Default:</em> DMPC</p>
<p><em>Description:</em> the name of the molecules for which the calculation will
take place. The name inputted here must match a name that MMTK assigned
to inside the NetCDF file.</p>
<ul class="simple">
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="coordination-number">
<h5><span class="section-number">7.9.1.5.2. </span>Coordination Number<a class="headerlink" href="#coordination-number" title="Permalink to this heading"></a></h5>
<p id="theory-and-implementation-10">Theory and implementation</p>
<p>In chemistry, the Coordination Number (<em>CN</em>) is the total number of
neighbours of a central atom in a molecule or ion. The definition used
in <em>MDANSE</em> is somewhat different and can be seen as an extension of as
the former definition. Indeed, in <em>MDANSE</em>, the <em>CN</em> is not defined over
one defined central atom but around the centres of gravity of a set of
group of atoms. So, if only one group made of only atom is selected for
the analysis, then, the definition is the same as the original
definition. In that context, the <em>CN</em> is defined as:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{n{\left( {r,{r + \mathit{dr}}} \right) = \frac{1}{N_{G}}}{\sum\limits_{g = 1}^{N_{G}}{\sum\limits_{I = 1}^{N_{\mathit{species}}}{n_{\mathit{gI}}\left( {r,{r + \mathit{dr}}} \right)}}}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}78} \right) \\
\end{matrix}</span></p>
</div><p>where NG is the number of groups of atoms, N<sub>species</sub> is the
number of species found in the system and n<sub>gI</sub>(r) is the <em>CN</em>
defined for specie <em>I</em> defined as the number of atoms of species <em>I</em>
found in a shell of width <em>dr</em> at a distance <em>r</em> of the center of
gravity of the group of atom <em>g</em>.</p>
<p><em>MDANSE</em> allows one to compute the <em>CN</em> on a set of equidistantly spaced
distances at different times</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\mathit{CN}\left( r_{m} \right)\doteq\frac{1}{N_{\mathit{frames}}}\frac{1}{N_{G}}{\sum\limits_{f = 1}^{N_{\mathit{frames}}}{\sum\limits_{g = 1}^{N_{G}}{\sum\limits_{I = 1}^{N_{\mathit{species}}}{CN_{\mathit{gI}}\left( {r_{m},t_{f}} \right)}}}},{m = 0}\ldots{N_{r} - 1},{n = 0}\ldots{N_{\mathit{frames}} - 1.}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}79} \right) \\
\end{matrix}</span></p>
</div><p>where N<sub>r</sub> and N<sub>frames</sub> are respectively the number of
distances and times at which the <em>CN</em> is evaluated and</p>
<div class="math">
<p><span class="math">\begin{matrix}
{CN_{\mathit{gI}}{\left( {r_{m},t_{f}} \right) = n_{\mathit{gI}}}\left( {r_{m},t_{f}} \right),} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}80} \right) \\
\end{matrix}</span></p>
</div><p>is the number of atoms of specie <em>I</em> found within [rm, rm + dr] at frame
<em>f</em> from the centre of gravity of group <em>g</em>.</p>
<p>From these expressions, several remarks can be done. Firstly, the Eqs.</p>
<div class="math">
<p><span class="math">79</span></p>
</div><p><a class="reference external" href="#anchor-158">Error: Reference source not found</a> and</p>
<div class="math">
<p><span class="math">80</span></p>
</div><p><a class="reference external" href="#anchor-159">Error: Reference source not found</a> can be restricted
to intramolecular and intermolecular distances only. Secondly, these
equations can be averaged over the selected frames providing a time
averaged intra and intermolecular <em>CN</em>. Finally, the same equations
(time-dependent and time-averaged) can be integrated over r to provide a
cumulative <em>CN</em>. <em>MDANSE</em> computes all these variations.</p>
<p>The concept of <em>CN</em> is useful for structure-related analysis. It can
reveal for instance some packing effects that may have occurred during
the simulation.</p>
<p id="gui-10">GUI</p>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<a class="reference internal image-reference" href="../_images/100000010000031E000002773364C0C15571A8B0.png"><img alt="../_images/100000010000031E000002773364C0C15571A8B0.png" src="../_images/100000010000031E000002773364C0C15571A8B0.png" style="width: 15.921cm; height: 12.589cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p>r values</p>
<ul>
<li><p><strong>from</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> the minimum distance from a central particle in
nanometers taken into consideration. Only particles at that distance or
further will be counted.</p>
<ul class="simple">
<li><ul>
<li><p><strong>to</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 10</p>
<p><em>Description:</em> the maximum distance from a central particle in
nanometers. Only particles up to and including this distance will be
counted.</p>
<ul class="simple">
<li><ul>
<li><p><strong>by step of</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 1</p>
<p><em>Description:</em> the size of the step in nanometers used to generate a
range of values between the above two extremes above. Eg. using the
default r-values, the range will be {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10}.</p>
<ul class="simple">
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Atom_Transmutation_1">atom transmutation</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="density-profile">
<h5><span class="section-number">7.9.1.5.3. </span>Density Profile<a class="headerlink" href="#density-profile" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<a class="reference internal image-reference" href="../_images/1000000100000323000002F7066E8CC898B27610.png"><img alt="../_images/1000000100000323000002F7066E8CC898B27610.png" src="../_images/1000000100000323000002F7066E8CC898B27610.png" style="width: 15.921cm; height: 15.048cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Atom_Transmutation_1">atom transmutation</a></p></li>
<li><p><strong>axis</strong></p></li>
</ul>
<p><em>Format:</em> drop-down</p>
<p><em>Default:</em> c</p>
<p><em>Description:</em> the simulation box axis that Density Profile will be
calculated along.</p>
<ul class="simple">
<li><p><strong>dr</strong></p></li>
</ul>
<p><em>Format:</em> float</p>
<p><em>Default:</em> 0.01</p>
<p><em>Description:</em> during Density Profile calculation the axis specified in
the <strong>axis</strong> field is divided into a number of bins along its length.
<strong>dr</strong> specifies how large each of these bins will be.</p>
<ul class="simple">
<li><p><a class="reference external" href="#_Weights">weights</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="eccentricity">
<h5><span class="section-number">7.9.1.5.4. </span>Eccentricity<a class="headerlink" href="#eccentricity" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<a class="reference internal image-reference" href="../_images/100000010000032200000217EAF4D97A16B24CBA.png"><img alt="../_images/100000010000032200000217EAF4D97A16B24CBA.png" src="../_images/100000010000032200000217EAF4D97A16B24CBA.png" style="width: 15.921cm; height: 10.62cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Atom_Transmutation_1">atom transmutation</a></p></li>
<li><p><a class="reference external" href="#_Weights">weights</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
</ul>
</section>
<section id="molecular-trace">
<h5><span class="section-number">7.9.1.5.5. </span>Molecular Trace<a class="headerlink" href="#molecular-trace" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<a class="reference internal image-reference" href="../_images/100000010000032200000221CA1B5E3FC473217D.png"><img alt="../_images/100000010000032200000221CA1B5E3FC473217D.png" src="../_images/100000010000032200000221CA1B5E3FC473217D.png" style="width: 15.921cm; height: 10.82cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><strong>spatial resolution</strong></p></li>
</ul>
<p><em>Format:</em> float</p>
<p><em>Default:</em> 0.1</p>
<p><em>Description:</em> the resolution with which Molecular Trace is calculated.
It is used to determine how many grid points are used to represent a
unit of length.</p>
<ul class="simple">
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="pair-distribution-function">
<h5><span class="section-number">7.9.1.5.6. </span>Pair Distribution Function<a class="headerlink" href="#pair-distribution-function" title="Permalink to this heading"></a></h5>
<p id="theory-and-implementation-11">Theory and implementation</p>
<p>The Pair Distribution Function (<em>PDF</em>) is an example of a pair
correlation function, which describes how, on average, the atoms in a
system are radially packed around each other. This proves to be a
particularly effective way of describing the average structure of
disordered molecular systems such as liquids. Also in systems like
liquids, where there is continual movement of the atoms and a single
snapshot of the system shows only the instantaneous disorder, it is
extremely useful to be able to deal with the average structure.</p>
<p>The <em>PDF</em> is useful in other ways. For example, it is something that can
be deduced experimentally from x-ray or neutron diffraction studies,
thus providing a direct comparison between experiment and simulation. It
can also be used in conjunction with the interatomic pair potential
function to calculate the internal energy of the system, usually quite
accurately.</p>
<p>Mathematically, the <em>PDF</em> can be computed using the following formula:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\mathit{PDF}{(r) = {\sum\limits_{{I = 1},J\geq I}^{N_{\mathit{species}}}n_{I}}}n_{J}\omega_{I}\omega_{J}g_{\mathit{IJ}}(r)} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}81} \right) \\
\end{matrix}</span></p>
</div><p>where N<sub>species</sub> is the number of selected species, n<sub>I</sub>
and n<sub>J</sub> are respectively the numbers of atoms of species <em>I</em> and
<em>J</em>, ω<sub>I</sub> and ω<sub>J</sub> respectively the weights for species
<em>I</em> and <em>J</em> (see Section ?? for more details) and</p>
<div class="math">
<p><span class="math">\mathit{PD}F_{\mathit{\alpha\beta}}(r)</span></p>
</div><p>is the partial <em>PDF</em> for I and J species that can be defined as:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\mathit{PD}F_{\mathit{IJ}}{(r) = \frac{\left\langle {\sum\limits_{\alpha = 1}^{n_{I}}{n_{\alpha J}(r)}} \right\rangle}{n_{I}\rho_{J}4\pi r^{2}\mathit{dr}}}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}82} \right) \\
\end{matrix}</span></p>
</div><p>where ρ<sub>J</sub> is the density of atom of specie <em>J</em> and</p>
<div class="math">
<p><span class="math">n_{\alpha J}(r)</span></p>
</div><p>is the mean number of atoms of specie <em>J</em> in a shell of width <em>dr</em> at
distance <em>r</em> of the atom α of specie <em>I</em>.</p>
<p>From the computation of PDF, two related quantities are also calculated;
the Radial Distribution Function (RDF), defined as</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\mathit{RDF}{(r) = 4}\pi r^{2}\rho_{0}\mathit{PDF}(r),} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}83} \right) \\
\end{matrix}</span></p>
</div><p>and the Total Correlation Function (TCF), defined as</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\mathit{TCF}{(r) = 4}\pi r\rho_{0}\left( {\mathit{PDF}{(r) - 1}} \right),} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}83} \right) \\
\end{matrix}</span></p>
</div><p>where ρ<sub>0</sub> is the average atomic density, which is defined as</p>
<div class="math">
<p><span class="math">\begin{matrix}
{{\rho_{0} = \frac{N}{V}},} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}83} \right) \\
\end{matrix}</span></p>
</div><p>where N is the total number of atoms in the system and V the volume of
the simulation.</p>
<p>All these quantities are initially calculated as intramolecular and
intermolecular parts for each pair of atoms, which are then added to
create the total PDF/RDF/TCF for each pair of atoms, as well as the
total intramolecular and total intermolecular values. Lastly, the total
functions are computed. Please note, however, that in the case of TCF,
the below set of equations has been chosen, which will return results
that differ from those of nMOLDYN.</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\mathit{TCF}_{\mathit{intramolecular}}{(r) = 4}\pi r\rho_{0}\mathit{PDF}_{\mathit{intramolecular}}(r),} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}83} \right) \\
\end{matrix}</span></p>
</div><div class="math">
<p><span class="math">\begin{matrix}
{\mathit{TCF}_{\mathit{intermolecular}}{(r) = 4}\pi r\rho_{0}\left( {\mathit{PDF}_{\mathit{intermolecular}}{(r) - 1}} \right),} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}83} \right) \\
\end{matrix}</span></p>
</div><div class="math">
<p><span class="math">\begin{matrix}
{\mathit{TCF}_{\mathit{total}}{(r) = 4}\pi r\rho_{0}\left( {\mathit{PDF}_{\mathit{total}}{(r) - 1}} \right),} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}83} \right) \\
\end{matrix}</span></p>
</div><p id="gui-11">GUI</p>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<a class="reference internal image-reference" href="../_images/1000000100000321000002AF539D7E98B51D2ABC.png"><img alt="../_images/1000000100000321000002AF539D7E98B51D2ABC.png" src="../_images/1000000100000321000002AF539D7E98B51D2ABC.png" style="width: 15.921cm; height: 13.656cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p>r values</p>
<ul>
<li><p><strong>from</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> the minimum distance from a central particle in
nanometers taken into consideration. Only particles at that distance or
further will be counted.</p>
<ul class="simple">
<li><ul>
<li><p><strong>to</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 10</p>
<p><em>Description:</em> the maximum distance from a central particle in
nanometers. Only particles up to and including this distance will be
counted.</p>
<ul class="simple">
<li><ul>
<li><p><strong>by step of</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 1</p>
<p><em>Description:</em> the size of the step in nanometers used to generate a
range of values between the above two extremes above. Eg. using the
default r-values, the range will be {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10}.</p>
<ul class="simple">
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Atom_Transmutation_1">atom transmutation</a></p></li>
<li><p><a class="reference external" href="#_Weights">weights</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="root-mean-square-deviation">
<h5><span class="section-number">7.9.1.5.7. </span>Root Mean Square Deviation<a class="headerlink" href="#root-mean-square-deviation" title="Permalink to this heading"></a></h5>
<p id="theory-and-implementation-12">Theory and implementation</p>
<p>The Root Mean-Square Deviation (<em>RMSD</em>) is maybe the most popular
estimator of structural similarity. It is a numerical measure of the
difference between two structures that can be defined as:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\mathit{RMSD}{(t) = \sqrt{\frac{\sum\limits_{\alpha = 1}^{N_{\alpha}}\left( {r_{\alpha}{(t) - r_{\alpha}}\left( t_{\mathit{ref}} \right)} \right)}{N_{\alpha}}}}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}85} \right) \\
\end{matrix}</span></p>
</div><p>where N_ is the number of atoms of the system, and r_(t) and r_(tref )
are respectively the position of atom α at time t and tref where tref is
a reference time usually chosen as the first step of the simulation.
Typically, <em>RMSD</em> is used to quantify the structural evolution of the
system during the simulation. It can provide precious information about
the system especially if it reached equilibrium or conversely if major
structural changes occurred during the simulation.</p>
<p>In Molecular Dynamics Analysis for Neutron Scattering Experiments
(<em>MDANSE</em>), <em>RMSD</em> is computed using the discretized version of equation</p>
<div class="math">
<p><span class="math">83</span></p>
</div><p><a class="reference external" href="#anchor-174">Error: Reference source not found</a>:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\mathit{RMSD}{\left( {n\cdot\Delta t} \right) = \sqrt{\frac{\sum\limits_{\alpha = 1}^{N_{\alpha}}\left( {r_{\alpha}{(t) - r_{\mathit{ref}}}(t)} \right)}{N_{\alpha}}}},{n = 0}\ldots{N_{t} - 1}.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}86} \right) \\
\end{matrix}</span></p>
</div><p>where Nt is the number of frames and</p>
<div class="math">
<p><span class="math">\mathrm{\Delta}t</span></p>
</div><p>is the time step.</p>
<p id="gui-12">GUI</p>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<a class="reference internal image-reference" href="../_images/1000000100000320000002F9EA9ADCD8260F39E8.png"><img alt="../_images/1000000100000320000002F9EA9ADCD8260F39E8.png" src="../_images/1000000100000320000002F9EA9ADCD8260F39E8.png" style="width: 15.921cm; height: 15.145cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><strong>reference frame</strong></p></li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> the number of the frame which will be used as reference
for the calculation. The deviation will be calculated as how it deviates
from the values in this frame.</p>
<ul class="simple">
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Group_coordinates_by">Group coordinates by</a></p></li>
<li><p><a class="reference external" href="#_Atom_Transmutation_1">atom transmutation</a></p></li>
<li><p><a class="reference external" href="#_Weights">weights</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="root-mean-square-fluctuation">
<h5><span class="section-number">7.9.1.5.8. </span>Root Mean Square Fluctuation<a class="headerlink" href="#root-mean-square-fluctuation" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<a class="reference internal image-reference" href="../_images/100000010000031E0000021D3A0201B22A02F0F8.png"><img alt="../_images/100000010000031E0000021D3A0201B22A02F0F8.png" src="../_images/100000010000031E0000021D3A0201B22A02F0F8.png" style="width: 15.921cm; height: 10.793cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Group_coordinates_by">Group coordinates by</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="radius-of-gyration">
<h5><span class="section-number">7.9.1.5.9. </span>Radius Of Gyration<a class="headerlink" href="#radius-of-gyration" title="Permalink to this heading"></a></h5>
<p id="theory-and-implementation-13">Theory and implementation</p>
<p>Radius Of Gyration (<em>ROG</em>) is the name of several related measures of
the size of an object, a surface, or an ensemble of points. It is
calculated as the Root Mean Square Distance between the system and a
reference that can be either the centre of gravity of the system either
a given axis. In <em>MDANSE</em>, the reference is chosen to be the centre of
gravity of the system under study. Mathematically, it can be defined as:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\mathit{ROG}{(t) = \sqrt{\frac{\sum\limits_{\alpha = 1}^{N_{\alpha}}\left( {r_{\alpha}{(t) - r_{\mathit{cms}}}(t)} \right)}{N_{\alpha}}}}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}87} \right) \\
\end{matrix}</span></p>
</div><p>where</p>
<div class="math">
<p><span class="math">N_{\alpha}</span></p>
</div><p>is the number of atoms of the system, and r<sub>α</sub>(t) and
r<sub>cms</sub>(t) are respectively the position of atom α and the
centre of mass of the system at time t.</p>
<p><em>ROG</em> describes the overall spread of the molecule and as such is a good
measure for the molecule compactness. For example, it can be useful when
monitoring folding process.</p>
<p>In <em>MDANSE</em>, <em>ROG</em> is computed using the discretized version of equation</p>
<div class="math">
<p><span class="math">85</span></p>
</div><p><a class="reference external" href="#anchor-181">Error: Reference source not found</a>:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\mathit{ROG}{\left( {n\cdot\Delta t} \right) = \sqrt{\frac{\sum\limits_{\alpha = 1}^{N_{\alpha}}\left( {r_{\alpha}{(t) - r_{\mathit{cms}}}(t)} \right)}{N_{\alpha}}}},{n = 0}\ldots{N_{t} - 1.}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}88} \right) \\
\end{matrix}</span></p>
</div><p>where N<sub>t</sub> is the number of frames and Δt is the time step.</p>
<p id="gui-13">GUI</p>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<a class="reference internal image-reference" href="../_images/10000001000003210000021F447FD4560DD7995B.png"><img alt="../_images/10000001000003210000021F447FD4560DD7995B.png" src="../_images/10000001000003210000021F447FD4560DD7995B.png" style="width: 15.921cm; height: 10.793cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Weights">weights</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="solvent-accessible-surface">
<h5><span class="section-number">7.9.1.5.10. </span>Solvent Accessible Surface<a class="headerlink" href="#solvent-accessible-surface" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<a class="reference internal image-reference" href="../_images/1000000100000326000002790EB025922D724131.png"><img alt="../_images/1000000100000326000002790EB025922D724131.png" src="../_images/1000000100000326000002790EB025922D724131.png" style="width: 15.921cm; height: 12.504cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><strong>n sphere points</strong></p></li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 1000</p>
<p><em>Description:</em> Solvent Accessible Surface calculation involves the
creation of a mesh of points equidistant form each atom or molecule.
This field determines how many of these points should be created.</p>
<ul class="simple">
<li><p><strong>probe radius</strong></p></li>
</ul>
<p><em>Format:</em> float</p>
<p><em>Default:</em> 0.14</p>
<p><em>Description:</em> (in nanometers) affects the observed surface area.
Smaller probe radius detects more detail and therefore reports larger
surface area. The default value is approximately equal to the radius of
a water molecule.</p>
<ul class="simple">
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="spatial-density">
<h5><span class="section-number">7.9.1.5.11. </span>Spatial Density<a class="headerlink" href="#spatial-density" title="Permalink to this heading"></a></h5>
<p id="theory-and-implementation-14">Theory and implementation</p>
<p>The Spatial Density (<em>SD</em>) can be seen as a generalization of the pair
distribution function. Indeed, pair distribution functions are defined
as orientationally averaged distribution functions. Although these
correlation functions reflect many key features of the short-range order
in molecular systems, it should be realized that an average spatial
assembly of non-spherical particles cannot be uniquely characterized
from these one-dimensional functions. So, structural models postulated
for the molecular ordering in non-simple systems based only on
one-dimensional <em>PDF</em> will always be somewhat ambiguous. The goal of
<em>SD</em> analysis is to provide greater clarity in the structural analysis
of molecular systems by utilizing distribution function which span both
the radial and angular coordinates of the separation vector. This can
provide useful information about the average local structure in a
complex system.</p>
<p><em>MDANSE</em> allows one to compute the <em>SD</em> in spherical coordinates on a
set of concentric shells surrounding the centres of mass of selected
triplets of atoms using the formula:</p>
<div class="math">
<p><span class="math">\mathit{SD}\left( {r_{l},\theta_{m},\phi_{n}} \right)\doteq\frac{1}{N_{\mathit{triplets}N_{\mathit{groups}}}}{\sum\limits_{t = 1}^{N_{\mathit{triplets}}}{\sum\limits_{g = 1}^{N_{\mathit{groups}}}\left\langle {n_{\mathit{tg}}\left( {r_{l},\theta_{m},\phi_{n}} \right)} \right\rangle}},</span></p>
</div><div class="math">
<p><span class="math">\begin{matrix}
{{l = 0}\ldots{N_{r} - 1},{m = 0}\ldots{N_{\theta} - 1},{n = 0}\ldots{N_{\phi} - 1.}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}89} \right) \\
\end{matrix}</span></p>
</div><p>where N<sub>triplets</sub> and N<sub>groups</sub> are respectively the
number of triplets and groups, r<sub>l</sub>, θ<sub>m</sub> and φ<sub>n</sub>
are the spherical coordinates at which the <em>SD</em> is evaluated,
N<sub>r</sub>,</p>
<div class="math">
<p><span class="math">N_{\theta}</span></p>
</div><p>and</p>
<div class="math">
<p><span class="math">N_{\phi}</span></p>
</div><p>are respectively the number of discrete <em>r</em>, θ and φ values and
n<sub>tg</sub>(r<sub>l</sub>, θ<sub>m</sub>, φ<sub>n</sub>) is the number of
group of atoms of type <em>g</em> whose centres of mass is found to be in the
volume element defined by [r, r + dr], [θ, θ + dθ] and [φ, φ + dφ] in
the spherical coordinates basis cantered on the centre of mass of
triplet <em>t</em>. So technically, <em>MDANSE</em> proceeds more or less in the
following way:</p>
<ul>
<li><p>defines the centre of mass</p>
<div class="math">
<p><span class="math">c_{i}^{t}{i = 1},2\ldots N_{\mathit{triplets}}</span></p>
</div><p>for each triplet of atoms,</p>
</li>
<li><p>defines the centre of mass</p>
<div class="math">
<p><span class="math">c_{i}^{g}{i = 1},2\ldots N_{\mathit{groups}}</span></p>
</div><p>for each group of atoms,</p>
</li>
<li><p>constructs an oriented orthonormal basis</p>
<div class="math">
<p><span class="math">R_{i}^{t}{i = 1},2\ldots N_{\mathit{triplets}}</span></p>
</div><p>cantered on each c<sup>t</sup>, this basis is defined from the three
vectors <strong>v1</strong>, <strong>v2</strong>, <strong>v3</strong>,</p>
<ul>
<li><div class="math">
<p><span class="math">v_{1} = \frac{n_{1} + n_{2}}{\left| \left| {n_{1} + n_{2}} \right| \right|}</span></p>
</div><p>where <strong>n1</strong> and <strong>n2</strong> are respectively the normalized vectors
in (<strong>a1</strong>,<strong>a2</strong>) and (<strong>a1</strong>,<strong>a3</strong>) directions where
(<strong>a1</strong>,<strong>a2</strong>,<strong>a3</strong>) are the three atoms of the triplet <em>t</em>,</p>
</li>
<li><p>v<sub>2</sub> is defined as the clockwise normal vector orthogonal
to v1 that belongs to the plane defined by <strong>a1</strong>, <strong>a2</strong> and
<strong>a3</strong> atoms,</p></li>
<li><div class="math">
<p><span class="math">{\overrightarrow{v_{3}} = \overrightarrow{v_{1}}}\times\overrightarrow{v_{2}}</span></p>
</div></li>
</ul>
</li>
<li><p>expresses the cartesian coordinates of each c<sup>g</sup> in each
R<sup>t</sup>,</p></li>
<li><p>transforms these coordinates in spherical coordinates,</p></li>
<li><p>discretizes the spherical coordinates in r<sub>l</sub>, θ<sub>m</sub> and
φ<sub>n</sub>,</p></li>
<li><p>does</p>
<div class="math">
<p><span class="math">n_{\mathit{tg}}{\left( {r_{l},\theta_{m},\phi_{n}} \right) = n_{\mathit{tg}}}{\left( {r_{l},\theta_{m},\phi_{n}} \right) + 1}</span></p>
</div></li>
</ul>
<p id="gui-14">GUI</p>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<a class="reference internal image-reference" href="../_images/10000001000003200000027836715F0544BCA168.png"><img alt="../_images/10000001000003200000027836715F0544BCA168.png" src="../_images/10000001000003200000027836715F0544BCA168.png" style="width: 15.921cm; height: 12.578cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><strong>spatial resolution</strong></p></li>
</ul>
<p><em>Format:</em> float</p>
<p><em>Default:</em> 0.1</p>
<p><em>Description:</em> the resolution with which Spatial Density is calculated.
It is used to determine how many grid points are used to represent a
unit of length.</p>
<ul class="simple">
<li><p><strong>reference basis</strong></p></li>
</ul>
<p><em>Format:</em> drop-down</p>
<p><em>Default:</em> None</p>
<p><em>Description:</em> can be used exactly like <a class="reference external" href="#_Axis_Selection_1">Axis
Selection</a>. &lt;insert&gt; what it does</p>
<ul class="simple">
<li><p><strong>target molecule</strong></p></li>
</ul>
<p><em>Format:</em> drop-down</p>
<p><em>Default:</em> None</p>
<p><em>Description:</em> can be used exactly an Atom Selection. Allows for a
subset of particles to be selected on which the analysis will be
performed. More information in <a class="reference external" href="#_Atom_Selection_1">Atom Selection</a>.</p>
<ul class="simple">
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="static-structure-factor">
<h5><span class="section-number">7.9.1.5.12. </span>Static Structure Factor<a class="headerlink" href="#static-structure-factor" title="Permalink to this heading"></a></h5>
<p id="theory-and-implementation-15">Theory and implementation</p>
<p>This analysis is a shortcut to obtain the static coherent structure
factor defined as S(q) = F<sub>coh</sub>(q, t = 0). It uses exactly the
same procedure as the one defined in the <a class="reference external" href="#_Theory_and_implementation_3">Dynamic Coherent Structure
Factor</a> section.</p>
<p id="gui-15">GUI</p>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<a class="reference internal image-reference" href="../_images/1000000100000320000002FC939CE5AA59D4D2C7.png"><img alt="../_images/1000000100000320000002FC939CE5AA59D4D2C7.png" src="../_images/1000000100000320000002FC939CE5AA59D4D2C7.png" style="width: 15.921cm; height: 15.205cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p>r values</p>
<ul>
<li><p><strong>from</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> the minimum distance from a central particle in
nanometers taken into consideration. Only particles at that distance or
further will be counted.</p>
<ul class="simple">
<li><ul>
<li><p><strong>to</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 10</p>
<p><em>Description:</em> the maximum distance from a central particle in
nanometers. Only particles up to and including this distance will be
counted.</p>
<ul class="simple">
<li><ul>
<li><p><strong>by step of</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 1</p>
<p><em>Description:</em> the size of the step in nanometers used to generate a
range of values between the above two extremes above. Eg. using the
default r-values, the range will be {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10}.</p>
<ul class="simple">
<li><p>q values</p>
<ul>
<li><p><strong>from</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> the minimum value used to generate the range of q values.</p>
<ul class="simple">
<li><ul>
<li><p><strong>to</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 10</p>
<p><em>Description:</em> the maximum value used to generate the range of q values.</p>
<ul class="simple">
<li><ul>
<li><p><strong>by step of</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 1</p>
<p><em>Description:</em> the step size value used to generate the range of q
values.</p>
<ul class="simple">
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Atom_Transmutation_1">atom transmutation</a></p></li>
<li><p><a class="reference external" href="#_Weights">weights</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="voronoi">
<h5><span class="section-number">7.9.1.5.13. </span>Voronoi<a class="headerlink" href="#voronoi" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<a class="reference internal image-reference" href="../_images/1000000100000321000001B102EE53DCF2A6701F.png"><img alt="../_images/1000000100000321000001B102EE53DCF2A6701F.png" src="../_images/1000000100000321000001B102EE53DCF2A6701F.png" style="width: 15.921cm; height: 8.606cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><strong>apply periodic_boundary_condition</strong></p></li>
</ul>
<p><em>Format:</em> bool</p>
<p><em>Default:</em> True</p>
<p><em>Description:</em> determines if the periodic boundary conditions is applied
to the Voronoi cell.</p>
<ul class="simple">
<li><p><strong>pbc border size</strong></p></li>
</ul>
<p><em>Format:</em> float</p>
<p><em>Default:</em> 0.0</p>
<p><em>Description:</em> &lt;insert&gt;</p>
<ul class="simple">
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="xray-static-structure-factor">
<h5><span class="section-number">7.9.1.5.14. </span>Xray Static Structure Factor<a class="headerlink" href="#xray-static-structure-factor" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<a class="reference internal image-reference" href="../_images/1000000100000321000002B4804828B2E2D13E48.png"><img alt="../_images/1000000100000321000002B4804828B2E2D13E48.png" src="../_images/1000000100000321000002B4804828B2E2D13E48.png" style="width: 15.921cm; height: 13.755cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p>r values</p>
<ul>
<li><p><strong>from</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> the minimum distance from a central particle in
nanometers taken into consideration. Only particles at that distance or
further will be counted.</p>
<ul class="simple">
<li><ul>
<li><p><strong>to</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 10</p>
<p><em>Description:</em> the maximum distance from a central particle in
nanometers. Only particles up to and including this distance will be
counted.</p>
<ul class="simple">
<li><ul>
<li><p><strong>by step of</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 1</p>
<p><em>Description:</em> the size of the step in nanometers used to generate a
range of values between the above two extremes above. Eg. using the
default r-values, the range will be {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10}.</p>
<ul class="simple">
<li><p>q values</p>
<ul>
<li><p><strong>from</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> the minimum value used to generate the range of q values.</p>
<ul class="simple">
<li><ul>
<li><p><strong>to</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 10</p>
<p><em>Description:</em> the maximum value used to generate the range of q values.</p>
<ul class="simple">
<li><ul>
<li><p><strong>by step of</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 1</p>
<p><em>Description:</em> the step size value used to generate the range of q
values.</p>
<ul class="simple">
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Atom_Transmutation_1">atom transmutation</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
</section>
<section id="thermodynamics">
<h4><span class="section-number">7.9.1.6. </span>Thermodynamics<a class="headerlink" href="#thermodynamics" title="Permalink to this heading"></a></h4>
<p>This section contains the following Plugins:</p>
<ul class="simple">
<li><p><a class="reference external" href="#_Density">Density</a></p></li>
<li><p><a class="reference external" href="#_Temperature">Temperature</a></p></li>
</ul>
<section id="density">
<h5><span class="section-number">7.9.1.6.1. </span>Density<a class="headerlink" href="#density" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<a class="reference internal image-reference" href="../_images/1000000100000320000001955616A0F8950ADF86.png"><img alt="../_images/1000000100000320000001955616A0F8950ADF86.png" src="../_images/1000000100000320000001955616A0F8950ADF86.png" style="width: 15.921cm; height: 8.059cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="temperature">
<h5><span class="section-number">7.9.1.6.2. </span>Temperature<a class="headerlink" href="#temperature" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<a class="reference internal image-reference" href="../_images/10000001000003220000017A08B3789C04716632.png"><img alt="../_images/10000001000003220000017A08B3789C04716632.png" src="../_images/10000001000003220000017A08B3789C04716632.png" style="width: 15.921cm; height: 7.504cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Interpolation_order">interpolation order</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
</section>
<section id="trajectory">
<h4><span class="section-number">7.9.1.7. </span>Trajectory<a class="headerlink" href="#trajectory" title="Permalink to this heading"></a></h4>
<p>The Plugins within this section are listed below. They are used to
adjust the trajectory in some way.</p>
<ul class="simple">
<li><p><a class="reference external" href="#_Box_Translated_Trajectory">Box Translated Trajectory</a></p></li>
<li><p><a class="reference external" href="#_Center_Of_Masses">Centre Of Masses Trajectory</a></p></li>
<li><p><a class="reference external" href="#_Cropped_Trajectory">Cropped Trajectory</a></p></li>
<li><p><a class="reference external" href="#_Global_Motion_Filtered">Global Motion Filtered Trajectory</a></p></li>
<li><p><a class="reference external" href="#_Rigid_Body_Trajectory">Rigid Body Trajectory</a></p></li>
<li><p><a class="reference external" href="#_Unfolded_Trajectory">Unfolded Trajectory</a></p></li>
</ul>
<section id="box-translated-trajectory">
<h5><span class="section-number">7.9.1.7.1. </span>Box Translated Trajectory<a class="headerlink" href="#box-translated-trajectory" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<a class="reference internal image-reference" href="../_images/100000010000032000000182CFECE57E69B1E015.png"><img alt="../_images/100000010000032000000182CFECE57E69B1E015.png" src="../_images/100000010000032000000182CFECE57E69B1E015.png" style="width: 15.921cm; height: 7.682cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="center-of-masses-trajectory">
<h5><span class="section-number">7.9.1.7.2. </span>Center Of Masses Trajectory<a class="headerlink" href="#center-of-masses-trajectory" title="Permalink to this heading"></a></h5>
<p id="theory-and-implementation-16">Theory and implementation</p>
<p>The Center Of Mass Trajectory (<em>COMT</em>) analysis consists in deriving the
trajectory of the respective centres of mass of a set of groups of
atoms. In order to produce a visualizable trajectory, <em>MDANSE</em> assigns
the centres of mass to pseudo-hydrogen atoms whose mass is equal to the
mass of their associated group. Thus, the produced trajectory can be
reused for other analysis. In that sense, <em>COMT</em> analysis is a practical
way to reduce noticeably the dimensionality of a system.</p>
<p id="gui-16">GUI</p>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<a class="reference internal image-reference" href="../_images/1000000100000324000001CE931274740DA7326D.png"><img alt="../_images/1000000100000324000001CE931274740DA7326D.png" src="../_images/1000000100000324000001CE931274740DA7326D.png" style="width: 15.921cm; height: 9.148cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Group_coordinates_by">Group coordinates by</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="cropped-trajectory">
<h5><span class="section-number">7.9.1.7.3. </span>Cropped Trajectory<a class="headerlink" href="#cropped-trajectory" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<a class="reference internal image-reference" href="../_images/100000010000031E00000186B928A6B653B00BF5.png"><img alt="../_images/100000010000031E00000186B928A6B653B00BF5.png" src="../_images/100000010000031E00000186B928A6B653B00BF5.png" style="width: 15.921cm; height: 7.781cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="global-motion-filtered-trajectory">
<h5><span class="section-number">7.9.1.7.4. </span>Global Motion Filtered Trajectory<a class="headerlink" href="#global-motion-filtered-trajectory" title="Permalink to this heading"></a></h5>
<p id="theory-and-implementation-17">Theory and implementation</p>
<p>It is often of interest to separate global motion from internal motion,
both for quantitative analysis and for visualization by animated
display. Obviously, this can be done under the hypothesis that global
and internal motions are decoupled within the length and timescales of
the analysis. <em>MDANSE</em> can create Global Motion Filtered Trajectory
(<em>GMFT</em>) by filtering out global motions (made of the three
translational and rotational degrees of freedom), either on the whole
system or on a user-defined subset, by fitting it to a reference
structure (usually the first frame of the <em>MD</em>). Global motion filtering
uses a straightforward algorithm:</p>
<ul class="simple">
<li><p>for the first frame, find the linear transformation such that the
coordinate origin becomes the centre of mass of the system and its
principal axes of inertia are parallel to the three coordinates axes
(also called principal axes transformation),</p></li>
<li><p>this provides a reference configuration C<sub>ref</sub>,</p></li>
<li><p>for any other frames <em>f</em>, finds and applies the linear transformation
that minimizes the RMS distance between frame <em>f</em> and C<sub>ref</sub>.</p></li>
</ul>
<p>The result is stored in a new trajectory file that contains only
internal motions. This analysis can be useful in case where diffusive
motions are not of interest or simply not accessible to the experiment
(time resolution, powder analysis … ).</p>
<p id="gui-17">GUI</p>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<a class="reference internal image-reference" href="../_images/1000000100000322000002196544DE20D17020BF.png"><img alt="../_images/1000000100000322000002196544DE20D17020BF.png" src="../_images/1000000100000322000002196544DE20D17020BF.png" style="width: 15.921cm; height: 10.661cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><strong>reference basis</strong></p></li>
</ul>
<p><em>Format:</em> drop-down</p>
<p><em>Default:</em> None</p>
<p><em>Description:</em> can be used exactly like <a class="reference external" href="#_Axis_Selection_1">Axis
Selection</a>. &lt;insert&gt; what it does</p>
<ul class="simple">
<li><p><strong>Make the chemical object contiguous</strong></p></li>
</ul>
<p><em>Format:</em> bool</p>
<p><em>Default:</em> False</p>
<p><em>Description:</em> makes the configuration contiguous. This is done via MMTK
universe’s contiguousObjectConfiguration() method.</p>
<ul class="simple">
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="rigid-body-trajectory">
<h5><span class="section-number">7.9.1.7.5. </span>Rigid Body Trajectory<a class="headerlink" href="#rigid-body-trajectory" title="Permalink to this heading"></a></h5>
<p id="theory-and-implementation-18">Theory and implementation</p>
<p>To analyse the dynamics of complex molecular systems it is often
desirable to consider the overall motion of molecules or molecular
subunits. We will call this motion rigid-body motion in the following.
Rigid-body motions are fully determined by the dynamics of the centroid,
which may be the centre-of-mass, and the dynamics of the angular
coordinates describing the orientation of the rigid body. The angular
coordinates are the appropriate variables to compute angular correlation
functions of molecular systems in space and time. In most cases,
however, these variables are not directly available from <em>MD</em>
simulations since <em>MD</em> algorithms typically work in cartesian
coordinates. Molecules are either treated as flexible, or, if they are
treated as rigid, constraints are taken into account in the framework of
cartesian coordinates [<a class="reference external" href="#SignetBibliographie_023">23</a>]. In <em>MDANSE</em>,
Rigid-Body Trajectory (<em>RBT</em>) can be defined from a <em>MD</em> trajectory by
fitting rigid reference structures, defining a (sub)molecule, to the
corresponding structure in each time frame of the trajectory. Here ‘fit’
means the optimal superposition of the structures in a least-squares
sense. We will describe now how rigid body motions, i.e. global
translations and rotations of molecules or subunits of complex
molecules, can be extracted from a <em>MD</em> trajectory. A more detailed
presentation is given in [<a class="reference external" href="#SignetBibliographie_024">24</a>]. We define
an optimal rigid-body trajectory in the following way: for each time
frame of the trajectory the atomic positions of a rigid reference
structure, defined by the three cartesian components of its centroid
(e.g. the centre of mass) and three angles, are as close as possible to
the atomic positions of the corresponding structure in the <em>MD</em>
configuration. Here ‘as close as possible’ means as close as possible in
a least-squares sense.</p>
<p><strong>Optimal superposition.</strong> We consider a given time frame in which the
atomic positions of a (sub)molecule are given by</p>
<div class="math">
<p><span class="math">x_{\alpha},{\alpha = 1}\ldots N</span></p>
</div><p>. The corresponding positions in the reference structure are denoted as</p>
<div class="math">
<p><span class="math">x_{\alpha}^{(0)},{\alpha = 1}\ldots N</span></p>
</div><p>. For both the given structure and the reference structure we introduce
the yet undetermined centroids X and X<sup>(0)</sup>, respectively, and
define the deviation</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\Delta_{\alpha}\doteq D(q){\left\lbrack {x_{\alpha}^{(0)} - X^{(0)}} \right\rbrack - \left\lbrack {x_{\alpha} - X} \right\rbrack}.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}90} \right) \\
\end{matrix}</span></p>
</div><p>Here <strong>D(q)</strong> is a rotation matrix which depends on also yet
undetermined angular coordinates which we chose to be <em>quaternion
parameters</em>, abbreviated as vector <strong>q</strong> = (q<sub>0</sub>, q<sub>1</sub>,
q<sub>2</sub>, q<sub>3</sub>). The quaternion parameters fulfil the
normalization condition</p>
<div class="math">
<p><span class="math">q・{q = 1}</span></p>
</div><p>[<a class="reference external" href="#SignetBibliographie_025">25</a>]. The target function to be
minimized is now defined as</p>
<div class="math">
<p><span class="math">\begin{matrix}
{m{\left( {q;X,X^{(0)}} \right) = {\sum\limits_{\alpha}{\omega_{\alpha}|\Delta|_{\alpha}^{2}}}}.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}91} \right) \\
\end{matrix}</span></p>
</div><p>where ω<sub>α</sub> are atomic weights (see Section ??). The minimization
with respect to the centroids is decoupled from the minimization with
respect to the quaternion parameters and yields</p>
<div class="math">
<p><span class="math">\begin{matrix}
{{X = {\sum\limits_{\alpha}\omega_{\alpha}}}x_{\alpha},} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}92} \right) \\
\end{matrix}</span></p>
</div><div class="math">
<p><span class="math">\begin{matrix}
{{X^{(0)} = {\sum\limits_{\alpha}\omega_{\alpha}}}x_{\alpha}^{(0)}.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}93} \right) \\
\end{matrix}</span></p>
</div><p>We are now left with a minimization problem for the rotational part
which can be written as</p>
<div class="math">
<p><span class="math">\begin{matrix}
{m{(q) = {\sum\limits_{\alpha}{\omega_{\alpha}\left\lbrack {{D(q)r}_{\alpha}^{(0)} - r_{\alpha}} \right\rbrack^{2}}}\overset{!}{=}\mathit{Min}}.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}94} \right) \\
\end{matrix}</span></p>
</div><p>The relative position vectors</p>
<div class="math">
<p><span class="math">\begin{matrix}
{{r_{\alpha} = {x_{\alpha} - X}},} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}95} \right) \\
\end{matrix}</span></p>
</div><div class="math">
<p><span class="math">\begin{matrix}
{r_{\alpha}^{(0)} = {x_{\alpha}^{(0)} - X^{(0)}}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}96} \right) \\
\end{matrix}</span></p>
</div><p>are fixed and the rotation matrix reads
[<a class="reference external" href="#SignetBibliographie_025">25</a>]</p>
<div class="math">
<p><span class="math">\begin{matrix}
{D{(q) = \begin{pmatrix}
{q_{0}^{2} + q_{1}^{2} - q_{2}^{2} - q_{3}^{2}} &amp; {2\left( {{- q_{0}}{q_{3} + q_{1}}q_{2}} \right)} &amp; {2\left( {q_{0}{q_{2} + q_{1}}q_{3}} \right)} \\
{2\left( {q_{0}{q_{3} + q_{1}}q_{2}} \right)} &amp; {q_{0}^{2} + q_{2}^{2} - q_{1}^{2} - q_{3}^{2}} &amp; {2\left( {{- q_{0}}{q_{1} + q_{2}}q_{3}} \right)} \\
{2\left( {{- q_{0}}{q_{2} + q_{1}}q_{3}} \right)} &amp; {2\left( {q_{0}{q_{1} + q_{2}}q_{3}} \right)} &amp; {q_{0}^{2} + q_{3}^{2} - q_{1}^{2} - q_{2}^{2}} \\
\end{pmatrix}}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}97} \right) \\
\end{matrix}</span></p>
</div><p><strong>Quaternions and rotations.</strong> The rotational minimization problem can
be elegantly solved by using quaternion algebra. Quaternions are
so-called hypercomplex numbers, having a real unit, 1, and three
imaginary units, <strong>I</strong>, <strong>J</strong>, and <strong>K</strong>. Since <strong>IJ</strong> = <strong>K</strong> (cyclic),
quaternion multiplication is not commutative. A possible matrix
representation of an arbitrary quaternion,</p>
<div class="math">
<p><span class="math">\begin{matrix}
{{A = a_{0}}\cdot{1 + a_{1}}\cdot{I + a_{2}}\cdot{J + a_{3}}\cdot K,} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}98} \right) \\
\end{matrix}</span></p>
</div><p>reads</p>
<div class="math">
<p><span class="math">\begin{matrix}
{A = \begin{pmatrix}
a_{0} &amp; {- a_{1}} &amp; {- a_{2}} &amp; {- a_{3}} \\
a_{1} &amp; a_{0} &amp; {- a_{3}} &amp; a_{2} \\
a_{2} &amp; a_{3} &amp; a_{0} &amp; {- a_{1}} \\
a_{3} &amp; {- a_{2}} &amp; a_{1} &amp; a_{0} \\
\end{pmatrix}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}99} \right) \\
\end{matrix}</span></p>
</div><p>The components</p>
<div class="math">
<p><span class="math">a_{\upsilon}</span></p>
</div><p>are real numbers. Similarly, as normal complex numbers allow one to
represent rotations in a plane, quaternions allow one to represent
rotations in space. Consider the quaternion representation of a vector
r, which is given by</p>
<div class="math">
<p><span class="math">\begin{matrix}
{{R = x}\cdot{I + y}\cdot{J + z}\cdot K,} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}100} \right) \\
\end{matrix}</span></p>
</div><p>and perform the operation</p>
<div class="math">
<p><span class="math">\begin{matrix}
{{R^{'} = \mathit{QRQ}^{T}},} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}101} \right) \\
\end{matrix}</span></p>
</div><p>where Q is a normalised quaternion</p>
<div class="math">
<p><span class="math">\begin{matrix}
{\text{|}Q\text{|}^{2}\doteq{{q_{0}^{2} + q_{1}^{2} + q_{2}^{2} + q_{3}^{2}} = \frac{1}{4}}\mathit{tr}\text{\textbackslash\{}Q^{T}Q{\text{\textbackslash\}} = 1.}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}102} \right) \\
\end{matrix}</span></p>
</div><p>The symbol <em>tr</em> stands for ‘trace’. We note that a normalized quaternion
is represented by an <em>orthogonal</em> 4 × 4 matrix. <strong>R′</strong> may then be
written as</p>
<div class="math">
<p><span class="math">\begin{matrix}
{{R^{'} = x^{'}}\cdot{I + y^{'}}\cdot{J + z^{'}}\cdot K,} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}103} \right) \\
\end{matrix}</span></p>
</div><p>where the components x′, y′, z′, abbreviated as r′, are given by</p>
<div class="math">
<p><span class="math">\begin{matrix}
{{r^{'} = D}(q)r.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}104} \right) \\
\end{matrix}</span></p>
</div><p>The matrix <strong>D</strong>(<strong>q</strong>) is the rotation matrix defined in</p>
<div class="math">
<p><span class="math">95</span></p>
</div><p><a class="reference external" href="#anchor-221">Error: Reference source not found</a>.</p>
<p><strong>Solution of the minimization problem</strong>. In quaternion algebra, the
rotational minimization problem may now be phrased as follows:</p>
<div class="math">
<p><span class="math">\begin{matrix}
{m{(q) = {{\sum\limits_{\alpha}{{\omega_{\alpha}\text{|}\mathit{QR}}_{\alpha}^{(0)}Q}^{T}} - R_{\alpha}}}{\text{|}^{2}\overset{!}{=}\mathit{Min}}.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}105} \right) \\
\end{matrix}</span></p>
</div><p>Since the matrix Q representing a normalized quaternion is orthogonal
this may also be written as</p>
<div class="math">
<p><span class="math">\begin{matrix}
{{{m{(q) = {\sum\limits_{\alpha}\omega_{\alpha}}}\text{|}\mathit{QR}}_{\alpha}^{(0)} - R_{\alpha}}Q\text{|}^{2}{.\overset{!}{=}\mathit{Min}}.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}106} \right) \\
\end{matrix}</span></p>
</div><p>This follows from the simple fact that</p>
<div class="math">
<p><span class="math">\text{|}A{\text{|} = \text{|}}\mathit{AQ}\text{|}</span></p>
</div><p>, if Q is normalized. Eq.</p>
<div class="math">
<p><span class="math">104</span></p>
</div><p><a class="reference external" href="#anchor-222">Error: Reference source not found</a> shows that the
target function to be minimized can be written as a simple quadratic
form in the quaternion parameters [<a class="reference external" href="#SignetBibliographie_024">24</a>],</p>
<div class="math">
<p><span class="math">\begin{matrix}
{m{(q) = q}\cdot\mathit{Mq},} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}107} \right) \\
\end{matrix}</span></p>
</div><div class="math">
<p><span class="math">\begin{matrix}
{{M = {\sum\limits_{\alpha}{\omega_{\alpha}M_{\alpha}}}}.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}108} \right) \\
\end{matrix}</span></p>
</div><p>The matrices M_ are positive semi-definite matrices depending on the
positions</p>
<div class="math">
<p><span class="math">r_{\alpha}</span></p>
</div><p>and</p>
<div class="math">
<p><span class="math">r_{\alpha}^{(0)}</span></p>
</div><p>:</p>
<p><a class="reference internal" href="../_images/1000000000000226000000D8F0CF60C6C4938937.png"><img alt="image32" src="../_images/1000000000000226000000D8F0CF60C6C4938937.png" style="width: 13.123cm; height: 5.154cm;" /></a></p>
<div class="math">
<p><span class="math">({\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}109})</span></p>
</div><p>The rotational fit is now reduced to the problem of finding the minimum
of a quadratic form with the constraint that the quaternion to be
determined must be normalized. Using the method of Lagrange multipliers
to account for the normalization constraint we have</p>
<div class="math">
<p><span class="math">\begin{matrix}
{m^{'}{\left( {q,\lambda} \right) = q}\cdot{\mathit{Mq} - \lambda}{\left( {q\cdot{q - 1}} \right)\overset{!}{=}\mathit{Min}}.} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}110} \right) \\
\end{matrix}</span></p>
</div><p>This leads immediately to the eigenvalue problem</p>
<div class="math">
<p><span class="math">\begin{matrix}
{{\mathit{Mq} = \lambda}q,} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}111} \right) \\
\end{matrix}</span></p>
</div><div class="math">
<p><span class="math">\begin{matrix}
{q\cdot{q = 1.}} \\
\left( {\mathit{SEQ}\mathit{Equation}\mathit{ARABIC}112} \right) \\
\end{matrix}</span></p>
</div><p>Now any normalized eigenvector <strong>q</strong> fulfils the relation</p>
<div class="math">
<p><span class="math">{\lambda = q}\cdot\mathit{Mq}\equiv m(q)</span></p>
</div><p>. Therefore, the eigenvector belonging to the smallest eigenvalue,
λ<sub>min</sub>, is the desired solution. At the same time λ<sub>min</sub>
gives the average error per atom. The result of <em>RBT</em> analysis is stored
in a new trajectory file that contains only <em>RBT</em> motions.</p>
<p id="gui-18">GUI</p>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<a class="reference internal image-reference" href="../_images/100000010000032200000275B155A2D4E67091F5.png"><img alt="../_images/100000010000032200000275B155A2D4E67091F5.png" src="../_images/100000010000032200000275B155A2D4E67091F5.png" style="width: 15.921cm; height: 12.487cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Group_coordinates_by">Group coordinates by</a></p></li>
<li><p><strong>reference</strong></p></li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> the number of the frame that is used as reference.</p>
<ul class="simple">
<li><p><strong>remove translation</strong></p></li>
</ul>
<p><em>Format:</em> bool</p>
<p><em>Default:</em> False</p>
<p><em>Description:</em> &lt;insert&gt;</p>
<ul class="simple">
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
<section id="unfolded-trajectory">
<h5><span class="section-number">7.9.1.7.6. </span>Unfolded Trajectory<a class="headerlink" href="#unfolded-trajectory" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<a class="reference internal image-reference" href="../_images/100000010000031F0000018EC02857C67CB357DA.png"><img alt="../_images/100000010000031F0000018EC02857C67CB357DA.png" src="../_images/100000010000031F0000018EC02857C67CB357DA.png" style="width: 15.921cm; height: 7.93cm;" /></a>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><a class="reference external" href="#_Atom_Selection_1">atom selection</a></p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
</section>
<section id="virtual-instruments">
<h4><span class="section-number">7.9.1.8. </span>Virtual Instruments<a class="headerlink" href="#virtual-instruments" title="Permalink to this heading"></a></h4>
<section id="mcstas-virtual-instrument">
<h5><span class="section-number">7.9.1.8.1. </span>McStas Virtual Instrument<a class="headerlink" href="#mcstas-virtual-instrument" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<p><a class="reference internal" href="../_images/100000010000031F00000203A1B6C4356C211C30.png"><img alt="image33" src="../_images/100000010000031F00000203A1B6C4356C211C30.png" style="width: 15.921cm; height: 10.262cm;" /></a> <a class="reference internal" href="../_images/10000001000003220000018769B28972812F81A2.png"><img alt="image34" src="../_images/10000001000003220000018769B28972812F81A2.png" style="width: 15.921cm; height: 7.761cm;" /></a></p>
<ul class="simple">
<li><p><a class="reference external" href="#_Frames">frames</a></p></li>
<li><p><strong>MDANSE Coherent Structure Factor</strong></p></li>
</ul>
<p><em>Format:</em> str</p>
<p><em>Default:</em> ..\..\..\Data\NetCDF\dcsf_prot.nc</p>
<p><em>Description:</em> the path to a calculated Coherent Structure Factor. The
file must be in MMTK NetCDF file and should have been generated with
MDANSE’s Dynamic Coherent Structure Factor analysis &lt;link&gt;.</p>
<ul class="simple">
<li><p><strong>MDANSE Incoherent Structure Factor</strong></p></li>
</ul>
<p><em>Format:</em> str</p>
<p><em>Default:</em> ..\..\..\Data\NetCDF\disf_prot.nc</p>
<p><em>Description:</em> the path to a calculated Incoherent Structure Factor. The
file must be in MMTK NetCDF file and should have been generated with
MDANSE’s Dynamic Incoherent Structure Factor analysis &lt;link&gt;.</p>
<ul class="simple">
<li><p><strong>temperature</strong></p></li>
</ul>
<p><em>Format:</em> strictly positive float</p>
<p><em>Default:</em> 298.0</p>
<p><em>Description:</em> the temperature in Kelvin at which the MD simulation was
performed.</p>
<ul class="simple">
<li><p><strong>trace the 3D view of the simulation</strong></p></li>
</ul>
<p><em>Format:</em> bool</p>
<p><em>Default:</em> False</p>
<p><em>Description:</em> &lt;insert&gt;</p>
<ul class="simple">
<li><p><strong>mcstas instrument</strong></p></li>
</ul>
<p><em>Format:</em> drop-down</p>
<p><em>Default:</em> None</p>
<p><em>Description:</em> &lt;insert&gt;</p>
<ul class="simple">
<li><p>mcstas options</p>
<ul>
<li><p><strong>ncount</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> int</p>
<p><em>Default:</em> 10000</p>
<p><em>Description:</em> &lt;insert&gt;</p>
<ul class="simple">
<li><ul>
<li><p><strong>dir</strong></p></li>
</ul>
</li>
</ul>
<p><em>Format:</em> str</p>
<p><em>Default:</em> None</p>
<p><em>Description:</em> &lt;insert&gt;</p>
<ul class="simple">
<li><p>mcstas parameters – these options become visible once a McStas
instrument has been chosen.</p></li>
<li><p><a class="reference external" href="#_Output_files">output files</a></p></li>
<li><p><a class="reference external" href="#_Running_mode">running mode</a></p></li>
</ul>
</section>
</section>
</section>
<section id="miscellaneous">
<h3><span class="section-number">7.9.2. </span>Miscellaneous<a class="headerlink" href="#miscellaneous" title="Permalink to this heading"></a></h3>
<p>This section normally contains only one Plugin, which is present for
both trajectories and analysis results. However, some other Plugins
appear under certain circumstances.</p>
<section id="data-info">
<h4><span class="section-number">7.9.2.1. </span>Data info<a class="headerlink" href="#data-info" title="Permalink to this heading"></a></h4>
<ul class="simple">
<li><p>available for trajectories and analysis results</p></li>
</ul>
<p>This plugin opens a window containing an overview of the data stored in
the selected NetCDF file. For trajectory files, it might look like the
picture below, while it may not be able to read any data from an
analysis result. Generally, the following information should be included
for a trajectory:</p>
<ul class="simple">
<li><p>Location of the trajectory on disk</p></li>
<li><p>Number of time steps</p></li>
<li><p>Universe (the MMTK object)</p></li>
<li><p>Direct cell at the beginning</p></li>
<li><p>Reciprocal cell at the beginning</p></li>
<li><p>List of molecules</p></li>
<li><p>List of variables contained in the trajectory</p></li>
</ul>
<a class="reference internal image-reference" href="../_images/100000010000025700000277AC41F1013CDDDC3D.png"><img alt="../_images/100000010000025700000277AC41F1013CDDDC3D.png" src="../_images/100000010000025700000277AC41F1013CDDDC3D.png" style="width: 11.441cm; height: 12.053cm;" /></a>
</section>
<section id="animation">
<h4><span class="section-number">7.9.2.2. </span>Animation<a class="headerlink" href="#animation" title="Permalink to this heading"></a></h4>
<ul class="simple">
<li><p>available for trajectories only</p></li>
<li><p>appears only when <a class="reference external" href="#_Molecular_Viewer">Molecular Viewer</a> is active</p></li>
</ul>
<p>Once double-clicked, it creates a new bar below Molecular Viewer that
allows you to watch the whole MD simulation.</p>
<a class="reference internal image-reference" href="../_images/10000001000004540000004B8ED7C35C8B494D1E.png"><img alt="../_images/10000001000004540000004B8ED7C35C8B494D1E.png" src="../_images/10000001000004540000004B8ED7C35C8B494D1E.png" style="width: 15.921cm; height: 1.078cm;" /></a>
<ul class="simple">
<li><p><strong>Skip to the beginning</strong> button (leftmost) sets the frame number (15
in the picture above) to 0.</p></li>
<li><p><strong>Play</strong> button starts the simulation at the speed determined by the
rightmost box (95 in the picture above)</p></li>
<li><p><strong>Skip to the end</strong> button (right of Play) sets the frame number to
the last frame in the trajectory.</p></li>
<li><p>The left sliding bar allows you to select any of the frames in the
trajectory. It displays the frame number by altering the Frame number
box to the left of itself.</p></li>
<li><p><strong>Frame number</strong> box allows you to view a frame by typing in its
index. Press enter to view the frame.</p></li>
<li><p>The right sliding bar allows you to alter the speed at which the
simulation is shown. It also shows the speed in the box to the left
of itself.</p></li>
<li><p><strong>Speed</strong> determines how fast the simulation is displayed. The higher
the number, the faster the playback.</p></li>
</ul>
</section>
<section id="density-superposition">
<h4><span class="section-number">7.9.2.3. </span>Density Superposition<a class="headerlink" href="#density-superposition" title="Permalink to this heading"></a></h4>
<ul class="simple">
<li><p>available for trajectories only</p></li>
<li><p>appears only when <a class="reference external" href="#_Molecular_Viewer">Molecular Viewer</a> is active
and you have left-clicked anywhere inside it</p></li>
</ul>
<p>Double-clicking this opens the following window:</p>
<a class="reference internal image-reference" href="../_images/100000010000011B00000149C792FEA0A3BBF869.png"><img alt="../_images/100000010000011B00000149C792FEA0A3BBF869.png" src="../_images/100000010000011B00000149C792FEA0A3BBF869.png" style="width: 6.168cm; height: 7.17cm;" /></a>
<ul class="simple">
<li><p><strong>Select file</strong></p></li>
</ul>
<p><em>Format:</em> drop-down</p>
<p><em>Default:</em> None</p>
<p><em>Description:</em> first, a file has to be found using the <strong>Browse</strong>
button, and then it can be found in the drop-down menu. This file has to
be the result of <a class="reference external" href="#_Molecular_Trace">Molecular Trace</a> analysis.</p>
<ul class="simple">
<li><p><strong>Shape</strong></p></li>
</ul>
<p><em>Format:</em> str</p>
<p><em>Default:</em> loaded from file</p>
<p><em>Description:</em> cannot be edited.</p>
<ul class="simple">
<li><p><strong>Rendering mode</strong></p></li>
</ul>
<p><em>Format:</em> drop-down</p>
<p><em>Default:</em> surface</p>
<p><em>Description:</em> determines the way in which the Density Superposition is
displayed.</p>
<ul class="simple">
<li><p><strong>Opacity level</strong></p></li>
</ul>
<p><em>Format:</em> float between 0 and 1</p>
<p><em>Default:</em> 0.5</p>
<p><em>Description:</em> the opacity/transparency of the Density Superposition.</p>
<ul class="simple">
<li><p><strong>Contour Level</strong></p></li>
</ul>
<p><em>Format:</em> sliding bar</p>
<p><em>Default:</em> 0</p>
<p><em>Description:</em> determines the level of detail?&lt;insert&gt;</p>
<ul class="simple">
<li><p><strong>Clear</strong> button removes the Density Superposition from <a class="reference external" href="#_Molecular_Viewer">Molecular
Viewer</a>.</p></li>
<li><p><strong>Draw</strong> button add Density Superposition on top of <a class="reference external" href="#_Molecular_Viewer">Molecular
Viewer</a>.</p></li>
</ul>
</section>
<section id="trajectory-viewer">
<h4><span class="section-number">7.9.2.4. </span>Trajectory Viewer<a class="headerlink" href="#trajectory-viewer" title="Permalink to this heading"></a></h4>
<ul class="simple">
<li><p>Available for trajectories only</p></li>
<li><p>appears only when <a class="reference external" href="#_Molecular_Viewer">Molecular Viewer</a> is active</p></li>
</ul>
<p>This plugin was designed to help visualise the variables contained in a
trajectory. It can only plot the 3D trajectory variables, and nothing
else. It does this by separating the chosen 3D variable into its
constituent 1D parts and plotting those. This way, the x, y, or z
component of a chosen variable can be plotted for one atom against time.
Once it is double-clicked, the following window opens:</p>
<a class="reference internal image-reference" href="../_images/100000010000025700000213FCFF259FE25DE0B6.png"><img alt="../_images/100000010000025700000213FCFF259FE25DE0B6.png" src="../_images/100000010000025700000213FCFF259FE25DE0B6.png" style="width: 9.566cm; height: 8.453cm;" /></a>
<p>The plotting is controlled through the panel at the top, which is unique
to the Trajectory Viewer. The plot is visualised immediately after all
three fields are filled. It consists of these parameters:</p>
<ul class="simple">
<li><p><strong>Trajectory</strong></p></li>
</ul>
<p><em>Format</em>: drop-down</p>
<p><em>Default</em>: None</p>
<p><em>Description</em>: the variable that will be plotted. All 3D variables
present in the trajectory are available for plotting, meaning that
configuration (i.e., positions) can always be plotted, and velocities
and gradients if they are present.</p>
<ul class="simple">
<li><p><strong>Atom</strong></p></li>
</ul>
<p><em>Format:</em> positive int</p>
<p><em>Default:</em> 0</p>
<p><em>Description</em>: The atom for which the chosen variable will be plotted.
The number represents the index of the atom in the trajectory. The
arrows next to this box can be used to navigate the atoms one by one. If
a number larger than the number of atoms is inputted, the last atom will
instead be selected.</p>
<ul class="simple">
<li><p><strong>Dimension</strong></p></li>
</ul>
<p><em>Format:</em> drop-down</p>
<p><em>Default:</em> None</p>
<p><em>Description:</em> the spatial component of the selected variable which will
be plotted. For example, the change in position of a specific atom along
the x-axis over time can be plotted. The x, y, and z components of the
‘variable’ vectors are available for plotting.</p>
<p>The menu at the bottom of the plotter is identical to the one used in
<a class="reference external" href="#_Toolbar_1">Line Plotter</a>, and so the description of its function
can be found there. However, there is some difference in that; at the
very bottom of the Trajectory Viewer window are three options which work
differently here:</p>
<ul class="simple">
<li><p><strong>Clear</strong> button removes all the lines from the plot.</p></li>
<li><p><strong>Plot on same figure</strong></p></li>
</ul>
<p><em>Format:</em> Bool</p>
<p><em>Default:</em> False</p>
<p><em>Description:</em> controls the number of lines that can be plotted
simultaneously.</p>
<p>When it’s unticked (i.e., False) only one line can be plotted at a time.
Therefore, when a line is already plotted and any change is made in the
topmost toolbar, the current line is replaced by the new selection.</p>
<p>When it’s ticked (i.e., True), any number of lines can be plotted.
Therefore, when a line is already plotted and any change is made in the
topmost toolbar, a new line is added.</p>
<ul class="simple">
<li><p><strong>Show legend</strong></p></li>
</ul>
<p><em>Format:</em> Bool</p>
<p><em>Default:</em> False</p>
<p><em>Description:</em> Toggles the legend. When False, the legend is hidden.
When True, the legend appears in the location matplotlib determines as
‘best’.</p>
</section>
</section>
<section id="my-jobs">
<h3><span class="section-number">7.9.3. </span>My jobs<a class="headerlink" href="#my-jobs" title="Permalink to this heading"></a></h3>
<p>This section only appears if you have used the <a class="reference external" href="#save_analysis_template">Save analysis
template</a> button in the main window’s
toolbar. It contains all the analyses created this way and allows them
to be run.</p>
</section>
<section id="plotter">
<h3><span class="section-number">7.9.4. </span>Plotter<a class="headerlink" href="#plotter" title="Permalink to this heading"></a></h3>
<section id="d3d-plotter-1">
<span id="id3"></span><h4><span class="section-number">7.9.4.1. </span>2D/3D Plotter<a class="headerlink" href="#d3d-plotter-1" title="Permalink to this heading"></a></h4>
<ul class="simple">
<li><p>available for analysis results only</p></li>
</ul>
<p>Launches the 2D/3D Plotter inside the current tab of the working panel,
like below. For more information, please see <a class="reference external" href="#_2D/3D_Plotter">2D/3D
Plotter</a>.</p>
<a class="reference internal image-reference" href="../_images/1000000100000456000001F7F9358DAEDACCE259.png"><img alt="../_images/1000000100000456000001F7F9358DAEDACCE259.png" src="../_images/1000000100000456000001F7F9358DAEDACCE259.png" style="width: 15.921cm; height: 7.214cm;" /></a>
</section>
</section>
<section id="user-definition">
<h3><span class="section-number">7.9.5. </span>User definition<a class="headerlink" href="#user-definition" title="Permalink to this heading"></a></h3>
<p>This section contains all the
definitions/<a class="reference external" href="#_Creating_selections">selections</a> that have been made
for the selected NetCDF file, serving similar purpose to <a class="reference external" href="#user_definitions_editor">User
definition editor</a>.</p>
</section>
<section id="viewer">
<h3><span class="section-number">7.9.6. </span>Viewer<a class="headerlink" href="#viewer" title="Permalink to this heading"></a></h3>
<section id="molecular-viewer">
<h4><span class="section-number">7.9.6.1. </span>Molecular Viewer<a class="headerlink" href="#molecular-viewer" title="Permalink to this heading"></a></h4>
<ul class="simple">
<li><p>available for trajectories only</p></li>
</ul>
<p>Double-clicking on this option opens the Molecular Viewer plugin inside
the current tab of the <a class="reference external" href="#_Working_panel">Working panel</a>. This shows a
simulated 3D view of the first frame of the trajectory. The Viewer can
be interacted with by dragging the simulation and zooming in/out. It can
be closed using the x button in the top right corner:</p>
<a class="reference internal image-reference" href="../_images/1000000100000454000001F6A0725729E476539D.png"><img alt="../_images/1000000100000454000001F6A0725729E476539D.png" src="../_images/1000000100000454000001F6A0725729E476539D.png" style="width: 15.921cm; height: 7.213cm;" /></a>
<p>Clicking on an atom highlights it and prints out some basic information
about it in the Logger&lt;link&gt;. More options are available by
right-clicking anywhere inside the Molecular Viewer, which brings up the
following menu:</p>
<a class="reference internal image-reference" href="../_images/10000001000000E30000009A5B85D15F6882D700.png"><img alt="../_images/10000001000000E30000009A5B85D15F6882D700.png" src="../_images/10000001000000E30000009A5B85D15F6882D700.png" style="width: 6.008cm; height: 4.075cm;" /></a>
<ul class="simple">
<li><p><strong>Rendering</strong> brings up a menu of rendering options when hovered over
or clicked. These change the way the system is displayed and should
both self-explanatory and familiar from other molecular visualisation
software.</p></li>
<li><p><strong>Show/hide selection box</strong> creates a box around the whole system.
This disables your ability to move and rotate the system, but instead
you can move the faces of the box by dragging the large balls.
Everything inside the box is highlighted and considered selected.</p></li>
</ul>
<a class="reference internal image-reference" href="../_images/1000000100000456000001F44A4E1623C2FD5291.png"><img alt="../_images/1000000100000456000001F44A4E1623C2FD5291.png" src="../_images/1000000100000456000001F44A4E1623C2FD5291.png" style="width: 15.921cm; height: 7.172cm;" /></a>
<ul class="simple">
<li><p><strong>Save selection</strong> opens a window prompting you to enter a selection
name. Once that is done and OK is pressed, the selection will be
saved for the current trajectory using the atoms that have been
selected by either clicking on them or with the selection box above.</p></li>
<li><p><strong>Clear selection</strong> unselects all the selected atoms. It does not
hide the selection box, so interacting with it will once again select
all the atoms inside it.</p></li>
<li><p><strong>Parallel projection</strong> toggles on/off trimetric parallel projection
of the camera. According to Wikipedia
[<a class="reference external" href="#SignetBibliographie_026">26</a>], this means that three axes of
space should appear unequally foreshortened. The scale along each of
the three axes and the angles among them are determined separately as
dictated by the angle of viewing.</p></li>
<li><p><strong>Show/hide bounding box</strong> shows/hides the simulation box within
which the system is bound.</p></li>
</ul>
</section>
</section>
</section>
<section id="jobs">
<h2><span class="section-number">7.10. </span>Jobs<a class="headerlink" href="#jobs" title="Permalink to this heading"></a></h2>
<p>When an analysis is started by clicking on the Run button, it appears as
a job in this panel, like so:</p>
<a class="reference internal image-reference" href="../_images/10000001000007800000004AA7F683E25A4E52BB.png"><img alt="../_images/10000001000007800000004AA7F683E25A4E52BB.png" src="../_images/10000001000007800000004AA7F683E25A4E52BB.png" style="width: 15.921cm; height: 0.614cm;" /></a>
<ol class="arabic simple">
<li><p><strong>NAME</strong> field shows the unique name MDANSE assigned to the job. It
is also a button which shows the options that were selected for the
analysis:</p></li>
</ol>
<a class="reference internal image-reference" href="../_images/10000001000002A20000012C4E87306FF6F6DC3C.png"><img alt="../_images/10000001000002A20000012C4E87306FF6F6DC3C.png" src="../_images/10000001000002A20000012C4E87306FF6F6DC3C.png" style="width: 8.671cm; height: 3.859cm;" /></a>
<ol class="arabic simple">
<li><p><strong>PID</strong> field shows the process ID assigned by the operating system
to the job process.</p></li>
<li><p><strong>START</strong> field shows the exact date and time when this job was
started.</p></li>
<li><p><strong>ELAPSED</strong> field shows the time elapsed since the start of the job.</p></li>
<li><p><strong>STATE</strong> field shows the state of the job. This can be ‘running’,
indicating that MDANSE is in the process of performing the job,
‘finished’, indicating that the job was completed successfully, and
‘aborted’, indicating that the job failed due to an error. This field
is also a button which shows the traceback to the error that caused
the failure when clicked. This should provide all the information to
either correct your mistake or to inform us of a bug. When <a class="reference external" href="#_Toolbar">reporting
a bug</a>, please copy the entire traceback from here.</p></li>
</ol>
<a class="reference internal image-reference" href="../_images/100000010000077E00000029ED03FC61583BB04B.png"><img alt="../_images/100000010000077E00000029ED03FC61583BB04B.png" src="../_images/100000010000077E00000029ED03FC61583BB04B.png" style="width: 15.921cm; height: 0.34cm;" /></a>
<ol class="arabic simple">
<li><p><strong>PROGRESS</strong> field approximately shows the progress of the job. This
is not perfect, so it is not unusual if it appears to get stuck for a
long time, especially with large files. When that happens, it is
likely that MDANSE is performing a large and computationally
intensive stage. MDANSE performs jobs in four stages: initialisation,
run, combination, and finalisation. Of these, only the run stage is
composed of many steps, after each of which the progress bar is
updated. Of the other stages, any can be very computationally
intensive yet for them the bar is updated only at the beginning and
end of the stage.</p></li>
<li><p><strong>ETA</strong> field shows the estimated time until the completion of the
job. Similar to the progress field, this is not entirely accurate,
but it is a good rough estimate.</p></li>
<li><p><strong>KILL</strong> field contains a button that allows for the cancellation of
the job. This causes the job to be removed from this Jobs panel,
making space, visually, for more job. If the job was running when it
was killed, it will be stopped and no output file will be created.
First though, the button will make a notification prompt to appear,
asking if you are sure you want to kill the job.</p></li>
</ol>
<a class="reference internal image-reference" href="../_images/100000010000025C000000B1ACE43AF975D440AC.png"><img alt="../_images/100000010000025C000000B1ACE43AF975D440AC.png" src="../_images/100000010000025C000000B1ACE43AF975D440AC.png" style="width: 7.666cm; height: 2.245cm;" /></a>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="files.html" class="btn btn-neutral float-left" title="6. Input and output files" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="cmd.html" class="btn btn-neutral float-right" title="8. Using MDANSE from command line" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2015, Gael Goret, Bachir Aoun and Eric C. Pellegrini.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>